<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="46593819">
          <h3>
            <a class="item" href="https://developer.apple.com/news/?id=8jzbigf4"
              >Update on age requirements for apps distributed in Texas</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 20:27:34</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46593819"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46593802">
          <h3>
            <a class="item" href="https://www.bellard.org/ts_zip/"
              >Fabrice Bellard's TS Zip (2024)</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 20:26:47</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46593802"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46593395">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=c0mLhHDcY3I"
              >The chess bot on Delta Air Lines will destroy you (2024)
              [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 19:57:37</span
              ><span class="points-container"
                >Points: <span class="points">95</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46593395"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46593022">
          <h3>
            <a
              class="item"
              href="https://claude.com/blog/cowork-research-preview"
              >Cowork: Claude Code for the rest of your work</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 19:27:19</span
              ><span class="points-container"
                >Points: <span class="points">393</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46593022"
                  >Comments</a
                ><span class="descendants">: 212</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46592461">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/clearspace/jobs/GOWiDwp-research-engineer-at-clearspace"
              >Clearspace (YC W23) Is Hiring an Applied Researcher (ML)</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 18:41:47</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46592424">
          <h3>
            <a
              class="item"
              href="https://www.promptarmor.com/resources/superhuman-ai-exfiltrates-emails"
              >Superhuman AI exfiltrates emails</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 18:38:39</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46592424"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46592376">
          <h3>
            <a class="item" href="https://github.com/sarusso/bedtime"
              >Show HN: Fall asleep by watching JavaScript load</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 18:36:12</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46592376"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46592344">
          <h3>
            <a class="item" href="https://github.com/finbarr/yolobox"
              >Show HN: Yolobox – Run AI coding agents with full sudo without
              nuking home dir</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 18:34:02</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46592344"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46591708">
          <h3>
            <a class="item" href="https://walzr.com/postal-arbitrage"
              >Postal Arbitrage</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 17:41:50</span
              ><span class="points-container"
                >Points: <span class="points">197</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46591708"
                  >Comments</a
                ><span class="descendants">: 105</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46591402">
          <h3>
            <a
              class="item"
              href="https://www.cloudamqp.com/blog/message-queues-exaplined-with-analogies.html"
              >Message Queues: A Simple Guide with Analogies (2024)</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 17:17:09</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46591402"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46591100">
          <h3>
            <a class="item" href="https://www.trylad.com"
              >Show HN: AI in SolidWorks</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 16:56:17</span
              ><span class="points-container"
                >Points: <span class="points">96</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46591100"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.trylad.com/">https://www.trylad.com/</a>).
              <p>
                We come from software engineering backgrounds where tools like
                Claude Code and Cursor have come to dominate, but when poking
                around CAD systems a few months back we realized there's no way
                to go from a text prompt input to a modeling output in any of
                the major CAD systems. In our testing, the LLMs aren't as good
                at making 3D objects as they are are writing code, but we think
                they'll get a lot better in the upcoming months and years.
              </p>
              <p>
                To bridge this gap, we've created LAD, an add-in in SolidWorks
                to turn conversational input and uploaded documents/images into
                parts, assemblies, and macros. It includes:
              </p>
              <p>
                - Dozens of tools the LLM can call to create sketches, features,
                and other objects in parts.
              </p>
              <p>
                - Assembly tools the LLM can call to turn parts into assemblies.
              </p>
              <p>
                - File system tools the LLM can use to create, save, search, and
                read SolidWorks files and documentation.
              </p>
              <p>
                - Macro writing/running tools plus a SolidWorks API
                documentation search so the LLM can use macros.
              </p>
              <p>
                - Automatic screenshots and feature tree parsing to provide the
                LLM context on the current state.
              </p>
              <p>
                - Checkpointing to roll back unwanted edits and permissioning to
                determine which commands wait for user permission.
              </p>
              <p>
                You can try LAD at
                <a href="https://www.trylad.com/">https://www.trylad.com/</a>
                and let us know what features would make it more useful for your
                work. To be honest, the LLMs aren't great at CAD right now, but
                we're mostly curious to hear if people would want and use this
                if it worked well.
              </p>
            </div>
          </section>
        </section>
        <section id="46590541">
          <h3>
            <a
              class="item"
              href="https://github.com/scionassociation/blog-25gbit-workstation"
              >Building a 25 Gbit/s workstation for the SCION Association</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 16:20:16</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46590541"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46590280">
          <h3>
            <a class="item" href="https://github.com/haykgrigo3/TimeCapsuleLLM"
              >TimeCapsuleLLM: LLM trained only on data from 1800-1875</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 16:04:27</span
              ><span class="points-container"
                >Points: <span class="points">411</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46590280"
                  >Comments</a
                ><span class="descendants">: 179</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46589675">
          <h3>
            <a
              class="item"
              href="https://www.cnbc.com/2026/01/12/apple-google-ai-siri-gemini.html"
              >Apple picks Google's Gemini to power Siri</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 15:22:21</span
              ><span class="points-container"
                >Points: <span class="points">542</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46589675"
                  >Comments</a
                ><span class="descendants">: 322</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46589658">
          <h3>
            <a
              class="item"
              href="https://piccalil.li/blog/date-is-out-and-temporal-is-in/"
              >Date is out, Temporal is in</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 15:20:36</span
              ><span class="points-container"
                >Points: <span class="points">263</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46589658"
                  >Comments</a
                ><span class="descendants">: 86</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46589543">
          <h3>
            <a
              class="item"
              href="https://digitalseams.com/blog/computers-that-used-to-be-human"
              >Computers that used to be human</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 15:09:32</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46589543"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46588905">
          <h3>
            <a class="item" href="https://github.com/njbrake/agent-of-empires"
              >Show HN: Agent-of-empires: OpenCode and Claude Code session
              manager</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 14:23:07</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46588905"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
            <div class="text">
              <p>
                - Written in rust and relies on tmux for security and
                reliability - Monitors state of cli sessions to tell you when an
                agent is running vs idle vs waiting for your input - Manage
                sessions by naming them, grouping them, configuring profiles for
                various settings
              </p>
              <p>
                I'm passionate about getting self-hosted open-weight LLMs to be
                valid options to compete with proprietary closed models. One
                roadblock for me is that although tools like opencode allow you
                to connect to Local LLMs (Ollama, lm studio, etc), they
                generally run muuuuuch slower than models hosted by Anthropic
                and OpenAI. I would start a coding agent on a task, but then
                while I was sitting waiting for that task to complete, I would
                start opening new terminal windows to start multitasking. Pretty
                soon, I was spending a lot of time toggling between terminal
                windows to see which one needed me: like help in adding a
                clarification, approving a new command, or giving it a new task.
              </p>
              <p>
                That’s why I build agent-of-empires (“aoe”). With aoe, I can
                launch a bunch of opencode and Claude Code sessions and quickly
                see their status or toggle between them, which helps me avoid
                having a lot of terminal windows open, or having to manually
                attach and detach from tmux sessions myself. It’s helping me
                give local LLMs a fair try, because them being slower is now
                much less of a bottleneck.
              </p>
              <p>You can give it an install with</p>
              <p>
                curl -fsSL
                <a
                  href="https://raw.githubusercontent.com/njbrake/agent-of-empires/main/scripts/install.sh"
                  >https://raw.githubusercontent.com/njbrake/agent-of-empires/m...</a
                >
                | bash
              </p>
              <p>Or brew install njbrake/aoe/aoe</p>
              <p>And then launch by simply entering the command `aoe`.</p>
              <p>
                I’m interested in what you think as well as what features you
                think would be useful to add!
              </p>
              <p>
                I am planning to add some further features around sandboxing
                (with docker) as well as support for intuitive git worktrees and
                am curious if there are any opinions about what should or
                shouldn’t be in it.
              </p>
              <p>
                I decided against MCP management or generic terminal usage, to
                help keep the tool focused on parts of agentic coding that I
                haven’t found a usable solution for.
              </p>
              <p>
                I hit the character limit on this post which prevented me from
                including a view of the output, but the readme on the github
                link has a screenshot showing what it looks like.
              </p>
              <p>Thanks!</p>
            </div>
          </section>
        </section>
        <section id="46588837">
          <h3>
            <a
              class="item"
              href="https://www.npopov.com/2026/01/11/LLVM-The-bad-parts.html"
              >LLVM: The bad parts</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 14:18:13</span
              ><span class="points-container"
                >Points: <span class="points">252</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46588837"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46588572">
          <h3>
            <a
              class="item"
              href="https://taylorkolasinski.com/notes/mhc-reproduction/"
              >Reproducing DeepSeek's MHC: When Residual Connections Explode</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 13:57:32</span
              ><span class="points-container"
                >Points: <span class="points">91</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46588572"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46587934">
          <h3>
            <a
              class="item"
              href="https://blog.smartere.dk/2026/01/floppy-disks-the-best-tv-remote-for-kids/"
              >Floppy disks turn out to be the greatest TV remote for kids</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 13:07:49</span
              ><span class="points-container"
                >Points: <span class="points">451</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46587934"
                  >Comments</a
                ><span class="descendants">: 262</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46587804">
          <h3>
            <a class="item" href="https://github.com/z-libs/Zen-C"
              >Zen-C: Write like a high-level language, run like C</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 12:57:44</span
              ><span class="points-container"
                >Points: <span class="points">145</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46587804"
                  >Comments</a
                ><span class="descendants">: 86</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46587498">
          <h3>
            <a
              class="item"
              href="https://blog.gripdev.xyz/2026/01/10/actions-terminal-on-failure-for-debugging/"
              >Launch a Debugging Terminal into GitHub Actions</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 12:25:27</span
              ><span class="points-container"
                >Points: <span class="points">124</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46587498"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46586766">
          <h3>
            <a class="item" href="https://archaeologist.dev/artifacts/anthropic"
              >Anthropic made a mistake in cutting off third-party clients</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 10:57:29</span
              ><span class="points-container"
                >Points: <span class="points">180</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46586766"
                  >Comments</a
                ><span class="descendants">: 152</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46585947">
          <h3>
            <a
              class="item"
              href="https://www.bbc.com/news/articles/cj9r3zl2ywyo"
              >Ai, Japanese chimpanzee who counted and painted dies at 49</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-12 @ 09:10:45</span
              ><span class="points-container"
                >Points: <span class="points">161</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46585947"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46581095">
          <h3>
            <a class="item" href="https://cy.md/opencode-rce/"
              >Unauthenticated remote code execution in OpenCode</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-11 @ 22:33:32</span
              ><span class="points-container"
                >Points: <span class="points">167</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46581095"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
            <div class="text">
              Previous versions of OpenCode started a server which allowed any
              website visited in a web browser to execute arbitrary commands on
              the local machine. Make sure you are using v1.1.10 or newer; see
              link for more details.
            </div>
          </section>
        </section>
        <section id="46543257">
          <h3>
            <a class="item" href="https://www.raphkoster.com/2017/09/22/31098/"
              >What old tennis players teach us (2017)</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-08 @ 16:50:58</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46543257"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46529507">
          <h3>
            <a
              class="item"
              href="https://github.com/dev-sec/ansible-collection-hardening"
              >Ansible battle tested hardening for Linux, SSH, Nginx, MySQL</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-07 @ 17:38:53</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46529507"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46526896">
          <h3>
            <a
              class="item"
              href="https://www.openculture.com/2026/01/j-r-r-tolkien-reads-from-the-hobbit-for-30-minutes-1952.html"
              >JRR Tolkien reads from The Hobbit for 30 Minutes (1952)</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-07 @ 14:43:16</span
              ><span class="points-container"
                >Points: <span class="points">305</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46526896"
                  >Comments</a
                ><span class="descendants">: 118</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46525639">
          <h3>
            <a
              class="item"
              href="https://blog.yiningkarlli.com/2025/12/zootopia-2.html"
              >Personal thoughts/notes from working on Zootopia 2</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-07 @ 12:29:01</span
              ><span class="points-container"
                >Points: <span class="points">265</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46525639"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46519839">
          <h3>
            <a
              class="item"
              href="https://metacpan.org/dist/perlsecret/view/lib/perlsecret.pod"
              >Perlsecret – Perl secret operators and constants</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-06 @ 22:39:08</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46519839"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2026/index.md"
              >2026</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
