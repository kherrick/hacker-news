<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="41598276">
          <h3>
            <a
              class="item"
              href="https://manuelmoreale.com/thoughts-on-the-new-ios-control-centre"
              >Thoughts on the New iOS Control Centre</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-20 @ 02:32:56</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41598276"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41598170">
          <h3>
            <a
              class="item"
              href="https://petapixel.com/2024/09/18/why-apple-uses-jpeg-xl-in-the-iphone-16-and-what-it-means-for-your-photos/"
              >Why Apple Uses JPEG XL in the iPhone 16 and What It Means for
              Your Photos</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-20 @ 02:10:45</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41598170"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41598112">
          <h3>
            <a
              class="item"
              href="https://tinyapps.org/blog/202409180700_disable_sequoia_nag.html"
              >Disable Sequoia's monthly screen recording permission prompt</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-20 @ 01:56:49</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41598112"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41597929">
          <h3>
            <a
              class="item"
              href="https://travel.stackexchange.com/questions/26780/is-there-a-flight-search-engine-that-combines-flights-from-different-airlines"
              >A flight search engine that combines flights from different
              airlines? (2014)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-20 @ 01:20:32</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41597929"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41597830">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/gromo/jobs/GyqMnKn-business-analyst-product-analyst"
              >GroMo (YC W21) Is Hiring</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-20 @ 01:00:23</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41597676">
          <h3>
            <a class="item" href="https://github.com/pytorch-labs/LeanRL"
              >Show HN: LeanRL: Fast PyTorch RL with Torch.compile and CUDA
              Graphs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-20 @ 00:27:22</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41597676"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
            <div class="text">
              <p>
                Reinforcement learning is notoriously CPU-bound due to the high
                frequency of small CPU operations. PyTorch's powerful compiler
                can help alleviate these issues, but comes with its own costs.
                LeanRL addresses this challenge by providing simple recipes to
                accelerate your training loop and better utilize your GPU.
              </p>
              <p>
                Key results: - 6.8x speed-up with PPO (Atari) - 5.7x speed-up
                with SAC - 3.4x speed-up with TD3 - 2.7x speed-up with PPO
                (continuous actions)
              </p>
              <p>Why LeanRL?</p>
              <p>
                - Single-file implementations of RL algorithms with minimal
                dependencies in the spirit of gpt-fast - All optimization tricks
                are explained in the README - no heavy doc, just simple tricks -
                Forked from the popular CleanRL library
              </p>
              <p>
                Check out LeanRL on
                <a href="https://github.com/pytorch-labs/leanrl"
                  >https://github.com/pytorch-labs/leanrl</a
                >
                now!
              </p>
            </div>
          </section>
        </section>
        <section id="41597530">
          <h3>
            <a
              class="item"
              href="https://www.space.com/secret-satellites-caught-on-camera"
              >Caught on camera: Satellite tracker photographs secret
              spacecraft</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-19 @ 23:56:26</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41597530"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41597250">
          <h3>
            <a class="item" href="https://kibty.town/blog/arc/"
              >Gaining access to anyones browser without them even visiting a
              website</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-19 @ 23:04:42</span
              ><span class="points-container"
                >Points: <span class="points">108</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41597250"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41597162">
          <h3>
            <a class="item" href="https://simpleicons.org/"
              >3K free SVG icons for popular brands</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-19 @ 22:52:07</span
              ><span class="points-container"
                >Points: <span class="points">202</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41597162"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41596818">
          <h3>
            <a
              class="item"
              href="https://ittavern.com/visual-guide-to-ssh-tunneling-and-port-forwarding/"
              >Visual guide to SSH tunneling and port forwarding</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-19 @ 22:00:18</span
              ><span class="points-container"
                >Points: <span class="points">177</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41596818"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41596466">
          <h3>
            <a
              class="item"
              href="https://ianspence.com/blog/2024-09/github-email-hijack/"
              >GitHub Notification Emails Hijacked to Send Malware</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-19 @ 21:16:39</span
              ><span class="points-container"
                >Points: <span class="points">238</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41596466"
                  >Comments</a
                ><span class="descendants">: 79</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41595310">
          <h3>
            <a
              class="item"
              href="https://www.zombiezen.com/blog/2024/09/zb-early-stage-build-system/"
              >Zb: An Early-Stage Build System</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-19 @ 19:16:04</span
              ><span class="points-container"
                >Points: <span class="points">172</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41595310"
                  >Comments</a
                ><span class="descendants">: 68</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41594862">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/gadgets/2024/09/real-time-linux-is-officially-part-of-the-kernel-after-decades-of-debate/"
              >Real-time Linux is officially part of the kernel</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-19 @ 18:31:00</span
              ><span class="points-container"
                >Points: <span class="points">210</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41594862"
                  >Comments</a
                ><span class="descendants">: 68</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41594758">
          <h3>
            <a class="item" href="https://github.com/vaktibabat/ecurvechat"
              >Show HN: An Elliptic Curve-Based Secure Chat, Written Using Rust
              and Protobuf</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-19 @ 18:22:00</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41594758"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
            <div class="text">
              <a href="https://vaktibabat.github.io/posts/ecurvechat/"
                >https://vaktibabat.github.io/posts/ecurvechat/</a
              >) that explains all the crypto concepts and algorithms used in
              the project, and how I implemented them. I'd be very glad for any
              feedback about both the code and the post :)
            </div>
          </section>
        </section>
        <section id="41593809">
          <h3>
            <a
              class="item"
              href="https://www.ftc.gov/news-events/news/press-releases/2024/09/ftc-staff-report-finds-large-social-media-video-streaming-companies-have-engaged-vast-surveillance"
              >FTC: Vast Surveillance of Users by Social Media and Video
              Streaming Companies</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-19 @ 16:49:38</span
              ><span class="points-container"
                >Points: <span class="points">359</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41593809"
                  >Comments</a
                ><span class="descendants">: 236</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41593216">
          <h3>
            <a class="item" href="https://playground.numscript.org/"
              >Show HN: Numscript, a declarative language to model financial
              transactions</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-19 @ 15:59:19</span
              ><span class="points-container"
                >Points: <span class="points">144</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41593216"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
            <div class="text">
              <p>
                * Payments involving vouchers and a user's prepaid balance *
                Complex funds destination scenario where the customer gets cash
                back * Configurable user credit balance spending transactions
              </p>
              <p>
                The main idea is to take the pain out of describing of a system
                dealing with money movements should behave in traditional
                languages such as JS/TS/Go/Ruby etc, landing an expressive way
                to model these movements of value.
              </p>
              <p>
                It is voluntarily broad in applicability—our customers use it
                today for use-cases ranging from marketplaces funds
                orchestration to home-grown loan management systems.
              </p>
              <p>
                Once those transactions are modeled, they are to be picked up
                and committed to a system-of-record, ledgering system or
                executed on a set of payments and banking APIs.
              </p>
              <p>
                It was initially a DSL we bundled into our Core Ledger product
                at Formance (YCS21) but we're giving it more autonomy now and
                started to make it standalone, with the idea that anyone could
                eventually bolt Numscript on top of their ledgering system.
                We're also exploring to make it natively compatible with other
                backends.
              </p>
              <p>
                As part of this un-bundling, we've just shipping a playground
                which lets you fiddle with it without installing anything at
                <a href="https://playground.numscript.org/"
                  >https://playground.numscript.org/</a
                >
                (it works best on desktop).
              </p>
              <p>Happy to chime in on any questions!</p>
            </div>
          </section>
        </section>
        <section id="41592552">
          <h3>
            <a
              class="item"
              href="https://spectrum.ieee.org/5g-antenna-transparent-window"
              >Glass Antenna Turns windows into 5G Base Stations</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-19 @ 14:53:32</span
              ><span class="points-container"
                >Points: <span class="points">282</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41592552"
                  >Comments</a
                ><span class="descendants">: 98</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41591527">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2024-09-astronomers-biggest-black-hole-jets.html"
              >Biggest ever seen black hole jets; blasting plasma well beyond
              their own galaxy</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-19 @ 13:12:56</span
              ><span class="points-container"
                >Points: <span class="points">91</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41591527"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41591449">
          <h3>
            <a class="item" href="https://github.com/dragostis/chili"
              >Show HN: Chili. Rust port of Spice, a low-overhead
              parallelization library</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-19 @ 13:04:21</span
              ><span class="points-container"
                >Points: <span class="points">198</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41591449"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41591399">
          <h3>
            <a
              class="item"
              href="https://risk-engineering.org/concept/Rasmussen-practical-drift"
              >Drift towards danger and the normalization of deviance (2017)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-19 @ 12:58:18</span
              ><span class="points-container"
                >Points: <span class="points">168</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41591399"
                  >Comments</a
                ><span class="descendants">: 84</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41591018">
          <h3>
            <a class="item" href="https://github.com/MightyMoud/sidekick"
              >Show HN: A CLI tool I made to self-host any app with two commands
              on a VPS</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-19 @ 12:17:05</span
              ><span class="points-container"
                >Points: <span class="points">278</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41591018"
                  >Comments</a
                ><span class="descendants">: 102</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41590807">
          <h3>
            <a class="item" href="https://www.trebeljahr.com/posts/diatoms"
              >Diatom Arrangements</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-19 @ 11:47:45</span
              ><span class="points-container"
                >Points: <span class="points">146</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41590807"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41590466">
          <h3>
            <a class="item" href="https://larslofgren.com/forbes-marketplace/"
              >Forbes Marketplace: The Parasite SEO Company Trying to Devour Its
              Host</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-19 @ 10:44:08</span
              ><span class="points-container"
                >Points: <span class="points">319</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41590466"
                  >Comments</a
                ><span class="descendants">: 131</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41589361">
          <h3>
            <a
              class="item"
              href="https://neilmadden.blog/2024/09/18/digital-signatures-and-how-to-avoid-them/"
              >Digital signatures and how to avoid them</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-19 @ 07:12:16</span
              ><span class="points-container"
                >Points: <span class="points">109</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41589361"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41565056">
          <h3>
            <a
              class="item"
              href="https://wunkolo.github.io/post/2024/09/gpu-debug-scopes/"
              >GPU Debug Scopes</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-17 @ 06:59:52</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41565056"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41562506">
          <h3>
            <a
              class="item"
              href="https://placesjournal.org/article/julia-childs-kitchens/"
              >Julia Child's Kitchens</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-16 @ 23:54:56</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41562506"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41554729">
          <h3>
            <a class="item" href="https://github.com/Harvie/cnc-simulator"
              >I Revived 3-Axis CNC Mill G-Code Simulator</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-16 @ 10:45:54</span
              ><span class="points-container"
                >Points: <span class="points">128</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41554729"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41553930">
          <h3>
            <a
              class="item"
              href="https://www.fortressofdoors.com/ai-markets-for-lemons-and-the-great-logging-off/"
              >AI: Markets for Lemons, and the Great Logging Off</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-16 @ 08:20:52</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41553930"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41552562">
          <h3>
            <a
              class="item"
              href="https://aeon.co/essays/tender-and-creative-is-the-night-on-the-benefits-of-insomnia"
              >Spinning the Night Self</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-16 @ 03:45:18</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41552562"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41550907">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=Bicjxl4EcJg"
              >The Cheating Device (ChatGPT on a TI-84) [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-15 @ 22:15:22</span
              ><span class="points-container"
                >Points: <span class="points">227</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41550907"
                  >Comments</a
                ><span class="descendants">: 130</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
