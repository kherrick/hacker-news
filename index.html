<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="41390219">
          <h3>
            <a
              class="item"
              href="https://blog.karliner.net/posts/threads-enables-fediverse-replies/"
              >Meta's Threads enables Fediverse replies and likes</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-29 @ 12:43:12</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41390219"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41390094">
          <h3>
            <a
              class="item"
              href="https://www.wired.com/story/applebot-extended-apple-ai-scraping/"
              >Major Sites Are Saying No to Apple's AI Scraping</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-29 @ 12:29:07</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41390094"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41389931">
          <h3>
            <a class="item" href="https://lowcostminipcs.com/"
              >Show HN: Low Cost Mini PCs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-29 @ 12:03:41</span
              ><span class="points-container"
                >Points: <span class="points">154</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41389931"
                  >Comments</a
                ><span class="descendants">: 82</span></span
              >
            </h4>
            <div class="text">
              <p>
                I would like to add power usage, noise levels, PCIe slots but
                that data is hard to find.
              </p>
              <p>Please let me know if you have any feedback / suggestions.</p>
              <p>Thanks!</p>
            </div>
          </section>
        </section>
        <section id="41389806">
          <h3>
            <a
              class="item"
              href="https://ibis-project.org/posts/farewell-pandas/"
              >Farewell Pandas, and thanks for all the fish</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-29 @ 11:47:13</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41389806"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41389705">
          <h3>
            <a
              class="item"
              href="https://pointieststick.com/2024/08/28/asking-for-donations-in-plasma/"
              >KDE Asking for Donations</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-29 @ 11:31:24</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41389705"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41389642">
          <h3>
            <a class="item" href="https://www.webdesignmuseum.org/"
              >Web Design Museum</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-29 @ 11:23:53</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41389642"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41389378">
          <h3>
            <a
              class="item"
              href="https://web.archive.org/web/20070221033032/https://news.ycombinator.com/"
              >The first snapshot of Hacker News on Archive.org</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-29 @ 10:42:45</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41389378"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41389326">
          <h3>
            <a class="item" href="https://collidingscopes.github.io/ascii/"
              >Show HN: turn videos into ASCII art (open source, js+canvas)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-29 @ 10:35:55</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41389326"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
            <div class="text">
              <a href="https://github.com/collidingScopes/ascii"
                >https://github.com/collidingScopes/ascii</a
              >
            </div>
          </section>
        </section>
        <section id="41389185">
          <h3>
            <a
              class="item"
              href="https://glama.ai/blog/2024-08-29-reverse-engineering-minified-code-using-openai"
              >OpenAI is shockingly good at unminifying code</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-29 @ 10:14:50</span
              ><span class="points-container"
                >Points: <span class="points">273</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41389185"
                  >Comments</a
                ><span class="descendants">: 125</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41389176">
          <h3>
            <a class="item" href="https://github.com/remipch/solar_concentrator"
              >Show HN: Homemade Automated Solar Concentrator</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-29 @ 10:14:00</span
              ><span class="points-container"
                >Points: <span class="points">99</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41389176"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
            <div class="text">
              <p>
                I quit my job two years ago to have more time to work on my side
                projects.
              </p>
              <p>The main one is an automated solar concentrator.</p>
              <p>
                I've just open-sourced it, it's not perfect nor finished, and I
                still have a lot of ideas for further development, but I'm
                interested in knowing what you think of it.
              </p>
              <p>
                There are many applications where concentrated solar power could
                be a viable environmental and economic solution, I hope this
                technology will one day be more widely used.
              </p>
              <p>Feel free to give any feedback and ask questions.</p>
            </div>
          </section>
        </section>
        <section id="41389126">
          <h3>
            <a class="item" href="https://languagelog.ldc.upenn.edu/nll/?p=73"
              >Two Dots Too Many (2008)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-29 @ 10:04:43</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41389126"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41389000">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/society/article/2024/aug/28/type-2-diabetes-drug-associated-with-35-lower-risk-of-dementia-study-finds"
              >Type 2 diabetes drug associated with 35% lower risk of dementia,
              study finds</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-29 @ 09:44:11</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41389000"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41388888">
          <h3>
            <a
              class="item"
              href="https://www.politico.eu/article/uk-rail-minister-peter-hendy-fired-gareth-dennis-engineer-safety-concerns-trains-london-euston-station/"
              >UK rail minister got engineer sacked for raising safety
              concerns</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-29 @ 09:19:36</span
              ><span class="points-container"
                >Points: <span class="points">244</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41388888"
                  >Comments</a
                ><span class="descendants">: 133</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41388807">
          <h3>
            <a
              class="item"
              href="https://review.firstround.com/how-superhuman-built-an-engine-to-find-product-market-fit/"
              >Superhuman Built an Engine to Find Product Market Fit (2018)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-29 @ 09:06:17</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41388807"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41388805">
          <h3>
            <a class="item" href="https://paul.kinlan.me/fictitious-web/"
              >I spent an evening on a fictitious web</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-29 @ 09:05:47</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41388805"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41388335">
          <h3>
            <a class="item" href="https://github.com/dh1011/llm-term"
              >Show HN: LLM-Term – Simple Rust-based CLI assist tool</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-29 @ 07:42:45</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41388335"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
            <div class="text">
              Current AI-assisted CLI tools are often part of larger systems and
              work better on Linux. I built llm-term to address these. It's a
              Rust-based tool that compiles into a single binary file. You only
              need to download the binary, add it to your PATH, and configure
              your OpenAI key to get started. While llm-term offers an option
              for gpt-4o, it works great with gpt-4o-mini. So it's not costly. I
              appreciate any feedback or suggestions.
            </div>
          </section>
        </section>
        <section id="41388326">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/computer-scientists-prove-that-heat-destroys-entanglement-20240828/"
              >Computer Scientists Prove That Heat Destroys Entanglement</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-29 @ 07:41:36</span
              ><span class="points-container"
                >Points: <span class="points">96</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41388326"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41388111">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/windmill/jobs/REsQMZa-rust-typescript-engineer"
              >Windmill (YC S22) Hiring Rust and TypeScript Eng #3 in Paris</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-29 @ 07:01:10</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41387922">
          <h3>
            <a class="item" href="https://docusaurus.io/"
              >Docusaurus – Build optimized websites quickly, focus on your
              content</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-29 @ 06:27:36</span
              ><span class="points-container"
                >Points: <span class="points">106</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41387922"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41387674">
          <h3>
            <a
              class="item"
              href="https://www.saturdayeveningpost.com/wp-content/uploads/satevepost/what_life_means_to_einstein.pdf"
              >What Life Means to Einstein (1929) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-29 @ 05:32:49</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41387674"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41386319">
          <h3>
            <a
              class="item"
              href="https://blog.hopefullyuseful.com/blog/advantage-air-ezone-tablet-diy-repair/"
              >Air Con: $1697 for an on/off switch</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-29 @ 01:28:01</span
              ><span class="points-container"
                >Points: <span class="points">1326</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41386319"
                  >Comments</a
                ><span class="descendants">: 327</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41382335">
          <h3>
            <a class="item" href="https://www.windowmaker.org/"
              >Window Maker: X11 window manager with the look and feel of the
              NeXTSTEP UI</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-28 @ 18:05:29</span
              ><span class="points-container"
                >Points: <span class="points">247</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41382335"
                  >Comments</a
                ><span class="descendants">: 122</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41381598">
          <h3>
            <a class="item" href="https://github.com/sjpiper145/MakerSkillTree"
              >Maker Skill Trees</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-28 @ 17:01:15</span
              ><span class="points-container"
                >Points: <span class="points">401</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41381598"
                  >Comments</a
                ><span class="descendants">: 87</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41378317">
          <h3>
            <a
              class="item"
              href="https://www.qemu.org/docs/master/system/replay.html"
              >Deterministic Replay of QEMU Emulation</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-28 @ 11:24:23</span
              ><span class="points-container"
                >Points: <span class="points">105</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41378317"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41356954">
          <h3>
            <a
              class="item"
              href="https://www.adventurekid.se/2015/05/if-you-love-something-set-it-free-akwf-waveforms-are-now-in-the-public-domain/"
              >If you love something set it free – AKWF Waveforms now in public
              domain (2015)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-26 @ 13:33:44</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41356954"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41356666">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=41356666"
              >Ask HN: Developer PC setup automations for company owned
              devices</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-26 @ 12:54:03</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41356666"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
            <div class="text">
              <p>Current state:</p>
              <p>
                - Laptop with either Linux, Windows or MacOS pre-installed and
                integrated in Microsoft AD is provided.
              </p>
              <p>
                - The developer needs to install software, CLI tools, Git
                configuration and so on by following guides in our
                documentation.
              </p>
              <p>
                - Docs are frequently updated to reflect latest changes within
                the tooling (new version of software, different commands, ...).
              </p>
              <p>
                - Setup time is roughly a day for less experienced developers.
              </p>
              <p>
                Now some people ask for an automation to get a "pre-installed"
                laptop that only needs some sign-in credentials to get started.
                I'm sceptical that this does work without huge efforts,
                developers preferences might interfer a lot with the auomations.
                Especially for the upgrade case when updates happen.
              </p>
              <p>
                Is there any other company/your employer doing such a thing and
                how well does that work?
              </p>
            </div>
          </section>
        </section>
        <section id="41355731">
          <h3>
            <a
              class="item"
              href="https://www.zdnet.com/article/linus-torvalds-talks-ai-rust-adoption-and-why-the-linux-kernel-is-the-only-thing-that-matters/"
              >Linus Torvalds talks AI, Rust, &amp;amp; why Linux is the only
              thing that matters</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-26 @ 10:24:35</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41355731"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41347422">
          <h3>
            <a class="item" href="https://github.com/goshops-com/clipshare"
              >Open-source alternative to Loom that only requires S3</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-25 @ 14:10:22</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41347422"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41347188">
          <h3>
            <a
              class="item"
              href="https://simonwillison.net/2024/Aug/24/pipe-syntax-in-sql/"
              >Google's new pipe syntax in SQL</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-25 @ 13:33:23</span
              ><span class="points-container"
                >Points: <span class="points">300</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41347188"
                  >Comments</a
                ><span class="descendants">: 153</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41338124">
          <h3>
            <a
              class="item"
              href="https://github.com/Explosion-Scratch/firebuilder"
              >Show HN: Firebuilder: A complete Firefox customization tool</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-24 @ 13:22:00</span
              ><span class="points-container"
                >Points: <span class="points">112</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41338124"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
            <div class="text">
              <p>
                My tool (firebuilder) has an interactive CLI to select what to
                apply, (e.g. firefox hardening, custom CSS, etc) then creates a
                brand new profile folder for you. You can also seamlessly port
                from an existing profile folder to preserve all of your history,
                bookmarks, extensions, etc.
              </p>
              <p>
                For those more interested in using it programmatically
                everything is compiled from a config.json file which contains
                all the config necessary to build the said firefox profile. It
                currently supports: - userChrome tweaks - user.js (usually
                hardening related tweaks) - fx-autoconfig scripts - extending
                existing profiles. You can copy custom files or presets like
                history, bookmarks, extensions, etc
              </p>
              <p>
                Also its defaults (if you just have a blank config.json) do the
                following: - Apply hardening that removes telemetry, sponsors,
                some mozilla features - Keeps the browser very usable, doesn't
                remove unnecessary features or make things break - Adds vibrancy
                for macOS
              </p>
              <p>
                Firebuilder also supports whatever firefox tool you've been
                currently working on. It can install custom features from any
                git based repo, including downloading from releases, and keeping
                resources as well (so even if your theme sets custom icons
                you're still good!). Additionally if whatever you've created for
                firefox has about:config based settings these can be defined in
                the repo's json file as well.
              </p>
              <p>
                The codebase is mainly JavaScript, and is then compiled and run
                with Bun. I've intentionally tried to make it easy to add new
                features via PR and easy to extend via configuration. See the
                examples folder for lots of examples.
              </p>
              <p>
                Feel free to give any feedback, ask questions, etc, and drop a
                star if you like the project!
              </p>
            </div>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
