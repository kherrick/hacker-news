<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="46086863">
          <h3>
            <a
              class="item"
              href="https://www.jneurosci.org/content/early/2025/10/24/JNEUROSCI.0344-25.2025"
              >DMT-induced shifts in criticality correlate with
              self-dissolution</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-29 @ 11:52:21</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46086863"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46086771">
          <h3>
            <a
              class="item"
              href="https://www.bleepingcomputer.com/news/artificial-intelligence/leak-confirms-openai-is-preparing-ads-on-chatgpt-for-public-roll-out/"
              >Leak confirms OpenAI is preparing ads on ChatGPT for public roll
              out</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-29 @ 11:31:58</span
              ><span class="points-container"
                >Points: <span class="points">213</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46086771"
                  >Comments</a
                ><span class="descendants">: 163</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46086681">
          <h3>
            <a
              class="item"
              href="https://old.reddit.com/r/europe/comments/1p9kxhm/belgian_federal_police_forgot_to_turn_their_vpn/"
              >Belgian Police exposed using botnets to manipulate EU data law
              impact assessment</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-29 @ 11:10:39</span
              ><span class="points-container"
                >Points: <span class="points">116</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46086681"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46086624">
          <h3>
            <a
              class="item"
              href="https://scienceclock.com/exercise-may-protect-less-when-air-pollution-is-high-study-finds/"
              >High air pollution could diminish exercise benefits by half –
              study</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-29 @ 10:54:16</span
              ><span class="points-container"
                >Points: <span class="points">94</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46086624"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46085897">
          <h3>
            <a
              class="item"
              href="https://www.cs.utexas.edu/~EWD/transcriptions/EWD10xx/EWD1094.html"
              >The undeserved status of the pigeon-hole principle (1991)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-29 @ 08:14:23</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46085897"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46085585">
          <h3>
            <a
              class="item"
              href="https://en.wikipedia.org/wiki/Garfield%27s_proof_of_the_Pythagorean_theorem"
              >Garfield's Proof of the Pythagorean Theorem</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-29 @ 06:37:05</span
              ><span class="points-container"
                >Points: <span class="points">81</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46085585"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46084956">
          <h3>
            <a
              class="item"
              href="https://macos9lives.com/smforum/index.php?topic=7711.0"
              >System 7 natively boots on the Mac mini G4</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-29 @ 03:26:01</span
              ><span class="points-container"
                >Points: <span class="points">235</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46084956"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46084535">
          <h3>
            <a
              class="item"
              href="https://mathoverflow.net/questions/363119/every-mathematician-has-only-a-few-tricks"
              >Every mathematician has only a few tricks (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-29 @ 01:37:42</span
              ><span class="points-container"
                >Points: <span class="points">165</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46084535"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46084122">
          <h3>
            <a
              class="item"
              href="https://www.johndcook.com/blog/2025/11/28/tricusp-triangle/"
              >A triangle whose interior angles sum to zero</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-29 @ 00:26:42</span
              ><span class="points-container"
                >Points: <span class="points">115</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46084122"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46083303">
          <h3>
            <a
              class="item"
              href="https://kerrick.blog/articles/2025/confessions-of-a-software-developer-no-more-self-censorship/"
              >Confessions of a Software Developer: No More Self-Censorship</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-28 @ 22:21:25</span
              ><span class="points-container"
                >Points: <span class="points">276</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46083303"
                  >Comments</a
                ><span class="descendants">: 228</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46083051">
          <h3>
            <a
              class="item"
              href="https://roam.be/notes/2025/a-first-look-at-djangos-new-background-tasks/"
              >A first look at Django's new background tasks</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-28 @ 21:46:07</span
              ><span class="points-container"
                >Points: <span class="points">128</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46083051"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46083004">
          <h3>
            <a
              class="item"
              href="https://www.airbus.com/en/newsroom/press-releases/2025-11-airbus-update-on-a320-family-precautionary-fleet-action"
              >Airbus A320 – intense solar radiation may corrupt data critical
              for flight</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-28 @ 21:40:21</span
              ><span class="points-container"
                >Points: <span class="points">384</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46083004"
                  >Comments</a
                ><span class="descendants">: 114</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46082291">
          <h3>
            <a
              class="item"
              href="https://www.dolthub.com/blog/2025-11-13-electron-vs-tauri/"
              >Electron vs. Tauri</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-28 @ 20:06:30</span
              ><span class="points-container"
                >Points: <span class="points">104</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46082291"
                  >Comments</a
                ><span class="descendants">: 57</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46082204">
          <h3>
            <a class="item" href="https://github.com/gvanrossum/abc-unix"
              >The original ABC language, Python's predecessor (1991)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-28 @ 19:58:13</span
              ><span class="points-container"
                >Points: <span class="points">117</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46082204"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46081188">
          <h3>
            <a class="item" href="https://blog.tymscar.com/posts/imgurukproxy/"
              >Imgur geo-blocked the UK, so I geo-unblocked my network</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-28 @ 18:15:50</span
              ><span class="points-container"
                >Points: <span class="points">434</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46081188"
                  >Comments</a
                ><span class="descendants">: 146</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46081053">
          <h3>
            <a
              class="item"
              href="https://clickhouse.com/docs/getting-started/example-datasets/hackernews-vector-search-dataset"
              >28M Hacker News comments as vector embedding search dataset</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-28 @ 18:02:04</span
              ><span class="points-container"
                >Points: <span class="points">420</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46081053"
                  >Comments</a
                ><span class="descendants">: 156</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46080916">
          <h3>
            <a class="item" href="https://molly.im/"
              >Molly: An Improved Signal App</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-28 @ 17:48:25</span
              ><span class="points-container"
                >Points: <span class="points">366</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46080916"
                  >Comments</a
                ><span class="descendants">: 218</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46080364">
          <h3>
            <a class="item" href="https://blog.yakkomajuri.com/blog/local-rag"
              >So you wanna build a local RAG?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-28 @ 16:54:56</span
              ><span class="points-container"
                >Points: <span class="points">324</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46080364"
                  >Comments</a
                ><span class="descendants">: 76</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46080289">
          <h3>
            <a class="item" href="https://objectiveunclear.com/airloom.html"
              >Airloom – 3D Flight Tracker</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-28 @ 16:49:12</span
              ><span class="points-container"
                >Points: <span class="points">237</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46080289"
                  >Comments</a
                ><span class="descendants">: 73</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46080143">
          <h3>
            <a class="item" href="https://github.com/JB-SelfCompany/Tyr"
              >True P2P Email on Top of Yggdrasil Network</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-28 @ 16:35:24</span
              ><span class="points-container"
                >Points: <span class="points">158</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46080143"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46079073">
          <h3>
            <a
              class="item"
              href="https://gwern.net/doc/psychology/linguistics/2024-fedorenko.pdf"
              >Language is primarily a tool for communication rather than
              thought (2024) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-28 @ 14:42:19</span
              ><span class="points-container"
                >Points: <span class="points">92</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46079073"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46056715">
          <h3>
            <a
              class="item"
              href="https://fredkozlowski.com/2025/11/02/running-a-business-means-contact-with-reality/"
              >Running a Business Means Contact with Reality</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-26 @ 12:20:04</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46056715"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46054879">
          <h3>
            <a class="item" href="https://bourdain.greg.technology/"
              >Anthony Bourdain's Lost Li.st's</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-26 @ 07:03:27</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46054879"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
            <div class="text">
              I read through the years about Bourdain's content on the defunct
              li.st service, but was never able to find an archive of it. A more
              thorough perusing of archive.org and a pointer from an Internet
              stranger led me to create this site. Cheers
            </div>
          </section>
        </section>
        <section id="46045207">
          <h3>
            <a class="item" href="https://github.com/winapps-org/winapps"
              >WinApps: Run Windows apps as if they were a part of the native
              Linux OS</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-25 @ 12:34:25</span
              ><span class="points-container"
                >Points: <span class="points">214</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46045207"
                  >Comments</a
                ><span class="descendants">: 98</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46038868">
          <h3>
            <a
              class="item"
              href="https://www.johndcook.com/blog/2025/11/24/monero-stealth-addresses/"
              >How stealth addresses work in Monero</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-24 @ 20:29:21</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46038868"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46037031">
          <h3>
            <a class="item" href="https://neberej.github.io/exposedbydefault/"
              >Show HN: Explore what the browser exposes about you</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-24 @ 18:05:08</span
              ><span class="points-container"
                >Points: <span class="points">108</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46037031"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
            <div class="text">
              <p>
                GitHub:
                <a href="https://github.com/neberej/exposedbydefault"
                  >https://github.com/neberej/exposedbydefault</a
                >
              </p>
              <p>
                Demo:
                <a href="https://neberej.github.io/exposedbydefault/"
                  >https://neberej.github.io/exposedbydefault/</a
                >
              </p>
              <p>
                Note: No data is sent anywhere. Everything runs in your browser.
              </p>
            </div>
          </section>
        </section>
        <section id="46035126">
          <h3>
            <a class="item" href="https://webr.sh/">WebR – R in the Browser</a>
          </h3>
          <section>
            <h4>
              <span>2025-11-24 @ 15:27:53</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46035126"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46034255">
          <h3>
            <a class="item" href="https://github.com/asim/mu"
              >Show HN: Mu – The Micro Network</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-24 @ 14:06:40</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46034255"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46013269">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/s41746-025-02079-y"
              >The risk of round numbers and sharp thresholds in clinical
              practice</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-22 @ 08:51:08</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46013269"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46004895">
          <h3>
            <a class="item" href="https://github.com/Skarlso/adventure-voter"
              >Show HN: Choose your own adventure style Presentation</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-11-21 @ 14:24:21</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46004895"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
            <div class="text">
              <p>
                So... TL;DR: I find presentations boring. I find Choose your own
                adventure style books not boring. I married the two. Now, you
                can have presentations where the people you present two have the
                ability to choose how your presentation proceeds! And you can
                construct your presentation using plain markdown, start a
                server, your audience opens the `/voter` link you open the
                `/presenter` link and start your presentation. Whenever there is
                a question, they will choose and the presentation proceeds
                according to the choice.
              </p>
              <p>Longer version:</p>
              <p>
                In the years I partook on presentations I always liked the ones
                that are more interactive. Not in a I ask questions and then
                wait uncomfortably for people to shout out something, no. In a
                way where I, as a viewer, got something to do! Makes me more
                interested in the presentation as well, and I'll be learning and
                remembering things more as well.
              </p>
              <p>
                I also like choose your own adventure type of books. So I
                wondered, how could I make these two come together? So I wrote
                this little tool called adventure-voter. Not a very good name,
                but meh... The point is that you'll have a backend and a
                frontend to deal with votes and deal with following forks in
                your presentation. Going back from a fork if the fork ended up
                in death or a failed route. ( you procastinated, your backend
                didn't start, you server didn't come up, etc whatever makes
                sense as an end in your presentation ). And then you can explore
                a different route. Imagine, you are presenting something about
                Kubernetes. And one of the questions is, okay you are now
                bringing up etcd. How do you configure it? Do you... and the
                vote begins.
              </p>
              <p>
                This makes the presentation a little bit more enjoyable I think.
                Also, the framework is super easy. You have your presentation in
                Markdown and the frontend is a lightweight parser with tailwind
                that does things and makes it look relatively nice. ( I'm not a
                frontend dev, sorry ). And you can link together steps and
                stories with `next: slide-1b` or whatever.
              </p>
              <p>
                Granted, you'd have to work a bit more to get a presentation
                that makes sense, but honestly, I think it will make for a very
                interesting talk. Something I'm aiming to do on the next KubeCon
                in Atlanta. I'm going to be using this framework to present
                something. ( If I get in. :)) )
              </p>
              <p>
                Lastely, I want the presentation to be enjoyable and not boring.
                :) And that's my main goal. On KubeCon you sit through
                presentation after presentation after presentation and hopefully
                this one will be ( if I get accepted ) something that you enjoy
                and don't fall asleep on. :)
              </p>
              <p>I hope this is useful. Enjoy folks. :)</p>
            </div>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
