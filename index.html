<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="39109222">
          <h3>
            <a
              class="item"
              href="https://www.airlinepilotforums.com/safety/146074-boeing-internal-whistleblower-re-max-door.html"
              >Boeing internal whistleblower RE: MAX DOOR</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-23 @ 20:24:37</span
              ><span class="points-container"
                >Points: <span class="points">103</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39109222"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39109185">
          <h3>
            <a class="item" href="https://openinframap.org"
              >Open Infrastructure Map</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-23 @ 20:20:47</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39109185"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39109104">
          <h3>
            <a
              class="item"
              href="https://www.noahpinion.blog/p/the-dark-forest-hypothesis-is-absurd"
              >The Dark Forest hypothesis is absurd</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-23 @ 20:14:52</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39109104"
                  >Comments</a
                ><span class="descendants">: 57</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39107854">
          <h3>
            <a
              class="item"
              href="https://www.bloomberg.com/news/articles/2024-01-23/apple-car-ev-set-to-debut-in-2028-with-limited-autonomous-driving"
              >Apple dials back car's self-driving features and delays launch to
              2028</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-23 @ 18:53:18</span
              ><span class="points-container"
                >Points: <span class="points">99</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39107854"
                  >Comments</a
                ><span class="descendants">: 153</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39107620">
          <h3>
            <a
              class="item"
              href="https://crowsonkb.github.io/hourglass-diffusion-transformers/"
              >Direct Pixel-Space Megapixel Image Generation with Diffusion
              Models</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-23 @ 18:38:58</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39107620"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39107536">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=39107536"
              >Show HN: Blocks by Cosmic – Web components for headless CMS</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-23 @ 18:33:04</span
              ><span class="points-container"
                >Points: <span class="points">4</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39107536"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
            <div class="text">
              <a href="https://blocks.cosmicjs.com/"
                >https://blocks.cosmicjs.com/</a
              >), our new data infused components for building Cosmic (<a
                href="https://www.cosmicjs.com/"
                >https://www.cosmicjs.com/</a
              >) (W19) powered websites and apps.
              <p>
                Cosmic is a headless content management system (CMS). We provide
                a dashboard to create content and API tools to deliver content
                to any website or app.
              </p>
              <p>
                Blocks are pre-built website components that you can drop into
                your project. Choose from landing pages, blogs, image galleries,
                product pages, and more. With Blocks you can build these
                features with Cosmic faster than ever.
              </p>
              <p>
                It's our goal to empower your team to create the best content
                powered websites and apps. Blocks can be considered the missing
                "head" to connect with the Cosmic headless CMS. It is our
                opinionated component frontend for building highly scalable and
                performant web applications built with tools we think offer a
                development experience and performance advantage (React Server
                Components, Next.js, and Tailwind CSS).
              </p>
              <p>
                React Server Components (RSCs) have unlocked a new paradigm in
                building data-driven web applications. By safely encapsulating
                data-fetching inside components, we can use RSCs as building
                blocks to enable faster and more scalable application
                development. We are excited for the potential of RSCs and
                Blocks. This is just the beginning.
              </p>
              <p>
                To get started, go to the Blocks website (<a
                  href="https://blocks.cosmicjs.com/"
                  >https://blocks.cosmicjs.com/</a
                >) and follow the steps for installation. View the Blocks demo
                (Agency Template) (<a
                  href="https://cosmic-agency-template.vercel.app/"
                  >https://cosmic-agency-template.vercel.app/</a
                >) to see all of the Blocks in action.
              </p>
              <p>
                Blocks are built to give developers a head start with features
                that are:
              </p>
              <p>
                - Performance optimized - Draft preview ready - Mobile
                responsive - Localization ready - Dark mode ready - Customizable
                - Accessible - Type safe
              </p>
              <p>
                Blocks not only provide a fast development experience, they have
                been optimized for speed and performance by default, so you can
                ship production-ready faster. Check out the Blocks demo (Agency
                Template) (<a href="https://cosmic-agency-template.vercel.app/"
                  >https://cosmic-agency-template.vercel.app/</a
                >) to see how building with Blocks can give you high scores
                across the board for performance, SEO, and accessibility.
              </p>
              <p>
                Blocks are open source (<a
                  href="https://github.com/cosmicjs/blocks"
                  >https://github.com/cosmicjs/blocks</a
                >) and built with React Server Components, Next.js, TypeScript,
                Tailwind CSS, and powered by the Cosmic content management
                system. You can install Blocks into any new or existing Next.js
                (v13+) codebase using the Blocks CLI (<a
                  href="https://www.npmjs.com/package/@cosmicjs/blocks"
                  >https://www.npmjs.com/package/@cosmicjs/blocks</a
                >).
              </p>
              <p>
                Check it out on the Blocks website (<a
                  href="https://blocks.cosmicjs.com/"
                  >https://blocks.cosmicjs.com/</a
                >) and let us know what you think in the comments.
              </p>
              <p>Tony</p>
            </div>
          </section>
        </section>
        <section id="39107483">
          <h3>
            <a class="item" href="https://atlas.co"
              >Show HN: Atlas – GIS and interactive maps in the browser</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-23 @ 18:29:26</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39107483"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39107144">
          <h3>
            <a
              class="item"
              href="https://www.brex.com/journal/a-message-from-our-founder"
              >Brex Layoffs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-23 @ 18:08:37</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39107144"
                  >Comments</a
                ><span class="descendants">: 89</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39107084">
          <h3>
            <a class="item" href="https://go.dev/blog/deadcode"
              >Deadcode: Finding unreachable functions in Go</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-23 @ 18:05:53</span
              ><span class="points-container"
                >Points: <span class="points">86</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39107084"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39106973">
          <h3>
            <a
              class="item"
              href="https://blog.google/products/chrome/google-chrome-generative-ai-features-january-2024/"
              >Chrome experimental AI features</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-23 @ 17:57:34</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39106973"
                  >Comments</a
                ><span class="descendants">: 86</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39106972">
          <h3>
            <a class="item" href="https://sourcegraph.com/blog/slow-to-simd"
              >From slow to SIMD: A Go optimization story</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-23 @ 17:57:31</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39106972"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39106916">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/cars/2024/01/higher-vehicle-hoods-significantly-increase-pedestrian-deaths-study-finds/"
              >Higher vehicle hoods significantly increase pedestrian deaths,
              study finds</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-23 @ 17:54:32</span
              ><span class="points-container"
                >Points: <span class="points">153</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39106916"
                  >Comments</a
                ><span class="descendants">: 149</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39106901">
          <h3>
            <a
              class="item"
              href="https://subzero.cloud/blog/serverfree-architecture/"
              >Is offline-first not enough? Do we need "serverfree"?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-23 @ 17:53:45</span
              ><span class="points-container"
                >Points: <span class="points">93</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39106901"
                  >Comments</a
                ><span class="descendants">: 104</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39106355">
          <h3>
            <a
              class="item"
              href="https://www.404media.co/these-are-the-notorious-nsa-furby-documents-showing-spy-agency-freaking-out-about-childrens-toy/"
              >The NSA Furby Documents</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-23 @ 17:21:04</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39106355"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39106050">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=39106050"
              >Hightouch (YC S19) Is Hiring a Lead Front End Engineer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-23 @ 17:00:16</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
            <div class="text">
              <p>
                We are looking for a senior frontend engineer with the ability
                to develop production-ready applications and a passion for
                building a great user experience. This role will be the primary
                owner on the frontend for several new products we’ve launched
                recently, giving it significant ownership and room for impact.
              </p>
              <p>
                As a key member of the frontend team, you will also play a
                crucial role in shaping best practices within our engineering
                organization. You will have the opportunity to mentor other
                frontend engineers, make important technical decisions, and
                establish the standard for our user experience.
              </p>
              <p>
                <a href="https://boards.greenhouse.io/hightouch/jobs/4981337004"
                  >https://boards.greenhouse.io/hightouch/jobs/4981337004</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="39105916">
          <h3>
            <a
              class="item"
              href="https://www.wired.co.uk/article/horse-racing-drone"
              >The Horse, the Drone and the Epic Fight for Gambling Success</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-23 @ 16:50:57</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39105916"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39105626">
          <h3>
            <a
              class="item"
              href="https://9to5google.com/2024/01/23/samsung-expands-diy-repair-program-galaxy-s23-fold-5/"
              >Samsung heavily expands DIY repair program, adds Galaxy S23 and
              Fold 5 in US</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-23 @ 16:33:36</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39105626"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39105114">
          <h3>
            <a
              class="item"
              href="https://blog.mozilla.org/en/products/4-reasons-to-try-mozillas-new-firefox-linux-package-for-ubuntu-and-debian-derivatives/"
              >Mozilla's new Firefox Linux package for Ubuntu and Debian
              derivatives</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-23 @ 16:00:19</span
              ><span class="points-container"
                >Points: <span class="points">276</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39105114"
                  >Comments</a
                ><span class="descendants">: 117</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39104363">
          <h3>
            <a
              class="item"
              href="https://www.phoronix.com/review/framework-laptop-16"
              >Framework Laptop 16 Delivers Great Linux Support and
              Performance</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-23 @ 15:12:13</span
              ><span class="points-container"
                >Points: <span class="points">262</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39104363"
                  >Comments</a
                ><span class="descendants">: 213</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39103419">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2401.09514"
              >Is the emergence of life an expected phase transition in the
              evolving universe?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-23 @ 14:06:03</span
              ><span class="points-container"
                >Points: <span class="points">231</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39103419"
                  >Comments</a
                ><span class="descendants">: 227</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39102577">
          <h3>
            <a class="item" href="https://www.loro.dev/blog/loro-richtext"
              >Introduction to Loro's Rich Text CRDT</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-23 @ 12:40:16</span
              ><span class="points-container"
                >Points: <span class="points">138</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39102577"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39102069">
          <h3>
            <a
              class="item"
              href="https://www.smithsonianmag.com/smart-news/another-of-ancient-romes-mysterious-12-sided-objects-has-been-found-in-england-180983632/"
              >Another mysterious Roman dodecahedron has been unearthed in
              England</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-23 @ 11:33:44</span
              ><span class="points-container"
                >Points: <span class="points">185</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39102069"
                  >Comments</a
                ><span class="descendants">: 266</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39102002">
          <h3>
            <a
              class="item"
              href="https://www.rawrlab.com/godot_nintendo_switch_free_port.html"
              >Free Godot engine port for Nintendo Switch</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-23 @ 11:26:58</span
              ><span class="points-container"
                >Points: <span class="points">341</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39102002"
                  >Comments</a
                ><span class="descendants">: 188</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39101564">
          <h3>
            <a class="item" href="https://dgroshev.com/blog/bufferbloat/"
              >Unbloating the Buffers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-23 @ 10:18:02</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39101564"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39101165">
          <h3>
            <a
              class="item"
              href="https://www.atlasobscura.com/articles/make-coffee-moka-pot"
              >The Humble Brilliance of Italy's Moka Coffee Pot</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-23 @ 09:13:08</span
              ><span class="points-container"
                >Points: <span class="points">238</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39101165"
                  >Comments</a
                ><span class="descendants">: 211</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39096449">
          <h3>
            <a
              class="item"
              href="https://www.historytoday.com/archive/miscellanies/her-own-hair-victorian-prisoners-art"
              >'With Her Own Hair': A Victorian Prisoner's Art</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 22:30:45</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39096449"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39088704">
          <h3>
            <a
              class="item"
              href="http://distro.ibiblio.org/vectorlinux/Uelsk8s/GAMBAS/gambas-beginner-guide.pdf"
              >A Beginner's Guide to Gambas [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 12:22:16</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39088704"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39087170">
          <h3>
            <a
              class="item"
              href="https://www.tomshardware.com/pc-components/cpus/china-planning-1600-core-chips-that-use-an-entire-wafer-similar-to-american-company-cerebras-wafer-scale-design"
              >Chinese researchers planning 1,600-core chips that use an entire
              wafer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 07:20:29</span
              ><span class="points-container"
                >Points: <span class="points">100</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39087170"
                  >Comments</a
                ><span class="descendants">: 71</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39086631">
          <h3>
            <a
              class="item"
              href="https://www.science.org/content/blog-post/organic-syntheses"
              >Organic Syntheses (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 05:34:13</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39086631"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39086334">
          <h3>
            <a class="item" href="https://iter.ca/post/gh-sig-pwn/"
              >Forging signed commits on GitHub</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-01-22 @ 04:49:26</span
              ><span class="points-container"
                >Points: <span class="points">269</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39086334"
                  >Comments</a
                ><span class="descendants">: 103</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
