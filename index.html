<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="38260815">
          <h3>
            <a
              class="item"
              href="https://www.reuters.com/technology/trumps-truth-social-reports-73-mln-net-loss-since-launch-2023-11-14/"
              >Truth Social reports $73M net loss since launch</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-14 @ 09:04:20</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38260815"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38258101">
          <h3>
            <a
              class="item"
              href="https://techcrunch.com/2023/11/09/google-play-tightens-up-rules-for-android-app-developers-to-require-testing-increased-app-review/"
              >Android App Devs now require 20 people to test before publishing
              to Play Store</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-14 @ 02:13:10</span
              ><span class="points-container"
                >Points: <span class="points">185</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38258101"
                  >Comments</a
                ><span class="descendants">: 114</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38257813">
          <h3>
            <a
              class="item"
              href="https://www.atlasobscura.com/articles/los-angeles-home-scam"
              >Many popular houses in 1920s L.A. were part of a scam</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-14 @ 01:35:21</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38257813"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38257794">
          <h3>
            <a class="item" href="https://www.fly.faa.gov/adv/adv_spt.jsp"
              >Starship will attempt a launch this Friday</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-14 @ 01:32:58</span
              ><span class="points-container"
                >Points: <span class="points">426</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38257794"
                  >Comments</a
                ><span class="descendants">: 307</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38257499">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=38257499"
              >Unlogged (YC S22) Is Hiring a founding back end engineer</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-14 @ 01:01:06</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
            <div class="text">
              <p>
                We are looking for a senior backend engineer to join us in our
                Banglore office.
              </p>
              <p>
                If you are passionate about regression-free speedy deployments,
                do consider working with us.
              </p>
              <p>Responsibilities:</p>
              <p>
                - Design, develop, and maintain backend applications using Java
                and various Java frameworks.
              </p>
              <p>
                - Talk to other developers and understand the nuances of their
                day-to-day needs. Founders do this too.
              </p>
              <p>- Implement a fast and bug-free log scanning pipeline.</p>
              <p>- Integrate 3rd party APIs with the dashboard.</p>
              <p>
                - Deploy and manage services on cloud platforms such as AWS,
                GCP, or Azure.
              </p>
              <p>
                - Identify and address performance bottlenecks in the software.
              </p>
              <p>
                - Participate in code reviews to maintain code quality and
                ensure best practices.
              </p>
              <p>
                - Proactively suggest process improvements and participate in
                technical discussions.
              </p>
              <p>Requirements:</p>
              <p>
                - 4-8 years of hands-on experience with Java development and
                various Java frameworks.
              </p>
              <p>
                - Strong knowledge and passion for JVM-related technologies and
                Java programming.
              </p>
              <p>
                - Experience working with at least one SQL database and one
                NoSQL database.
              </p>
              <p>
                - Proficiency in containerization using Docker for efficient
                deployment.
              </p>
              <p>
                - Hands-on experience with at least one cloud platform such as
                AWS, GCP, or Azure.
              </p>
              <p>
                - Excellent problem-solving skills and ability to tackle complex
                technical challenges.
              </p>
              <p>
                - Strong communication and teamwork skills for effective
                collaboration.
              </p>
              <p>- Willingness to learn and explore new technologies.</p>
              <p>Benefits:</p>
              <p>
                - Competitive salary and equity options based on experience and
                performance.
              </p>
              <p>
                - Opportunity to work on cutting-edge projects with a talented
                team.
              </p>
              <p>
                - Collaborative and innovative work environment that encourages
                new ideas.
              </p>
              <p>
                Location: Preferred: Bangalore, India We are ok with Remote in
                exceptional cases.
              </p>
              <p>
                To apply, please submit your resume, and GitHub repository links
                to us at ssl [at] unlogged [dot] io
              </p>
            </div>
          </section>
        </section>
        <section id="38257284">
          <h3>
            <a
              class="item"
              href="https://clivethompson.medium.com/the-laptop-that-wont-die-0c478c3fe46c"
              >The laptop that won't die</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-14 @ 00:33:59</span
              ><span class="points-container"
                >Points: <span class="points">109</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38257284"
                  >Comments</a
                ><span class="descendants">: 162</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38257094">
          <h3>
            <a
              class="item"
              href="https://www.newyorker.com/magazine/2023/11/20/a-coder-considers-the-waning-days-of-the-craft"
              >A coder considers the waning days of the craft</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-14 @ 00:08:45</span
              ><span class="points-container"
                >Points: <span class="points">331</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38257094"
                  >Comments</a
                ><span class="descendants">: 544</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38256810">
          <h3>
            <a
              class="item"
              href="https://apnews.com/article/nepal-tiktok-ban-social-media-854846a42ef566fa296ddaacd0099447"
              >Nepal bans TikTok and says it disrupts social harmony</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-13 @ 23:32:54</span
              ><span class="points-container"
                >Points: <span class="points">427</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38256810"
                  >Comments</a
                ><span class="descendants">: 230</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38256645">
          <h3>
            <a
              class="item"
              href="https://blog.normalcomputing.ai/posts/2023-09-12-supersizing-transformers/supersizing-transformers.html"
              >Infinite Context LLMs: Going Beyond RAG with Extended Minds</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-13 @ 23:13:04</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38256645"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38256137">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/d44151-023-00162-5"
              >Low current around roots boosts plant growth</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-13 @ 22:16:53</span
              ><span class="points-container"
                >Points: <span class="points">149</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38256137"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38255808">
          <h3>
            <a class="item" href="https://blog.vero.site/post/noulith"
              >Designing a programming language to speedrun Advent of Code</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-13 @ 21:45:55</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38255808"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38255455">
          <h3>
            <a
              class="item"
              href="https://terrytao.wordpress.com/2023/06/04/inequalities-convergence-and-continuity-as-special-deals/"
              >Inequalities, convergence, and continuity as "special deals"</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-13 @ 21:12:22</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38255455"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38254353">
          <h3>
            <a
              class="item"
              href="https://fortune.com/2023/11/08/panama-canal-congestion-record-4-million-skip-line/"
              >Panama Canal is so congested that one ship owner paid $4M to skip
              the line</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-13 @ 19:43:14</span
              ><span class="points-container"
                >Points: <span class="points">221</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38254353"
                  >Comments</a
                ><span class="descendants">: 225</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38253384">
          <h3>
            <a
              class="item"
              href="https://www.bloomberg.com/news/articles/2023-11-13/apple-gets-36-of-google-revenue-from-search-deal-witness-says"
              >Google pays Apple 36% of the revenue it earns from searches in
              Safari</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-13 @ 18:26:03</span
              ><span class="points-container"
                >Points: <span class="points">169</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38253384"
                  >Comments</a
                ><span class="descendants">: 186</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38252963">
          <h3>
            <a class="item" href="https://github.com/sirixdb/sirix"
              >Show HN: SirixDB – Bitemporal binary JSON database system and
              event store</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-13 @ 17:51:42</span
              ><span class="points-container"
                >Points: <span class="points">91</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38252963"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
            <div class="text">
              <p>So, what is it all about?</p>
              <p>
                The system uses ideas from ZFS (a keyed index trie, storing
                checksums in parent pages...) and Git (a persistent index
                structure that shares unchanged pages between revisions) but
                appends new tree roots on each commit [1][2].
              </p>
              <p>
                It is a JSON DBS. The system stores fine granular JSON nodes.
                Thus, there's almost no limit to the structure and size of an
                object. Objects can be arbitrarily nested, and updates are
                cheap.
              </p>
              <p>
                On a high level, it supports space-efficient snapshots, tracking
                changes by an author / optional commit messages, time travel
                queries, reverting to previous revisions (while all revisions
                in-between still exist for audits...), or retrieving the changes
                of whole (sub)trees.
              </p>
              <p>
                On the one hand, it's, thus, a bitemporal DBS, but on the other
                hand, it can be used as a simple event store. It stores the
                state after an event or a change occurs and tracks the changes.
              </p>
              <p>
                Thus, an entity, a node in the JSON structure, can be updated to
                new values and eventually be removed while the history is easily
                retrievable, or we can easily revert to a previous state. The
                system assigns a unique ID to each new node, which never changes
                and is never reused (even after the deletion of the node). Thus,
                the system stores the state after the change/event and the event
                itself (the change event).
              </p>
              <p>
                The leaf pages of the index structures are not simply copied
                during a write, but a sliding window algorithm is applied, such
                that only modified nodes and nodes that fall out of the sliding
                window have to be written. A predefined window length is
                configurable. The system avoids write-peaks, which would occur
                due to full snapshots and having to read a long chain of
                incremental changes in between.
              </p>
              <p>
                Thus, it's best suited for fast flash drives with fast random
                reads and sequential writes. Data is never overwritten thus,
                audit trails are given for free.
              </p>
              <p>
                Another aspect is that the system does not need a WAL (that is
                basically a second data store) due to atomic switches of a root
                index page and a single permitted read/write transaction (txn)
                concurrently and in parallel to N read-only txns, which are
                bound to specific revisions during the start. Reads do not
                involve any locks.[2]
              </p>
              <p>
                A path summary, an unordered set of all paths to leaf nodes in
                the tree, is built and enables various optimizations.
                Furthermore, a rolling hash is optionally built, whereas all
                ancestor node hashes are adapted during inserts.
              </p>
              <p>
                A dated Jupyter notebook with some examples can be found in [3],
                and overall documentation in [4].
              </p>
              <p>
                The query engine[5] Brackit is retargetable (a couple of
                interfaces and rewrite rules have to be implemented for DB
                systems) and especially finds implicit joins and applies known
                algorithms from the relational DB systems world to optimize
                joins and aggregate functions due to set-oriented processing of
                the operators.[6]
              </p>
              <p>
                I've given an interview in [7], but I'm usually very nervous, so
                don't judge too harshly.
              </p>
              <p>Give it a try, and happy coding!</p>
              <p>Kind regards</p>
              <p>Johannes</p>
              <p>
                [1] <a href="https://sirix.io">https://sirix.io</a> |
                <a href="https://github.com/sirixdb/sirix"
                  >https://github.com/sirixdb/sirix</a
                >
              </p>
              <p>
                [2]
                <a href="https://sirix.io/docs/concepts.html"
                  >https://sirix.io/docs/concepts.html</a
                >
              </p>
              <p>
                [3]
                <a
                  href="https://colab.research.google.com/drive/1NNn1nwSbK6hAekzo1YbED52RI3NMqqbG#scrollTo=CBWQIvc0Ov3P"
                  >https://colab.research.google.com/drive/1NNn1nwSbK6hAekzo1Yb...</a
                >
              </p>
              <p>
                [4] <a href="https://sirix.io/docs/">https://sirix.io/docs/</a>
              </p>
              <p>[5] <a href="http://brackit.io">http://brackit.io</a></p>
              <p>
                [6]
                <a
                  href="https://colab.research.google.com/drive/19eC-UfJVm_gCjY--koOWN50sgiFa5hSC"
                  >https://colab.research.google.com/drive/19eC-UfJVm_gCjY--koO...</a
                >
              </p>
              <p>
                [7]
                <a href="https://youtu.be/Ee-5ruydgqo?si=Ift73d49w84RJWb2"
                  >https://youtu.be/Ee-5ruydgqo?si=Ift73d49w84RJWb2</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="38252947">
          <h3>
            <a
              class="item"
              href="https://health.ucdavis.edu/news/headlines/researchers-identify-switch-to-activate-cancer-cell-death/2023/10"
              >Researchers identify 'switch' to activate cancer cell death</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-13 @ 17:50:27</span
              ><span class="points-container"
                >Points: <span class="points">150</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38252947"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38252566">
          <h3>
            <a class="item" href="https://matthew.science/posts/occupancy/"
              >Building an occupancy sensor with a $5 ESP32 and a serverless
              DB</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-13 @ 17:17:14</span
              ><span class="points-container"
                >Points: <span class="points">539</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38252566"
                  >Comments</a
                ><span class="descendants">: 179</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38252449">
          <h3>
            <a class="item" href="https://www.tng-project.org/about/"
              >Cosmological galaxy formation simulation software</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-13 @ 17:08:21</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38252449"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38251957">
          <h3>
            <a
              class="item"
              href="https://embracethered.com/blog/posts/2023/google-bard-data-exfiltration/"
              >Hacking Google Bard – From Prompt Injection to Data
              Exfiltration</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-13 @ 16:22:06</span
              ><span class="points-container"
                >Points: <span class="points">366</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38251957"
                  >Comments</a
                ><span class="descendants">: 138</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38251842">
          <h3>
            <a
              class="item"
              href="https://jxnl.github.io/instructor/blog/2023/11/05/chain-of-density/"
              >Smarter summaries with finetuning GPT-3.5 and chain of density</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-13 @ 16:12:44</span
              ><span class="points-container"
                >Points: <span class="points">201</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38251842"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38251330">
          <h3>
            <a
              class="item"
              href="https://blog.jim-nielsen.com/2023/html-web-components/"
              >HTML Web Components</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-13 @ 15:31:43</span
              ><span class="points-container"
                >Points: <span class="points">399</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38251330"
                  >Comments</a
                ><span class="descendants">: 206</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38250913">
          <h3>
            <a
              class="item"
              href="https://cdm.link/2023/11/black-goo-ferrofluid-synths/"
              >Black goo is the new oscilloscope: Love Hultén's ferrofluid
              synths</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-13 @ 15:01:11</span
              ><span class="points-container"
                >Points: <span class="points">254</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38250913"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38250459">
          <h3>
            <a class="item" href="https://macwright.com/2023/11/13/placemark"
              >Placemark is going open source and shutting down</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-13 @ 14:28:53</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38250459"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38249587">
          <h3>
            <a
              class="item"
              href="https://www.washingtonpost.com/business/2023/07/04/jorge-luis-borges-estate-overcomes-copyright-qualms-with-recognized-heirs/8f8d679e-1a23-11ee-be41-a036f4b098ec_story.html"
              >Jorge Luis Borges and the Labyrinths of Copyright</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-13 @ 12:52:46</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38249587"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38249214">
          <h3>
            <a
              class="item"
              href="https://www.canva.dev/blog/engineering/ship-shape/"
              >Ship Shape</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-13 @ 11:51:00</span
              ><span class="points-container"
                >Points: <span class="points">304</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38249214"
                  >Comments</a
                ><span class="descendants">: 79</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38248752">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=xBAduq0RGes"
              >C++ Lambda Idioms (2022) [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-13 @ 10:21:40</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38248752"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38248653">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=sx9X0bjj6_8"
              >Lets build an Amiga Network Adapter [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-13 @ 09:59:01</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38248653"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38248497">
          <h3>
            <a
              class="item"
              href="https://tech.marksblogg.com/maxar-open-data-free-satellite-imagery.html"
              >Maxar's Open Satellite Feed</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-13 @ 09:29:45</span
              ><span class="points-container"
                >Points: <span class="points">129</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38248497"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38247543">
          <h3>
            <a
              class="item"
              href="https://greekreporter.com/2023/11/09/best-timed-shot-tv-history/"
              >The Best Timed Shot in TV History (Probably)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-13 @ 06:23:43</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38247543"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38242992">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/books/2023/nov/09/andrew-wylie-agency-days-of-the-jackal-serious-literature-big-business"
              >Days of The Jackal: how Andrew Wylie turned serious literature
              into big business</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-12 @ 18:50:43</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38242992"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
