<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="43937242">
          <h3>
            <a class="item" href="https://www.bart.gov/"
              >Entire BART system is down due to computer systems failure</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-09 @ 14:33:49</span
              ><span class="points-container"
                >Points: <span class="points">73</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43937242"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43937214">
          <h3>
            <a
              class="item"
              href="https://www.home.cern/news/news/physics/alice-detects-conversion-lead-gold-lhc"
              >ALICE detects the conversion of lead into gold at the LHC</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-09 @ 14:31:20</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43937214"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43936884">
          <h3>
            <a class="item" href="https://www.itter.sh/"
              >Itter.sh – Micro-Blogging via Terminal</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-09 @ 14:02:02</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43936884"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43936844">
          <h3>
            <a
              class="item"
              href="https://nuejs.org/blog/standards-first-react-alternative/"
              >Show HN: Hyper – Standards first React alternative</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-09 @ 13:59:06</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43936844"
                  >Comments</a
                ><span class="descendants">: 49</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43936813">
          <h3>
            <a
              class="item"
              href="https://liliputing.com/dasung-paperlike-13k-is-a-13-3-inch-e-ink-color-monitor-crowdfunding/"
              >Dasung Paperlike 13K is a 13.3 inch E Ink color monitor</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-09 @ 13:56:37</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43936813"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43936592">
          <h3>
            <a class="item" href="https://nietras.com/2025/05/09/sep-0-10-0/"
              >21 GB/s CSV Parsing Using SIMD on AMD 9950X</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-09 @ 13:38:06</span
              ><span class="points-container"
                >Points: <span class="points">91</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43936592"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43936468">
          <h3>
            <a
              class="item"
              href="https://www.holightoptic.com/what-is-hollow-core-fiber-hcf%ef%bc%9f/"
              >Hollow Core Fiber (HCF)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-09 @ 13:25:17</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43936468"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43936461">
          <h3>
            <a
              class="item"
              href="https://royalsocietypublishing.org/doi/10.1098/rsif.2024.0757"
              >Reconstructing illusory camouflage patterns on moth wings using
              computer vision</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-09 @ 13:24:22</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43936461"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43936408">
          <h3>
            <a class="item" href="https://nrkno.github.io/sofie-core/"
              >Sofie: open-source web based system for automating live TV news
              production</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-09 @ 13:18:42</span
              ><span class="points-container"
                >Points: <span class="points">108</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43936408"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43936198">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/cars/2025/05/robotaxi-and-cybercab-are-too-unoriginal-to-trademark-uspto-tells-tesla/"
              >USPTO refuses Tesla Robotaxi trademark as "merely descriptive"</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-09 @ 12:55:11</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43936198"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43936097">
          <h3>
            <a class="item" href="https://aberdeenjs.org/"
              >Show HN: Aberdeen – An elegant approach to reactive UIs</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-09 @ 12:42:29</span
              ><span class="points-container"
                >Points: <span class="points">106</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43936097"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
            <div class="text">
              <p>
                I 'invented' the concept for this back in 2011, and it was used
                (as a proprietary lib) in various startups. Even though
                <i>many</i> similar open source libs have been released since,
                and boy have I tried a lot of them, none have been able to
                capture the elegance and DX of what we had back then. I might be
                biased though. :-)
              </p>
              <p>
                So I started creating a cleaned-up, modern, TypeScript, open
                source implementation for the concept about five years ago.
                After many iterations, working on the project on and off, I'm
                finally happy with its API and the developer experience it
                offers. I'm calling it 1.0!
              </p>
              <p>
                The concept: It uses many small, anonymous functions for
                emitting DOM elements, and automatically reruns them when their
                underlying proxied data changes. This proxied data can be
                anything from simple values to complex, typed, and deeply nested
                data structures.
              </p>
              <p>
                As I'm currently free to spend my time on labors of love like
                this, I'm planning to expand the ecosystem around this to
                include synchronizing data with a remote server/database, and to
                make CRUD apps very rapid and perhaps even pleasurable to
                implement.
              </p>
              <p>
                I've celebrated 1.0 by creating a tutorial with editable
                interactive examples!
                <a href="https://aberdeenjs.org/Tutorial/"
                  >https://aberdeenjs.org/Tutorial/</a
                >
              </p>
              <p>
                I would love to hear your feedback. The first few people to
                actually give Aberdeen a shot can expect fanatical support from
                me! :-)
              </p>
            </div>
          </section>
        </section>
        <section id="43935913">
          <h3>
            <a
              class="item"
              href="https://www.science.org/content/article/exclusive-nsf-faces-radical-shake-officials-abolish-its-37-divisions"
              >NSF faces shake-up as officials abolish its 37 divisions</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-09 @ 12:13:36</span
              ><span class="points-container"
                >Points: <span class="points">182</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43935913"
                  >Comments</a
                ><span class="descendants">: 233</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43935707">
          <h3>
            <a class="item" href="https://cryptpad.org/"
              >CryptPad: An Alternative to the Google Suite</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-09 @ 11:37:40</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43935707"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43935625">
          <h3>
            <a
              class="item"
              href="https://www.science.org/content/article/data-manipulations-alleged-study-paved-way-microsoft-s-quantum-chip"
              >Data manipulations alleged in study that paved way for
              Microsoft's quantum chip</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-09 @ 11:23:36</span
              ><span class="points-container"
                >Points: <span class="points">112</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43935625"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43935586">
          <h3>
            <a
              class="item"
              href="https://spectrum.ieee.org/amazon-stowing-robots"
              >Amazon's Vulcan Robots Now Stow Items Faster Than Humans</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-09 @ 11:18:06</span
              ><span class="points-container"
                >Points: <span class="points">112</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43935586"
                  >Comments</a
                ><span class="descendants">: 123</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43935434">
          <h3>
            <a class="item" href="https://brevzin.github.io/c++/2025/05/02/soa/"
              >Implementing a Struct of Arrays</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-09 @ 10:52:15</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43935434"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43935394">
          <h3>
            <a class="item" href="https://www.hyvector.com"
              >Show HN: Hyvector – A fast and modern SVG editor</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-09 @ 10:45:40</span
              ><span class="points-container"
                >Points: <span class="points">137</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43935394"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
            <div class="text">
              <p>
                Hyvector is an SVG editor that runs in all modern browsers. It
                is stable, very fast, and capable of handling complex SVG
                images.
              </p>
              <p>
                Big new features like art strokes, vector tracing, colorizing
                are in the making, but for now the focus is on pushing a
                polished first release out of the door.
              </p>
              <p>
                I would love to hear any feedback on what you like, missing
                features, or any bugs you encounter via our issue tracker:
                <a href="https://github.com/hyvectorapp/hyvector-issues"
                  >https://github.com/hyvectorapp/hyvector-issues</a
                >
              </p>
              <p>
                Note that while Hyvector should work on a phone, it is much more
                usable on a desktop computer or tablet.
              </p>
            </div>
          </section>
        </section>
        <section id="43935356">
          <h3>
            <a
              class="item"
              href="https://blog.kleine-koenig.org/ukl/the-linux-kernels-pgp-web-of-trust.html"
              >The Linux Kernel's PGP Web of Trust</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-09 @ 10:39:43</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43935356"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43934711">
          <h3>
            <a class="item" href="https://www.w3.org/TR/wasm-core-2/"
              >WASM 2.0</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-09 @ 08:01:06</span
              ><span class="points-container"
                >Points: <span class="points">216</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43934711"
                  >Comments</a
                ><span class="descendants">: 103</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43933891">
          <h3>
            <a class="item" href="https://avalovelace1.github.io/LegoGPT/"
              >LegoGPT: Generating Physically Stable and Buildable Lego</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-09 @ 04:55:20</span
              ><span class="points-container"
                >Points: <span class="points">436</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43933891"
                  >Comments</a
                ><span class="descendants">: 115</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43933628">
          <h3>
            <a
              class="item"
              href="https://www.damninteresting.com/dead-reckoning/"
              >Dead Reckoning</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-09 @ 03:46:53</span
              ><span class="points-container"
                >Points: <span class="points">138</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43933628"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43933511">
          <h3>
            <a
              class="item"
              href="https://www.usenix.org/blog/usenix-atc-announcement"
              >Usenix ATC Announcement</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-09 @ 03:18:03</span
              ><span class="points-container"
                >Points: <span class="points">100</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43933511"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43933452">
          <h3>
            <a
              class="item"
              href="https://www.darknavy.org/blog/a_first_glimpse_of_the_starlink_user_ternimal/"
              >Starlink User Terminal Teardown</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-09 @ 03:03:51</span
              ><span class="points-container"
                >Points: <span class="points">229</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43933452"
                  >Comments</a
                ><span class="descendants">: 77</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43933248">
          <h3>
            <a class="item" href="https://www.audiobookshelf.org/"
              >Audiobookshelf: Self-hosted audiobook and podcast server</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-09 @ 02:17:55</span
              ><span class="points-container"
                >Points: <span class="points">154</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43933248"
                  >Comments</a
                ><span class="descendants">: 72</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43931845">
          <h3>
            <a class="item" href="https://github.com/martinfama/fui"
              >Fui: C library for interacting with the framebuffer in a TTY
              context</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-08 @ 22:05:37</span
              ><span class="points-container"
                >Points: <span class="points">147</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43931845"
                  >Comments</a
                ><span class="descendants">: 57</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43909418">
          <h3>
            <a class="item" href="https://corticallabs.com/cl1.html"
              >The CL1: the first code deployable biological computer</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-06 @ 20:40:28</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43909418"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43908220">
          <h3>
            <a class="item" href="https://c0de517e.com/021_taxonomy.htm"
              >A Taxonomy for Rendering Engines</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-06 @ 18:34:57</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43908220"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43904546">
          <h3>
            <a class="item" href="https://www.linyangchen.com/Philately"
              >Malaya's Timeless Design</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-06 @ 12:54:20</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43904546"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43898280">
          <h3>
            <a
              class="item"
              href="https://openinverter.org/wiki/ZombieVerter_VCU"
              >Zombieverter: Open source VCU for reusing salvage EV
              components</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-05 @ 19:00:11</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43898280"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43894967">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2504.16966"
              >Structuring Competency-Based Courses Through Skill Trees</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-05 @ 13:34:45</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43894967"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
