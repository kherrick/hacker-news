<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="42980835">
          <h3>
            <a
              class="item"
              href="https://www.cambridge.org/core/journals/journal-of-functional-programming/article/turner-bird-eratosthenes-an-eternal-burning-thread/32E2EDF5D5EAEC95F13D313BC97B86F0"
              >Turner, Bird, Eratosthenes: An eternal burning thread</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-08 @ 06:17:09</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42980835"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42980097">
          <h3>
            <a
              class="item"
              href="https://www.mining.com/why-gold-loves-arsenic/"
              >Why gold loves arsenic (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-08 @ 03:26:57</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42980097"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42979986">
          <h3>
            <a class="item" href="https://github.com/awwaiid/ghostwriter"
              >Ghostwriter – use the reMarkable2 as an interface to
              vision-LLMs</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-08 @ 03:02:57</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42979986"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42979846">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2502.04327"
              >Value-Based Deep RL Scales Predictably</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-08 @ 02:36:38</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42979846"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42979467">
          <h3>
            <a class="item" href="https://fly.io/blog/vscode-ssh-wtf/"
              >VSCode's SSH agent is bananas</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-08 @ 01:25:32</span
              ><span class="points-container"
                >Points: <span class="points">323</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42979467"
                  >Comments</a
                ><span class="descendants">: 199</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42977416">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/zep-ai/jobs/e2QxKYu-staff-engineer"
              >Zep AI (YC W24) is hiring engineers to build SOTA agent memory</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-07 @ 21:00:03</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42977388">
          <h3>
            <a class="item" href="https://github.com/Tanq16/ExpenseOwl"
              >Show HN: ExpenseOwl – Simple, self-hosted expense tracker</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-07 @ 20:56:58</span
              ><span class="points-container"
                >Points: <span class="points">126</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42977388"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42975803">
          <h3>
            <a class="item" href="https://theretowhere.com/"
              >Show HN: A website that heatmaps your city based on your housing
              preferences</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-07 @ 18:23:40</span
              ><span class="points-container"
                >Points: <span class="points">247</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42975803"
                  >Comments</a
                ><span class="descendants">: 83</span></span
              >
            </h4>
            <div class="text">
              <p>
                - Where in my city have the best travel times to all the things
                and people I care about?
              </p>
              <p>
                - Given a listing, how far is it from all the things and people
                I care about?
              </p>
              <p>
                Personally this was fueled by my own frustrations when I was
                apartment hunting in NYC. I was frustrating to have to juggle so
                many Google Maps tabs when I was evaluating a listing, and it
                was also annoying to not have full confidence that I was even
                searching in the right places.
              </p>
              <p>
                I wanted to be close to work, a Trader Joe's, and a major park.
                Given that public transportation networks can sometimes make
                close things hard to get to and far things easy to get to, it's
                not always obvious whether a neighborhood actually even fits my
                criteria or not!
              </p>
              <p>
                The overarching goal of theretowhere.com is to allow you to make
                more informed moving decisions while also making things more
                convenient than they are today.
              </p>
              <p>
                <a href="https://ibb.co/pBsX2HjN">https://ibb.co/pBsX2HjN</a>
              </p>
              <p>
                It can generate detailed travel time breakdowns for individual
                listings and addresses, making it easier to determine whether a
                listing is worth applying for without juggling Google Maps tabs.
                This is great for questions like “How far is this apartment from
                my friends, work and dancing gyms?”
              </p>
              <p>
                <a href="https://ibb.co/mVBjwPrJ">https://ibb.co/mVBjwPrJ</a>
              </p>
              <p>
                It also has the powerful ability to heatmap a city based on
                which parts of it are close or not to the people and places you
                care about. This is great for questions like “Where in the city
                would I be reasonably close to work, friends and a woodworking
                studio?”
              </p>
              <p>
                <a href="https://ibb.co/vCynPSRK">https://ibb.co/vCynPSRK</a>
              </p>
              <p>
                You can add these heatmaps to sites like Zillow and Streeteasy
                to make things super convenient (this was very fun to make).
              </p>
              <p>
                The main thing that's on my mind is whether this is useful or
                not. Like, is this something you would actually use? I also have
                other ideas I'd like to eventually intergrate into this (crime
                heatmaps, noise heatmaps, etc)
              </p>
            </div>
          </section>
        </section>
        <section id="42975436">
          <h3>
            <a
              class="item"
              href="https://hearsum.ca/posts/history-of-code-signing-at-mozilla/"
              >A brief history of code signing at Mozilla</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-07 @ 17:51:49</span
              ><span class="points-container"
                >Points: <span class="points">203</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42975436"
                  >Comments</a
                ><span class="descendants">: 68</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42974809">
          <h3>
            <a class="item" href="https://ieeexplore.ieee.org/document/628099"
              >The origins of 60-Hz as a power frequency</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-07 @ 16:53:20</span
              ><span class="points-container"
                >Points: <span class="points">146</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42974809"
                  >Comments</a
                ><span class="descendants">: 189</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42974728">
          <h3>
            <a
              class="item"
              href="https://carto.com/blog/zip-codes-spatial-analysis"
              >Stop using zip codes for geospatial analysis (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-07 @ 16:46:47</span
              ><span class="points-container"
                >Points: <span class="points">163</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42974728"
                  >Comments</a
                ><span class="descendants">: 120</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42974727">
          <h3>
            <a
              class="item"
              href="https://www.sciencealert.com/mysterious-radiation-belts-detected-around-earth-after-epic-solar-storm"
              >Radiation belts detected around Earth after solar storm</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-07 @ 16:46:45</span
              ><span class="points-container"
                >Points: <span class="points">128</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42974727"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42974461">
          <h3>
            <a class="item" href="https://github.com/AIFanatic/three-nanite"
              >Three-nanite: Unreal Nanite in Three.js</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-07 @ 16:23:50</span
              ><span class="points-container"
                >Points: <span class="points">197</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42974461"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42974378">
          <h3>
            <a class="item" href="https://github.com/c0stya/trre"
              >Show HN: Transductive regular expressions for text editing</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-07 @ 16:18:14</span
              ><span class="points-container"
                >Points: <span class="points">233</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42974378"
                  >Comments</a
                ><span class="descendants">: 73</span></span
              >
            </h4>
            <div class="text">
              <p>
                I wanted to do this for a very long time. It is more of a sketch
                or prototype. I'd really appreciate your feedback!
              </p>
            </div>
          </section>
        </section>
        <section id="42972781">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/s41586-024-08502-w"
              >Children's arithmetic skills do not transfer between applied and
              academic math</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-07 @ 14:18:19</span
              ><span class="points-container"
                >Points: <span class="points">150</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42972781"
                  >Comments</a
                ><span class="descendants">: 168</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42972062">
          <h3>
            <a class="item" href="https://lkml.org/lkml/2025/2/7/9"
              >Asahi Linux lead developer Hector Martin resigns from Linux
              kernel</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-07 @ 13:02:03</span
              ><span class="points-container"
                >Points: <span class="points">647</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42972062"
                  >Comments</a
                ><span class="descendants">: 602</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42970412">
          <h3>
            <a
              class="item"
              href="https://www.washingtonpost.com/technology/2025/02/07/apple-encryption-backdoor-uk/"
              >U.K. orders Apple to let it spy on users' encrypted accounts</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-07 @ 07:45:05</span
              ><span class="points-container"
                >Points: <span class="points">258</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42970412"
                  >Comments</a
                ><span class="descendants">: 726</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42966958">
          <h3>
            <a
              class="item"
              href="https://www.runpulse.com/blog/why-llms-suck-at-ocr"
              >Why LLMs still have problems with OCR</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-06 @ 22:04:03</span
              ><span class="points-container"
                >Points: <span class="points">107</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42966958"
                  >Comments</a
                ><span class="descendants">: 78</span></span
              >
            </h4>
            <div class="text">
              Document ingestion and the launch of Gemini 2.0 caused a lot of
              buzz this week. As a team building in this space, this is
              something we researched thoroughly. Here’s our take: ingestion is
              a multistep pipeline, and maintaining confidence from LLM
              nondeterministic outputs over millions of pages is a problem.
            </div>
          </section>
        </section>
        <section id="42964124">
          <h3>
            <a
              class="item"
              href="https://www.newscientist.com/article/2466930-the-superconductivity-of-layered-graphene-is-surprisingly-strange/"
              >The superconductivity of layered graphene</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-06 @ 16:44:21</span
              ><span class="points-container"
                >Points: <span class="points">118</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42964124"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42962822">
          <h3>
            <a class="item" href="https://dubroy.com/blog/five-coding-hats/"
              >Five coding hats</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-06 @ 14:44:11</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42962822"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42961868">
          <h3>
            <a class="item" href="https://colorlife.quick.jaredforsyth.com"
              >A colorful Game of Life</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-06 @ 12:55:17</span
              ><span class="points-container"
                >Points: <span class="points">63</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42961868"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42961849">
          <h3>
            <a class="item" href="https://github.com/andrewcmyers/maybe"
              >A better (than Optional) maybe for Java</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-06 @ 12:51:56</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42961849"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42959841">
          <h3>
            <a class="item" href="https://github.com/mierau/hotline"
              >Hotline for modern Apple systems</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-06 @ 07:01:26</span
              ><span class="points-container"
                >Points: <span class="points">177</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42959841"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42959110">
          <h3>
            <a
              class="item"
              href="https://sacckey.dev/posts/implementing-a-game-boy-emulator-in-ruby/"
              >Implementing a Game Boy emulator in Ruby</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-06 @ 04:32:43</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42959110"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42945980">
          <h3>
            <a
              class="item"
              href="https://soranews24.com/2024/12/21/station-of-despair-what-to-do-if-you-get-stuck-at-the-end-of-tokyos-chuo-rapid-line/"
              >Station of despair: What to do if you get stuck at end of Tokyo
              Chuo Rapid Line</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-05 @ 09:12:41</span
              ><span class="points-container"
                >Points: <span class="points">375</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42945980"
                  >Comments</a
                ><span class="descendants">: 223</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42945013">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/science/2025/feb/03/farewell-potholes-uk-team-invents-self-healing-road-surface"
              >Farewell potholes? UK team invents self-healing road surface</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-05 @ 07:16:30</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42945013"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42942204">
          <h3>
            <a
              class="item"
              href="https://agilescientific.com/blog/2020/2/25/visual-explanations-of-mathematics"
              >Visual explanations of mathematics (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-05 @ 01:25:05</span
              ><span class="points-container"
                >Points: <span class="points">112</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42942204"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42936085">
          <h3>
            <a class="item" href="https://mandobot.netlify.app/"
              >Show HN: Mandarin Word Segmenter with Translation</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-04 @ 17:56:33</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42936085"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
            <div class="text">
              <a href="https://mandobot.netlify.app/?share_id=e8PZ8KFE5Y"
                >https://mandobot.netlify.app/?share_id=e8PZ8KFE5Y</a
              >. This is my presentation of the first chapter of a classic story
              from the Republican era of Chinese fiction, Diary of a Madman by
              Lu Xun. Other chapters are located in the "Reading Room" section
              of the app.
              <p>
                This app exists because reading Mandarin is very hard for
                learners (like me), since Mandarin text does not separate words
                using spaces in the same way Western languages do. But extensive
                reading is the most effective way to learn vocabulary and
                grammar. Thus, learning Mandarin by reading requires first
                memorizing hundreds or thousands of words, before you can even
                know where one word ends and the next word begins.
              </p>
              <p>
                I'm solving this problem by allowing users to input Mandarin
                text, which is then computationally segmented and machine
                translated by my server, which also adds dictionary definitions
                for each word and character. The hard part is the segmentation:
                it turns out that "Chinese Word Segmentation"[0] is
                <i>the</i> central problem in Chinese Natural Language
                Processing; no current solutions reach 100% accuracy, whether
                they're from Stanford[1], Academia Sinica[2], or Tsing Hua
                University[3]. This includes every LLM currently available.
              </p>
              <p>
                I could talk about this for hours, but the bottom line is that
                this app is a way to develop my full-stack skills; the backend
                should be fast, accurate, secure, well-tested, and
                well-documented, and the front-end should be pretty, secure,
                well-tested, responsive, and accessible. I am the sole
                developer, and I'm open to any comments and suggestions:
                roberto.loja+hn@gmail.com
              </p>
              <p>Thanks HN!</p>
              <p>
                [0]
                <a
                  href="https://en.wikipedia.org/wiki/Chinese_word-segmented_writing"
                  >https://en.wikipedia.org/wiki/Chinese_word-segmented_writing</a
                >
              </p>
              <p>
                [1]
                <a href="https://nlp.stanford.edu/software/segmenter.shtml"
                  >https://nlp.stanford.edu/software/segmenter.shtml</a
                >
              </p>
              <p>
                [2]
                <a href="https://ckip.iis.sinica.edu.tw/project/ws"
                  >https://ckip.iis.sinica.edu.tw/project/ws</a
                >
              </p>
              <p>
                [3]
                <a href="http://thulac.thunlp.org/"
                  >http://thulac.thunlp.org/</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="42931241">
          <h3>
            <a
              class="item"
              href="https://freelansations.medium.com/the-story-of-the-ps2s-backwards-compatibility-from-the-engineer-who-built-it-ec39cf5a0353"
              >The PS2's backwards compatibility from the engineer who built it
              (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-04 @ 11:56:35</span
              ><span class="points-container"
                >Points: <span class="points">126</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42931241"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="42926396">
          <h3>
            <a class="item" href="https://www.calling315.com/annunicators"
              >The evolution of annunciator signaling for telephones</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-04 @ 01:44:45</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=42926396"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
