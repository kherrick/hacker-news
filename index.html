<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="45706792">
          <h3>
            <a class="item" href="https://github.com/RohanAdwankar/oxdraw"
              >Show HN: Diagram as code tool with draggable customizations</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-25 @ 20:38:58</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45706792"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
            <div class="text">
              <p>
                Therefore I am now working on this to combine the benefits of
                both into just one tool which can do both functions.
              </p>
              <p>
                The project is certainly in the early stages but if you find
                yourself making architecture diagrams I'd love to hear your
                thoughts on the idea or even a Github issue for a feature
                request!
              </p>
              <p>
                One of the workflows I'm targeting is when an AI generates the
                first draft of the diagram (all the LLMs know .mmd syntax) and
                then the user can then customize it to their liking which I
                think can drastically speed up making complex diagrams!
              </p>
            </div>
          </section>
        </section>
        <section id="45706765">
          <h3>
            <a
              class="item"
              href="https://about.nike.com/en/newsroom/releases/nike-project-amplify-official-images"
              >Project Amplify: Powered footwear for running and walking</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-25 @ 20:35:48</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45706765"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45706705">
          <h3>
            <a
              class="item"
              href="https://blog.matthewbrunelle.com/testing-out-ble-beacons-with-beacondb/"
              >Testing out BLE beacons with BeaconDB</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-25 @ 20:26:59</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45706705"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45706660">
          <h3>
            <a
              class="item"
              href="https://eli.thegreenplace.net/2011/08/25/load-time-relocation-of-shared-libraries/"
              >Load-time relocation of shared libraries (2011)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-25 @ 20:19:36</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45706660"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45706624">
          <h3>
            <a
              class="item"
              href="https://news.mongabay.com/2025/10/in-memory-of-the-christmas-island-shrew/"
              >In memory of the Christmas Island shrew</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-25 @ 20:13:55</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45706624"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45706570">
          <h3>
            <a
              class="item"
              href="https://blog.alexboden.ca/toronto-bike-share-status/"
              >Show HN: Status of my favorite bike share stations</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-25 @ 20:04:50</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45706570"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45706545">
          <h3>
            <a class="item" href="https://pytorch.org/blog/torchcomms/"
              >Torchcomms: A modern PyTorch communications API</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-25 @ 20:00:36</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45706545"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45706534">
          <h3>
            <a
              class="item"
              href="https://www.datacenterdynamics.com/en/news/proenergy-offers-repurposed-jet-engines-to-data-cent/"
              >ProEnergy repurposes jet engines to power data centers</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-25 @ 19:59:32</span
              ><span class="points-container"
                >Points: <span class="points">4</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45706534"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45706527">
          <h3>
            <a
              class="item"
              href="https://www.latimes.com/environment/story/2025-10-17/california-made-it-through-another-summer-without-a-flex-alert"
              >California invests in battery energy storage, leaving rolling
              blackouts behind</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-25 @ 19:58:55</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45706527"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45706487">
          <h3>
            <a class="item" href="https://shadcnthemer.com"
              >Show HN: Shadcn/UI theme editor – Design and share Shadcn
              themes</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-25 @ 19:51:24</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45706487"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
            <div class="text">
              <a href="https://ShadcnThemer.com">https://ShadcnThemer.com</a> -
              a web app for creating and sharing themes for shadcn/ui, made with
              my some of my favorites, Next.js 15, Tailwind CSS 4, Drizzle ORM,
              and Supabase.
              <p>
                The goal was to make it easy to visually design shadcn color
                themes, preview them live across various example UIs, and export
                them straight into your projects (as CSS or via the shadcn CLI
                registry command).
              </p>
              <p>
                I had a bit of experience going into this because I built the
                Theme Studio for VS Code in the past, but it was fun using a
                modern stack and leveraging Cursor to help me along the way this
                time.
              </p>
              <p>
                GitHub:
                <a href="https://github.com/miketromba/shadcn-themer"
                  >https://github.com/miketromba/shadcn-themer</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="45706380">
          <h3>
            <a class="item" href="https://amit.prasad.me/blog/before-main"
              >The Journey Before main()</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-25 @ 19:33:22</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45706380"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45706077">
          <h3>
            <a
              class="item"
              href="https://www.washingtonpost.com/world/2025/10/25/switzerland-nuclear-bunkers-overhaul/"
              >Switzerland is spending millions revamping its vast network of
              bunkers</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-25 @ 18:47:55</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45706077"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45705583">
          <h3>
            <a
              class="item"
              href="https://blog.ezyang.com/2025/10/draw-high-dimensional-tensors-as-a-matrix-of-matrices/"
              >Draw high dimensional tensors as a matrix of matrices</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-25 @ 17:33:43</span
              ><span class="points-container"
                >Points: <span class="points">3</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45705583"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45705381">
          <h3>
            <a class="item" href="https://libera.chat/news/advised"
              >We do not have sufficient links to the UK for Online Safety Act
              to be applicable</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-25 @ 17:07:40</span
              ><span class="points-container"
                >Points: <span class="points">146</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45705381"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45705125">
          <h3>
            <a
              class="item"
              href="https://rocktumbler.com/tips/rock-tumbler-instructions/"
              >Rock Tumbler Instructions</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-25 @ 16:32:40</span
              ><span class="points-container"
                >Points: <span class="points">114</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45705125"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45703926">
          <h3>
            <a
              class="item"
              href="https://tigerbeetle.com/blog/2025-10-25-synadia-and-tigerbeetle-pledge-512k-to-the-zig-software-foundation/#blog-post"
              >TigerBeetle and Synadia pledge $512k to the Zig Software
              Foundation</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-25 @ 13:54:33</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45703926"
                  >Comments</a
                ><span class="descendants">: 145</span></span
              >
            </h4>
            <div class="text">
              <a
                href="https://www.synadia.com/blog/synadia-tigerbeetle-zig-foundation-pledge"
                >https://www.synadia.com/blog/synadia-tigerbeetle-zig-foundat...</a
              >
            </div>
          </section>
        </section>
        <section id="45703556">
          <h3>
            <a
              class="item"
              href="https://popovicu.com/posts/making-a-micro-linux-distro/"
              >Making a micro Linux distro (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-25 @ 13:01:39</span
              ><span class="points-container"
                >Points: <span class="points">129</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45703556"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45702558">
          <h3>
            <a class="item" href="https://backbonenotbad.hyperclay.com/"
              >React vs. Backbone in 2025</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-25 @ 09:43:54</span
              ><span class="points-container"
                >Points: <span class="points">260</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45702558"
                  >Comments</a
                ><span class="descendants">: 193</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45701980">
          <h3>
            <a
              class="item"
              href="https://en.andros.dev/blog/4e12225f/why-your-socialorg-files-can-have-millions-of-lines-without-any-performance-issues/"
              >Why your social.org files can have millions of lines without
              performance issues</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-25 @ 07:27:07</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45701980"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45701404">
          <h3>
            <a
              class="item"
              href="https://www.seangoedecke.com/good-code-reviews/"
              >Mistakes I see engineers making in their code reviews</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-25 @ 04:42:09</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45701404"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45700946">
          <h3>
            <a
              class="item"
              href="https://iverify.io/blog/key-iocs-for-pegasus-and-predator-spyware-cleaned-with-ios-26-update"
              >Key IOCs for Pegasus and Predator Spyware Removed with iOS 26
              Update</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-25 @ 02:31:55</span
              ><span class="points-container"
                >Points: <span class="points">198</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45700946"
                  >Comments</a
                ><span class="descendants">: 135</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45698570">
          <h3>
            <a
              class="item"
              href="https://www.swift.org/blog/nightly-swift-sdk-for-android/"
              >The Swift SDK for Android</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-24 @ 20:06:52</span
              ><span class="points-container"
                >Points: <span class="points">656</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45698570"
                  >Comments</a
                ><span class="descendants">: 253</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45695979">
          <h3>
            <a
              class="item"
              href="https://www.assembled.com/blog/why-i-code-as-a-cto"
              >Why I code as a CTO</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-24 @ 16:03:53</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45695979"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45695134">
          <h3>
            <a
              class="item"
              href="https://www.saxrag.com/tech/reversing/2025/06/01/BAWiFi.html"
              >Unlocking free WiFi on British Airways</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-24 @ 14:40:34</span
              ><span class="points-container"
                >Points: <span class="points">552</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45695134"
                  >Comments</a
                ><span class="descendants">: 132</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45672494">
          <h3>
            <a class="item" href="https://github.com/danirod/jacqueline"
              >Jacqueline – A minimal i386 kernel written in Pascal (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-22 @ 17:37:46</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45672494"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45665513">
          <h3>
            <a class="item" href="https://edera.dev/stories/tarmageddon"
              >Tarmageddon: RCE vulnerability highlights challenges of open
              source abandonware</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-22 @ 06:26:33</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45665513"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45653639">
          <h3>
            <a
              class="item"
              href="https://www.nbcnews.com/health/health-news/tiny-eye-implant-special-glasses-legally-blind-patients-can-read-rcna238488"
              >People with blindness can read again after retinal implant and
              special glasses</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-21 @ 08:19:27</span
              ><span class="points-container"
                >Points: <span class="points">281</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45653639"
                  >Comments</a
                ><span class="descendants">: 82</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.nature.com/articles/d41586-025-03420-x"
                >https://www.nature.com/articles/d41586-025-03420-x</a
              >
            </div>
          </section>
        </section>
        <section id="45653543">
          <h3>
            <a
              class="item"
              href="https://google.github.io/building-secure-and-reliable-systems/raw/ch01.html#on_passwords_and_power_drills"
              >Passwords and Power Drills</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-21 @ 08:03:17</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45653543"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45638990">
          <h3>
            <a
              class="item"
              href="https://asawicki.info/news_1791_calculating_the_bounding_rectangle_of_a_circular_sector"
              >Calculating the Bounding Rectangle of a Circular Sector</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-19 @ 23:40:14</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45638990"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45633311">
          <h3>
            <a
              class="item"
              href="https://blog.baro.dev/p/the-future-of-python-web-services-looks-gil-free"
              >The future of Python web services looks GIL-free</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-19 @ 10:38:25</span
              ><span class="points-container"
                >Points: <span class="points">158</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45633311"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
