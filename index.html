<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="41238632">
          <h3>
            <a
              class="item"
              href="https://blog.google/products/pixel/google-pixel-watch-3/"
              >Google Pixel Watch 3: bigger, brighter, fine-tuned for fitness</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-13 @ 19:14:29</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41238632"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41238102">
          <h3>
            <a
              class="item"
              href="https://www.usgs.gov/media/images/all-earths-water-a-single-sphere"
              >All of Earth's water in a single sphere</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-13 @ 18:32:52</span
              ><span class="points-container"
                >Points: <span class="points">127</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41238102"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41237275">
          <h3>
            <a
              class="item"
              href="https://store.google.com/us/product/pixel_9_pro?hl=en-US"
              >Google Pixel 9 Pro</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-13 @ 17:08:20</span
              ><span class="points-container"
                >Points: <span class="points">254</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41237275"
                  >Comments</a
                ><span class="descendants">: 573</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41237200">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=41237200"
              >Retell AI (YC W24) is hiring a full stack engineer and a support
              engineer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-13 @ 17:00:31</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.workatastartup.com/jobs/68665"
                >https://www.workatastartup.com/jobs/68665</a
              >
              Support eng:
              <a href="https://www.workatastartup.com/jobs/68666"
                >https://www.workatastartup.com/jobs/68666</a
              >
            </div>
          </section>
        </section>
        <section id="41236430">
          <h3>
            <a
              class="item"
              href="https://github.blog/security/vulnerability-research/from-object-transition-to-rce-in-the-chrome-renderer/"
              >From object transition to RCE in the Chrome renderer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-13 @ 15:31:45</span
              ><span class="points-container"
                >Points: <span class="points">99</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41236430"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41236275">
          <h3>
            <a
              class="item"
              href="https://onlinelibrary.wiley.com/doi/10.1111/opo.13351"
              >You've got to hide your myopia away: John Lennon's contact
              lenses</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-13 @ 15:14:54</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41236275"
                  >Comments</a
                ><span class="descendants">: 82</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41236273">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=41236273"
              >Launch HN: Trellis (YC W24) – AI-powered workflows for
              unstructured data</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-13 @ 15:14:47</span
              ><span class="points-container"
                >Points: <span class="points">130</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41236273"
                  >Comments</a
                ><span class="descendants">: 82</span></span
              >
            </h4>
            <div class="text">
              <a href="https://runtrellis.com/">https://runtrellis.com/</a>).
              We’re building AI-powered ETL for unstructured data. Trellis
              transforms phone calls, PDFs, and chats into structured SQL format
              based on any schema you define in natural language. This helps
              data and ops teams automate manual data entry and run SQL queries
              on messy data.
              <p>
                There’s a demo video at
                <a href="https://www.youtube.com/watch?v=ib3mRh2tnSo"
                  >https://www.youtube.com/watch?v=ib3mRh2tnSo</a
                >
                and a sandbox to try out (no sign-in required!) at
                <a href="https://demo.runtrellis.com/"
                  >https://demo.runtrellis.com/</a
                >. An interesting historical archive of unstructured data we
                thought it would be interesting to run Trellis on top of are old
                Enron emails which famously took months to review. We’ve created
                a showcase demo here:
                <a
                  href="https://demo.runtrellis.com/showcase/enron-email-analysis"
                  >https://demo.runtrellis.com/showcase/enron-email-analysis</a
                >, with some documentation here:
                <a
                  href="https://docs.runtrellis.com/docs/example-email-analytics"
                  >https://docs.runtrellis.com/docs/example-email-analytics</a
                >.
              </p>
              <p>
                Why we built this: At the Stanford AI lab where we met, we
                collaborated with many F500 data teams (including Amazon, Meta,
                and Standard Chartered), and repeatedly saw the same problem:
                80% of enterprise data is unstructured, and traditional
                platforms can’t handle it. For example, a major commercial bank
                I work with couldn’t improve credit risk models because critical
                data was stuck in PDFs and emails.
              </p>
              <p>
                We realized that our research from the AI lab could be turned
                into a solution with an abstraction layer that works as well for
                financial underwriting as it does for analysis of call center
                transcripts: an AI-powered ETL that takes in any unstructured
                data source and turns it into a schematically correct table.
              </p>
              <p>
                Some interesting technical challenges we had to tackle along the
                way: (1) Supporting complex documents out of the box: We use
                LLM-based map-reduce to handle long documents and vision models
                for table and layout extraction. (2) Model Routing: We select
                the best model for each transformation to optimize cost and
                speed. For instance, in data extraction tasks, we could leverage
                simpler fine-tuned models that are specialized in returning
                structured JSONs of financial tables. (3) Data Validation and
                Schema Guarantees: We ensure accuracy with reference links and
                anomaly detection.
              </p>
              <p>
                After launching Trellis, we’ve seen diverse use cases,
                especially in legacy industries where PDFs are treated as APIs.
                For example, financial services companies need to process
                complex documents like bonds and credit ratings into a
                structured format, and need to speed up underwriting and enable
                pass-through loan processing. Customer support and back-office
                operations need to accelerate onboarding by mapping documents
                across different schema and ERP systems, and ensure support
                agents follow SOPs (security questions, compliance disclosures,
                etc.). And many companies today want data preprocessing in ETL
                pipelines and data ingestion for RAG.
              </p>
              <p>
                We’d love your feedback! Try it out at
                <a href="https://demo.runtrellis.com/"
                  >https://demo.runtrellis.com/</a
                >. To save and track your large data transformations, you can
                visit our dashboard and create an account at
                <a href="https://dashboard.runtrellis.com/"
                  >https://dashboard.runtrellis.com/</a
                >. If you’re interested in integrating with our APIs, our quick
                start docs are here:
                <a href="https://docs.runtrellis.com/docs/getting-started"
                  >https://docs.runtrellis.com/docs/getting-started</a
                >. If you have any specific use cases in mind, we’d be happy to
                do a custom integration and onboarding—anything for HN. :)
              </p>
              <p>
                Excited to hear about your experience wrangling with
                unstructured data in the past, workflows you want to automate,
                and what data integration you would like to see.
              </p>
            </div>
          </section>
        </section>
        <section id="41235789">
          <h3>
            <a
              class="item"
              href="https://dualpower.supply/posts/rfb-kit-workshop/"
              >An open-source flow battery kit</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-13 @ 14:25:19</span
              ><span class="points-container"
                >Points: <span class="points">89</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41235789"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41235733">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=41235733"
              >Launch HN: Shaped (YC W22) – AI-Powered Recommendations and
              Search</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-13 @ 14:19:21</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41235733"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.shaped.ai/">https://www.shaped.ai/</a>).
              We're building a semantic recommendation and search platform for
              marketplaces and content companies.
              <p>
                There’s a sandbox at
                <a href="https://play.shaped.ai/dashboard/home"
                  >https://play.shaped.ai/dashboard/home</a
                >
                that you can use to explore demo models and evaluate results
                interactively. And we have a demo video at
                <a href="https://www.youtube.com/watch?v=toCsUYQnJ_g"
                  >https://www.youtube.com/watch?v=toCsUYQnJ_g</a
                >.
              </p>
              <p>
                The explosion of online content, driven by both individuals and
                generative tools, is making it harder than ever for users to
                sift through the noise and find what's relevant to them.
                Platforms like Netflix, TikTok, and Meta have set a high bar,
                proving that personalized experiences are key to cutting through
                the clutter and engaging users effectively.
              </p>
              <p>
                Despite advancements in AI and semantic infrastructure like
                vector stores, building a truly relevant recommendation or
                search system is still extremely difficult. It's not just about
                deploying the latest LLM—the difficulties lie in creating the
                infrastructure to orchestrate the components seamlessly.
                Consider the challenge of continuously fine-tuning models with
                fresh data while simultaneously serving real-time personalized
                recommendations to millions of users. It requires a delicate
                balancing act of speed, scale, and sophistication.
              </p>
              <p>
                Our goal is to empower any technical team to build
                state-of-the-art recommendation and search systems, regardless
                of their data infrastructure. Here's how we eliminate the
                friction:
              </p>
              <p>
                Solving Data Challenges: We integrate directly with your data
                sources—Segment, Amplitude, Rudderstack, and more. We handle the
                complexities of real-time streaming, ETLs, and data quality
                robustness, so you can get started in minutes.
              </p>
              <p>
                Leveraging Cutting-Edge Models – we utilize state-of-the-art
                large-scale language, image, and tabular encoding models. This
                not only extracts maximum value from your data but also
                simplifies the process, even with unstructured data.
              </p>
              <p>
                Real-time Optimization: Unlike vision or NLP tasks,
                recommendation system performance hinges on real-time
                capabilities—training, feature engineering, and serving. We've
                architected our platform with this at its core.
              </p>
              <p>
                We're already helping many companies build relevant
                recommendations and search for their users. Outdoorsy, for
                example, uses us to power its RV rental marketplace. E-commerce
                businesses like DribbleUp and startups like Overlap have seen up
                to a 40% increase in both conversions and engagement when
                integrating Shaped.
              </p>
              <p>
                A bit about us: Tullie was previously an AI Researcher at FAIR
                working on multimodal ranking at Meta. He released PyTorchVideo,
                a widely-used video understanding library, which contains the
                video understanding models that power systems like IG Reels. Dan
                led product research at Afterpay and Uber, driven by how
                behavioral psychology influences user experience.
              </p>
              <p>
                We've been heads down building Shaped for quite a while, so this
                launch feels like a big milestone. We'd love to hear your
                feedback – technical deep dives, feature requests, you name it.
                Let us know what you think!
              </p>
            </div>
          </section>
        </section>
        <section id="41235677">
          <h3>
            <a
              class="item"
              href="https://ntietz.com/blog/you-should-make-a-new-terrible-programming-language/"
              >What you learn by making a new programming language</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-13 @ 14:12:54</span
              ><span class="points-container"
                >Points: <span class="points">147</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41235677"
                  >Comments</a
                ><span class="descendants">: 87</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41235462">
          <h3>
            <a class="item" href="https://github.com/libAudioFlux/audioFlux"
              >AudioFlux: A C/C++ library for audio and music analysis</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-13 @ 13:51:27</span
              ><span class="points-container"
                >Points: <span class="points">140</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41235462"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41235259">
          <h3>
            <a class="item" href="https://github.com/jbunke/stipple-effect"
              >Show HN: Stipple Effect – a scriptable pixel art editor to make
              game art faster</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-13 @ 13:29:27</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41235259"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41234964">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/the-webb-telescope-further-deepens-the-biggest-controversy-in-cosmology-20240813/"
              >The Webb Telescope further deepens the Hubble tension controversy
              in cosmology</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-13 @ 12:50:54</span
              ><span class="points-container"
                >Points: <span class="points">181</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41234964"
                  >Comments</a
                ><span class="descendants">: 146</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41234877">
          <h3>
            <a class="item" href="https://github.com/Parrot-Developers/libpomp"
              >Printf Oriented Message Protocol</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-13 @ 12:41:07</span
              ><span class="points-container"
                >Points: <span class="points">73</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41234877"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41234713">
          <h3>
            <a class="item" href="https://github.com/jianchang512/pyvideotrans"
              >Open-source tool translates and dubs videos into other languages
              using AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-13 @ 12:15:57</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41234713"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41234636">
          <h3>
            <a
              class="item"
              href="http://yummymelon.com/devnull/contextual-interfaces-in-casual-calc.html"
              >Emacs: Contextual Interfaces in Casual Calc</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-13 @ 12:05:22</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41234636"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41233811">
          <h3>
            <a class="item" href="https://github.com/dplanitzer/Serena"
              >Serena: An experimental operating system for 32bit Amiga
              computers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-13 @ 09:33:28</span
              ><span class="points-container"
                >Points: <span class="points">131</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41233811"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41230033">
          <h3>
            <a
              class="item"
              href="https://www.historytoday.com/miscellanies/record-music-mass-production"
              >The Record: Music before mass production (2018)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-12 @ 22:22:51</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41230033"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41228278">
          <h3>
            <a
              class="item"
              href="https://www.ni.com/en/perspectives/letter-to-customers.html"
              >National Instruments acquired by Emerson</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-12 @ 19:21:47</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41228278"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41227987">
          <h3>
            <a
              class="item"
              href="https://simonwillison.net/2024/Aug/12/smuggling-queries-at-the-protocol-level/"
              >SQL Injection Isn't Dead: Smuggling Queries at the Protocol
              Level</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-12 @ 18:52:59</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41227987"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41227772">
          <h3>
            <a class="item" href="https://github.com/callisto-lang/compiler"
              >Callisto: Reverse polish notation programming language inspired
              by YSL-C3, Forth</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-12 @ 18:31:45</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41227772"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41227179">
          <h3>
            <a
              class="item"
              href="https://ianthehenry.com/posts/quote-unquote-macros/"
              >Quote-unquote "macros"</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-12 @ 17:40:09</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41227179"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41227011">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2024/08/10/world/asia/worlds-oldest-calendar-gobekli-tepe.html"
              >Ancient calendar, recently discovered, may document a long-ago
              disaster</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-12 @ 17:24:40</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41227011"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41222577">
          <h3>
            <a class="item" href="https://sponsor.ajay.app/"
              >SponsorBlock – skip sponsor segments on YouTube</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-12 @ 09:10:44</span
              ><span class="points-container"
                >Points: <span class="points">283</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41222577"
                  >Comments</a
                ><span class="descendants">: 110</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41220188">
          <h3>
            <a class="item" href="https://linux.die.net/man/3/hcreate"
              >Hcreate(3)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-12 @ 00:21:01</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41220188"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41212566">
          <h3>
            <a
              class="item"
              href="https://www.totemlabs.com/post/how-the-totem-compass-works"
              >How the Totem Compass Works</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-10 @ 22:01:49</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41212566"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41212297">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=oVWsbpdDxTg"
              >Captain Disillusion debunks David Beckham beach kicks [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-10 @ 21:22:10</span
              ><span class="points-container"
                >Points: <span class="points">175</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41212297"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41207987">
          <h3>
            <a
              class="item"
              href="https://www.eff.org/deeplinks/2024/07/effs-concerns-about-un-draft-cybercrime-convention"
              >EFF’s concerns about the UN Cybercrime Convention</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-10 @ 07:46:45</span
              ><span class="points-container"
                >Points: <span class="points">130</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41207987"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41202134">
          <h3>
            <a
              class="item"
              href="https://thecritic.co.uk/issues/july-2024/of-mice-and-men-and-magdalen/"
              >Of mice and men and Magdalen: C. S. Lewis’s Oxford</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-09 @ 14:24:19</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41202134"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41199092">
          <h3>
            <a
              class="item"
              href="https://blog.orange.tw/2024/08/confusion-attacks-en.html"
              >Confusion Attacks: Exploiting Hidden Semantic Ambiguity in Apache
              HTTP Server</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-09 @ 05:47:11</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41199092"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
