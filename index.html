<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="41943117">
          <h3>
            <a
              class="item"
              href="https://fgiesen.wordpress.com/2024/10/24/inserting-a-0-bit-in-the-middle-of-a-value/"
              >Inserting a 0 bit in the middle of a value</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-25 @ 07:44:01</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41943117"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41943098">
          <h3>
            <a
              class="item"
              href="https://alfy.blog/2024/10/19/linking-directly-to-web-page-content.html"
              >Smarter Than 'Ctrl+F': Linking Directly to Web Page Content</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-25 @ 07:41:36</span
              ><span class="points-container"
                >Points: <span class="points">81</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41943098"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41942978">
          <h3>
            <a
              class="item"
              href="https://marx.wtf/2024/10/10/law-enforcement-undermines-tor/"
              >Law Enforcement Undermines Tor</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-25 @ 07:16:33</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41942978"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41942096">
          <h3>
            <a
              class="item"
              href="https://www.nih.gov/news-events/nih-research-matters/brain-waste-clearance-system-shown-people-first-time"
              >The brain's waste clearing lymphatic system shown in people for
              first time</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-25 @ 03:56:32</span
              ><span class="points-container"
                >Points: <span class="points">156</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41942096"
                  >Comments</a
                ><span class="descendants">: 49</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41941930">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/vapi/jobs/BnVHTaQ-founding-senior-engineer-infrastructure"
              >Vapi (YC W21) is hiring a founding infra engineer to handle
              scale</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-25 @ 03:14:58</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41941493">
          <h3>
            <a class="item" href="https://github.com/open-feature"
              >OpenFeature – a vendor-agnostic, community-driven API for feature
              flagging</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-25 @ 01:26:45</span
              ><span class="points-container"
                >Points: <span class="points">130</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41941493"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41941308">
          <h3>
            <a class="item" href="https://github.com/resola-ai/rust-aws-tui"
              >Show HN: Rust based AWS Lambda Logs Viewer (TUI)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-25 @ 00:53:59</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41941308"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
            <div class="text">
              My first Rust program with support from Cursor :)). few days for
              idea. 1 night for "talk and fight" with Cursor
            </div>
          </section>
        </section>
        <section id="41940580">
          <h3>
            <a
              class="item"
              href="https://github.com/bitwarden/sdk-internal/commit/db648d7ea85878e9cce03283694d01d878481f6b"
              >Bitwarden SDK relicensed from proprietary to GPLv3</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-24 @ 22:41:03</span
              ><span class="points-container"
                >Points: <span class="points">675</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41940580"
                  >Comments</a
                ><span class="descendants">: 246</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41940266">
          <h3>
            <a
              class="item"
              href="https://www.goto10retro.com/p/st-book-the-notebook-atari-st"
              >ST Book, the Notebook Atari ST</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-24 @ 21:57:54</span
              ><span class="points-container"
                >Points: <span class="points">77</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41940266"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41939967">
          <h3>
            <a
              class="item"
              href="https://www.circle-lang.org/draft-profiles.html"
              >Why Safety Profiles Failed</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-24 @ 21:26:09</span
              ><span class="points-container"
                >Points: <span class="points">188</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41939967"
                  >Comments</a
                ><span class="descendants">: 126</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41939189">
          <h3>
            <a class="item" href="https://calnewport.com/quit-social-media/"
              >Quit Social Media (2016)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-24 @ 20:04:52</span
              ><span class="points-container"
                >Points: <span class="points">129</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41939189"
                  >Comments</a
                ><span class="descendants">: 120</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41939027">
          <h3>
            <a class="item" href="https://typeschema.org/"
              >Show HN: TypeSchema – A JSON specification to describe data
              models</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-24 @ 19:46:58</span
              ><span class="points-container"
                >Points: <span class="points">100</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41939027"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41938831">
          <h3>
            <a class="item" href="https://github.com/ArthurBrussee/brush"
              >Brush – A new compatible Gaussian splatting engine</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-24 @ 19:24:36</span
              ><span class="points-container"
                >Points: <span class="points">145</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41938831"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41938819">
          <h3>
            <a
              class="item"
              href="https://about.gitlab.com/blog/2022/05/26/a-go-micro-language-framework-for-building-dsls/"
              >Lingo: A Go micro language framework for building Domain Specific
              Languages</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-24 @ 19:23:38</span
              ><span class="points-container"
                >Points: <span class="points">105</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41938819"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41938473">
          <h3>
            <a
              class="item"
              href="https://ai.meta.com/blog/meta-llama-quantized-lightweight-models/?_fb_noscript=1"
              >Quantized Llama models with increased speed and a reduced memory
              footprint</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-24 @ 18:52:44</span
              ><span class="points-container"
                >Points: <span class="points">417</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41938473"
                  >Comments</a
                ><span class="descendants">: 99</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41937815">
          <h3>
            <a class="item" href="https://github.com/E-xyza/zigler"
              >Zigler: Zig NIFs in Elixir</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-24 @ 17:53:26</span
              ><span class="points-container"
                >Points: <span class="points">201</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41937815"
                  >Comments</a
                ><span class="descendants">: 70</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41937664">
          <h3>
            <a
              class="item"
              href="https://security.apple.com/blog/pcc-security-research/"
              >Security research on Private Cloud Compute</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-24 @ 17:36:06</span
              ><span class="points-container"
                >Points: <span class="points">266</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41937664"
                  >Comments</a
                ><span class="descendants">: 91</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41937443">
          <h3>
            <a
              class="item"
              href="https://archaeologymag.com/2024/09/lion-of-st-marks-square-in-venice-is-chinese/"
              >The Lion of St. Mark's Square in Venice Is Chinese</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-24 @ 17:08:43</span
              ><span class="points-container"
                >Points: <span class="points">169</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41937443"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41937319">
          <h3>
            <a
              class="item"
              href="https://www.nps.gov/articles/post-wwii-food.htm"
              >Post World War II Food</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-24 @ 16:54:53</span
              ><span class="points-container"
                >Points: <span class="points">225</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41937319"
                  >Comments</a
                ><span class="descendants">: 210</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41936745">
          <h3>
            <a class="item" href="https://github.com/Skyvern-AI/Skyvern"
              >Launch HN: Skyvern (YC S23) – open-source AI agent for browser
              automations</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-24 @ 15:51:21</span
              ><span class="points-container"
                >Points: <span class="points">293</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41936745"
                  >Comments</a
                ><span class="descendants">: 63</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.skyvern.com">https://www.skyvern.com</a>).
              We’re building an open source tool to help companies automate
              browser-based workflows using LLMs.
              <p>
                Our open source repo is at
                <a href="https://github.com/Skyvern-AI/Skyvern"
                  >https://github.com/Skyvern-AI/Skyvern</a
                >, and we're excited to share our cloud version with you (<a
                  href="https://app.skyvern.com"
                  >https://app.skyvern.com</a
                >) :)
              </p>
              <p>
                Skyvern allows you to define a single (or a series of)
                goal-based prompts to instruct an agent to complete complex
                tasks on websites. Here’s a quick demo of Skyvern:
                <a
                  href="https://www.loom.com/share/76b231309df74a528061fcf102e1967f"
                  >https://www.loom.com/share/76b231309df74a528061fcf102e1967f</a
                >
              </p>
              <p>
                We built this to solve a specific problem: building browser
                automations often requires companies to either hire people and
                scale out operations teams to do tedious manual work, or hire
                developers to use products like UI-Path or Selenium to build
                automations.
              </p>
              <p>
                Code-based solutions always run into the same problem: they’re
                brittle (wow this website added a new pop-up dialog and my
                script broke), and fail to achieve the same objective across
                multiple websites (how can I fill out a contact-us form on
                hundreds of different websites?)
              </p>
              <p>
                We did a Show HN a few months ago (<a
                  href="https://news.ycombinator.com/item?id=39706004"
                  >https://news.ycombinator.com/item?id=39706004</a
                >), and since then, we’ve onboarded customers for a wide variety
                of use cases: generating insurance quotes on websites like
                Geico.com; applying to jobs on websites like lever.co;
                automating filing permits in local government portals;
                registering new corporations for employment identification;
                fetching invoices from hundreds of different portals such as
                hydroone.com; automating purchasing on a handful of e-commerce
                websites like zooplus.com; and filling out contact us forms on a
                bunch of random smb websites (such as HVAC websites).
              </p>
              <p>
                To be able to service all of these, we’ve built and open-sourced
                quite a few interesting features:
              </p>
              <p>
                (1) a fully-featured React application allowing you to see every
                action Skyvern is taking in real-time;
              </p>
              <p>
                (2) livestreaming browser instances to allow our users to see
                what Skyvern is doing when running inside of a docker container;
              </p>
              <p>
                (3) authenticated sessions, integrating with Bitwarden and
                allowing users to specify Email + Phone + QR-code based 2FAs;
              </p>
              <p>
                (4) “workflows” allowing users to chain multiple goal-based
                prompts together, which can handle tasks like invoice
                downloading, or automating purchasing pipelines;
              </p>
              <p>
                (5) processing HTML Elements (ex. identifying + summarizing
                SVGs) and performing website interactions (ex. Iterating over
                dynamic autocompletes to fill in address information correctly)
              </p>
              <p>
                (6) “cached workflows”, allowing Skyvern to memorize previous
                interactions (ie text inputs) and re-use them in future runs.
              </p>
              <p>
                We’ve also been blessed with a few model advancements to solve
                some of the cost concerns the community brought up. Skyvern’s
                token costs went down 80% from $15 / 1M tokens (GPT-4V) to $2.50
                / 1M tokens (GPT-4O)
              </p>
              <p>
                Despite the model costs going down 80%, Skyvern is still quite
                expensive to run, so we give every new user $5 of credits to try
                it out and see if it can be useful for you.
              </p>
              <p>
                We would be honored if you could give it a try at
                <a href="https://app.skyvern.com">https://app.skyvern.com</a>
                and share some feedback with us, and we look forward to any and
                all of your comments!
              </p>
            </div>
          </section>
        </section>
        <section id="41932995">
          <h3>
            <a class="item" href="https://liblisa.nl/"
              >LibLISA – Instruction Discovery and Analysis on x86-64</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-24 @ 07:35:56</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41932995"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41930628">
          <h3>
            <a class="item" href="https://github.com/RamboRogers/rfhunter"
              >Show HN: RF Hunter – Find hidden cameras and other devices</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-24 @ 00:21:36</span
              ><span class="points-container"
                >Points: <span class="points">492</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41930628"
                  >Comments</a
                ><span class="descendants">: 152</span></span
              >
            </h4>
            <div class="text">
              This project is an RF Signal Scanner built using an ESP32, AD8317
              RF detector, and various other components. It's designed to detect
              and measure RF signals in the environment and display the signal
              strength on an OLED display. It's useful to find hidden cameras,
              wiretapping devices, and other RF-enabled devices.
            </div>
          </section>
        </section>
        <section id="41929412">
          <h3>
            <a
              class="item"
              href="https://eli.thegreenplace.net/2024/calculating-the-norm-of-a-complex-number/"
              >Calculating the norm of a complex number</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-23 @ 21:30:02</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41929412"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41926907">
          <h3>
            <a
              class="item"
              href="https://theoryandpractice.org/2024/10/Yes,%20we%20did%20discover%20the%20Higgs!/"
              >Yes, we did discover the Higgs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-23 @ 16:55:08</span
              ><span class="points-container"
                >Points: <span class="points">113</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41926907"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41923753">
          <h3>
            <a
              class="item"
              href="https://lilymara.xyz/posts/2024/01/transit-kindle/"
              >Never Missing the Train Again</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-23 @ 11:00:15</span
              ><span class="points-container"
                >Points: <span class="points">294</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41923753"
                  >Comments</a
                ><span class="descendants">: 112</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41923518">
          <h3>
            <a
              class="item"
              href="https://buttondown.com/hillelwayne/archive/tla-from-first-principles/"
              >TLA from First Principles</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-23 @ 10:03:53</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41923518"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41922503">
          <h3>
            <a
              class="item"
              href="https://technology.riotgames.com/news/peeking-valorants-netcode"
              >Riot Games: Peeking into Valorant's Netcode (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-23 @ 06:51:40</span
              ><span class="points-container"
                >Points: <span class="points">156</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41922503"
                  >Comments</a
                ><span class="descendants">: 72</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41922216">
          <h3>
            <a
              class="item"
              href="https://localnewsinitiative.northwestern.edu/posts/2024/10/22/blair-kamin-funds-chicago-tribune-architecture-writer/"
              >Writer Underwriting Writer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-23 @ 05:56:07</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41922216"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41922136">
          <h3>
            <a
              class="item"
              href="https://www.sstic.org/media/SSTIC2024/SSTIC-actes/when_vendor1_meets_vendor2_the_story_of_a_small_bu/SSTIC2024-Article-when_vendor1_meets_vendor2_the_story_of_a_small_bug_chain-rossi-bellom_neveu.pdf"
              >When Samsung meets MediaTek: the story of a small bug chain
              [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-23 @ 05:39:20</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41922136"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41911335">
          <h3>
            <a
              class="item"
              href="https://aeon.co/essays/the-indigenous-faith-that-reveres-its-own-alphabet-as-sacred"
              >The Script Creator</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-22 @ 05:02:16</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41911335"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
