<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="46771599">
          <h3>
            <a
              class="item"
              href="https://www.wsj.com/business/the-secret-society-of-people-who-know-the-formula-for-wd-40-e9c0ff54"
              >People who know the formula for WD-40</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 21:11:53</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46771599"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
            <div class="text">
              <a
                href="https://www.wsj.com/business/the-secret-society-of-people-who-know-the-formula-for-wd-40-e9c0ff54?st=zbjngP&amp;reflink=desktopwebshare_permalink"
                >https://www.wsj.com/business/the-secret-society-of-people-wh...</a
              >
            </div>
          </section>
        </section>
        <section id="46770274">
          <h3>
            <a
              class="item"
              href="https://visualrambling.space/dithering-part-2/"
              >Dithering – Part 2: The Ordered Dithering</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 19:23:54</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46770274"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46770221">
          <h3>
            <a
              class="item"
              href="https://simonwillison.net/2026/Jan/26/chatgpt-containers/"
              >ChatGPT Containers can now run bash, pip/npm install packages and
              download files</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 19:19:40</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46770221"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46769965">
          <h3>
            <a
              class="item"
              href="https://www.theregister.com/2026/01/26/cursor_opinion/"
              >When AI 'builds a browser,' check the repo before believing the
              hype</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 18:58:37</span
              ><span class="points-container"
                >Points: <span class="points">148</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46769965"
                  >Comments</a
                ><span class="descendants">: 65</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46769752">
          <h3>
            <a class="item" href="https://tetrisbench.com/tetrisbench/"
              >Show HN: TetrisBench – Gemini Flash reaches 66% win rate on
              Tetris against Opus</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 18:42:40</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46769752"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46769668">
          <h3>
            <a class="item" href="https://workdaycase.com"
              >Notice of Collective Action Lawsuit Against Workday, INC</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 18:37:37</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46769668"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46769422">
          <h3>
            <a class="item" href="https://ourguide.ai"
              >Show HN: Ourguide – OS wide task guidance system that shows you
              where to click</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 18:19:45</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46769422"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
            <div class="text">
              <p>
                I started building this because whenever I didn’t know how to do
                something on my computer, I found myself constantly tabbing
                between chatbots and the app, pasting screenshots, and asking
                “what do I do next?” Ourguide solves this with two modes. In
                Guide mode, the app overlays your screen and highlights the
                specific element to click next, eliminating the need to leave
                your current window. There is also Ask mode, which is a
                vision-integrated chat that captures your screen context—which
                you can toggle on and off anytime -so you can ask, "How do I fix
                this error?" without having to explain what "this" is.
              </p>
              <p>
                It’s an Electron app that works OS-wide, is vision-based, and
                isn't restricted to the browser.
              </p>
              <p>
                Figuring out how to show the user where to click was the hardest
                part of the process. I originally trained a computer vision
                model with 2300 screenshots to identify and segment all UI
                elements on a screen and used a VLM to find the correct icon to
                highlight. While this worked extremely well—better than SOTA
                grounding models like UI Tars—the latency was just too high.
                I'll be making that CV+VLM pipeline OSS soon, but for now, I’ve
                resorted to a simpler implementation that achieves &lt;1s
                latency.
              </p>
              <p>
                You may ask: if I can show you where to click, why can't I just
                click too? While trying to build computer-use agents during my
                job in Palo Alto, I hit the core limitation of today’s
                computer-use models where benchmarks hover in the mid-50% range
                (OSWorld). VLMs often know what to do but not what it looks
                like; without reliable visual grounding, agents misclick and
                stall. So, I built computer use—without the "use." It provides
                the visual grounding of an agent but keeps the human in the loop
                for the actual execution to prevent misclicks.
              </p>
              <p>
                I personally use it for the AWS Console's "treasure hunt" UI,
                like creating a public S3 bucket with specific CORS rules. It’s
                also been surprisingly helpful for non-technical tasks, like
                navigating obscure settings in Gradescope or Spotify. Ourguide
                really works for any task when you’re stuck or don't know what
                to do.
              </p>
              <p>
                You can download and test Ourguide here:
                <a href="https://ourguide.ai/downloads"
                  >https://ourguide.ai/downloads</a
                >
              </p>
              <p>
                The project is still very early, and I’d love your feedback on
                where it fails, where you think it worked well, and which
                specific niches you think Ourguide would be most helpful for.
              </p>
            </div>
          </section>
        </section>
        <section id="46769201">
          <h3>
            <a
              class="item"
              href="https://old.reddit.com/r/google/comments/1qn1hk1/google_has_seemingly_entirely_removed_search/"
              >Google Books removed all search functions for any books with
              previews</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 18:05:15</span
              ><span class="points-container"
                >Points: <span class="points">139</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46769201"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46769051">
          <h3>
            <a
              class="item"
              href="https://bsky.app/profile/did:plc:okydh7e54e2nok65kjxdklvd/post/3mdd55paffk2o"
              >Fedora Asahi Remix is now working on Apple M3</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 17:54:20</span
              ><span class="points-container"
                >Points: <span class="points">332</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46769051"
                  >Comments</a
                ><span class="descendants">: 112</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46768909">
          <h3>
            <a
              class="item"
              href="https://nproject.io/blog/juicessh-give-me-back-my-pro-features/"
              >JuiceSSH – Give me my pro features back</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 17:46:38</span
              ><span class="points-container"
                >Points: <span class="points">150</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46768909"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46767875">
          <h3>
            <a
              class="item"
              href="https://signoregalilei.com/2026/01/18/the-mountain-that-weighed-the-earth/"
              >The mountain that weighed the Earth</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 16:43:30</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46767875"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46767668">
          <h3>
            <a
              class="item"
              href="https://twitter.com/lellouchenico/status/2015775970330882319"
              >France Aiming to Replace Zoom, Google Meet, Microsoft Teams,
              etc.</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 16:27:46</span
              ><span class="points-container"
                >Points: <span class="points">396</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46767668"
                  >Comments</a
                ><span class="descendants">: 338</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46767440">
          <h3>
            <a
              class="item"
              href="https://www.zackliscio.com/posts/rip-low-code-2014-2025/"
              >RIP Low-Code 2014-2025</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 16:11:28</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46767440"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46766961">
          <h3>
            <a
              class="item"
              href="https://www.greptile.com/blog/ai-code-review-bubble"
              >There is an AI code review bubble</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 15:38:50</span
              ><span class="points-container"
                >Points: <span class="points">95</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46766961"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46766741">
          <h3>
            <a class="item" href="https://qwen.ai/blog?id=qwen3-max-thinking"
              >Qwen3-Max-Thinking</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 15:23:00</span
              ><span class="points-container"
                >Points: <span class="points">376</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46766741"
                  >Comments</a
                ><span class="descendants">: 321</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46766432">
          <h3>
            <a class="item" href="https://llmspy.org/docs/v3"
              >OSS ChatGPT WebUI – 530 Models, MCP, Tools, Gemini RAG,
              Image/Audio Gen</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 15:01:03</span
              ><span class="points-container"
                >Points: <span class="points">99</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46766432"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46766229">
          <h3>
            <a class="item" href="https://kwarc.info/teaching/TDM/Borges.pdf"
              >Exactitude in Science – Borges (1946) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 14:44:51</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46766229"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46766188">
          <h3>
            <a
              class="item"
              href="https://diamondgeezer.blogspot.com/2026/01/tv100.html"
              >Television is 100 years old today</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 14:41:04</span
              ><span class="points-container"
                >Points: <span class="points">333</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46766188"
                  >Comments</a
                ><span class="descendants">: 104</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46766031">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/technology/2026/jan/24/google-ai-overviews-youtube-medical-citations-study"
              >Google AI Overviews cite YouTube more than any medical site for
              health queries</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 14:27:00</span
              ><span class="points-container"
                >Points: <span class="points">316</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46766031"
                  >Comments</a
                ><span class="descendants">: 170</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46764170">
          <h3>
            <a class="item" href="https://github.com/kxzk/snapbench"
              >Show HN: Only 1 LLM can fly a drone</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 11:00:44</span
              ><span class="points-container"
                >Points: <span class="points">118</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46764170"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46763864">
          <h3>
            <a
              class="item"
              href="https://maplibre.org/news/2026-01-23-mlt-release/"
              >MapLibre Tile: a modern and efficient vector tile format</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 10:19:51</span
              ><span class="points-container"
                >Points: <span class="points">368</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46763864"
                  >Comments</a
                ><span class="descendants">: 73</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46763721">
          <h3>
            <a class="item" href="https://walzr.com/sf-graffiti"
              >San Francisco Graffiti</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 10:02:12</span
              ><span class="points-container"
                >Points: <span class="points">117</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46763721"
                  >Comments</a
                ><span class="descendants">: 115</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46762882">
          <h3>
            <a
              class="item"
              href="https://github.com/quaadgras/graphics.gd/discussions/242"
              >The Holy Grail of Linux Binary Compatibility: Musl and Dlopen</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 07:41:52</span
              ><span class="points-container"
                >Points: <span class="points">197</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46762882"
                  >Comments</a
                ><span class="descendants">: 165</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46762150">
          <h3>
            <a
              class="item"
              href="https://simonwillison.net/2026/Jan/25/the-browser-is-the-sandbox/"
              >The browser is the sandbox</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-26 @ 05:23:01</span
              ><span class="points-container"
                >Points: <span class="points">318</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46762150"
                  >Comments</a
                ><span class="descendants">: 167</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46727603">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2512.14319"
              >Not all Chess960 positions are equally complex</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-23 @ 02:27:30</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46727603"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46709461">
          <h3>
            <a
              class="item"
              href="https://rendiment.io/postgresql/2026/01/21/pgtrgm-pgvector-music.html"
              >Find 'Abbey Road when type 'Beatles abbey rd': Fuzzy/Semantic
              search in Postgres</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-21 @ 18:24:55</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46709461"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46709270">
          <h3>
            <a
              class="item"
              href="https://www.jampa.dev/p/lessons-learned-after-10-years-as"
              >Things I've learned in my 10 years as an engineering manager</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-21 @ 18:11:13</span
              ><span class="points-container"
                >Points: <span class="points">493</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46709270"
                  >Comments</a
                ><span class="descendants">: 126</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46701045">
          <h3>
            <a class="item" href="https://openflexure.org/projects/microscope/"
              >OpenFlexure Microscope</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-21 @ 04:16:48</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46701045"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46698264">
          <h3>
            <a
              class="item"
              href="https://www.experimental-history.com/p/text-is-king"
              >Text Is King</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-20 @ 21:57:08</span
              ><span class="points-container"
                >Points: <span class="points">151</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46698264"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46694193">
          <h3>
            <a
              class="item"
              href="https://practical.engineering/blog/2026/1/20/the-hidden-engineering-of-runways"
              >The Hidden Engineering of Runways</a
            >
          </h3>
          <section>
            <h4>
              <span>2026-01-20 @ 16:52:52</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46694193"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2026/index.md"
              >2026</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
