<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="37182306">
          <h3>
            <a
              class="item"
              href="https://unherd.com/2023/08/artists-have-forgotten-how-to-draw/"
              >Artists have forgotten how to draw</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-18 @ 21:21:32</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37182306"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37182200">
          <h3>
            <a
              class="item"
              href="https://static1.squarespace.com/static/5497331ae4b0148a6141bd47/t/5af842f8758d4615555d3f6d/1526219514965/Patterns+of+Conflict+Transcript.pdf"
              >Discourse on Winning and Losing (1989) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-18 @ 21:14:26</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37182200"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37182037">
          <h3>
            <a class="item" href="https://www.ycombinator.com/library"
              >YC Library</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-18 @ 21:00:30</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37182037"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37181759">
          <h3>
            <a
              class="item"
              href="https://hxstem.substack.com/p/a-testimony-of-guilt-by-association"
              >A testimony of “guilt-by-association” harassment in astronomy</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-18 @ 20:36:59</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37181759"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37180767">
          <h3>
            <a
              class="item"
              href="https://loup-vaillant.fr/articles/hsm-done-right"
              >Fixing the TPM: Hardware Security Modules Done Right</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-18 @ 19:22:09</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37180767"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37180583">
          <h3>
            <a class="item" href="https://spectrum.ieee.org/solar-powered-motor"
              >Solar-Powered Electric Motors for EVs That Never Plug In</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-18 @ 19:08:12</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37180583"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37180017">
          <h3>
            <a class="item" href="https://github.com/poozlehq/poozle"
              >Show HN: Poozle – open-source Plaid for LLMs</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-18 @ 18:27:54</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37180017"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
            <div class="text">
              <p>
                Poozle (<a href="https://github.com/poozlehq/poozle"
                  >https://github.com/poozlehq/poozle</a
                >) provides a single API that helps businesses achieve accurate
                LLM responses by providing real-time customer data from
                different SAAS tools (e.g Notion, Salesforce, Jira, Shopify,
                Google Ads etc).
              </p>
              <p>
                Why we built Poozle: As we were talking to more AI companies who
                need to integrate with their customers’ data we realised
                managing all SAAS tools data and keeping them up-to-date is a
                huge infra of ETL, Auth management, Webhooks and many more
                things before you take it to production. It struck us – why not
                streamline this process and allow companies to prioritise their
                core product?
              </p>
              <p>
                How it works: Poozle makes user authorization seamless using our
                drop-in component (Poozle Link) and handles both API Key and
                OAuth dance. Post-authentication developers can use our Unified
                model to fetch data to their LLMs (no need to sync data
                separately and then normalise at your end). Poozle keeps data
                updated in real time while giving you options to choose sync
                intervals. Even if the source doesn’t support webhooks, we’ve
                got you covered.
              </p>
              <p>
                Currently, we support Unified API for 3 categories - Ticketing,
                Documentation and Email. You can watch a demo of Poozle (<a
                  href="https://www.loom.com/share/30650e4d1fac41e3a7debc212b1c7c2d)l"
                  >https://www.loom.com/share/30650e4d1fac41e3a7debc212b1c7c2d)...</a
                >
              </p>
              <p>
                We just got started a month ago and we’re eager to get feedback
                and keep building. Let us know what you think in the comments :
                )
              </p>
            </div>
          </section>
        </section>
        <section id="37179094">
          <h3>
            <a
              class="item"
              href="https://theintercept.com/2023/08/18/gedmatch-dna-police-forensic-genetic-genealogy/"
              >Police are getting DNA data from people who think they opted
              out</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-18 @ 17:28:13</span
              ><span class="points-container"
                >Points: <span class="points">153</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37179094"
                  >Comments</a
                ><span class="descendants">: 109</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37179066">
          <h3>
            <a
              class="item"
              href="https://hypercritical.co/2023/08/18/the-plumber-problem"
              >The Plumber Problem</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-18 @ 17:26:54</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37179066"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37178842">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2308.06103"
              >Expanding Transformer size without losing function or starting
              from scratch</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-18 @ 17:14:59</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37178842"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37178251">
          <h3>
            <a class="item" href="https://en.wikipedia.org/wiki/Zaum">Zaum</a>
          </h3>
          <section>
            <h4>
              <span>2023-08-18 @ 16:41:25</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37178251"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37178009">
          <h3>
            <a class="item" href="https://research.swtch.com/ub"
              >C and C++ prioritize performance over correctness</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-18 @ 16:27:10</span
              ><span class="points-container"
                >Points: <span class="points">193</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37178009"
                  >Comments</a
                ><span class="descendants">: 338</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37176960">
          <h3>
            <a
              class="item"
              href="https://ibraheem.ca/posts/too-many-web-servers/"
              >Learning Async Rust with Too Many Web Servers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-18 @ 15:28:58</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37176960"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37176842">
          <h3>
            <a
              class="item"
              href="https://medium.com/strong-words/meaningful-exits-for-founders-4c3b2baba6b4"
              >Meaningful exits for founders (2016)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-18 @ 15:16:46</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37176842"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37176717">
          <h3>
            <a
              class="item"
              href="https://www.eff.org/deeplinks/2023/07/deja-vu-fbi-proves-again-it-cant-be-trusted-section-702"
              >The FBI proves again it can’t be trusted with Section 702</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-18 @ 15:07:32</span
              ><span class="points-container"
                >Points: <span class="points">242</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37176717"
                  >Comments</a
                ><span class="descendants">: 75</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37176703">
          <h3>
            <a
              class="item"
              href="https://jeanhsu.substack.com/p/ask-vs-guess-culture"
              >Ask vs. Guess Culture</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-18 @ 15:06:48</span
              ><span class="points-container"
                >Points: <span class="points">476</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37176703"
                  >Comments</a
                ><span class="descendants">: 276</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37176666">
          <h3>
            <a
              class="item"
              href="https://twitter.com/mikko/status/1692503249595584526"
              >Windows 11 will happily execute a binary compiled 30 years ago</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-18 @ 15:04:35</span
              ><span class="points-container"
                >Points: <span class="points">122</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37176666"
                  >Comments</a
                ><span class="descendants">: 155</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37175754">
          <h3>
            <a
              class="item"
              href="https://ftp.gnu.org/old-gnu/Manuals/coreutils-4.5.4/html_node/coreutils_149.html"
              >Why GNU su does not support the `wheel' group (2002)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-18 @ 14:03:42</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37175754"
                  >Comments</a
                ><span class="descendants">: 73</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37175721">
          <h3>
            <a
              class="item"
              href="https://fortomorrow.org/explore-solutions/sargablock"
              >Sargablock: Bricks from Seaweed</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-18 @ 14:00:55</span
              ><span class="points-container"
                >Points: <span class="points">125</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37175721"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37175432">
          <h3>
            <a
              class="item"
              href="https://www.goodnewsnetwork.org/mister-rogers-had-a-point-routinely-greeting-six-neighbors-maximizes-wellbeing-outcomes/"
              >Mister Rogers had a point – routinely greeting six neighbors
              maximizes wellbeing</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-18 @ 13:36:15</span
              ><span class="points-container"
                >Points: <span class="points">137</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37175432"
                  >Comments</a
                ><span class="descendants">: 149</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37175228">
          <h3>
            <a
              class="item"
              href="https://www.bmj.com/content/382/bmj-2022-074520"
              >Low dose radiation cancer 2x worse than predicted by LNT model</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-18 @ 13:20:50</span
              ><span class="points-container"
                >Points: <span class="points">136</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37175228"
                  >Comments</a
                ><span class="descendants">: 125</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37174657">
          <h3>
            <a class="item" href="https://github.com/Textualize/textual"
              >Textual: Rapid Application Development framework for Python</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-18 @ 12:22:07</span
              ><span class="points-container"
                >Points: <span class="points">187</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37174657"
                  >Comments</a
                ><span class="descendants">: 70</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37174474">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=37174474"
              >MixRank (YC S11) Is Hiring Global Remote Software Engineers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-18 @ 12:00:30</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
            <div class="text">
              <p>
                MixRank processes petabytes of data every month from web
                crawling. We have hundreds of customers using our data products
                including Google, Amazon, Facebook, Intel, and Adobe, across
                industries including Recruiting, Finance, Security, Sales, and
                Marketing.
              </p>
              <p>
                Our team is 37 full-time, full-remote from 16+ countries. We're
                growing, profitable, employee-owned, no dependence on outside
                funding. Applicants from all geographies and backgrounds are
                welcome.
              </p>
              <p>
                We are looking for passionate individuals for whom programming
                is not just a job but it's something they love to do. We're
                obsessed with computers, programming, big data, databases,
                compilers, hardware, math, data science, and the internet. Does
                this sound like you? Please apply to join our team.
              </p>
              <p>
                Our code base is very friendly to new contributors. You'll have
                a (fully-automated) development environment and be pushing
                commits on your first day. Deployments to production happen
                multiple times per day and finish in less than 2 minutes. Our
                codebase is written in Python, SQL, Javascript/TypeScript, Rust,
                and Nix. The basic technologies you'll need to be productive are
                Python, PostgreSQL, Linux, and Git.
              </p>
              <p>
                We operate at a larger scale than typical startups. We operate
                two datacenters with high performance servers we've built that
                are capable of dealing with the volumes of data we process.
                We've implemented our own distributed file system. We do
                full-scale web crawls. We download and perform static analysis
                on the entire universe of Android APKs and iOS IPAs that are
                published. Unlike a typical startup where you'll spend half of
                your time in meetings, and the other half fixing bugs from Jira
                tickets— at MixRank you'll get to direct your entire focus into
                difficult technical problems that will help you to grow as an
                individual.
              </p>
              <p>--</p>
              <p>Junior Software Engineer</p>
              <p>
                We're looking for remote junior engineers that have 0-3 years of
                professional experience in software, and 5+ years of curiosity
                exploring computers, programming, and technical hobby projects.
                This is an open-ended entry role with mentorship and diverse
                opportunities to work on all areas of our product: databases,
                distributed systems, infrastructure and tooling, data analysis,
                machine learning, frontend/backend web development, APIs, data
                mining, data modeling, and more. To stand out, please highlight
                what makes you unique: passion for computing, curiosity and side
                projects, work ethic, niche research, etc.
              </p>
              <p>
                Ideally you've already finished with school, but if you still
                have one or more years left please feel free to apply anyway. If
                you're the right fit for the team we'll figure out a way to
                accommodate your schedule.
              </p>
              <p>--</p>
              <p>Software Engineer</p>
              <p>
                We're hiring generalist software engineers to work on web
                applications, data mining, machine learning/data science, data
                transformation/ETL, data modeling, database scaling,
                infrastructure, devops, and more. We'll customize the role to
                whatever subset of these areas match your interests.
              </p>
              <p>
                Beneficial experience includes PostgreSQL, Python, Linux,
                TypeScript, Rust, Nix, frontend/backend web development, and
                data mining.
              </p>
              <p>--</p>
              <p>
                Please apply here:
                <a href="https://www.ycombinator.com/companies/mixrank/jobs"
                  >https://www.ycombinator.com/companies/mixrank/jobs</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="37173339">
          <h3>
            <a
              class="item"
              href="https://www.sjoerdlangkemper.nl/2023/08/16/session-timeout/"
              >Short session expiration does not help security</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-18 @ 09:45:32</span
              ><span class="points-container"
                >Points: <span class="points">486</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37173339"
                  >Comments</a
                ><span class="descendants">: 312</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37172769">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=qJgsuQoy9bc"
              >Emulating the 6502 CPU in C++ (2021) [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-18 @ 08:28:04</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37172769"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37172689">
          <h3>
            <a class="item" href="https://tembo.io/blog/introducing-pg-later/"
              >Pg_later: Asynchronous Queries for Postgres</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-18 @ 08:15:23</span
              ><span class="points-container"
                >Points: <span class="points">170</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37172689"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37171943">
          <h3>
            <a class="item" href="https://fsharpforfunandprofit.com/rop/"
              >Railway Oriented Programming</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-18 @ 06:20:29</span
              ><span class="points-container"
                >Points: <span class="points">287</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37171943"
                  >Comments</a
                ><span class="descendants">: 146</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37171553">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/complexity-theorys-50-year-journey-to-the-limits-of-knowledge-20230817/"
              >Complexity theory’s 50-year journey to the limits of knowledge</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-18 @ 05:07:44</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37171553"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37167833">
          <h3>
            <a class="item" href="https://www.dancowell.com/breaking-the-rules/"
              >Throwing away 10 months of work after 2 months on the job</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-17 @ 20:48:00</span
              ><span class="points-container"
                >Points: <span class="points">104</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37167833"
                  >Comments</a
                ><span class="descendants">: 78</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37163742">
          <h3>
            <a
              class="item"
              href="https://mrcjkb.dev/posts/2023-08-17-lua-adts.html"
              >Algebraic data types in Lua (almost)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-17 @ 16:01:09</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37163742"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
