<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="37903172">
          <h3>
            <a
              class="item"
              href="https://twitter.com/modernistwitch/status/1713962311579234428"
              >"About half of Bandcamp was laid off today"</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 17:25:33</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37903172"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37903120">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/the-mathematician-who-shaped-string-theory-20231016/"
              >The Mathematician Who Sculpted the Shape of Space</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 17:22:21</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37903120"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37902815">
          <h3>
            <a
              class="item"
              href="https://jobs.ashbyhq.com/motion/4f5f6a29-3af0-4d79-99a4-988ff7c5ba05?utm_source=hn"
              >Motion (YC W20) is hiring staff front end engineers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 17:00:48</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37902412">
          <h3>
            <a
              class="item"
              href="https://www.fastcompany.com/90338379/i-wrote-the-book-on-user-friendly-design-what-i-see-today-horrifies-me"
              >I wrote the book on user-friendly design. What I see today
              horrifies me (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 16:37:00</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37902412"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37902350">
          <h3>
            <a
              class="item"
              href="https://randomwire.com/recreating-ghost-in-hong-kong/comment-page-1/"
              >Hong Kong Locations in Ghost in the Shell</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 16:33:45</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37902350"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37902190">
          <h3>
            <a
              class="item"
              href="https://blog.torproject.org/2023-fundraiser-make-a-donation-to-Tor/"
              >If you value Tor, please make a donation</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 16:25:28</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37902190"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37902148">
          <h3>
            <a
              class="item"
              href="https://www.bleepingcomputer.com/news/security/signal-says-there-is-no-evidence-rumored-zero-day-bug-is-real/"
              >Signal says there is no evidence rumored zero-day bug is real</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 16:23:15</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37902148"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37901930">
          <h3>
            <a
              class="item"
              href="https://www.cnbc.com/2023/10/15/australia-fines-x-formerly-twitter-for-not-answering-questions-on-child-abuse-content-.html"
              >Australia fines X for not answering questions on child abuse
              content</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 16:09:32</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37901930"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37901902">
          <h3>
            <a class="item" href="https://github.com/cpacker/MemGPT"
              >MemGPT – LLMs with self-editing memory for unbounded context</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 16:07:56</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37901902"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37901259">
          <h3>
            <a
              class="item"
              href="https://www.wired.com/story/babylon-health-warning-ai-unicorns/"
              >The Fall of Babylon is a warning to AI unicorns</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 15:32:37</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37901259"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37901120">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=37901120"
              >Launch HN: Radical (YC W23) – Autonomous high-altitude solar
              aircraft</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 15:23:57</span
              ><span class="points-container"
                >Points: <span class="points">116</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37901120"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
            <div class="text">
              <a href="https://youtu.be/E6oDxQYEksc"
                >https://youtu.be/E6oDxQYEksc</a
              >. Our website is at
              <a href="https://www.radicalaero.com/"
                >https://www.radicalaero.com/</a
              >, but it's pretty bare. If you use LinkedIn, we have a few more
              posts at
              <a href="https://www.linkedin.com/company/radicalaero"
                >https://www.linkedin.com/company/radicalaero</a
              >.
              <p>
                Our aircraft is designed to fly over specific areas for months,
                carrying various payloads for tasks like imagery, sensing, and
                telecommunications. What we’re building behaves like a drone in
                some ways, and like a satellite in other ways. Much like
                satellites, we’re able to provide service for long periods of
                time, but we’re also much closer to users (we fly at around 20
                km altitude) and able to maneuver or remain over an area of
                interest. This makes what we’re building really well suited to
                applications that require continuous coverage or
                high-resolution/bandwidth data.
              </p>
              <p>
                Examples of this include continuous real-time monitoring (such
                as in wildfire management or illegal fishing), high-resolution
                mapping and imagery (we’re able to collect sub-10 cm resolution
                imagery), and high-speed direct-to-device internet. The ability
                to permanently host sensors and devices in the sky in this way
                opens the door to lots of new opportunities. In truth, we still
                don’t know all the new applications that will arise from this
                (we’re really interested to hear your thoughts on potential
                applications!).
              </p>
              <p>
                As for the technical details: Our aircraft is battery electric
                and driven by propellers. It has a large wing for high
                aerodynamic efficiency and to generate the necessary lift
                required to fly in the thin air of the stratosphere. The wing is
                covered in solar cells, during the day, these power the aircraft
                and charge its batteries. Through the night, battery energy is
                deployed to continue flight. We repeat this process daily,
                enabling us to fly for up to a year without needing to land.
                Ultimately, battery cycle life is what limits our aircraft’s
                flight endurance - and we can land, carry out simple maintenance
                tasks and then re-launch to continue flying. Our aircraft has
                multiple tails which help to stabilize the ultra-lightweight
                structure (our 20 ft. prototype weighs just 13 lbs.). We also
                use these tails to control the aircraft, they provide roll
                control by twisting the main wing of the aircraft, increasing or
                decreasing lift as needed.
              </p>
              <p>
                The aircraft is fully autonomous; it has a full autopilot system
                onboard and various sensors for position, airspeed, and other
                key data streams (much like a typical drone or UAS). The
                aircraft flies at high altitudes of around 70,000 ft. (20 km)
                avoiding cloud cover, civil air traffic, and the turbulent winds
                of the troposphere.
              </p>
              <p>
                Long endurance flight has been the goal of many past projects.
                NASA’s Helios and the DARPA Vulture program tried to develop
                long endurance aircraft. Helios’s crash led to an overhaul of
                aircraft structural analysis codes, and DARPA Vulture led to
                advancements in battery and solar tech. More recently, both
                Facebook’s Aquila and Google’s Loon were discontinued. Recent
                advancements in battery and solar tech, and miniaturization of
                electronics mean long endurance flight is now feasible - but we
                are aware we need to do things differently to succeed. Unlike
                those before us, we’re not tying ourselves to a single
                application and are focused on bringing a cost-effective
                solution to market. That means avoiding research-grade
                components and moving quickly. Additionally, we firmly believe
                that iterating to a solution will allow us to continue making
                progress where others have stalled and lost momentum. We’ve seen
                this before in hard tech where companies like SpaceX and Helion
                Energy have made rapid progress against difficult problems.
              </p>
              <p>
                We approach our technology with an iterative design philosophy -
                we’ll keep building and learning as we go. We use-off-the-shelf
                components, iterate quickly, and design for easy assembly to
                keep costs low. For example, from clean sheet to flight, we
                designed, built, and flew our 20 ft. aircraft in less than two
                months. After our first flights, we prepared our 24-hour-capable
                prototype in two weeks, which successfully completed its
                non-stop 24-hour flight on first launch. Having proved our core
                technologies at a smaller scale, we’re now moving onto bigger
                things. Our next goal is to fly a full-scale 110 ft. wingspan
                aircraft in the stratosphere next year!
              </p>
              <p>
                Both of us have Masters degrees in Aerospace Engineering and we
                then spent 6 years working together on delivery drones at Amazon
                Prime Air. Whilst the application is very different - we’ve
                found our knowledge of drone and robotics hardware to be
                invaluable so far with Radical. By using readily available
                components, learning through iteration, and designing an
                aircraft that is easy to assemble, we can keep the cost of our
                aircraft low and address many markets that weren’t feasible
                before.
              </p>
              <p>
                We’re really excited about the technology we’re developing, it's
                a challenging physics problem that pushes the boundaries of what
                is possible. Super excited to share this with you and to hear
                your thoughts and comments!
              </p>
            </div>
          </section>
        </section>
        <section id="37901025">
          <h3>
            <a class="item" href="https://www.analogue.co/3d">Analogue 3D</a>
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 15:18:17</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37901025"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37900713">
          <h3>
            <a
              class="item"
              href="https://statmodeling.stat.columbia.edu/2023/10/16/a-successful-example-of-adversarial-collaboration-when-does-this-approach-work-and-when-does-it-not/"
              >A successful example of "adversarial collaboration"</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 14:57:12</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37900713"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37900651">
          <h3>
            <a
              class="item"
              href="https://www.theverge.com/2023/10/16/23919004/stack-overflow-layoff-ai-profitability"
              >Stack Overflow is laying off another 28%</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 14:53:10</span
              ><span class="points-container"
                >Points: <span class="points">151</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37900651"
                  >Comments</a
                ><span class="descendants">: 129</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37900131">
          <h3>
            <a
              class="item"
              href="https://www.lemonde.fr/en/science/article/2023/10/16/an-archaeological-dig-near-paris-unearthed-beginnings-of-urbanization-dating-back-to-4-200-b-c_6177642_10.html"
              >Dig near Paris unearths beginnings of urbanization dating back to
              4,200 BC</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 14:11:14</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37900131"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37899922">
          <h3>
            <a class="item" href="https://adventofcode.com/about#ai_leaderboard"
              >Advent of Code 2023's new AI/LLM Policy</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 13:53:49</span
              ><span class="points-container"
                >Points: <span class="points">127</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37899922"
                  >Comments</a
                ><span class="descendants">: 87</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37899319">
          <h3>
            <a class="item" href="https://www.openbsd.org/74.html"
              >OpenBSD 7.4</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 13:06:48</span
              ><span class="points-container"
                >Points: <span class="points">123</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37899319"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37899098">
          <h3>
            <a
              class="item"
              href="https://jvns.ca/blog/2016/06/13/should-you-be-scared-of-signals/"
              >Should you be scared of Unix signals?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 12:46:58</span
              ><span class="points-container"
                >Points: <span class="points">114</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37899098"
                  >Comments</a
                ><span class="descendants">: 85</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37898999">
          <h3>
            <a
              class="item"
              href="https://eli.thegreenplace.net/2023/better-http-server-routing-in-go-122/"
              >Better HTTP server routing in Go 1.22</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 12:38:14</span
              ><span class="points-container"
                >Points: <span class="points">226</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37898999"
                  >Comments</a
                ><span class="descendants">: 138</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37898544">
          <h3>
            <a class="item" href="https://en.wikipedia.org/wiki/Sensorvault"
              >Sensorvault</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 11:58:54</span
              ><span class="points-container"
                >Points: <span class="points">86</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37898544"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37898391">
          <h3>
            <a class="item" href="https://osgalleries.org/collectors/"
              >Oughtred Society Archive of Slide Rule Collections</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 11:45:35</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37898391"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37898223">
          <h3>
            <a
              class="item"
              href="https://socks-studio.com/2023/10/15/the-hidden-territory-usgss-1950s-to-1970s-isometric-geological-diagrams/"
              >Isometric Geological Diagrams</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 11:23:57</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37898223"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37898001">
          <h3>
            <a class="item" href="https://bloop.ai/blog/gpu_with_ggml"
              >GPU Embedding with GGML</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 10:53:41</span
              ><span class="points-container"
                >Points: <span class="points">100</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37898001"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37897958">
          <h3>
            <a class="item" href="https://apenwarr.ca/log/20190201"
              >Forget privacy: you're terrible at targeting anyway (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 10:48:01</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37897958"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37897155">
          <h3>
            <a class="item" href="https://www.bunniestudios.com/blog/?cat=28"
              >Can we build trustable hardware? (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 08:41:22</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37897155"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37897113">
          <h3>
            <a
              class="item"
              href="https://lukashermann.dev/writing/bootstrapping-a-saas-business-in-germany/"
              >Bootstrapping a SaaS Business in Germany: How I did it</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 08:34:03</span
              ><span class="points-container"
                >Points: <span class="points">101</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37897113"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37896157">
          <h3>
            <a
              class="item"
              href="https://urbigenous.net/library/how_to_build.html"
              >How to build a universe that doesn’t fall apart two days later
              (1978)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 05:17:49</span
              ><span class="points-container"
                >Points: <span class="points">207</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37896157"
                  >Comments</a
                ><span class="descendants">: 108</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37895601">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2310.09199"
              >PaLI-3 Vision Language Models</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 03:20:55</span
              ><span class="points-container"
                >Points: <span class="points">155</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37895601"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37895446">
          <h3>
            <a class="item" href="https://cockpit-project.org/"
              >Cockpit: Web-based graphical interface for servers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-16 @ 02:48:21</span
              ><span class="points-container"
                >Points: <span class="points">382</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37895446"
                  >Comments</a
                ><span class="descendants">: 159</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37886049">
          <h3>
            <a
              class="item"
              href="https://garrit.xyz/posts/2023-10-13-organizing-multiple-git-identities"
              >Organizing multiple Git identities</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-15 @ 01:43:24</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37886049"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
