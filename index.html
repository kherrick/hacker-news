<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="40055942">
          <h3>
            <a class="item" href="https://github.com/huangyz0918/termax"
              >Show HN: A shell CLI tool to predict your next command enhanced
              by LLM and RAG</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-16 @ 19:05:09</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40055942"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
            <div class="text">
              <p>
                We would like to encourage you to install Termax and start
                powering up your command line coding. Your feedback and
                contributions are invaluable to us. Join our community of
                developers to make Termax even better!
              </p>
            </div>
          </section>
        </section>
        <section id="40055598">
          <h3>
            <a
              class="item"
              href="https://www.bbc.com/future/article/20240412-the-secret-scandinavian-a-bomb-project"
              >Why Sweden abandoned its secret A-bomb project</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-16 @ 18:36:27</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40055598"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40055239">
          <h3>
            <a
              class="item"
              href="https://www.wallpaper.com/design-interiors/david-lynch-salone-del-mobile-2024"
              >David Lynch presents 'A Thinking Room'</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-16 @ 18:06:20</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40055239"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40055120">
          <h3>
            <a
              class="item"
              href="https://www.noemamag.com/we-need-to-rewild-the-internet/"
              >We Need to Rewild the Internet</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-16 @ 17:57:31</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40055120"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40054901">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2404.08801"
              >Megalodon: Efficient LLM Pretraining and Inference with Unlimited
              Context Length</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-16 @ 17:40:47</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40054901"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40054580">
          <h3>
            <a class="item" href="https://www.spice-space.org/usbredir.html"
              >usbredir: A protocol for sending USB device traffic over a
              network connection</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-16 @ 17:13:59</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40054580"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40054425">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/apriora/jobs/IoC1DU7-full-stack-software-engineer"
              >Apriora (YC W24) is hiring a founding full-stack engineer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-16 @ 17:00:18</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40054190">
          <h3>
            <a
              class="item"
              href="https://www.statecraft.pub/p/how-to-stop-losing-17500-kidneys"
              >How to stop losing 17,500 kidneys</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-16 @ 16:42:08</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40054190"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40054019">
          <h3>
            <a
              class="item"
              href="https://twitter.com/tonyzzhao/status/1780263497584230432"
              >Google DeepMind's Aloha Unleashed is pushing the boundaries of
              robot dexterity</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-16 @ 16:28:16</span
              ><span class="points-container"
                >Points: <span class="points">110</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40054019"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40053774">
          <h3>
            <a class="item" href="https://pudding.cool/2024/03/teenagers/"
              >This is a teenager</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-16 @ 16:07:59</span
              ><span class="points-container"
                >Points: <span class="points">481</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40053774"
                  >Comments</a
                ><span class="descendants">: 198</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40053576">
          <h3>
            <a
              class="item"
              href="https://www.washingtonpost.com/dc-md-va/2024/04/16/amazon-hq2-jobs-arlington-virginia/"
              >Amazon HQ2 was supposed to add jobs last year. It shed them
              instead</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-16 @ 15:49:06</span
              ><span class="points-container"
                >Points: <span class="points">90</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40053576"
                  >Comments</a
                ><span class="descendants">: 87</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40053257">
          <h3>
            <a class="item" href="https://www.termtyper.com/"
              >Show HN: Term Typer – Learn a Language by Typing</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-16 @ 15:27:26</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40053257"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
            <div class="text">
              Hey HN! I'm from Brazil and I created Term Typer to help my little
              brother learn other languages while practicing his keyboard typing
              skills. We've found it super helpful and fun. Feel free to try it
              out and let me know your thoughts and feedback. Thanks a lot!
            </div>
          </section>
        </section>
        <section id="40052824">
          <h3>
            <a
              class="item"
              href="https://emoncms.org/app/view?name=MyBoilerIdealLogicH24OpenthermSAT&amp;readkey=1d29c637a4817acdf6e6e271850c9026"
              >Efficient gas boiler with real-time data</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-16 @ 14:58:55</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40052824"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
            <div class="text">
              <p>
                Many gas boilers are oversized which means it's more difficult
                to run them efficiently. Also, many gas boilers have capability
                to run more efficiently but are not configured to.
              </p>
              <p>
                This particular boiler does not seem to respect the MM=0 command
                (despite OpenTherm's such specification requirement) which is
                not uncommon. SAT sends the MM=0 command for the boiler to work
                at its minimum capacity. CS= minimum_setpoint and then PWM
                controls the ON/OFF times of the boiler. However, I have a
                workaround which ensures that most of the time, the boiler is
                indeed working at its minimum modulation, unless the target flow
                (heating curve + PID) demand is high [higher than current flow
                temperature] during warm up.
              </p>
              <p>
                The boiler supplies heat to the central heating and domestic hot
                water tank, but not at the same time. The hot water tank
                capacity is 255 litres. When DHW call is made, boiler ignores
                OpenTherm instructions and runs at 80 C degrees. There are three
                zone valves in the house: Hot Water, Upstairs and Downstairs
                (not talking about TRVs here). When DHW call is made, Hot Water
                valve opens, and Upstairs &amp; Downstairs close; then if CH
                call is made, Hot Water valve closes and the other two open.
              </p>
              <p>
                The hot water system is also fitted with "Waste Water Heat
                Recovery System". In essence, the heat energy extracted from
                showers and baths is used to preheat cold water that is then
                sent to the hot water tank. The extraction recovers about 60% of
                heat normally lost. You can watch examples of how it works here
                -
                <a href="https://www.youtube.com/watch?v=G-jKlCoRvEM"
                  >https://www.youtube.com/watch?v=G-jKlCoRvEM</a
                >
              </p>
              <p>
                SAT project - the brain behind the efficiency
                <a href="https://github.com/Alexwijn/SAT"
                  >https://github.com/Alexwijn/SAT</a
                >
              </p>
              <p>
                OpenEnergyMonitor - for making possible to share real time
                boiler data
                <a
                  href="https://community.openenergymonitor.org/t/my-gas-boiler-data-is-live/25733"
                  >https://community.openenergymonitor.org/t/my-gas-boiler-data...</a
                >
              </p>
              <p>Any questions, let me know :)</p>
            </div>
          </section>
        </section>
        <section id="40052729">
          <h3>
            <a
              class="item"
              href="https://www.osohq.com/post/distributed-authorization"
              >Distributed Authorization</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-16 @ 14:51:48</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40052729"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40052611">
          <h3>
            <a
              class="item"
              href="https://www.benthamsgaze.org/wp-content/uploads/2022/06/briefing-presumption-that-computers-are-reliable.pdf"
              >The legal rule that computers are presumed to be operating
              correctly (2022) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-16 @ 14:43:48</span
              ><span class="points-container"
                >Points: <span class="points">86</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40052611"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40051975">
          <h3>
            <a
              class="item"
              href="https://blog.mdturp.ch/posts/2024-04-05-visual_guide_to_vision_transformer.html"
              >A Visual Guide to Vision Transformers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-16 @ 14:00:58</span
              ><span class="points-container"
                >Points: <span class="points">149</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40051975"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40051818">
          <h3>
            <a class="item" href="https://pmf.firstround.com/levels"
              >A framework to help B2B founders find product-market fit</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-16 @ 13:48:55</span
              ><span class="points-container"
                >Points: <span class="points">149</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40051818"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40051698">
          <h3>
            <a
              class="item"
              href="https://www.tomshardware.com/pc-components/cpus/amd-unveils-ryzen-pro-8040-hawk-point-and-8000-series-phoenix-processors-ai-engines-come-to-the-commercial-market"
              >AMD unveils Ryzen Pro 8000-series processors</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-16 @ 13:38:07</span
              ><span class="points-container"
                >Points: <span class="points">134</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40051698"
                  >Comments</a
                ><span class="descendants">: 106</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40051524">
          <h3>
            <a class="item" href="https://www.searchhacker.news"
              >Show HN: Search HN for interesting comment sections</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-16 @ 13:19:18</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40051524"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40051191">
          <h3>
            <a
              class="item"
              href="https://aliramadhan.me/2024/03/31/trillion-rows.html"
              >Loading a trillion rows of weather data into TimescaleDB</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-16 @ 12:39:07</span
              ><span class="points-container"
                >Points: <span class="points">243</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40051191"
                  >Comments</a
                ><span class="descendants">: 101</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40050717">
          <h3>
            <a
              class="item"
              href="https://blog.abctaylor.com/what-would-happen-to-low-latency-trading-if-exchanges-moved-to-the-cloud/"
              >Thoughts on low latency trading if exchanges went full cloud</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-16 @ 11:28:12</span
              ><span class="points-container"
                >Points: <span class="points">163</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40050717"
                  >Comments</a
                ><span class="descendants">: 145</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40049623">
          <h3>
            <a class="item" href="https://github.com/SilinMeng0510/imgcatr"
              >Show HN: a Rust based CLI tool 'imgcatr' for displaying images</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-16 @ 08:30:46</span
              ><span class="points-container"
                >Points: <span class="points">102</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40049623"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
            <div class="text">cat for images, by RUST</div>
          </section>
        </section>
        <section id="40049400">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/science/2024/apr/16/astronomers-discover-milky-way-biggest-stellar-black-hole-bh3-33-times-size-of-sun"
              >Astronomers discover Milky Way’s biggest stellar black hole</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-16 @ 07:50:36</span
              ><span class="points-container"
                >Points: <span class="points">87</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40049400"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40048177">
          <h3>
            <a class="item" href="https://github.com/kevinbentley/Descent3"
              >Descent 3 Source Code</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-16 @ 03:49:06</span
              ><span class="points-container"
                >Points: <span class="points">1031</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40048177"
                  >Comments</a
                ><span class="descendants">: 273</span></span
              >
            </h4>
            <div class="text">
              Someone recently asked if the source code from Descent 3 will be
              released. I reached out to my old boss (Matt Toschlog) at Outrage
              Entertainment and he gave me the go ahead. I'm going to work on
              getting this running again and I'm looking for some
              co-maintainers.
            </div>
          </section>
        </section>
        <section id="40047806">
          <h3>
            <a
              class="item"
              href="https://maphappenings.com/2024/04/11/story-of-etak/"
              >A curious phenomenon called 'Etak'</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-16 @ 02:27:23</span
              ><span class="points-container"
                >Points: <span class="points">629</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40047806"
                  >Comments</a
                ><span class="descendants">: 157</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40047212">
          <h3>
            <a class="item" href="https://github.com/honojs/hono"
              >HonoJS: Small, simple, and ultrafast web framework for the
              Edges</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-16 @ 00:41:33</span
              ><span class="points-container"
                >Points: <span class="points">258</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40047212"
                  >Comments</a
                ><span class="descendants">: 66</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40047041">
          <h3>
            <a class="item" href="https://github.com/johang/btfs"
              >BTFS: BitTorrent Filesystem</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-16 @ 00:08:46</span
              ><span class="points-container"
                >Points: <span class="points">337</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40047041"
                  >Comments</a
                ><span class="descendants">: 99</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40044665">
          <h3>
            <a
              class="item"
              href="https://www.chiark.greenend.org.uk/~sgtatham/putty/wishlist/vuln-p521-bias.html"
              >PuTTY vulnerability vuln-p521-bias</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-15 @ 19:24:52</span
              ><span class="points-container"
                >Points: <span class="points">514</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40044665"
                  >Comments</a
                ><span class="descendants">: 198</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40041198">
          <h3>
            <a
              class="item"
              href="https://axleos.com/building-a-gps-receiver-part-1-hearing-whispers/"
              >Show HN: Building a GPS receiver</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-15 @ 14:42:10</span
              ><span class="points-container"
                >Points: <span class="points">499</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40041198"
                  >Comments</a
                ><span class="descendants">: 121</span></span
              >
            </h4>
            <div class="text">
              <p>
                Shortly after publishing my iOS 4 jailbreak last October[1], I
                got to work on my next hobby project: a from-scratch homebrew
                GPS receiver, which can solve the user’s location solely from
                billions of radio antenna samples.
              </p>
              <p>
                I took a commodity SDR (alongside the Python standard library
                and numpy) and built a signal processing pipeline that can
                detect and track GPS satellites over many minutes, drop and pick
                up satellites as they come in and out of view, and precisely
                determine the user’s position and clock inaccuracy.
              </p>
              <p>
                All told, gypsum can go from a cold start to a fix on the user’s
                position, and the precise time, in less than a minute of
                listening to the antenna. I went on a journey of learning how to
                detect and track satellite signals that are literally too quiet
                to hear, and I hope that some of the magic comes through in the
                posts!
              </p>
              <p>
                After implementing this myself and walking the long road of
                getting it working, I’m left completely stunned by the
                brilliance of GPS, across so many axes. I hope you enjoy the
                read!
              </p>
              <p>
                On a more personal note, I’ll be starting a new job next week
                which isn’t as amenable to publishing side projects, and
                therefore this will be my last publicly-published project for
                some time. I’ve had great experiences making and sharing
                projects on here, and I’m really grateful for the positive
                feedback that’s been shared!
              </p>
              <p>
                [1]:
                <a href="https://news.ycombinator.com/item?id=37736318"
                  >https://news.ycombinator.com/item?id=37736318</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="40037589">
          <h3>
            <a
              class="item"
              href="https://amu.hal.science/hal-04167028/file/tcs2023-1.pdf"
              >Trap spaces of Boolean networks are conflict-free siphons of
              their Petri net [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-15 @ 06:30:50</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40037589"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
