<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="39316234">
          <h3>
            <a
              class="item"
              href="https://www.tomshardware.com/tech-industry/cryptomining/just-137-crypto-miners-use-23-of-total-us-power-government-now-requiring-commercial-miners-to-report-energy-consumption"
              >Just 137 crypto miners use 2.3% of total U.S. power</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-09 @ 16:08:21</span
              ><span class="points-container"
                >Points: <span class="points">81</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39316234"
                  >Comments</a
                ><span class="descendants">: 77</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39316193">
          <h3>
            <a class="item" href="https://ctan.org/pkg/coffeestains"
              >Add coffee stains to LaTeX documents</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-09 @ 16:05:00</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39316193"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39315986">
          <h3>
            <a class="item" href="https://www.goody2.ai/chat"
              >Goody-2, the world's most responsible AI model</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-09 @ 15:48:29</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39315986"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39315880">
          <h3>
            <a
              class="item"
              href="https://fedoramagazine.org/introducing-fedora-atomic-desktops/"
              >Fedora Atomic Desktops</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-09 @ 15:40:30</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39315880"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39315786">
          <h3>
            <a
              class="item"
              href="https://www.reuters.com/technology/openais-altman-talks-raise-funds-chips-ai-initiative-wsj-2024-02-09/"
              >Sam Altman seeks to raise up to $7T for new chip project</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-09 @ 15:32:52</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39315786"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39315378">
          <h3>
            <a
              class="item"
              href="https://astrobiology.com/2024/02/what-turned-earth-into-a-giant-snowball-700m-years-ago.html"
              >What Turned Earth into a Giant Snowball 700M Years Ago?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-09 @ 14:54:16</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39315378"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39315367">
          <h3>
            <a
              class="item"
              href="https://apnews.com/article/climate-change-defamation-michael-mann-penn-state-61289ee2d8d2143768d28995c83899ef"
              >Jury awards climate scientist Michael Mann $1M in defamation
              lawsuit</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-09 @ 14:53:06</span
              ><span class="points-container"
                >Points: <span class="points">74</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39315367"
                  >Comments</a
                ><span class="descendants">: 57</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39314189">
          <h3>
            <a
              class="item"
              href="https://www.cnn.com/2024/02/09/tech/china-huawei-france-financial-investigation-intl-hnk/index.html"
              >Huawei's offices in France raided by financial prosecutors</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-09 @ 12:41:05</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39314189"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39313928">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/circle-medical/jobs/2RM7yFC-senior-backend-engineer"
              >Circle Medical (YC S15) Is Hiring Ruby Engineers in Montreal</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-09 @ 12:01:09</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39313891">
          <h3>
            <a
              class="item"
              href="https://github.com/honojs/hono/releases/tag/v4.0.0"
              >Hono v4.0.0</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-09 @ 11:55:10</span
              ><span class="points-container"
                >Points: <span class="points">113</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39313891"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39313696">
          <h3>
            <a
              class="item"
              href="https://www.gregegan.net/PERMUTATION/Permutation.html"
              >Permutation City (1994)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-09 @ 11:18:07</span
              ><span class="points-container"
                >Points: <span class="points">215</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39313696"
                  >Comments</a
                ><span class="descendants">: 115</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39313339">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=AF8d72mA41M"
              >It was almost impossible to make the blue LED [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-09 @ 10:14:54</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39313339"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39311507">
          <h3>
            <a class="item" href="https://rachelbythebay.com/w/2024/02/08/ldap/"
              >Figure out who's leaving the company: dump, diff, repeat</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-09 @ 04:46:02</span
              ><span class="points-container"
                >Points: <span class="points">494</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39311507"
                  >Comments</a
                ><span class="descendants">: 324</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39310837">
          <h3>
            <a
              class="item"
              href="https://www.citusdata.com/blog/2024/02/08/whats-new-in-postgres-16-query-planner-optimizer/"
              >What's new in the Postgres 16 query planner</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-09 @ 02:52:10</span
              ><span class="points-container"
                >Points: <span class="points">224</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39310837"
                  >Comments</a
                ><span class="descendants">: 117</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39309083">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2024/02/08/science/walter-shawlee-dead.html"
              >Walter Shawlee, the sovereign of slide rules, has died</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-08 @ 23:11:50</span
              ><span class="points-container"
                >Points: <span class="points">128</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39309083"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39307677">
          <h3>
            <a class="item" href="https://en.wikipedia.org/wiki/Doorway_effect"
              >Doorway effect</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-08 @ 21:04:59</span
              ><span class="points-container"
                >Points: <span class="points">273</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39307677"
                  >Comments</a
                ><span class="descendants">: 117</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39305994">
          <h3>
            <a
              class="item"
              href="https://aras-p.info/blog/2024/02/06/I-accidentally-Blender-VSE/"
              >I accidentally Blender VSE</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-08 @ 18:57:04</span
              ><span class="points-container"
                >Points: <span class="points">472</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39305994"
                  >Comments</a
                ><span class="descendants">: 84</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39305452">
          <h3>
            <a
              class="item"
              href="https://devblogs.microsoft.com/commandline/introducing-sudo-for-windows/"
              >Sudo for Windows</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-08 @ 18:16:05</span
              ><span class="points-container"
                >Points: <span class="points">506</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39305452"
                  >Comments</a
                ><span class="descendants">: 378</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39302870">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=39302870"
              >Launch HN: AgentHub (YC W24) – A no-code automation platform</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-08 @ 15:17:05</span
              ><span class="points-container"
                >Points: <span class="points">133</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39302870"
                  >Comments</a
                ><span class="descendants">: 77</span></span
              >
            </h4>
            <div class="text">
              <p>
                We’re Rahul and Max, co-founders of AgentHub.dev (<a
                  href="https://www.agenthub.dev/"
                  >https://www.agenthub.dev/</a
                >). We automate repetitive workflows for businesses using
                LLM-powered automations. Our platform lets you build and host
                these automations to emulate employee workflows in a scalable
                way. Here’s a demo video:
                <a href="https://www.youtube.com/watch?v=BD9aoyKPOjs"
                  >https://www.youtube.com/watch?v=BD9aoyKPOjs</a
                >
              </p>
              <p>
                We started 9 months ago while lurking in the Auto-GPT discord
                and seeing thousands of non-technical users struggle to clone
                the repo or set up their environments. We were excited by the
                concepts of Agents so we built and deployed a (very ugly) web
                app within a few days so anyone could experiment. We started to
                see people literally begging the Agents to complete simple tasks
                and giving up due to cost/frustration. Seeing the type of
                relatively simple work people were trying to automate with AI
                was the catalyst for what we ended up building.
              </p>
              <p>
                We decided to make a drag-and-drop automation builder so these
                users could piece together their ideal automations instead of
                begging the agent to do that same task and failing. V1 was a
                borderline un-usable series of drop down menus but evolved into
                the canvas based workflow builder it is now.
              </p>
              <p>
                It’s somewhat similar in concept to Zapier or Make.com except
                we’re aiming to automate much more complex work end to end
                instead of just speeding up simple tasks. We originally
                described it as Zapier on crack but as it's gotten more complex,
                some people compare it to existing RPA platforms like UI Path.
                We like to call it an 'LLM-based Intelligent Automation
                Platform'.
              </p>
              <p>
                Our biggest challenge from the very beginning has been balancing
                usability and complexity. We wanted anyone to be able to
                understand it while still being powerful enough for people to
                get creative. Building the framework has been an extremely
                iterative process of users getting confused (for good reason)
                and us tweaking our approach. We still have a ways to go in
                terms of usability but are proud of where it’s at. Eager to hear
                your feedback!
              </p>
              <p>
                Here are 3 template automations we built to give people a
                starting point. I think the real beauty of the platform is how
                personalized the automations users create are but these general
                templates give a nice idea of how it works.
              </p>
              <p>
                <a
                  href="https://www.agenthub.dev/templates/hr_hiring/linkedin_profile_processor"
                  >https://www.agenthub.dev/templates/hr_hiring/linkedin_profil...</a
                >
                <a
                  href="https://www.agenthub.dev/templates/media_news/autonomous_twitter_bot"
                  >https://www.agenthub.dev/templates/media_news/autonomous_twi...</a
                >
                <a
                  href="https://www.agenthub.dev/templates/sales_crm/automated_sales_emails"
                  >https://www.agenthub.dev/templates/sales_crm/automated_sales...</a
                >
              </p>
              <p>
                These templates are on the simpler side. Our power users nest
                automations, trigger them via webhook and have them running at a
                pretty surprising scale. The highest we’ve seen was last Friday
                with a single user running 5k automations within a few hours.
                The unofficial record before that for most automations runs was
                one of our users who discovered infinite-recursion by accident,
                but that doesn't count.
              </p>
              <p>
                We have two main types of users at the moment, people automating
                their existing businesses work and people using the no-code
                builder to build new ideas. The first was our original
                intention, letting any semi technical person in a company spot
                inefficiency and quickly get a solution deployed to address it.
                The second and more unexpected type of user has been
                non-technical founders spotting problems and being able to build
                APIs to serve niches they’ve found without needing to code.
              </p>
              <p>
                It’s called AgentHub because I bought the domain for 10 dollars
                on day 2 of building when I thought we’d be a hub to host and
                share agents and never bothered rebranding. If anyone wants to
                take a crack at a better name, we’d be interested!(I speak kind
                of quickly and people think I’m saying ‘asian-hub’ pretty often…
              </p>
              <p>
                We’re really excited to share the platform with you all and look
                forward to your feedback!
              </p>
            </div>
          </section>
        </section>
        <section id="39301495">
          <h3>
            <a
              class="item"
              href="https://blog.google/products/gemini/bard-gemini-advanced-app/"
              >Bard is now Gemini, and we’re rolling out a mobile app and Gemini
              Advanced</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-08 @ 13:07:37</span
              ><span class="points-container"
                >Points: <span class="points">600</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39301495"
                  >Comments</a
                ><span class="descendants">: 1025</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39300985">
          <h3>
            <a
              class="item"
              href="https://idlewords.com/2008/04/controlled_tango_into_terrain.htm"
              >Controlled Tango into Terrain (2008)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-08 @ 12:05:35</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39300985"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39300859">
          <h3>
            <a
              class="item"
              href="https://craftinginterpreters.com/compiling-expressions.html"
              >Compiling Expressions</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-08 @ 11:49:20</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39300859"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39300629">
          <h3>
            <a
              class="item"
              href="https://en.wikipedia.org/wiki/Cyclomatic_complexity"
              >Cyclomatic Complexity</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-08 @ 11:11:21</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39300629"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39300573">
          <h3>
            <a
              class="item"
              href="https://engineeringatscale.substack.com/p/how-quic-is-displacing-tcp-for-speed"
              >How QUIC is displacing TCP for speed</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-08 @ 11:02:18</span
              ><span class="points-container"
                >Points: <span class="points">94</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39300573"
                  >Comments</a
                ><span class="descendants">: 90</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39299794">
          <h3>
            <a
              class="item"
              href="https://hegdenu.net/posts/debugging-tokio-instrumentation/"
              >Debugging Tokio Instrumentation</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-08 @ 08:51:51</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39299794"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39299715">
          <h3>
            <a
              class="item"
              href="https://zenhorace.dev/blog/context-control-go/"
              >Context Control in Go</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-08 @ 08:40:58</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39299715"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39299482">
          <h3>
            <a
              class="item"
              href="https://blog.fponzi.me/2024-02-02-lamport-clocks.html"
              >Lamport Clocks</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-08 @ 08:01:00</span
              ><span class="points-container"
                >Points: <span class="points">95</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39299482"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39299455">
          <h3>
            <a class="item" href="https://colourclash.co.uk/spectrum-analyser/"
              >Spectrum Analyser, a Sinclair ZX Spectrum reverse engineering
              tool</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-08 @ 07:55:58</span
              ><span class="points-container"
                >Points: <span class="points">107</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39299455"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39299419">
          <h3>
            <a
              class="item"
              href="https://support.nooelec.com/hc/en-us/articles/10407982882327-Receiving-Weather-Satellite-Images-Using-SatDump"
              >Receiving Weather Satellite Images Using SatDump</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-08 @ 07:50:19</span
              ><span class="points-container"
                >Points: <span class="points">124</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39299419"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39297185">
          <h3>
            <a
              class="item"
              href="https://scanalyst.fourmilab.ch/t/john-walker-1949-2024/4305"
              >John Walker, founder of Autodesk, has died</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-08 @ 02:33:50</span
              ><span class="points-container"
                >Points: <span class="points">1014</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39297185"
                  >Comments</a
                ><span class="descendants">: 204</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
