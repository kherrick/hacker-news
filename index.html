<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="37861927">
          <h3>
            <a
              class="item"
              href="https://mastodon.social/@gvwilson/111223262876771219"
              >It appears that Dropbox is sharing all content ouside the EU with
              OpenAI</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 19:28:24</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37861927"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37861589">
          <h3>
            <a
              class="item"
              href="https://www.nginx.com/blog/http-2-rapid-reset-attack-impacting-f5-nginx-products/"
              >HTTP/2 rapid reset attack impacting Nginx products</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 19:04:50</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37861589"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37861508">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2023-10-scientists-biological-secrets-aging.html"
              >Scientists unlock biological secrets of the aging process</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 19:00:01</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37861508"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37861467">
          <h3>
            <a
              class="item"
              href="https://old.reddit.com/r/kde/comments/175upzi/has_play_protect_removed_kde_connect_from_your/"
              >Has Play Protect removed KDE Connect from your phone? Let us
              know</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 18:57:35</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37861467"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37860819">
          <h3>
            <a
              class="item"
              href="https://generatingconversation.substack.com/p/openai-is-too-cheap-to-beat"
              >OpenAI is too cheap to beat</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 18:16:09</span
              ><span class="points-container"
                >Points: <span class="points">136</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37860819"
                  >Comments</a
                ><span class="descendants">: 122</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37860702">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/tech-policy/2023/10/t-mobile-switches-users-to-pricier-plans-and-tells-them-its-not-a-price-hike/"
              >T-Mobile switches users to pricier plans</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 18:06:22</span
              ><span class="points-container"
                >Points: <span class="points">103</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37860702"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37860496">
          <h3>
            <a
              class="item"
              href="https://blog.quarkslab.com/qbindiff-a-modular-diffing-toolkit.html"
              >QBinDiff: A Modular Diffing Toolkit</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 17:52:46</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37860496"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37860172">
          <h3>
            <a class="item" href="https://clippings.june07.com"
              >Show HN: I got tired of reading "This posting has been deleted by
              its author"</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 17:27:51</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37860172"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37860010">
          <h3>
            <a
              class="item"
              href="https://www.nasa.gov/news-release/nasas-bennu-asteroid-sample-contains-carbon-water/"
              >NASA's Bennu Asteroid Sample</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 17:13:42</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37860010"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37860004">
          <h3>
            <a
              class="item"
              href="https://www.mandiant.com/resources/blog/gru-disruptive-playbook"
              >The GRU's Disruptive Playbook</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 17:13:07</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37860004"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37859905">
          <h3>
            <a
              class="item"
              href="https://www.vox.com/2015/1/15/7551873/jaywalking-history"
              >Automakers invented the crime of jaywalking (2015)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 17:05:03</span
              ><span class="points-container"
                >Points: <span class="points">148</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37859905"
                  >Comments</a
                ><span class="descendants">: 117</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37859655">
          <h3>
            <a
              class="item"
              href="https://english.kyodonews.net/news/2023/10/5e4f364913d7-toshiba-to-delist-in-japan-on-dec-20-after-74-years-of-history.html"
              >Toshiba to delist from Japanese stock exchange in December</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 16:48:30</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37859655"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37859437">
          <h3>
            <a class="item" href="https://dynomight.substack.com/p/midwit-home"
              >The midwit home</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 16:31:17</span
              ><span class="points-container"
                >Points: <span class="points">183</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37859437"
                  >Comments</a
                ><span class="descendants">: 162</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37859402">
          <h3>
            <a
              class="item"
              href="https://berthub.eu/articles/posts/client-side-scanning-dutch-parliament/"
              >EU "Chat Control" and Mandatory Client Side Scanning</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 16:28:34</span
              ><span class="points-container"
                >Points: <span class="points">187</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37859402"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37859311">
          <h3>
            <a class="item" href="https://jesseduffield.com/Can%27t-Be-Fcked/"
              >Can't be fucked: Underrated cause of tech debt</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 16:21:10</span
              ><span class="points-container"
                >Points: <span class="points">211</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37859311"
                  >Comments</a
                ><span class="descendants">: 195</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37859085">
          <h3>
            <a class="item" href="https://www.desmos.com/3d"
              >Desmos 3D graphing calculator</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 16:05:23</span
              ><span class="points-container"
                >Points: <span class="points">139</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37859085"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37858812">
          <h3>
            <a
              class="item"
              href="https://apps.apple.com/us/app/kali-ai-calendar-scheduler/id6460134539"
              >Show HN: Kali – Scheduling Assistant for iOS</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 15:46:14</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37858812"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
            <div class="text">
              <p>
                I hate scheduling and my gf got sick of managing my calendar for
                me, so I made an AI do it instead. :)
              </p>
              <p>Please let me know what you think!</p>
            </div>
          </section>
        </section>
        <section id="37858766">
          <h3>
            <a
              class="item"
              href="https://gizmodo.com/bionic-mia-hand-prosthetic-amputee-phantom-pain-1850919751"
              >Woman's Experimental Bionic Hand Passes Major Test with Flying
              Colors</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 15:42:50</span
              ><span class="points-container"
                >Points: <span class="points">89</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37858766"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37857991">
          <h3>
            <a
              class="item"
              href="https://blog.withedge.com/p/when-xml-in-word-became-illegal"
              >When XML in Word Became Illegal</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 14:49:31</span
              ><span class="points-container"
                >Points: <span class="points">87</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37857991"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37857765">
          <h3>
            <a class="item" href="https://www.diceright.com/"
              >Show HN: I built a virtual tabletop for playing Dungeons and
              Dragons</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 14:35:56</span
              ><span class="points-container"
                >Points: <span class="points">189</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37857765"
                  >Comments</a
                ><span class="descendants">: 60</span></span
              >
            </h4>
            <div class="text">
              <a href="https://tinyurl.com/diceright"
                >https://tinyurl.com/diceright</a
              >. And there’s a list of the main features right on the homepage.
              <p>
                It’s a Ruby on Rails site that makes heavy use of action cable
                for keeping the maps and tokens in sync for all players. On the
                front end, I’m using HTML canvas for the maps and a js library
                called fabric.js for interacting with the canvas. Otherwise,
                just jQuery on the front end. I optimized it all to work on
                mobile too.
              </p>
              <p>
                I built this as a side project for fun over of the past couple
                years. It took a lot longer than expected, but it was also a lot
                of fun. I did all the design / UX for it too which was a
                struggle at first but was a great learning experience.
              </p>
              <p>
                Let me know what you think and if you have any questions.
                Thanks!
              </p>
            </div>
          </section>
        </section>
        <section id="37857544">
          <h3>
            <a class="item" href="https://12factor.net/"
              >The Twelve-Factor App (2011)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 14:19:46</span
              ><span class="points-container"
                >Points: <span class="points">304</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37857544"
                  >Comments</a
                ><span class="descendants">: 179</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37857521">
          <h3>
            <a
              class="item"
              href="https://www.interconnects.ai/p/ai-research-job-market"
              >The AI research job market shit show (and my experience)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 14:18:07</span
              ><span class="points-container"
                >Points: <span class="points">139</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37857521"
                  >Comments</a
                ><span class="descendants">: 130</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37857417">
          <h3>
            <a class="item" href="https://scrollprize.org/firstletters"
              >First word discovered in unopened Herculaneum scroll by 21yo CS
              student</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 14:11:18</span
              ><span class="points-container"
                >Points: <span class="points">218</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37857417"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37856895">
          <h3>
            <a
              class="item"
              href="https://www.reuters.com/markets/deals/atlassian-agrees-buy-video-messaging-provider-loom-nearly-1-bln-2023-10-12/"
              >Atlassian to buy Loom for nearly $1B</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 13:33:58</span
              ><span class="points-container"
                >Points: <span class="points">220</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37856895"
                  >Comments</a
                ><span class="descendants">: 166</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37855719">
          <h3>
            <a
              class="item"
              href="https://www.rit.edu/vignellicenter/product-timecapsule/nasa-capillary-cup"
              >NASA: Capillary Cup</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 11:18:50</span
              ><span class="points-container"
                >Points: <span class="points">133</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37855719"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37855057">
          <h3>
            <a
              class="item"
              href="https://www.tokyoweekender.com/art_and_culture/entertainment-art_and_culture/47-anime-locations-47-prefectures-japan/"
              >47 Anime for 47 Prefectures in Japan</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 09:26:50</span
              ><span class="points-container"
                >Points: <span class="points">192</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37855057"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37854846">
          <h3>
            <a class="item" href="https://openintro-ims2.netlify.app/"
              >Introduction to Modern Statistics</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 08:45:10</span
              ><span class="points-container"
                >Points: <span class="points">504</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37854846"
                  >Comments</a
                ><span class="descendants">: 97</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37854844">
          <h3>
            <a class="item" href="https://nostalgist.js.org/"
              >Show HN: Nostalgist.js – Run emulators of retro consoles, within
              web browsers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 08:44:16</span
              ><span class="points-container"
                >Points: <span class="points">106</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37854844"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37854358">
          <h3>
            <a
              class="item"
              href="https://www.cambridge.org/core/journals/utilitas/article/benthams-mugging/9C67002F344B20661A6C35C960F25A86"
              >Bentham's Mugging (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 07:16:46</span
              ><span class="points-container"
                >Points: <span class="points">105</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37854358"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37854269">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/handle-com/jobs/lgchJ3v-abm-campaigns-manager"
              >Handle.com (YC W19) Is Hiring (ABM Manager)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-10-12 @ 07:00:55</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
