<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="43474593">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2025/03/25/us/maverick-county-texas-court-system.html"
              >In Jail Without a Lawyer: How a Texas Town Fails Poor
              Defendants</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-25 @ 18:59:22</span
              ><span class="points-container"
                >Points: <span class="points">88</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43474593"
                  >Comments</a
                ><span class="descendants">: 60</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43474505">
          <h3>
            <a
              class="item"
              href="https://refactoringenglish.com/tools/hn-popularity/"
              >The highest-ranking personal blogs of Hacker News</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-25 @ 18:48:57</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43474505"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43474250">
          <h3>
            <a
              class="item"
              href="https://www.centauri-dreams.org/2025/03/25/the-ethics-of-spreading-life-in-the-cosmos/"
              >The Ethics of Spreading Life in the Cosmos</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-25 @ 18:21:30</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43474250"
                  >Comments</a
                ><span class="descendants">: 57</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43474112">
          <h3>
            <a
              class="item"
              href="https://openai.com/index/introducing-4o-image-generation/"
              >4o Image Generation</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-25 @ 18:06:02</span
              ><span class="points-container"
                >Points: <span class="points">334</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43474112"
                  >Comments</a
                ><span class="descendants">: 198</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43473623">
          <h3>
            <a
              class="item"
              href="https://alexwlchan.net/2025/github-actions-audit/"
              >Whose code am I running in GitHub Actions?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-25 @ 17:17:05</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43473623"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43473618">
          <h3>
            <a
              class="item"
              href="https://supernuclear.substack.com/p/stoop-coffee-how-a-simple-idea-transformed"
              >Stoop Coffee: A simple idea transformed my neighborhood</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-25 @ 17:16:45</span
              ><span class="points-container"
                >Points: <span class="points">537</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43473618"
                  >Comments</a
                ><span class="descendants">: 206</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43473489">
          <h3>
            <a
              class="item"
              href="https://blog.google/technology/google-deepmind/gemini-model-thinking-updates-march-2025/"
              >Gemini 2.5</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-25 @ 17:01:54</span
              ><span class="points-container"
                >Points: <span class="points">460</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43473489"
                  >Comments</a
                ><span class="descendants">: 221</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43473478">
          <h3>
            <a class="item" href="https://careers.activeloop.ai/"
              >Activeloop (YC S18) Is Hiring Senior Python Back End and AI
              Search Engineers</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-25 @ 17:00:36</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43473358">
          <h3>
            <a class="item" href="https://abcdinamo.com/news/german-bold-italic"
              >Kylie Minogue song about a typeface</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-25 @ 16:51:09</span
              ><span class="points-container"
                >Points: <span class="points">124</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43473358"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43472668">
          <h3>
            <a
              class="item"
              href="https://ethz.ch/en/news-and-events/eth-news/news/2025/03/were-large-soda-lakes-the-cradle-of-life.html"
              >Were large soda lakes the cradle of life?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-25 @ 15:42:58</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43472668"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43472663">
          <h3>
            <a
              class="item"
              href="https://math.ucr.edu/home/baez/physics/Relativity/SpeedOfLight/c.html"
              >Why is C the symbol for the speed of light? (2004)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-25 @ 15:42:03</span
              ><span class="points-container"
                >Points: <span class="points">93</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43472663"
                  >Comments</a
                ><span class="descendants">: 79</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43472320">
          <h3>
            <a
              class="item"
              href="https://www.theworldwar.org/learn/about-wwi/borne-back-ceaselessly-past-fitzgerald-gatsby-and-wwi"
              >Borne Back Ceaselessly into the Past: Fitzgerald, Gatsby and
              WWI</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-25 @ 15:11:56</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43472320"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43472143">
          <h3>
            <a class="item" href="https://danilafe.com/blog/chapel_x_macros/"
              >My Favorite C++ Pattern: X Macros (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-25 @ 14:57:59</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43472143"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43471939">
          <h3>
            <a class="item" href="https://feudlegame.com"
              >Show HN: Feudle – a daily puzzle game built with AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-25 @ 14:42:21</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43471939"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
            <div class="text">
              <p>
                Each day, there’s a survey question, and players try to guess
                the most popular responses—but the twist is that today’s answers
                come from real players who played yesterday. After playing, you
                can vote on or submit new questions, shaping future Feudles.
              </p>
              <p>
                If I were to start again, I’d explore newer AI-assisted coding
                tools like Cursor, but overall, this was a great learning
                experience. Hopefully, this inspires others to experiment with
                AI tools to bring their ideas to life.
              </p>
              <p>
                Any feedback? Any tips for AI tools I should explore when
                iterating on the game?
              </p>
            </div>
          </section>
        </section>
        <section id="43471177">
          <h3>
            <a
              class="item"
              href="https://utcc.utoronto.ca/~cks/space/blog/sysadmin/RunMoreExtraNetworkFiber"
              >If you get the chance, always run more extra network fiber
              cabling</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-25 @ 13:40:59</span
              ><span class="points-container"
                >Points: <span class="points">86</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43471177"
                  >Comments</a
                ><span class="descendants">: 93</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43470971">
          <h3>
            <a
              class="item"
              href="https://www.shirleywu.studio/notebook/2025-02-innovation-killer"
              >What Killed Innovation?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-25 @ 13:26:01</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43470971"
                  >Comments</a
                ><span class="descendants">: 70</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43470906">
          <h3>
            <a
              class="item"
              href="https://blog.cloudflare.com/open-sourcing-openpubkey-ssh-opkssh-integrating-single-sign-on-with-ssh/"
              >Open-sourcing OpenPubkey SSH (OPKSSH): integrating single sign-on
              with SSH</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-25 @ 13:22:09</span
              ><span class="points-container"
                >Points: <span class="points">117</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43470906"
                  >Comments</a
                ><span class="descendants">: 94</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43470651">
          <h3>
            <a class="item" href="https://github.com/facebookresearch/vggt"
              >VGGT: Visual Geometry Grounded Transformer</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-25 @ 12:59:26</span
              ><span class="points-container"
                >Points: <span class="points">123</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43470651"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43470162">
          <h3>
            <a class="item" href="https://github.com/habedi/hann"
              >Hann: A Fast Approximate Nearest Neighbor Search Library for
              Go</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-25 @ 11:57:11</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43470162"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43468498">
          <h3>
            <a
              class="item"
              href="https://www.theparisreview.org/blog/2025/03/17/is-robert-frost-even-a-good-poet/"
              >Is Robert Frost Even a Good Poet?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-25 @ 06:11:46</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43468498"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43467847">
          <h3>
            <a
              class="item"
              href="https://www.newyorker.com/magazine/2025/03/31/miracles-and-wonder-elaine-pagels-book-review-heretic-catherine-nixey"
              >We're Still Not Done with Jesus</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-25 @ 03:23:48</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43467847"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43462783">
          <h3>
            <a
              class="item"
              href="https://www.theatlantic.com/politics/archive/2025/03/trump-administration-accidentally-texted-me-its-war-plans/682151/"
              >U.S. national-security leaders included me in a group chat</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-24 @ 16:23:55</span
              ><span class="points-container"
                >Points: <span class="points">1402</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43462783"
                  >Comments</a
                ><span class="descendants">: 562</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43452725">
          <h3>
            <a
              class="item"
              href="https://gizmodo.com/chicago-sized-iceberg-hid-ancient-ecosystem-scientists-reveal-2000579125"
              >Chicago-Sized Iceberg Hid Ancient Ecosystem, Scientists Reveal</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-23 @ 13:19:07</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43452725"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43451700">
          <h3>
            <a class="item" href="https://polypane.app/"
              >Polypane, The browser for ambitious web developers</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-23 @ 09:07:17</span
              ><span class="points-container"
                >Points: <span class="points">155</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43451700"
                  >Comments</a
                ><span class="descendants">: 96</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43451222">
          <h3>
            <a class="item" href="https://fingernotes.com/note/97513380"
              >Show HN: Fingernotes – handwritten notes which become their own
              preview image</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-23 @ 06:32:19</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43451222"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
            <div class="text">
              <p>
                Hacking fingernotes.com together over a couple of weeks was a
                creative outlet when work got stressful. I think of it as
                digital sticky notes. The goal was to make notes with a personal
                touch that are easy to write and share. I also wanted them to
                appear as their own link preview image on supported platforms.
                That way when you send the link to a note, the person sees the
                message without following the link.
              </p>
              <p>Let me know what you think!</p>
              <p>
                I drew inspiration from Apple's quick notes: low latency made
                scribbling a pleasure, and sending notes to friends felt warm
                and original compared to a typical exchange. It was also
                intriguing to see my handwriting printed in a message chat. In a
                time of rising artificial generation, spreading my clumsy
                handwriting feels like an act of rebellion.
              </p>
              <p>
                But I dislike the light background in Apple notes, which I don't
                think you can change when sharing. More importantly, no one sent
                a note back. With fingernotes the low-friction interaction is
                meant to make creating notes simple. I also find the image
                previews aesthetically more pleasing.
              </p>
              <p>
                For implementation, fingernotes are publicly accessible links to
                collections of strokes that have been persisted to a Cloudflare
                D1 database and rendered in SVG. Like pen on a sticky note, each
                stroke is immutable but anyone can add to a note if they have
                the link. You can't undo strokes, so if you mess up your note
                just throw it out and start a new one. Having append-only
                collections avoids handling order of operations when multiple
                people edit the same note. Hosting it as a Cloudflare worker
                made it easy to get up and running. There's some latency in
                Safari on iOS which is absent on desktop. It's noticeable
                compared to Apple notes and I'm afraid it's a limitation of the
                browser.
              </p>
            </div>
          </section>
        </section>
        <section id="43449608">
          <h3>
            <a
              class="item"
              href="https://www.engadget.com/ai/amc-theatres-will-screen-a-swedish-movie-visually-dubbed-with-the-help-of-ai-130022232.html"
              >AMC Theatres will screen a Swedish movie 'visually dubbed' with
              the help of AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-22 @ 23:37:43</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43449608"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43440321">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2025-03-scientists-plastic-simple-inexpensive-catalyst.html"
              >Scientists break down plastic using a simple, inexpensive
              catalyst and air</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-21 @ 20:12:49</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43440321"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43440143">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/d41586-025-00593-3"
              >How 'animal methods bias' is affecting research careers</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-21 @ 19:51:42</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43440143"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43439501">
          <h3>
            <a
              class="item"
              href="https://research.google/blog/deciphering-language-processing-in-the-human-brain-through-llm-representations/"
              >Deciphering language processing in the human brain through LLM
              representations</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-21 @ 18:44:37</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43439501"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43437752">
          <h3>
            <a class="item" href="https://github.com/SerenityOS/jakt"
              >The Jakt Programming Language</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-21 @ 16:34:26</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43437752"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
