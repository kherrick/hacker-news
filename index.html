<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="45487476">
          <h3>
            <a class="item" href="https://blog.archive.org/trillion/"
              >Celebrating 1 Trillion Web Pages Archived</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-06 @ 03:48:34</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45487476"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45487452">
          <h3>
            <a class="item" href="https://deflock.me/"
              >Find Nearby Automated License Plate Readers (ALPR)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-06 @ 03:42:15</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45487452"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45487247">
          <h3>
            <a
              class="item"
              href="https://www.addy.rocks/blog/text-to-3d-agent-hybrid-architecture"
              >Building Effective Text-to-3D AI Agents: A Hybrid Architecture
              Approach</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-06 @ 02:57:21</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45487247"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45487044">
          <h3>
            <a class="item" href="https://vgel.me/posts/seahorse/"
              >Why do LLMs freak out over the seahorse emoji?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-06 @ 02:20:05</span
              ><span class="points-container"
                >Points: <span class="points">145</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45487044"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45486829">
          <h3>
            <a
              class="item"
              href="https://blog.adacore.com/should-i-choose-ada-spark-or-rust-over-c-c"
              >Should I choose Ada, SPARK, or Rust over C/C++? (2024)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-06 @ 01:35:03</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45486829"
                  >Comments</a
                ><span class="descendants">: 49</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45486825">
          <h3>
            <a class="item" href="https://sites.google.com/view/mic-e-mouse"
              >Mic-E-Mouse â€“ Covert eavesdropping through computer mice</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-06 @ 01:34:31</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45486825"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45486306">
          <h3>
            <a
              class="item"
              href="https://www.shortliffe.net/Buchanan-Shortliffe-1984/MYCIN%20Book.htm"
              >Rule-Based Expert Systems: The Mycin Experiments (1984)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-05 @ 23:51:47</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45486306"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45486031">
          <h3>
            <a class="item" href="https://spectrum.ieee.org/ai-energy-use"
              >Estimating AI energy use</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-05 @ 23:00:23</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45486031"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45485806">
          <h3>
            <a
              class="item"
              href="https://grist.org/buildings/how-germany-outfitted-half-a-million-balconies-with-solar-panels/"
              >Germany outfitted half a million balconies with solar panels</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-05 @ 22:18:31</span
              ><span class="points-container"
                >Points: <span class="points">176</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45485806"
                  >Comments</a
                ><span class="descendants">: 195</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45485736">
          <h3>
            <a class="item" href="https://kenparkerarchtops.com"
              >Ken Parker, famed luthier, has died</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-05 @ 22:10:15</span
              ><span class="points-container"
                >Points: <span class="points">86</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45485736"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45485175">
          <h3>
            <a
              class="item"
              href="https://hackaday.com/2025/07/23/the-death-of-industrial-design-and-the-era-of-dull-electronics/"
              >The death of industrial design and the era of dull electronics</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-05 @ 20:55:26</span
              ><span class="points-container"
                >Points: <span class="points">126</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45485175"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45484284">
          <h3>
            <a class="item" href="https://github.com/landley/toybox"
              >Toybox: All-in-one Linux command line</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-05 @ 19:09:35</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45484284"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45483924">
          <h3>
            <a class="item" href="https://fi-le.net/oss/"
              >What GPT-OSS leaks about OpenAI's training data</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-05 @ 18:28:16</span
              ><span class="points-container"
                >Points: <span class="points">208</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45483924"
                  >Comments</a
                ><span class="descendants">: 47</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45483651">
          <h3>
            <a class="item" href="http://www.tutok.sk/fastgl/callback.html"
              >Callbacks in C++ using template functors (1994)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-05 @ 17:50:17</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45483651"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45483531">
          <h3>
            <a class="item" href="https://github.com/ksdme/ut"
              >Show HN: ut â€“ Rust based CLI utilities for devs and IT</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-05 @ 17:36:20</span
              ><span class="points-container"
                >Points: <span class="points">133</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45483531"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
            <div class="text">
              <p>
                I find myself reaching for tools like it-tools.tech or other
                random sites every now and then during development or debugging.
                So, I built a toolkit with a sane and simple CLI interface for
                most of those tools.
              </p>
              <p>For the curious and lazy, at the moment, ut has tools for,</p>
              <p>- Encoding: base64 (encode, decode), url (encode, decode)</p>
              <p>- Hashing: md5, sha1, sha224, sha256, sha384, sha512</p>
              <p>
                - Data Generation: uuid (v1, v3, v4, v5), token, lorem, random
              </p>
              <p>
                - Text Processing: case (lower, upper, camel, title, constant,
                header, sentence, snake), pretty-print, diff
              </p>
              <p>- Development Tools: calc, json (builder), regex, datetime</p>
              <p>- Web &amp; Network: http (status), serve, qr</p>
              <p>- Color &amp; Design: color (convert)</p>
              <p>- Reference: unicode</p>
              <p>
                For full disclosure, parts of the toolkit were built with Claude
                Code (I wanted to use this as an opportunity to play with it
                more). Feel free to open feature requests and/or contribute.
              </p>
            </div>
          </section>
        </section>
        <section id="45483386">
          <h3>
            <a
              class="item"
              href="https://koreajoongangdaily.joins.com/news/2025-10-01/national/socialAffairs/NIRS-fire-destroys-governments-cloud-storage-system-no-backups-available/2412936"
              >Fire destroys S. Korean government's cloud storage system, no
              backups available</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-05 @ 17:20:39</span
              ><span class="points-container"
                >Points: <span class="points">1257</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45483386"
                  >Comments</a
                ><span class="descendants">: 556</span></span
              >
            </h4>
            <div class="text">
              <a
                href="https://www.chosun.com/english/national-en/2025/10/02/FPWGFSXMLNCFPIEGWKZF3BOQ3M/"
                >https://www.chosun.com/english/national-en/2025/10/02/FPWGFS...</a
              >
            </div>
          </section>
        </section>
        <section id="45482516">
          <h3>
            <a
              class="item"
              href="https://www.autotrader.co.uk/content/news/byd-builds-world-s-fastest-car"
              >BYD builds fastest car</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-05 @ 15:54:01</span
              ><span class="points-container"
                >Points: <span class="points">177</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45482516"
                  >Comments</a
                ><span class="descendants">: 141</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45482467">
          <h3>
            <a class="item" href="https://nfs40.online/"
              >NFS at 40 â€“ Remembering the Sun Microsystems Network File
              System</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-05 @ 15:49:58</span
              ><span class="points-container"
                >Points: <span class="points">114</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45482467"
                  >Comments</a
                ><span class="descendants">: 84</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45482333">
          <h3>
            <a class="item" href="https://www.delopsu.com/draw.html"
              >Show HN: ASCII Drawing Board</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-05 @ 15:36:21</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45482333"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
            <div class="text">
              <p>
                I want to keep it as manual/analog as possible, hence there is
                no tool for converting image to ASCII.
              </p>
              <p>
                Prompting LLMs to draw ASCII art turned out to be a difficult
                task
                <i
                  >. So instead I decided to ask it make a drawing board.
                  Wihtout coding agent I wouldn't even try myself. Although it
                  is an interesting task, it would drift me away.
                  <p>
                    Basically it's just a drawing board with endless variations
                    of textures and brushes: when you make large canvas and zoom
                    out you don't see ASCII anymore, but textured drawing. E.g.
                    this is a cat:
                    <a
                      href="https://x.com/delopsu_com/status/1971726204073136219"
                      >https://x.com/delopsu_com/status/1971726204073136219</a
                    >, brush used: " ".
                  </p>
                  <p>
                    I would appreciate if you could give it a try and tell your
                    people about it, if it's something that may be of their
                    interest. Also please give any feedback here or on X.
                  </p>
                  <p></p
                ></i>
                turns out there is already (or is emerging) ASCII benchmark for
                LLMs.
              </p>
            </div>
          </section>
        </section>
        <section id="45481892">
          <h3>
            <a
              class="item"
              href="https://www.abortretry.fail/p/the-qnx-operating-system"
              >The QNX Operating System</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-05 @ 14:47:13</span
              ><span class="points-container"
                >Points: <span class="points">200</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45481892"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45481008">
          <h3>
            <a
              class="item"
              href="https://github.com/ashtonsix/perf-portfolio/tree/main/bytepack"
              >86 GB/s bitpacking with ARM SIMD (single thread)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-05 @ 12:27:11</span
              ><span class="points-container"
                >Points: <span class="points">103</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45481008"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45480317">
          <h3>
            <a
              class="item"
              href="https://jamesoclaire.com/2025/10/05/self-hosting-10tb-in-s3-on-a-framework-laptop-disks/"
              >Self hosting 10TB in S3 on a framework laptop and disks</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-05 @ 09:51:26</span
              ><span class="points-container"
                >Points: <span class="points">203</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45480317"
                  >Comments</a
                ><span class="descendants">: 95</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45478780">
          <h3>
            <a class="item" href="https://ambigr.am/hall-of-fame">Ambigr.am</a>
          </h3>
          <section>
            <h4>
              <span>2025-10-05 @ 04:11:55</span
              ><span class="points-container"
                >Points: <span class="points">263</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45478780"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45473516">
          <h3>
            <a
              class="item"
              href="https://eclecticlight.co/2025/10/04/explainer-inodes-and-inode-numbers/"
              >Explainer: Inodes and Inode Numbers</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-04 @ 14:22:04</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45473516"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45455608">
          <h3>
            <a
              class="item"
              href="https://www.thepsmiths.com/p/joint-review-class-by-paul-fussell"
              >Joint Book Review: Class, by Paul Fussell</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-02 @ 21:10:45</span
              ><span class="points-container"
                >Points: <span class="points">4</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45455608"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45455356">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2025-09-catalyst-evolution-reveals-unsung-heroes.html"
              >Catalyst evolution reveals the unsung heroes in industrial
              ammonia production</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-02 @ 20:47:33</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45455356"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45450392">
          <h3>
            <a class="item" href="https://hannahilea.com/blog/birdnet-intro/"
              >Intro to BirdNET-Pi: Eavesdropping on my feathered friends</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-02 @ 14:49:12</span
              ><span class="points-container"
                >Points: <span class="points">84</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45450392"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45448747">
          <h3>
            <a
              class="item"
              href="https://magic-wormhole.readthedocs.io/en/latest/welcome.html"
              >Magic Wormhole: Get things from one computer to another,
              safely</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-02 @ 12:25:41</span
              ><span class="points-container"
                >Points: <span class="points">86</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45448747"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45448416">
          <h3>
            <a class="item" href="https://ut21.github.io/blog/triton.html"
              >The G in GPU is for Graphics damnit</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-02 @ 11:46:27</span
              ><span class="points-container"
                >Points: <span class="points">114</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45448416"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45447226">
          <h3>
            <a class="item" href="https://www.srb2.org/"
              >Sonic Robo Blast 2: 25 year old continuously developed DOOM
              engine-based fangame</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-10-02 @ 07:50:36</span
              ><span class="points-container"
                >Points: <span class="points">97</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45447226"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
