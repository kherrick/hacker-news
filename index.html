<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="44339793">
          <h3>
            <a
              class="item"
              href="https://www.tomshardware.com/pc-components/sound-cards/legendary-sound-blaster-isa-sound-card-gets-a-driver-update-30-years-later-patch-squashes-first-bug-report-after-25-years"
              >Legendary Sound Blaster ISA sound card gets a driver update 30
              years later</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-21 @ 18:47:32</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44339793"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44339596">
          <h3>
            <a
              class="item"
              href="https://www.bloomberg.com/news/articles/2025-06-20/ai-is-ushering-in-the-tiny-team-era-in-silicon-valley"
              >AI Is Ushering in the 'Tiny Team' Era in Silicon Valley</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-21 @ 18:21:27</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44339596"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44339227">
          <h3>
            <a class="item" href="https://account.hypr.land/pricing"
              >Hyprland Premium</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-21 @ 17:32:40</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44339227"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44339076">
          <h3>
            <a class="item" href="https://alltracker.github.io/"
              >AllTracker: Efficient Dense Point Tracking at High Resolution</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-21 @ 17:09:35</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44339076"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44339043">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/weave-3/jobs/SqFnIFE-founding-ai-engineer"
              >Weave (YC W25) is hiring a founding AI engineer</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-21 @ 17:01:50</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44339025">
          <h3>
            <a
              class="item"
              href="https://mattgreer.dev/blog/balatro-for-the-nintendo-ereader/"
              >Balatro for the Nintendo E-Reader</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-21 @ 16:59:47</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44339025"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44338562">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=44338562"
              >Tell HN: Beware confidentiality agreements that act as lifetime
              non competes</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-21 @ 16:02:24</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44338562"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
            <div class="text">
              <p>
                Companies don’t really need non-competes anymore. Some companies
                take an extremely broad interpretation of IP confidentiality,
                where they consider doing any work in the industry during your
                lifetime an inevitable confidentiality violation. They argue it
                would be impossible for you to work elsewhere in this industry
                <i>during your entire career</i> without violating
                confidentiality with the technical and business instincts you
                bring to that domain. It doesn’t require conscious violation on
                your part (they argue).
              </p>
              <p>So beware and read your employment agreement carefully.</p>
              <p>
                More here
                https://www.promarket.org/2024/02/08/confidentiality-agreements-can-act-like-noncompetes/
              </p>
              <p>And this is the insane legal doctrine behind this</p>
              <p>https://en.m.wikipedia.org/wiki/Inevitable_disclosure</p>
            </div>
          </section>
        </section>
        <section id="44338089">
          <h3>
            <a
              class="item"
              href="https://www.redpanda.com/blog/gcp-outage-june-redpanda-cloud"
              >Behind the scenes: Redpanda Cloud's response to the GCP outage</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-21 @ 14:57:07</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44338089"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44336915">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2025/06/20/technology/us-tech-europe-microsoft-trump-icc.html"
              >Microsoft suspended the email account of an ICC prosecutor at The
              Hague</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-21 @ 12:06:15</span
              ><span class="points-container"
                >Points: <span class="points">317</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44336915"
                  >Comments</a
                ><span class="descendants">: 168</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44336381">
          <h3>
            <a class="item" href="https://mmondrian.com/">Show HN: MMOndrian</a>
          </h3>
          <section>
            <h4>
              <span>2025-06-21 @ 10:39:21</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44336381"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
            <div class="text">
              Made a collaborative, persistent state Mondrian-style painting
              editor. Feedback welcome!
            </div>
          </section>
        </section>
        <section id="44336015">
          <h3>
            <a
              class="item"
              href="https://clickhouse.com/blog/scaling-observability-beyond-100pb-wide-events-replacing-otel"
              >Scaling our observability platform by embracing wide events and
              replacing OTel</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-21 @ 09:23:21</span
              ><span class="points-container"
                >Points: <span class="points">147</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44336015"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44335907">
          <h3>
            <a class="item" href="https://cosmoe.org/index.html"
              >Cosmoe: BeOS Class Library on Top of Wayland</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-21 @ 09:00:01</span
              ><span class="points-container"
                >Points: <span class="points">145</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44335907"
                  >Comments</a
                ><span class="descendants">: 57</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44335517">
          <h3>
            <a
              class="item"
              href="https://www.lemonde.fr/en/science/article/2025/06/21/gwada-negative-french-scientists-find-new-blood-type-in-woman_6742577_10.html"
              >'Gwada negative': French scientists find new blood type in
              woman</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-21 @ 07:38:42</span
              ><span class="points-container"
                >Points: <span class="points">109</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44335517"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44335065">
          <h3>
            <a class="item" href="https://delta.chat/en/"
              >Delta Chat is a decentralized and secure messenger app</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-21 @ 06:29:00</span
              ><span class="points-container"
                >Points: <span class="points">191</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44335065"
                  >Comments</a
                ><span class="descendants">: 95</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44335038">
          <h3>
            <a
              class="item"
              href="https://www.gematsu.com/2025/06/sega-mistakenly-reveals-sales-numbers-for-like-a-dragon-infinite-wealth-persona-3-reload-shin-megami-tensei-v-and-more"
              >Sega mistakenly reveals sales numbers of popular games</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-21 @ 06:23:01</span
              ><span class="points-container"
                >Points: <span class="points">186</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44335038"
                  >Comments</a
                ><span class="descendants">: 166</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44334403">
          <h3>
            <a
              class="item"
              href="https://graphics.cs.utah.edu/research/projects/avbd/"
              >Augmented Vertex Block Descent (AVBD)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-21 @ 04:04:56</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44334403"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44334167">
          <h3>
            <a
              class="item"
              href="https://smex.org/open-letter-to-samsung-end-forced-israeli-app-installations-in-the-wana-region/"
              >Samsung embeds IronSource spyware app on phones across WANA</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-21 @ 03:06:42</span
              ><span class="points-container"
                >Points: <span class="points">611</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44334167"
                  >Comments</a
                ><span class="descendants">: 367</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44333187">
          <h3>
            <a
              class="item"
              href="https://www.science.org/doi/10.1126/science.adp9274"
              >Plastic bag bans and fees reduce harmful bag litter on
              shorelines</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-20 @ 23:46:50</span
              ><span class="points-container"
                >Points: <span class="points">184</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44333187"
                  >Comments</a
                ><span class="descendants">: 116</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44332699">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2506.11440"
              >AbsenceBench: Language models can't tell what's missing</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-20 @ 22:26:52</span
              ><span class="points-container"
                >Points: <span class="points">288</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44332699"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44331362">
          <h3>
            <a class="item" href="https://writewithharper.com"
              >Harper – an open-source alternative to Grammarly</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-20 @ 19:51:45</span
              ><span class="points-container"
                >Points: <span class="points">499</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44331362"
                  >Comments</a
                ><span class="descendants">: 143</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44329712">
          <h3>
            <a class="item" href="https://iter.ca/post/yt-adblock/"
              >YouTube's new anti-adblock measures</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-20 @ 17:01:35</span
              ><span class="points-container"
                >Points: <span class="points">781</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44329712"
                  >Comments</a
                ><span class="descendants">: 1118</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44329457">
          <h3>
            <a class="item" href="https://github.com/nxtscape/nxtscape"
              >Show HN: Nxtscape – an open-source agentic browser</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-20 @ 16:35:55</span
              ><span class="points-container"
                >Points: <span class="points">287</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44329457"
                  >Comments</a
                ><span class="descendants">: 187</span></span
              >
            </h4>
            <div class="text">
              <p>
                -- Why bother building a new browser? For the first time since
                Netscape was released in 1994, it feels like we can reimagine
                browsers from scratch for the age of AI agents. The web browser
                of tomorrow might not look like what we have today.
              </p>
              <p>
                We saw how tools like Cursor gave developers a 10x productivity
                boost, yet the browser—where everyone else spends their entire
                workday—hasn't fundamentally changed.
              </p>
              <p>
                And honestly, we feel like we're constantly fighting the browser
                we use every day. It's not one big thing, but a series of small,
                constant frustrations. I'll have 70+ tabs open from three
                different projects and completely lose my train of thought. And
                simple stuff like reordering tide pods from amazon or filling
                out forms shouldn't need our full attention anymore. AI can
                handle all of this, and that's exactly what we're building.
              </p>
              <p>
                Here’s a demo of our early version
                <a href="https://dub.sh/nxtscape-demo"
                  >https://dub.sh/nxtscape-demo</a
                >
              </p>
              <p>
                -- What makes us different We know others are exploring this
                space (Perplexity, Dia), but we want to build something
                open-source and community-driven. We're not a search or ads
                company, so we can focus on being privacy-first – Ollama
                integration, BYOK (Bring Your Own Keys), ad-blocker.
              </p>
              <p>
                Btw we love what Brave started and stood for, but they've now
                spread themselves too thin across crypto, search, etc. We are
                laser-focused on one thing: making browsers work for YOU with
                AI. And unlike Arc (which we loved too but got abandoned), we're
                100% open source. Fork us if you don't like our direction.
              </p>
              <p>
                -- Our journey hacking a new browser To build this, we had to
                fork Chromium. Honestly, it feels like the only viable path
                today—we've seen others like Brave (started with electron) and
                Microsoft Edge learn this the hard way.
              </p>
              <p>
                We also started with why not just build an extension. But
                realized we needed more control. Similar to the reason why
                Cursor forked VSCode. For example, Chrome has this thing called
                the Accessibility Tree - basically a cleaner, semantic version
                of the DOM that screen readers use. Perfect for AI agents to
                understand pages, but you can't use it through extension APIs.
              </p>
              <p>
                That said, working with the 15M-line C++ chromium codebase has
                been an adventure. We've both worked on infra at Google and
                Meta, but Chromium is a different beast. Tools like Cursor's
                indexing completely break at this scale, so we've had to get
                really good with grep and vim. And the build times are
                brutal—even with our maxed-out M4 Max MacBook, a full build
                takes about 3 hours.
              </p>
              <p>
                Full disclosure: we are still very early, but we have a working
                prototype on GitHub. It includes an early version of a "local
                Manus" style agent that can automate simple web tasks, plus an
                AI sidebar for questions, and other productivity features
                (grouping tabs, saving/resuming sessions, etc.).
              </p>
              <p>Looking forward to any and all comments!</p>
              <p>
                You can download the browser from our github page:
                <a href="https://github.com/nxtscape/nxtscape"
                  >https://github.com/nxtscape/nxtscape</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="44328598">
          <h3>
            <a
              class="item"
              href="https://jgeekstudies.org/2025/06/20/wilted-lands-and-wounded-worlds-visualizing-environmental-costs-of-war-in-hayao-miyazakis-nausicaa-of-the-valley-of-the-wind/"
              >Visualizing environmental costs of war in Hayao Miyazaki's
              Nausicaä</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-20 @ 15:23:29</span
              ><span class="points-container"
                >Points: <span class="points">239</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44328598"
                  >Comments</a
                ><span class="descendants">: 64</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44328326">
          <h3>
            <a
              class="item"
              href="https://fly.io/blog/phoenix-new-the-remote-ai-runtime/"
              >Phoenix.new – Remote AI Runtime for Phoenix</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-20 @ 14:57:04</span
              ><span class="points-container"
                >Points: <span class="points">516</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44328326"
                  >Comments</a
                ><span class="descendants">: 232</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44314305">
          <h3>
            <a class="item" href="https://sarupro.itch.io/thenyanja"
              >The Nyanja new PC-Engine/TurboGrafx 16-bit console game in
              development</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-19 @ 00:02:20</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44314305"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44310763">
          <h3>
            <a class="item" href="https://airpass.tiagoalves.me/"
              >Airpass – easily overcome WiFi time limits</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-18 @ 15:29:30</span
              ><span class="points-container"
                >Points: <span class="points">161</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44310763"
                  >Comments</a
                ><span class="descendants">: 91</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44308953">
          <h3>
            <a
              class="item"
              href="https://blog.trailofbits.com/2025/06/17/unexpected-security-footguns-in-gos-parsers/"
              >Unexpected security footguns in Go's parsers</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-18 @ 11:35:12</span
              ><span class="points-container"
                >Points: <span class="points">141</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44308953"
                  >Comments</a
                ><span class="descendants">: 79</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44306892">
          <h3>
            <a
              class="item"
              href="https://www.omgubuntu.co.uk/2025/06/microsoft-edit-text-editor-ubuntu"
              >Using Microsoft's New CLI Text Editor on Ubuntu</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-18 @ 05:25:36</span
              ><span class="points-container"
                >Points: <span class="points">165</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44306892"
                  >Comments</a
                ><span class="descendants">: 179</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44303767">
          <h3>
            <a
              class="item"
              href="https://www.independent.co.uk/news/science/captain-cook-missing-ship-found-hms-endeavour-b2771322.html"
              >Captain Cook's missing ship found after sinking 250 years ago</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-17 @ 20:46:35</span
              ><span class="points-container"
                >Points: <span class="points">126</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44303767"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44298666">
          <h3>
            <a class="item" href="https://www.asimov.press/p/slime"
              >Life as Slime</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-17 @ 13:03:36</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44298666"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
