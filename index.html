<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="41784713">
          <h3>
            <a
              class="item"
              href="https://twitter.com/cassieceleste/status/1843702724090835178"
              >Cassie LaBelle: "eBay completely destroyed my life"</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-09 @ 05:16:48</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41784713"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41784668">
          <h3>
            <a
              class="item"
              href="https://easyos.org/about/why-the-iso-format-has-to-die.html"
              >Why the ISO format has to die</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-09 @ 05:06:55</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41784668"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41784591">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2410.00907"
              >Addition Is All You Need for Energy-Efficient Language Models</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-09 @ 04:47:40</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41784591"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41784387">
          <h3>
            <a class="item" href="https://github.com/mappu/miqt"
              >Miqt: MIT-licensed Qt bindings for Go</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-09 @ 03:56:18</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41784387"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41783340">
          <h3>
            <a class="item" href="https://css-tricks.com/emoji-as-a-favicon/"
              >Emoji as a Favicon Using SVG (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-09 @ 00:39:50</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41783340"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41782534">
          <h3>
            <a
              class="item"
              href="https://writings.stephenwolfram.com/2024/10/on-the-nature-of-time/"
              >On the Nature of Time</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-08 @ 22:42:01</span
              ><span class="points-container"
                >Points: <span class="points">236</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41782534"
                  >Comments</a
                ><span class="descendants">: 148</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41781855">
          <h3>
            <a
              class="item"
              href="https://roman.pt/posts/dont-let-dicts-spoil-your-code/"
              >Don't let dicts spoil your code</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-08 @ 21:10:14</span
              ><span class="points-container"
                >Points: <span class="points">127</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41781855"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41781777">
          <h3>
            <a
              class="item"
              href="https://entropicthoughts.com/practices-of-reliable-software-design"
              >Practices of Reliable Software Design</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-08 @ 21:01:22</span
              ><span class="points-container"
                >Points: <span class="points">97</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41781777"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41781768">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=41781768"
              >Instant (YC S22) is hiring a founding engineer to help build a
              modern Firebase</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-08 @ 21:00:16</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
            <div class="text">
              <p>
                You would be one of the founding engineers; why join us, when
                you can start a company yourself or work at an OpenAI?
              </p>
              <p>Here’s our case:</p>
              <p>
                Instant is (a) a really hard problem (b) that users want (c)
                worked on by an excellent team (d) where you can have immense
                impact and (e) be compensated accordingly.
              </p>
              <p>Let me explain:</p>
              <p>## (a) a really hard problem</p>
              <p>
                For the last two years, we’ve been hacking on Instant, the
                modern Firebase. Instant is a database you can use directly from
                the browser; you write queries, and they stay in sync, work
                offline, and come with optimistic updates out of the box. You
                get auth, and a system for running permissions too. You also
                have support for presence, and SDKs for React, vanilla JS, and
                React Native.
              </p>
              <p>
                For years we were in a cave building and talking to a core group
                of users; Instant turned out to be one of the hardest products
                we’ve ever worked on. We built a multi-tenant architecture, so
                we could offer a free tier that never freezes (you can even spin
                up a database without signing up, check out the tutorial [1]).
                We had to write a query engine on the backend, and a sync layer
                on top of that. To do it, we scoured articles on Figma’s
                LiveGraph, Asana’s Luna, and Andy Pavlo’s courses.
              </p>
              <p>
                We open sourced last month, and had one of the largest Show HN’s
                for a YC company [2]. And soon after that, we announced a 3.4M
                seed round [3], backed by James Tamplin (the founder of
                Firebase), Paul Graham, Greg Brockman, Jeff Dean, Amjad Masad,
                Karri Saarinen, and 50+ technical angels.
              </p>
              <p>
                ## (b) that users want Since launch, we have been flooded with
                user requests. Some of the largest infra and AI companies have
                reached out to us for integrations. We have people asking for
                enterprise deals, and had to turn some down due to bandwidth.
              </p>
              <p>
                You probably resonate yourself — you know how much of a schlep
                software development can be: spin up databases, write endpoints,
                funnel data to store, and finally paint screens. You do all of
                that, and the app is just ok. If you want to make it great, time
                to add reactivity, optimistic updates, and offline mode.
              </p>
              <p>
                It doesn’t have to be this hard. There’s a missing abstraction,
                and it looks like a database you can use in the browser.
                Companies like Figma, Asana, Linear, and Notion have all built
                this internally. It’s obvious to us that most apps will be built
                this way in the future, and we built Instant to power them.
              </p>
              <p>
                ## (c) worked on by an excellent team For the longest time,
                we’ve been a very small team: right now it’s just 3 of us: Joe
                Averbukh, Daniel Woelfel, and me. We’ve known each-other for 10
                years, and have worked across companies together. We think small
                teams of very talented people are special; It’s more fun, you
                get more autonomy, and you form relationships for life.
              </p>
              <p>
                This is how it feels at Instant. Each of us own projects that
                would have deserved large infrastructure orgs at other
                companies. Each of us takes our craft and our word seriously;
                it’s a breath of fresh air to work together, knowing that when
                you ask for help, you have someone who you deeply respect by
                your side.
              </p>
              <p>
                ## (d) where you can have immense impact Our current
                architecture got us to a new stage, but to really excel at this
                next stage, there’s a lot more to do.
              </p>
              <p>
                We recently had to turn down 2 customers because they would have
                added 2 magnitudes more traffic. Our infrastructure can’t handle
                that yet, but perhaps with your help, they will. Maybe you could
                dive deep into our sync engine: what kind of algorithms can we
                write to improve invalidation? How can we jig postgres to make
                queries even faster? How can we send less data to the client?
              </p>
              <p>
                We have a storage service in beta. We want to make it the best
                one on the market. We want files to live in your database too,
                so they can be reactive, and work with permissions out of the
                box. You shouldn’t have to deal with presigned URLs. You
                shouldn’t need triggers to sync different datastores. You should
                just be able to upload files from the client.
              </p>
              <p>
                We have a multi-tenant database you can start with, but what
                about existing companies? They already use Postgres. Well, what
                if we created a Postgres adapter for Instant? We could take
                Instant queries and translated them to postgres SQL. What kind
                of postgres introspection queries would you need to write to
                infer the schema?
              </p>
              <p>
                Right now we have no story for load testing. We want to build a
                suite to track metrics to track perf and have visibility on
                improvements/degradation. Even something akin to the one-laptop
                solution Figma had up to 2020 would be a big win for us. Can you
                build it?
              </p>
              <p>
                Or how about our client side SDK. Our reactive layer on the
                client is a state machine, and it’s getting out of control.
                Maybe it’s time to introduce observables. Can you add them? We
                should be able to introspect into the state of the client: what
                happens when you make a transaction? Can we see it propagate and
                change throughout the SDK?
              </p>
              <p>## (e) be compensated accordingly</p>
              <p>
                If this was a few months ago, I would not have written this, I
                didn’t think the risk/reward would be worth it for you. But at
                this point, I really think it is. We’re just at the point where
                we could hit PMF with your help, and since we haven’t raised an
                A yet, we can offer you significant equity to make it happen.
              </p>
              <p>---</p>
              <p>
                If you’re the kind of person who gets excited about this stuff,
                who truly loves their craft, and wants to work with others who
                do, who moves fast, but isn’t afraid to look deep into the
                ‘scarier’ programming problems. we want to talk to you.
              </p>
              <p>
                Send us an email: founders [at] instantdb.com, and include a
                project you worked on (if it comes with github that would be
                awesome!)
              </p>
              <p>
                [1]
                <a href="https://instantdb.com/tutorial"
                  >https://instantdb.com/tutorial</a
                >
                [2]
                <a href="https://news.ycombinator.com/item?id=41322281"
                  >https://news.ycombinator.com/item?id=41322281</a
                >
                [3]
                <a href="https://x.com/stopachka/status/1841514927099437144"
                  >https://x.com/stopachka/status/1841514927099437144</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="41781457">
          <h3>
            <a class="item" href="https://chrisdone.com/posts/htmx-critique/"
              >A modest critique of Htmx</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-08 @ 20:19:57</span
              ><span class="points-container"
                >Points: <span class="points">196</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41781457"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41780929">
          <h3>
            <a
              class="item"
              href="https://chipsandcheese.com/p/lunar-lakes-igpu-debut-of-intels"
              >Lunar Lake's iGPU: Debut of Intel's Xe2 Architecture</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-08 @ 19:32:37</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41780929"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41780297">
          <h3>
            <a class="item" href="https://player.style"
              >Show HN: Winamp and other media players, rebuilt for the web with
              Web Components</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-08 @ 18:27:46</span
              ><span class="points-container"
                >Points: <span class="points">258</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41780297"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
            <div class="text">
              <p>
                I know Web Components are in a bit of a drama cycle right now.
                I’m happy to see them get any attention really. I’ve been pretty
                bullish on them since ~2013 when I started working with them, at
                least in the context of a <i>widget</i> like a video player.
                I’ve even given many related talks on them like this one (<a
                  href="https://www.youtube.com/watch?v=N6Mh84SRoDg"
                  >https://www.youtube.com/watch?v=N6Mh84SRoDg</a
                >).
              </p>
              <p>
                I would never push them for a large app or as a full replacement
                for React, but they’ve been incredible for making video players
                that are compatible across many contexts, and Player.style is a
                clear demonstration of that when you get to the step of
                embedding a theme. Web components really shine for building bits
                of UI that can be shared between projects. They also are the
                best way to avoid the long term JS framework thrash that’s a
                challenge for any developer who works on the web for long
                enough. One of the best decisions I ever made for Video.js was
                to <i>not</i> build it with jQuery. Video.js is 15 years old now
                and still in use, while all the jQuery players are not.
              </p>
              <p>
                For some added context of this project, when I was building
                Video.js back in 2010 I put a lot of thought into how other
                developers would customize the player controls. I was excited to
                use web technologies (instead of Flash) to build a player and I
                <i>knew</i> other web devs would be too.
              </p>
              <p>
                Fast forward 14 years — Video.js has been used on millions of
                websites including Twitter, Instagram, Amazon, Dropbox, Linkedin
                and even in United Airlines headrests. In 99.99% of those cases
                the default Video.js controls were used with little to no
                customization. So…huge adoption success, utter failure in
                sparking creativity. In retrospect, asking people to learn a new
                UI framework just to style their player was too much.
              </p>
              <p>
                Media Chrome and Player.style are my answer to that friction.
              </p>
              <p>
                - Media Chrome - A suite of Web Components and React Components
                that let you easily build a media player UI from scratch, using
                components you’re already familiar with.
              </p>
              <p>
                - Player.stye - Themes built with Media Chrome, showing the
                cross-player and cross-framework flexibility of Media Chrome
              </p>
              <p>
                Media Chrome is already used on sites like TED.com, Syntax.fm,
                and anywhere the Mux Player is used. We’ve spent the last few
                months building some great themes for Player.style. I probably
                had the most fun recreating the Youtube icon animations from
                scratch using SVGs and CSS. (Whoever made the originals, nicely
                done!)
              </p>
              <p>
                It’s all free and open source, so don’t hesitate to jump in if
                you’re interested in the project. And of course I’m happy to
                answer any questions.
              </p>
            </div>
          </section>
        </section>
        <section id="41779952">
          <h3>
            <a
              class="item"
              href="https://www.welivesecurity.com/en/eset-research/mind-air-gap-goldenjackal-gooses-government-guardrails/"
              >European govt air-gapped systems breached using custom malware</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-08 @ 17:52:14</span
              ><span class="points-container"
                >Points: <span class="points">136</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41779952"
                  >Comments</a
                ><span class="descendants">: 80</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41779576">
          <h3>
            <a
              class="item"
              href="https://blog.jgc.org/2024/10/rabbit-hole-stumbling-across-two.html"
              >Rabbit hole: stumbling across two Portuguese punched cards</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-08 @ 17:19:18</span
              ><span class="points-container"
                >Points: <span class="points">126</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41779576"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41779519">
          <h3>
            <a
              class="item"
              href="https://nullonerror.org/2024/10/08/my-first-game-with-carimbo/"
              >My first game with Carimbo, my homemade engine</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-08 @ 17:13:16</span
              ><span class="points-container"
                >Points: <span class="points">219</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41779519"
                  >Comments</a
                ><span class="descendants">: 108</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41776878">
          <h3>
            <a
              class="item"
              href="https://blog.eriksen.com.br/en/introducing-kotlin-money"
              >Show HN: Kotlin Money</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-08 @ 12:59:52</span
              ><span class="points-container"
                >Points: <span class="points">357</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41776878"
                  >Comments</a
                ><span class="descendants">: 199</span></span
              >
            </h4>
            <div class="text">
              <p>
                Inspired by my days at N26 Brasil dealing with these challenges,
                I introduce Money: a Kotlin library that makes monetary
                calculations and allocations easy.
              </p>
            </div>
          </section>
        </section>
        <section id="41776706">
          <h3>
            <a
              class="item"
              href="https://pcreux.com/2024/10/07/rails-data-sync-service.html"
              >Building a robust data synchronization framework with Rails</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-08 @ 12:39:56</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41776706"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41776324">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2410.05258"
              >Differential Transformer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-08 @ 11:54:30</span
              ><span class="points-container"
                >Points: <span class="points">466</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41776324"
                  >Comments</a
                ><span class="descendants">: 157</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41775463">
          <h3>
            <a
              class="item"
              href="https://www.nobelprize.org/uploads/2024/09/advanced-physicsprize2024.pdf"
              >Nobel Prize in Physics awarded to John Hopfield and Geoffrey
              Hinton [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-08 @ 09:52:46</span
              ><span class="points-container"
                >Points: <span class="points">818</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41775463"
                  >Comments</a
                ><span class="descendants">: 710</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41775238">
          <h3>
            <a class="item" href="https://kristoff.it/blog/static-site-paradox/"
              >The Static Site Paradox</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-08 @ 09:08:51</span
              ><span class="points-container"
                >Points: <span class="points">368</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41775238"
                  >Comments</a
                ><span class="descendants">: 225</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41774871">
          <h3>
            <a
              class="item"
              href="https://devblogs.microsoft.com/oldnewthing/20241007-00/?p=110345"
              >A popular but wrong way to convert a string to uppercase or
              lowercase</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-08 @ 08:11:32</span
              ><span class="points-container"
                >Points: <span class="points">162</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41774871"
                  >Comments</a
                ><span class="descendants">: 169</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41770051">
          <h3>
            <a class="item" href="https://github.com/BobMcDear/trap"
              >Trap – Transformers in APL</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-07 @ 19:36:33</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41770051"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41764692">
          <h3>
            <a
              class="item"
              href="https://belowwaterlevel.com/2024/10/05/prioritize-through-purpose/"
              >Prioritize Through Purpose</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-07 @ 10:46:30</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41764692"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41761783">
          <h3>
            <a
              class="item"
              href="https://www.smithsonianmag.com/arts-culture/why-the-worlds-first-pet-cemetery-was-revolutionary-180985127/"
              >Why the First Pet Cemetery Was Revolutionary</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-07 @ 00:59:51</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41761783"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41760503">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2024-09-augmented-reality-displays-eyeglasses.html"
              >Shrinking augmented reality displays into eyeglasses to expand
              their use</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-06 @ 21:31:36</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41760503"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41758371">
          <h3>
            <a
              class="item"
              href="http://number-none.com/blow/blog/programming/2014/09/26/carmack-on-inlined-code.html"
              >John Carmack on Inlined Code</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-06 @ 16:47:18</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41758371"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41755303">
          <h3>
            <a
              class="item"
              href="https://kaiwenwang.com/writing/canvases-versus-documents"
              >Canvases versus Documents</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-06 @ 06:50:19</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41755303"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41749680">
          <h3>
            <a class="item" href="https://otterwiki.com/"
              >Otter Wiki: A minimalistic wiki powered by Python, Markdown and
              git</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-05 @ 13:28:29</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41749680"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41745798">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/science/2024/oct/03/teeth-as-time-capsules-soviet-secrets-and-my-dentist-grandmother"
              >Teeth as time capsules: Soviet secrets and my dentist
              grandmother</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-04 @ 21:36:12</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41745798"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41735871">
          <h3>
            <a
              class="item"
              href="https://www.abc.net.au/news/2024-10-04/robot-vacuum-hacked-photos-camera-audio/104414020"
              >ABC News hacks into popular robot vacuum, watches owner through
              camera</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-03 @ 22:43:05</span
              ><span class="points-container"
                >Points: <span class="points">274</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41735871"
                  >Comments</a
                ><span class="descendants">: 115</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
