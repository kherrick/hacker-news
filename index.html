<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="41058261">
          <h3>
            <a
              class="item"
              href="https://techcrunch.com/2024/07/24/crowdstrike-offers-a-10-apology-gift-card-to-say-sorry-for-outage/"
              >CrowdStrike offers a $10 apology gift card to say sorry for
              outage</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-24 @ 15:49:39</span
              ><span class="points-container"
                >Points: <span class="points">114</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41058261"
                  >Comments</a
                ><span class="descendants">: 49</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41058194">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/s41586-024-07566-y"
              >AI models collapse when trained on recursively generated data</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-24 @ 15:42:03</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41058194"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41058107">
          <h3>
            <a class="item" href="https://mistral.ai/news/mistral-large-2407/"
              >Large Enough – Mistral AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-24 @ 15:32:21</span
              ><span class="points-container"
                >Points: <span class="points">172</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41058107"
                  >Comments</a
                ><span class="descendants">: 91</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41057827">
          <h3>
            <a
              class="item"
              href="https://www.maximum-progress.com/p/ending-single-family-zoning-by-overturning"
              >End Mandatory Single Family Zoning by Overturning Euclid vs.
              Ambler</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-24 @ 15:04:30</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41057827"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41057814">
          <h3>
            <a
              class="item"
              href="https://www.sheshbabu.com/posts/visual-explanation-of-saml-authentication/"
              >Visual explanation of saml authentication</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-24 @ 15:02:57</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41057814"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41057766">
          <h3>
            <a class="item" href="https://interactivenn.net/index.html"
              >InteractiVenn – Interactive Venn Diagrams</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-24 @ 14:57:14</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41057766"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41057361">
          <h3>
            <a class="item" href="https://www.nber.org/papers/w32699"
              >How do you find a good manager?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-24 @ 14:16:30</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41057361"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41057302">
          <h3>
            <a
              class="item"
              href="https://symbl.ai/developers/blog/how-to-fine-tune-llama-3-for-customer-service/"
              >How to Fine-Tune Llama 3 for Customer Service</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-24 @ 14:10:04</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41057302"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41057289">
          <h3>
            <a
              class="item"
              href="https://gpuopen.com/learn/deep_learning_crash_course/"
              >Crash Course in Deep Learning (For Computer Graphics)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-24 @ 14:08:38</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41057289"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41057199">
          <h3>
            <a class="item" href="https://www.swyx.io/learn-in-public"
              >Learn in Public (2018)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-24 @ 13:59:02</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41057199"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41057033">
          <h3>
            <a
              class="item"
              href="https://www.404media.co/google-is-the-only-search-engine-that-works-on-reddit-now-thanks-to-ai-deal/"
              >Google is the only search engine that works on Reddit now thanks
              to AI deal</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-24 @ 13:41:22</span
              ><span class="points-container"
                >Points: <span class="points">162</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41057033"
                  >Comments</a
                ><span class="descendants">: 133</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41056463">
          <h3>
            <a
              class="item"
              href="https://news.mit.edu/2024/mit-researchers-advance-automated-interpretability-ai-models-maia-0723"
              >MIT researchers advance automated interpretability in AI
              models</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-24 @ 12:42:53</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41056463"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41056391">
          <h3>
            <a
              class="item"
              href="https://codewords.recurse.com/issues/three/algebra-and-calculus-of-algebraic-data-types"
              >The algebra (and calculus) of algebraic data types</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-24 @ 12:35:30</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41056391"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41056387">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/d41586-024-02383-9"
              >You got a null result. Will anyone publish it?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-24 @ 12:35:00</span
              ><span class="points-container"
                >Points: <span class="points">122</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41056387"
                  >Comments</a
                ><span class="descendants">: 81</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41053761">
          <h3>
            <a
              class="item"
              href="http://www.kohala.com/start/papers.others/doors.html"
              >"Doors" in Solaris: Lightweight RPC Using File Descriptors
              (1996)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-24 @ 05:02:30</span
              ><span class="points-container"
                >Points: <span class="points">97</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41053761"
                  >Comments</a
                ><span class="descendants">: 63</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41053201">
          <h3>
            <a
              class="item"
              href="https://github.com/trholding/llama2.c/blob/master/runq.c"
              >Llama 3.1 in C</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-24 @ 02:49:44</span
              ><span class="points-container"
                >Points: <span class="points">172</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41053201"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41052593">
          <h3>
            <a
              class="item"
              href="https://onlisp.co.uk/On-the-Origin-of-Emacs-in-1976.html"
              >The Origin of Emacs in 1976</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-24 @ 00:49:26</span
              ><span class="points-container"
                >Points: <span class="points">162</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41052593"
                  >Comments</a
                ><span class="descendants">: 60</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41052446">
          <h3>
            <a class="item" href="https://pnut.sh"
              >Pnut: A C to POSIX Shell Compiler you can Trust</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-24 @ 00:22:04</span
              ><span class="points-container"
                >Points: <span class="points">140</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41052446"
                  >Comments</a
                ><span class="descendants">: 86</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41052371">
          <h3>
            <a class="item" href="https://github.com/tekknolagi/scrapscript"
              >Scrapscript: A functional, content-addressable programming
              language</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-24 @ 00:08:21</span
              ><span class="points-container"
                >Points: <span class="points">165</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41052371"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41052365">
          <h3>
            <a
              class="item"
              href="https://martin.janiczek.cz/2024/07/23/taking-my-diabetes-treatment-into-my-own-hands.html"
              >Taking my diabetes treatment into my own hands (2024)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-24 @ 00:06:59</span
              ><span class="points-container"
                >Points: <span class="points">256</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41052365"
                  >Comments</a
                ><span class="descendants">: 177</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41050055">
          <h3>
            <a
              class="item"
              href="https://www.jhnewsandguide.com/the_hole_scroll/video-biscuit-basin-geyser-explodes-sending-yellowstone-tourists-packing/article_6862fda2-4923-11ef-b5c4-abdc9bc8cd83.html"
              >Hydrothermal explosion at Yellowstone National Park</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-23 @ 19:49:44</span
              ><span class="points-container"
                >Points: <span class="points">489</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41050055"
                  >Comments</a
                ><span class="descendants">: 254</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41049399">
          <h3>
            <a
              class="item"
              href="https://spectrum.ieee.org/motor-doping-cycling"
              >How Olympics officials try to catch “motor doping”</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-23 @ 18:43:51</span
              ><span class="points-container"
                >Points: <span class="points">207</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41049399"
                  >Comments</a
                ><span class="descendants">: 418</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41048707">
          <h3>
            <a
              class="item"
              href="https://www.chemistryworld.com/news/computer-program-paints-porphyrin-structures-in-the-style-of-famous-artist/4019839.article"
              >Computer program 'paints' porphyrin structures in the style of
              Piet Mondrian</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-23 @ 17:37:36</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41048707"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41048194">
          <h3>
            <a class="item" href="https://github.com/getomni-ai/zerox"
              >Show HN: Zerox – Document OCR with GPT-mini</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-23 @ 16:49:53</span
              ><span class="points-container"
                >Points: <span class="points">204</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41048194"
                  >Comments</a
                ><span class="descendants">: 84</span></span
              >
            </h4>
            <div class="text">
              <p>
                But this turned out to be better performing than our current
                implementation of Unstructured/Textract. At pretty much the same
                cost.
              </p>
              <p>
                I've tested almost every variant of document OCR over the past
                year, especially trying things like table / chart extraction.
                I've found the rules based extraction has always been lacking.
                Documents are meant to be a visual representation after all.
                With weird layouts, tables, charts, etc. Using a vision model
                just make sense!
              </p>
              <p>
                In general, I'd categorize this solution as slow, expensive, and
                non deterministic. But 6 months ago it was impossible. And 6
                months from now it'll be fast, cheap, and probably more
                reliable!
              </p>
            </div>
          </section>
        </section>
        <section id="41047110">
          <h3>
            <a class="item" href="https://punkx.org/unix-pipe-game/"
              >The Unix Pipe Card Game</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-23 @ 15:35:10</span
              ><span class="points-container"
                >Points: <span class="points">239</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41047110"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41046956">
          <h3>
            <a
              class="item"
              href="https://letsencrypt.org/2024/07/23/replacing-ocsp-with-crls.html"
              >Intent to end OCSP service</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-23 @ 15:25:14</span
              ><span class="points-container"
                >Points: <span class="points">369</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41046956"
                  >Comments</a
                ><span class="descendants">: 127</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41046773">
          <h3>
            <a
              class="item"
              href="https://about.fb.com/news/2024/07/open-source-ai-is-the-path-forward/"
              >Open source AI is the path forward</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-23 @ 15:08:41</span
              ><span class="points-container"
                >Points: <span class="points">2198</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41046773"
                  >Comments</a
                ><span class="descendants">: 829</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41045834">
          <h3>
            <a class="item" href="https://briefer.cloud/launches/notebooks/"
              >Show HN: Briefer – Multiplayer notebooks with schedules, SQL, and
              built-in LLMs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-23 @ 13:30:32</span
              ><span class="points-container"
                >Points: <span class="points">227</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41045834"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
            <div class="text">
              <p>
                Our notebooks are kind of a mix between Notion and Jupyter with
                extra features, like the ability to schedule notebooks, turn
                them into dashboards and apps, and write SQL queries whose
                results turn into data frames automatically.
              </p>
              <p>
                We're building better notebooks because we think they're a great
                idea poorly executed - for three reasons.
              </p>
              <p>
                The first problem with notebooks is that they're difficult to
                share. Non-technical people don't want to download docker
                containers and install Python libraries to see what the data
                team is doing. Then, the data team takes screenshots of their
                work and pastes them somewhere else. The issue with this
                approach is that the data gets stale, and the output is not
                interactive, so it's difficult to get feedback and iterate.
              </p>
              <p>
                The second problem with notebooks is that they get too messy too
                quickly. One morning you have 10 blocks, and by the end of the
                day you have 192, but only six of them are meant to be seen by
                other people and the rest is just you jiu-jitsuing with the
                data. Consequently, even if non-technical people could see your
                work, they'd have a hard time figuring out what's happening.
              </p>
              <p>
                The third problem with notebooks is that it takes too much work
                to do simple things like when you want to query a database. In
                that case, you need to have the database credentials in your
                machine, and you have to write a bunch of wrapper code. Calling
                APIs, plotting simple graphs, and adding interactive components
                is equally as annoying.
              </p>
              <p>
                We're solving the sharing problem by bringing notebooks to the
                cloud (so you can schedule them) and using CRDTs to manage their
                state. Whenever you edit a Briefer notebook, we reconcile that
                using Yjs, and then propagate it to everyone else who's editing
                that notebook. Regarding compute instances, each workspace gets
                its own, and we provision them on demand.
              </p>
              <p>
                By the way, we manage the execution state of your blocks using
                Yjs too, which makes it much more stable and responsive across
                all clients. When you click "run", for example, we don't
                immediately send a request to run the block. Instead, we change
                the block's state to "execution-requested". Then, the observers
                in the back-end react to the change and update the block's state
                with the results. In other words, the front end and the server
                communicate with each other through the notebook's state. One
                side updates the state, and the other reacts.
              </p>
              <p>
                To solve the "messiness" issue, we've invested a lot of time in
                designing clean notebooks and allowing you to organize blocks in
                ways that make them more presentable. In Briefer, you can group
                multiple blocks into tabs and decide which blocks appear in the
                published version of your notebook. That way, you can hide all
                that data wrangling and focus on results. We also know that a
                vertical format is not always the best way to display results,
                so you can use your notebook's outputs to build dashboards too.
              </p>
              <p>
                Last but not least, we're reducing friction in simple tasks like
                plotting graphs and querying databases. In Briefer, you can plot
                graphs using a click-through interface, and if you need to plot
                something more intricate like a Sankey chart there's also a
                built-in AI assistant that you can prompt to generate code. When
                it comes to queries, we turn their results into dataframes
                automatically, and you can use SQL to query uploaded files too
                (we use DuckDB for that).
              </p>
              <p>
                We're really happy we get to show this to you all, thank you for
                reading about it! Please let us know your thoughts and questions
                in the comments.
              </p>
            </div>
          </section>
        </section>
        <section id="41034297">
          <h3>
            <a
              class="item"
              href="https://d-star.ai/solving-the-out-of-context-chunk-problem-for-rag"
              >Solving the out-of-context chunk problem for RAG</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-22 @ 13:44:19</span
              ><span class="points-container"
                >Points: <span class="points">130</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41034297"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41012854">
          <h3>
            <a class="item" href="https://www.nasa.gov/history/alsj/main.html"
              >Apollo Lunar Surface Journal</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-20 @ 00:15:13</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41012854"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
