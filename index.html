<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="39562506">
          <h3>
            <a
              class="item"
              href="https://www.rollingstone.com/culture/culture-features/anti-trans-legislation-the-south-trans-kids-risk-1234977946/"
              >Anti-Trans Legislation in the South Is Putting Trans Kids at
              Risk</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-01 @ 15:13:31</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39562329">
          <h3>
            <a
              class="item"
              href="https://medium.com/@zaam.oussama/keycloak-modern-authentication-and-access-management-4c17976e4303"
              >Keycloak: Modern Authentication and Access Management</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-01 @ 14:55:23</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39562329"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39562231">
          <h3>
            <a
              class="item"
              href="https://jamesg.blog/2024/02/28/programming-projects/"
              >Challenging programming projects you should try</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-01 @ 14:42:57</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39562231"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39562114">
          <h3>
            <a
              class="item"
              href="https://7ctos.substack.com/p/you-too-can-should-be-a-fractional"
              >You too can (should) be a Fractional CTO</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-01 @ 14:30:42</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39562114"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39561799">
          <h3>
            <a
              class="item"
              href="https://www.brendangregg.com/ColonyGraphs/cloud.html"
              >Colony Graphs: Visualizing the Cloud</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-01 @ 13:57:30</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39561799"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39561656">
          <h3>
            <a
              class="item"
              href="https://academic.oup.com/mnras/article/528/4/6568/7596572"
              >Seismology of rubble-pile asteroids in binary systems</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-01 @ 13:41:30</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39561656"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39561594">
          <h3>
            <a class="item" href="https://jsr.io"
              >JSR: The JavaScript Registry</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-01 @ 13:33:23</span
              ><span class="points-container"
                >Points: <span class="points">125</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39561594"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39561492">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2024/03/01/science/daddy-long-legs-eyes.html"
              >A daddy-longlegs possesses six eyes, including two vestigial
              pairs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-01 @ 13:21:19</span
              ><span class="points-container"
                >Points: <span class="points">56</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39561492"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39561356">
          <h3>
            <a
              class="item"
              href="https://www.wabe.org/the-atlanta-magnet-man-is-saving-our-car-tires-one-bike-ride-at-a-time/"
              >The 'Atlanta Magnet Man' is saving our car tires, one bike ride
              at a time</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-01 @ 13:01:50</span
              ><span class="points-container"
                >Points: <span class="points">119</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39561356"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39561021">
          <h3>
            <a class="item" href="https://theins.ru/en/politics/269612"
              >Fugitive Wirecard COO Jan Marsalek exposed as decade-long GRU
              spy</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-01 @ 12:13:31</span
              ><span class="points-container"
                >Points: <span class="points">228</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39561021"
                  >Comments</a
                ><span class="descendants">: 75</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39560887">
          <h3>
            <a
              class="item"
              href="https://www.mistys-internet.website/blog/blog/2024/03/01/that-time-i-accidentally-deleted-a-game-from-mame/"
              >I Accidentally Deleted a Game from MAME</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-01 @ 11:51:11</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39560887"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39560862">
          <h3>
            <a
              class="item"
              href="https://cgad.ski/blog/where-is-noethers-principle-in-machine-learning.html"
              >Where Is Noether's Principle in Machine Learning?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-01 @ 11:47:30</span
              ><span class="points-container"
                >Points: <span class="points">73</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39560862"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39560509">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=39560509"
              >Ask HN: What AI assistants are already bundled for Linux?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-01 @ 10:38:31</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39560509"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
            <div class="text">
              <p>
                Or anything which is free (at least as in beer) and readily
                bundled in distro-specific installation packages?
              </p>
            </div>
          </section>
        </section>
        <section id="39560250">
          <h3>
            <a
              class="item"
              href="https://jobs.lever.co/photoroom/fb70ca3c-632f-4b1b-b6e2-004f0240011d?lever-origin=applied&amp;lever-source%5B%5D=yc"
              >Photoroom (YC S20) Is Hiring a Frontend State Architect in Paris
              (Mobx, React)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-01 @ 09:50:20</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39560180">
          <h3>
            <a
              class="item"
              href="https://lamplightdev.com/blog/2024/01/10/streaming-html-out-of-order-without-javascript/"
              >Streaming HTML out of order without JavaScript</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-01 @ 09:37:08</span
              ><span class="points-container"
                >Points: <span class="points">110</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39560180"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39559411">
          <h3>
            <a
              class="item"
              href="https://cacm.acm.org/news/cacm-is-now-open-access-2/"
              >CACM Is Now Open Access</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-01 @ 07:19:15</span
              ><span class="points-container"
                >Points: <span class="points">233</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39559411"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39559281">
          <h3>
            <a
              class="item"
              href="https://cloudinary.com/blog/jpeg-xl-and-the-pareto-front"
              >JPEG XL and the Pareto Front</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-01 @ 06:55:59</span
              ><span class="points-container"
                >Points: <span class="points">295</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39559281"
                  >Comments</a
                ><span class="descendants">: 174</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39557188">
          <h3>
            <a
              class="item"
              href="https://struct.ai/blog/introducing-the-struct-chat-platform"
              >Show HN: Struct – A Feed-Centric Chat Platform</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-01 @ 00:49:07</span
              ><span class="points-container"
                >Points: <span class="points">260</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39557188"
                  >Comments</a
                ><span class="descendants">: 120</span></span
              >
            </h4>
            <div class="text">
              <p>
                At Struct, we're frustrated by the clutter, distractions, and
                inefficiencies plaguing existing chat platforms like Slack and
                Discord.
              </p>
              <p>
                We've built a radical new chat platform that leverages threads,
                feeds, and AI to help alleviate these problems, and give you
                back more time in your day.
              </p>
              <p>
                Struct uses a thread-first approach to keep conversations
                on-topic. It applies AI-generated titles and summaries to help
                you decide what's worth your attention. Threads are then
                organized in a real-time feed, keeping all your conversations
                up-to-date and at the ready, eliminating the need for channel
                hopping.
              </p>
              <p>
                Comprehensive search tools make finding things a breeze, and
                Strucbot, our AI assistant can answer questions based on what
                it’s learned from prior threads. It can even proactively respond
                when it notices repeat requests, providing quick answers so you
                don’t have to. Structbot is fully GPT-4 enabled, so you can riff
                with Chat GPT and your peers (generate code, ask questions, all
                the good stuff) without ever switching apps.
              </p>
              <p>
                Struct is available on Linux, Windows, Mac, and even works as a
                Slack interface. Give us a try and let us know what you think.
              </p>
            </div>
          </section>
        </section>
        <section id="39557098">
          <h3>
            <a
              class="item"
              href="https://apps.apple.com/us/app/offlinellm/id6478590762"
              >Show HN: OfflineLLM – a Vision Pro app running TinyLlama on
              device</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-01 @ 00:33:23</span
              ><span class="points-container"
                >Points: <span class="points">109</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39557098"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
            <div class="text">
              Hey, I built this in a day while at Founders Inc Apple Vision Pro
              residency. Try it out, let me know what you think.
            </div>
          </section>
        </section>
        <section id="39556956">
          <h3>
            <a
              class="item"
              href="https://www.adamgrant.info/tiny-predictive-text"
              >Show HN: Predictive text using only 13kb of JavaScript. no LLM</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-03-01 @ 00:11:39</span
              ><span class="points-container"
                >Points: <span class="points">124</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39556956"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39553967">
          <h3>
            <a
              class="item"
              href="https://vickiboykis.com/2024/02/28/gguf-the-long-way-around/"
              >GGUF, the Long Way Around</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-29 @ 19:36:44</span
              ><span class="points-container"
                >Points: <span class="points">221</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39553967"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39548403">
          <h3>
            <a
              class="item"
              href="https://hakaimagazine.com/features/the-butterfly-redemption/"
              >The Butterfly Redemption</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-29 @ 12:17:34</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39548403"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39548130">
          <h3>
            <a class="item" href="https://github.com/Eventual-Inc/Daft"
              >Daft: Distributed DataFrame for Python</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-29 @ 11:40:18</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39548130"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39548050">
          <h3>
            <a
              class="item"
              href="https://ff8isthe.best/2024/02/the-game-magazine-that-spent-two-years-taunting-a-final-fantasy-viii-hater/"
              >The game magazine that spent two years taunting a Final Fantasy
              VIII hater</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-29 @ 11:10:55</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39548050"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39547971">
          <h3>
            <a
              class="item"
              href="https://www.collabora.com/news-and-blog/news-and-events/nvk-is-now-ready-for-prime-time.html"
              >NVK is now ready for prime time</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-29 @ 10:31:35</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39547971"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39547355">
          <h3>
            <a
              class="item"
              href="https://nicf.net/articles/curvature-of-polyhedra/"
              >Curvature of Polyhedra (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-29 @ 08:09:54</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39547355"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39547332">
          <h3>
            <a
              class="item"
              href="https://tratt.net/laurie/blog/2024/some_reflections_on_writing_unix_daemons.html"
              >Some Reflections on Writing Unix Daemon</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-29 @ 08:05:28</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39547332"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39546968">
          <h3>
            <a
              class="item"
              href="https://www.smithsonianmag.com/travel/via-ferratas-are-finally-catching-on-in-the-united-states-180983855/"
              >Via ferratas are finally catching on in the United States</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-29 @ 06:48:43</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39546968"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39546497">
          <h3>
            <a
              class="item"
              href="https://www.historytoday.com/archive/out-margins/beware-lides-march"
              >Beware the Lides of March</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-29 @ 04:53:09</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39546497"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39544498">
          <h3>
            <a
              class="item"
              href="https://en.wikipedia.org/wiki/Antarctic_English"
              >Antarctic English</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-28 @ 22:48:51</span
              ><span class="points-container"
                >Points: <span class="points">327</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39544498"
                  >Comments</a
                ><span class="descendants">: 138</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
