<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="41790295">
          <h3>
            <a class="item" href="https://www.dookiedemastered.com/"
              >DookieDemastered: The punk album re-exploded onto
              obscure/obsolete formats</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-09 @ 17:18:19</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41790295"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41790113">
          <h3>
            <a
              class="item"
              href="https://jobs.ashbyhq.com/motion/f1a2ebd8-c390-4d23-89e7-519979f4630b?utm_source=hn"
              >Motion (YC W20) is hiring our first customer success manager</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-09 @ 17:00:41</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41790026">
          <h3>
            <a
              class="item"
              href="https://www.ft.com/content/5649b66e-fdb3-46d3-84e0-23e33bdaf363"
              >OpenAI pursues public benefit structure to fend off hostile
              takeovers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-09 @ 16:53:02</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41790026"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41789277">
          <h3>
            <a
              class="item"
              href="https://www.newsweek.com/brain-changes-neuroscience-exercise-sleep-health-two-weeks-1965107"
              >Your Brain Changes Based on What You Did Two Weeks Ago</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-09 @ 15:51:58</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41789277"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41789242">
          <h3>
            <a
              class="item"
              href="https://www.arnaldur.be/writing/about/an-n-ball-between-n-balls"
              >An n-ball Between n-balls</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-09 @ 15:50:00</span
              ><span class="points-container"
                >Points: <span class="points">112</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41789242"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41788246">
          <h3>
            <a class="item" href="https://itineraries.io"
              >Show HN: Itineraries.io – I built a joint trip planner in between
              surgeries</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-09 @ 14:19:47</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41788246"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
            <div class="text">
              <p>
                For the last several weeks, I have just been sleeping, eating,
                operating and developing itineraries.io. Rinse and repeat.
              </p>
              <p>
                I work as a surgeon in the UK. My main other passions are travel
                and programming. Recently, when I haven't been stitching someone
                up, I've been working on my project.
              </p>
              <p>
                Having always dreamed of exploring the world as a child, I
                struck a goldmine when I found a wife who shared the same love
                of adventure as me. We couldn't afford to travel much when we
                first met at university. Over the last couple of years, since
                both entering the workforce, we have been able to live out some
                of our dreams. It has been wonderful. We now have a little one
                coming along and I can't wait to adventure as a family.
              </p>
              <p>
                I created itineraries.io because my wife and I usually rely on
                making Excel spreadsheets for our travels. These eventually
                become quite detailed. I thought a better user experience could
                be designed, and a community could grow from it centred around
                adventure.
              </p>
              <p>
                Here are the main benefits I envision of using itineraires.io:
              </p>
              <p>
                - Everything you need for your trip stored in one location
                (tickets, driving directions, travel documents, etc)
              </p>
              <p>
                - Collaborative planning: plan your trip with your companions by
                sending a joining link via email
              </p>
              <p>
                - Community: save your favourite itineraries made by others,
                clone them with a single click, and make them your own
              </p>
              <p>I'd love to hear your thoughts and feedback :)</p>
              <p>Samar</p>
            </div>
          </section>
        </section>
        <section id="41788026">
          <h3>
            <a
              class="item"
              href="https://discuss.python.org/t/pep-760-no-more-bare-excepts/67182"
              >PEP 760: No more bare excepts</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-09 @ 13:54:41</span
              ><span class="points-container"
                >Points: <span class="points">124</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41788026"
                  >Comments</a
                ><span class="descendants">: 239</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41787967">
          <h3>
            <a
              class="item"
              href="https://news.mongabay.com/2024/10/for-ranchers-in-costa-rica-jaguars-and-pumas-become-unexpected-allies/"
              >For ranchers in Costa Rica, jaguars and pumas become unexpected
              allies</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-09 @ 13:50:07</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41787967"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41787647">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/world/2024/oct/07/germany-influence-of-english-idiots-apostrophe"
              >Germans decry influence of English as 'idiot's apostrophe' gets
              approval</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-09 @ 13:16:55</span
              ><span class="points-container"
                >Points: <span class="points">135</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41787647"
                  >Comments</a
                ><span class="descendants">: 321</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41786101">
          <h3>
            <a
              class="item"
              href="https://www.nobelprize.org/prizes/chemistry/2024/press-release/"
              >Chemistry Nobel: Computational protein design and protein
              structure prediction</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-09 @ 09:54:38</span
              ><span class="points-container"
                >Points: <span class="points">421</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41786101"
                  >Comments</a
                ><span class="descendants">: 227</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41785511">
          <h3>
            <a class="item" href="https://github.com/alebeck/boring"
              >Show HN: I made an SSH tunnel manager to learn Go</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-09 @ 07:52:24</span
              ><span class="points-container"
                >Points: <span class="points">152</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41785511"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41784591">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2410.00907"
              >Addition Is All You Need for Energy-Efficient Language Models</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-09 @ 04:47:40</span
              ><span class="points-container"
                >Points: <span class="points">254</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41784591"
                  >Comments</a
                ><span class="descendants">: 79</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41784287">
          <h3>
            <a
              class="item"
              href="https://www.ft.com/content/f6e84608-e0e5-48c5-a0eb-dde7675fb608"
              >US weighs Google break-up in landmark antitrust case</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-09 @ 03:39:50</span
              ><span class="points-container"
                >Points: <span class="points">162</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41784287"
                  >Comments</a
                ><span class="descendants">: 211</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41784069">
          <h3>
            <a
              class="item"
              href="https://forum.makemkv.com/forum/viewtopic.php?t=18856"
              >What Is LibreDrive (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-09 @ 02:58:39</span
              ><span class="points-container"
                >Points: <span class="points">133</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41784069"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41781777">
          <h3>
            <a
              class="item"
              href="https://entropicthoughts.com/practices-of-reliable-software-design"
              >Practices of Reliable Software Design</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-08 @ 21:01:22</span
              ><span class="points-container"
                >Points: <span class="points">192</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41781777"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41780929">
          <h3>
            <a
              class="item"
              href="https://chipsandcheese.com/p/lunar-lakes-igpu-debut-of-intels"
              >Lunar Lake's iGPU: Debut of Intel's Xe2 Architecture</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-08 @ 19:32:37</span
              ><span class="points-container"
                >Points: <span class="points">120</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41780929"
                  >Comments</a
                ><span class="descendants">: 57</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41780569">
          <h3>
            <a
              class="item"
              href="https://sherwood.news/power/who-died-and-left-the-us-7-billion-fayez-sarofim/"
              >Who died and left the US $7B?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-08 @ 18:58:26</span
              ><span class="points-container"
                >Points: <span class="points">360</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41780569"
                  >Comments</a
                ><span class="descendants">: 369</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41780297">
          <h3>
            <a class="item" href="https://player.style"
              >Show HN: Winamp and other media players, rebuilt for the web with
              Web Components</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-08 @ 18:27:46</span
              ><span class="points-container"
                >Points: <span class="points">361</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41780297"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
            <div class="text">
              <p>
                I know Web Components are in a bit of a drama cycle right now.
                I’m happy to see them get any attention really. I’ve been pretty
                bullish on them since ~2013 when I started working with them, at
                least in the context of a <i>widget</i> like a video player.
                I’ve even given many related talks on them like this one (<a
                  href="https://www.youtube.com/watch?v=N6Mh84SRoDg"
                  >https://www.youtube.com/watch?v=N6Mh84SRoDg</a
                >).
              </p>
              <p>
                I would never push them for a large app or as a full replacement
                for React, but they’ve been incredible for making video players
                that are compatible across many contexts, and Player.style is a
                clear demonstration of that when you get to the step of
                embedding a theme. Web components really shine for building bits
                of UI that can be shared between projects. They also are the
                best way to avoid the long term JS framework thrash that’s a
                challenge for any developer who works on the web for long
                enough. One of the best decisions I ever made for Video.js was
                to <i>not</i> build it with jQuery. Video.js is 15 years old now
                and still in use, while all the jQuery players are not.
              </p>
              <p>
                For some added context of this project, when I was building
                Video.js back in 2010 I put a lot of thought into how other
                developers would customize the player controls. I was excited to
                use web technologies (instead of Flash) to build a player and I
                <i>knew</i> other web devs would be too.
              </p>
              <p>
                Fast forward 14 years — Video.js has been used on millions of
                websites including Twitter, Instagram, Amazon, Dropbox, Linkedin
                and even in United Airlines headrests. In 99.99% of those cases
                the default Video.js controls were used with little to no
                customization. So…huge adoption success, utter failure in
                sparking creativity. In retrospect, asking people to learn a new
                UI framework just to style their player was too much.
              </p>
              <p>
                Media Chrome and Player.style are my answer to that friction.
              </p>
              <p>
                - Media Chrome - A suite of Web Components and React Components
                that let you easily build a media player UI from scratch, using
                components you’re already familiar with.
              </p>
              <p>
                - Player.stye - Themes built with Media Chrome, showing the
                cross-player and cross-framework flexibility of Media Chrome
              </p>
              <p>
                Media Chrome is already used on sites like TED.com, Syntax.fm,
                and anywhere the Mux Player is used. We’ve spent the last few
                months building some great themes for Player.style. I probably
                had the most fun recreating the Youtube icon animations from
                scratch using SVGs and CSS. (Whoever made the originals, nicely
                done!)
              </p>
              <p>
                It’s all free and open source, so don’t hesitate to jump in if
                you’re interested in the project. And of course I’m happy to
                answer any questions.
              </p>
            </div>
          </section>
        </section>
        <section id="41779576">
          <h3>
            <a
              class="item"
              href="https://blog.jgc.org/2024/10/rabbit-hole-stumbling-across-two.html"
              >Rabbit hole: stumbling across two Portuguese punched cards</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-08 @ 17:19:18</span
              ><span class="points-container"
                >Points: <span class="points">173</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41779576"
                  >Comments</a
                ><span class="descendants">: 57</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41779519">
          <h3>
            <a
              class="item"
              href="https://nullonerror.org/2024/10/08/my-first-game-with-carimbo/"
              >My first game with Carimbo, my homemade engine</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-08 @ 17:13:16</span
              ><span class="points-container"
                >Points: <span class="points">277</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41779519"
                  >Comments</a
                ><span class="descendants">: 147</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41776878">
          <h3>
            <a
              class="item"
              href="https://blog.eriksen.com.br/en/introducing-kotlin-money"
              >Show HN: Kotlin Money</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-08 @ 12:59:52</span
              ><span class="points-container"
                >Points: <span class="points">408</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41776878"
                  >Comments</a
                ><span class="descendants">: 213</span></span
              >
            </h4>
            <div class="text">
              <p>
                Inspired by my days at N26 Brasil dealing with these challenges,
                I introduce Money: a Kotlin library that makes monetary
                calculations and allocations easy.
              </p>
            </div>
          </section>
        </section>
        <section id="41766087">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/s41378-021-00240-7"
              >Multilayer microhydraulic actuators with speed and force
              configurations (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-07 @ 13:58:25</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41766087"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41765127">
          <h3>
            <a class="item" href="https://luckymike.dev/posts/warm-handoffs/"
              >Warm Handoffs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-07 @ 11:59:11</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41765127"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41764465">
          <h3>
            <a
              class="item"
              href="https://cacm.acm.org/research/50-years-of-queries/"
              >50 Years of Queries</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-07 @ 10:08:32</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41764465"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41764095">
          <h3>
            <a
              class="item"
              href="https://kimray.com/training/how-gas-compressor-station-works"
              >How a Gas Compressor Station Works</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-07 @ 09:05:36</span
              ><span class="points-container"
                >Points: <span class="points">77</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41764095"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41761409">
          <h3>
            <a
              class="item"
              href="https://news.artnet.com/art-world-archives/gustav-klimt-gold-2543498"
              >The Surprising Backstory Behind Gustav Klimt's Obsession with
              Gold</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-06 @ 23:52:43</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41761409"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41760503">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2024-09-augmented-reality-displays-eyeglasses.html"
              >Shrinking augmented reality displays into eyeglasses to expand
              their use</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-06 @ 21:31:36</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41760503"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41758371">
          <h3>
            <a
              class="item"
              href="http://number-none.com/blow/blog/programming/2014/09/26/carmack-on-inlined-code.html"
              >John Carmack on inlined code (2014)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-06 @ 16:47:18</span
              ><span class="points-container"
                >Points: <span class="points">410</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41758371"
                  >Comments</a
                ><span class="descendants">: 259</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41749680">
          <h3>
            <a class="item" href="https://otterwiki.com/"
              >Otter Wiki: A minimalistic wiki powered by Python, Markdown and
              git</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-05 @ 13:28:29</span
              ><span class="points-container"
                >Points: <span class="points">192</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41749680"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41745798">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/science/2024/oct/03/teeth-as-time-capsules-soviet-secrets-and-my-dentist-grandmother"
              >Teeth as time capsules: Soviet secrets and my dentist
              grandmother</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-10-04 @ 21:36:12</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41745798"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
