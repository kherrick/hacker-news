<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="45111909">
          <h3>
            <a
              class="item"
              href="https://www.printables.com/model/441233-comic-sans-typeball-for-the-ibm-selectric-typewrit"
              >Comic Sans typeball designed to work with the IBM Selectric
              typewriters</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-03 @ 03:13:05</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45111909"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45111405">
          <h3>
            <a class="item" href="https://ziglang.org/news/2025-financials/"
              >Zig Software Foundation 2025 Financial Report and Fundraiser</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-03 @ 01:45:47</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45111405"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45110748">
          <h3>
            <a
              class="item"
              href="https://github.com/Tortured-Metaphor/LightCycle"
              >Show HN: LightCycle, a FOSS game in Rust based on Tron</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-03 @ 00:08:54</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45110748"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45110688">
          <h3>
            <a
              class="item"
              href="https://www.brendanlong.com/cpu-utilization-is-a-lie.html"
              >%CPU utilization is a lie</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-03 @ 00:01:02</span
              ><span class="points-container"
                >Points: <span class="points">194</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45110688"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45110386">
          <h3>
            <a
              class="item"
              href="https://joegm.github.io/blog/indices-not-pointers/"
              >Indices, not Pointers</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-02 @ 23:21:30</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45110386"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45110209">
          <h3>
            <a
              class="item"
              href="https://blog.ctms.me/posts/2024-08-29-running-this-blog-on-a-pixel-5/"
              >This blog is running on a recycled Google Pixel 5 (2024)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-02 @ 22:58:23</span
              ><span class="points-container"
                >Points: <span class="points">161</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45110209"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45108548">
          <h3>
            <a
              class="item"
              href="https://www.cnbc.com/2025/09/02/google-antitrust-search-ruling.html"
              >Google can keep its Chrome browser but will be barred from
              exclusive contracts</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-02 @ 20:26:47</span
              ><span class="points-container"
                >Points: <span class="points">639</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45108548"
                  >Comments</a
                ><span class="descendants">: 402</span></span
              >
            </h4>
            <div class="text">
              <a
                href="https://storage.courtlistener.com/recap/gov.uscourts.dcd.223205/gov.uscourts.dcd.223205.1436.0_1.pdf"
                >https://storage.courtlistener.com/recap/gov.uscourts.dcd.223...</a
              >
            </div>
          </section>
        </section>
        <section id="45108066">
          <h3>
            <a
              class="item"
              href="https://dgross.ca/blog/linux-home-server-auto-sleep"
              >Making a Linux home server sleep on idle and wake on demand
              (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-02 @ 19:42:48</span
              ><span class="points-container"
                >Points: <span class="points">186</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45108066"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45107962">
          <h3>
            <a
              class="item"
              href="https://www.sanity.io/blog/first-attempt-will-be-95-garbage"
              >A staff engineer's journey with Claude Code</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-02 @ 19:34:24</span
              ><span class="points-container"
                >Points: <span class="points">320</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45107962"
                  >Comments</a
                ><span class="descendants">: 198</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45106981">
          <h3>
            <a
              class="item"
              href="https://openai.com/index/vijaye-raji-to-become-cto-of-applications-with-acquisition-of-statsig/"
              >Vijaye Raji to become CTO of Applications with acquisition of
              Statsig</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-02 @ 18:18:10</span
              ><span class="points-container"
                >Points: <span class="points">156</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45106981"
                  >Comments</a
                ><span class="descendants">: 60</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45106846">
          <h3>
            <a class="item" href="https://imadr.me/pbr/"
              >Physically based rendering from first principles</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-02 @ 18:07:22</span
              ><span class="points-container"
                >Points: <span class="points">185</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45106846"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45106314">
          <h3>
            <a
              class="item"
              href="https://blog.adacore.com/introduction-to-ada-a-project-based-exploration-with-rosettas"
              >Introduction to Ada: a project-based exploration with rosettas</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-02 @ 17:32:08</span
              ><span class="points-container"
                >Points: <span class="points">165</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45106314"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45106189">
          <h3>
            <a
              class="item"
              href="https://tonybaloney.github.io/posts/why-isnt-python-async-more-popular.html"
              >Python has had async for 10 years – why isn't it more popular?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-02 @ 17:24:57</span
              ><span class="points-container"
                >Points: <span class="points">262</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45106189"
                  >Comments</a
                ><span class="descendants">: 242</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45106049">
          <h3>
            <a
              class="item"
              href="https://developer.mozilla.org/en-US/docs/Web/HTML/Reference/Elements/template"
              >: The Content Template element</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-02 @ 17:16:42</span
              ><span class="points-container"
                >Points: <span class="points">178</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45106049"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45105710">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/world-models-an-old-idea-in-ai-mount-a-comeback-20250902/"
              >'World Models,' an old idea in AI, mount a comeback</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-02 @ 16:53:29</span
              ><span class="points-container"
                >Points: <span class="points">164</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45105710"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45104974">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=45104974"
              >Launch HN: Datafruit (YC S25) – AI for DevOps</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-02 @ 16:08:31</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45104974"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
            <div class="text">
              <a href="https://datafruit.dev/">https://datafruit.dev/</a>), an
              AI DevOps agent. We’re like Devin for DevOps. You can ask
              Datafruit to check your cloud spend, look for loose security
              policies, make changes to your IaC, and it can reason across your
              deployment standards, design docs, and DevOps practices.
              <p>
                Demo video:
                <a href="https://www.youtube.com/watch?v=2FitSggI7tg"
                  >https://www.youtube.com/watch?v=2FitSggI7tg</a
                >.
              </p>
              <p>
                Right now, we have two main methods to interact with Datafruit:
              </p>
              <p>
                (1) automated infrastructure audits— agents periodically scan
                your environment to find cost optimization opportunities, detect
                infrastructure drift, and validate your infra against compliance
                requirements.
              </p>
              <p>
                (2) chat interface (available as a web UI and through slack) —
                ask the agent questions for real-time insights, or assign tasks
                directly, such as investigating spend anomalies, reviewing
                security posture, or applying changes to IaC resources.
              </p>
              <p>
                Working at FAANG and various high-growth startups, we realized
                that infra work requires an enormous amount of context, often
                more than traditional software engineering. The business
                decisions, codebase, and cloud itself are all extremely
                important in any task that has been assigned. To maximize the
                success of the agents, we do a fair amount of context
                engineering. Not hallucinating is super important!
              </p>
              <p>
                One thing which has worked incredibly well for us is a
                multi-agent system where we have specialized sub-agents with
                access to specific tool calls and documentation for their
                specialty. Agents choose to “handoff” to each other when they
                feel like another agent would be more specialized for the task.
                However, all agents share the same context (<a
                  href="https://cognition.ai/blog/dont-build-multi-agents"
                  >https://cognition.ai/blog/dont-build-multi-agents</a
                >). We’re pretty happy with this approach, and believe it could
                work in other disciplines which require high amounts of
                specialized expertise.
              </p>
              <p>
                Infrastructure is probably the most mission-critical part of any
                software organization, and needs extremely heavy guardrails to
                keep it safe. Language models are not yet at the point where
                they can be trusted to make changes (we’ve talked to a couple of
                startups where the Claude Code + AWS CLI combo has taken their
                infra down). Right now, Datafruit receives read-only access to
                your infrastructure and can only make changes through pull
                requests to your IaC repositories. The agent also operates in a
                sandboxed virtual environment so that it could not write cloud
                CLI commands if it wanted to!
              </p>
              <p>
                Where LLMs <i>can</i> add significant value is in reducing the
                constant operational inefficiencies that eat up cloud spend and
                delay deadlines—the small-but-urgent ops work. Once Datafruit
                indexes your environment, you can ask it to do things like:
              </p>
              <p></p>
              <pre><code>  "Grant @User write access to analytics S3 bucket for 24 hours"
    -&gt; Creates temporary IAM role, sends least-privilege credentials, auto-revokes tomorrow

  "Find where this secret is used so I can rotate it without downtime"
    -&gt; Discovers all instances of your secret, including old cron-jobs you might not know about, so you can safely rotate your keys


  "Why did database costs spike yesterday?"
    -&gt; Identifies expensive queries, shows optimization options, implements fixes

</code></pre>
              We charge a straightforward subscription model for a managed
              version, but we also offer a bring-your-own-cloud model. All of
              Datafruit can be deployed on Kubernetes using Helm charts for
              enterprise customers where data can’t leave your VPC. For the time
              being, we’re installing the product ourselves on customers'
              clouds. It doesn’t exist in a self-serve form yet. We’ll get there
              eventually, but in the meantime if you’re interested we’d love for
              you guys to email us at founders@datafruit.dev.
              <p>
                We would love to hear your thoughts! If you work with cloud
                infra, we are especially interested in learning about what kinds
                of work you do which you wish could be offloaded onto an agent.
              </p>
            </div>
          </section>
        </section>
        <section id="45104907">
          <h3>
            <a
              class="item"
              href="https://www.anthropic.com/news/anthropic-raises-series-f-at-usd183b-post-money-valuation"
              >Anthropic raises $13B Series F</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-02 @ 16:04:15</span
              ><span class="points-container"
                >Points: <span class="points">530</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45104907"
                  >Comments</a
                ><span class="descendants">: 531</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45104303">
          <h3>
            <a
              class="item"
              href="https://hamatti.org/posts/static-sites-enable-a-good-time-travel-experience/"
              >Static sites enable a good time travel experience</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-02 @ 15:25:44</span
              ><span class="points-container"
                >Points: <span class="points">163</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45104303"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45104289">
          <h3>
            <a
              class="item"
              href="https://en.wikipedia.org/wiki/The_staff_ate_it_later"
              >The staff ate it later</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-02 @ 15:24:48</span
              ><span class="points-container"
                >Points: <span class="points">240</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45104289"
                  >Comments</a
                ><span class="descendants">: 130</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45103436">
          <h3>
            <a
              class="item"
              href="https://github.com/the-litte-book-of/linear-algebra"
              >The Little Book of Linear Algebra</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-02 @ 14:17:07</span
              ><span class="points-container"
                >Points: <span class="points">340</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45103436"
                  >Comments</a
                ><span class="descendants">: 91</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45102512">
          <h3>
            <a class="item" href="https://dynomight.net/liking/"
              >Take something you don’t like and try to like it</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-02 @ 12:56:37</span
              ><span class="points-container"
                >Points: <span class="points">193</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45102512"
                  >Comments</a
                ><span class="descendants">: 153</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45101779">
          <h3>
            <a
              class="item"
              href="https://www.worksinprogress.news/p/torontos-underground-labyrinth"
              >Toronto’s network of pedestrian tunnels</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-02 @ 11:44:14</span
              ><span class="points-container"
                >Points: <span class="points">197</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45101779"
                  >Comments</a
                ><span class="descendants">: 146</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45092967">
          <h3>
            <a class="item" href="https://github.com/gethopp/hopp"
              >Show HN: We built an open-source alternative to expensive pair
              programming apps</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-01 @ 14:36:11</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45092967"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
            <div class="text">
              <p>
                We believe core developer collaboration shouldn't be locked
                behind an expensive subscription.
              </p>
              <p>
                So for the past year we spent our nights and weekend building
                Hopp, an open-source alternative.
              </p>
              <p>
                We would love your feedback and we are here to answer any and
                all questions.
              </p>
            </div>
          </section>
        </section>
        <section id="45080683">
          <h3>
            <a
              class="item"
              href="https://www.vldb.org/pvldb/vol18/p5531-viktor.pdf"
              >Still Asking: How Good Are Query Optimizers, Really? [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-31 @ 05:53:19</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45080683"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45078962">
          <h3>
            <a class="item" href="https://github.com/krig/LISP"
              >Lisp interpreter with GC in &amp;lt;750 lines of Odin (and
              &amp;lt;500 lines of C)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-30 @ 23:35:32</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45078962"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45078315">
          <h3>
            <a
              class="item"
              href="https://www.magiclantern.fm/forum/index.php?topic=27315.0"
              >Magic Lantern Is Back</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-30 @ 21:52:58</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45078315"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45073031">
          <h3>
            <a
              class="item"
              href="https://kvachev.com/blog/posts/triangular-grid/"
              >Triangle Grids</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-30 @ 08:46:05</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45073031"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45072481">
          <h3>
            <a
              class="item"
              href="https://discourse.llvm.org/t/tpde-llvm-10-20x-faster-llvm-o0-back-end/86664"
              >10-20x Faster LLVM -O0 Back-End – Code Generation</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-30 @ 06:55:30</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45072481"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45071457">
          <h3>
            <a
              class="item"
              href="https://eclecticlight.co/2025/08/29/what-happens-during-startup/"
              >What happens during startup?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-30 @ 02:35:00</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45071457"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45064241">
          <h3>
            <a
              class="item"
              href="https://aresluna.org/the-primitive-tortureboard/"
              >Untangling the myths and mysteries of Dvorak and QWERTY (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-29 @ 13:59:33</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45064241"
                  >Comments</a
                ><span class="descendants">: 70</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
