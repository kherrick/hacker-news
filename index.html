<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="44400105">
          <h3>
            <a
              class="item"
              href="https://machinelearning.apple.com/research/normalizing-flows"
              >Normalizing Flows Are Capable Generative Models</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-27 @ 20:50:10</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44400105"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44399854">
          <h3>
            <a
              class="item"
              href="https://www.smithsonianmag.com/smart-news/brief-history-children-sent-through-mail-180959372/"
              >A Brief History of Children Sent Through the Mail</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-27 @ 20:12:00</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44399854"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44399757">
          <h3>
            <a
              class="item"
              href="https://dl.acm.org/doi/abs/10.1145/3736112.3736141"
              >Structuring Arrays with Algebraic Shapes</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-27 @ 19:55:26</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44399757"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44399234">
          <h3>
            <a class="item" href="https://github.com/ExtensityAI/symbolicai"
              >SymbolicAI: A neuro-symbolic perspective on LLMs</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-27 @ 18:49:57</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44399234"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44399193">
          <h3>
            <a class="item" href="https://github.com/mikra01/nimbme"
              >nimbme â€“ Nim bare-metal environment</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-27 @ 18:45:05</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44399193"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44399186">
          <h3>
            <a
              class="item"
              href="https://newscenter.lbl.gov/2025/06/17/new-process-uses-microbes-to-create-valuable-materials-from-urine/"
              >New Process Uses Microbes to Create Valuable Materials from
              Urine</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-27 @ 18:43:41</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44399186"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44398710">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/us-news/2025/jun/27/trump-supreme-court-birthright-citizenship-scotus"
              >US Supreme Court limits federal judges' power to block Trump
              orders</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-27 @ 17:38:08</span
              ><span class="points-container"
                >Points: <span class="points">155</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44398710"
                  >Comments</a
                ><span class="descendants">: 171</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44398390">
          <h3>
            <a
              class="item"
              href="https://halcy.de/blog/2025/06/27/transmitting-data-via-ultrasound-without-any-special-equipment/"
              >Transmitting data via ultrasound without any special equipment</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-27 @ 17:02:17</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44398390"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44398370">
          <h3>
            <a class="item" href="https://bitmovin.com/careers/7943569002/"
              >Bitmovin (YC S15) Is Hiring a Junior Solutions Engineer in
              Denver</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-27 @ 17:00:16</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44397923">
          <h3>
            <a
              class="item"
              href="https://www.anthropic.com/research/project-vend-1"
              >Project Vend: Can Claude run a small shop? (And why does that
              matter?)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-27 @ 16:09:14</span
              ><span class="points-container"
                >Points: <span class="points">122</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44397923"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44397367">
          <h3>
            <a
              class="item"
              href="https://www.wakunguma.com/blog/rust-weird-expr"
              >Weird Expressions in Rust</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-27 @ 15:08:26</span
              ><span class="points-container"
                >Points: <span class="points">120</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44397367"
                  >Comments</a
                ><span class="descendants">: 95</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44397168">
          <h3>
            <a
              class="item"
              href="https://parkerhiggins.net/2025/04/10-years-of-pomological-watercolors/"
              >10 Years of Pomological Watercolors</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-27 @ 14:42:04</span
              ><span class="points-container"
                >Points: <span class="points">136</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44397168"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44397124">
          <h3>
            <a class="item" href="https://qwenlm.github.io/blog/qwen-vlo/"
              >Qwen VLo: From "Understanding" the World to "Depicting" It</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-27 @ 14:35:04</span
              ><span class="points-container"
                >Points: <span class="points">137</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44397124"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44396518">
          <h3>
            <a class="item" href="https://jameshard.ing/pilot"
              >Show HN: I'm an airline pilot â€“ I built interactive graphs/globes
              of my flights</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-27 @ 13:06:54</span
              ><span class="points-container"
                >Points: <span class="points">865</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44396518"
                  >Comments</a
                ><span class="descendants">: 143</span></span
              >
            </h4>
            <div class="text">
              <p>
                Pilots everywhere are required to keep a logbook of all their
                flying hours, aircraft, airports, and so on. Since I track
                everything digitally (some people still just use paper
                logbooks!), I put together some data visualizations and a few 3D
                globes to show my flying history.
              </p>
              <p>
                This globe is probably my favourite so far:
                <a href="https://jameshard.ing/pilot/globes/all"
                  >https://jameshard.ing/pilot/globes/all</a
                >
              </p>
              <p>
                If youâ€™ve got ideas for other graphs or ways to show this kind
                of data, Iâ€™d love to hear them!
              </p>
            </div>
          </section>
        </section>
        <section id="44395799">
          <h3>
            <a
              class="item"
              href="https://kramkow.ski/article/2025/06/27/my_lights_run_on_bash.html"
              >My Lights Run on Bash</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-27 @ 11:09:42</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44395799"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44395782">
          <h3>
            <a
              class="item"
              href="https://github.com/microsoft/vscode-copilot-chat"
              >Copilot Chat in VS Code is now open source</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-27 @ 11:06:43</span
              ><span class="points-container"
                >Points: <span class="points">116</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44395782"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44394929">
          <h3>
            <a class="item" href="https://github.com/e6a5/zenta"
              >Show HN: Zenta â€“ Mindfulness for Terminal Users</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-27 @ 08:28:28</span
              ><span class="points-container"
                >Points: <span class="points">162</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44394929"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44394386">
          <h3>
            <a class="item" href="https://pj5cpu.wordpress.com/">PJ5 TTL CPU</a>
          </h3>
          <section>
            <h4>
              <span>2025-06-27 @ 07:05:58</span
              ><span class="points-container"
                >Points: <span class="points">70</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44394386"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44394051">
          <h3>
            <a class="item" href="https://github.com/sirbread/sink"
              >Show HN: Sink â€“ Sync any directory with any device on your local
              network</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-27 @ 06:01:37</span
              ><span class="points-container"
                >Points: <span class="points">95</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44394051"
                  >Comments</a
                ><span class="descendants">: 72</span></span
              >
            </h4>
            <div class="text">
              <p>
                it just uses your local wifi. run it on your machines, tell them
                to trust each other, and you're set. and if you manage to edit
                the same file at once, it handles the conflict and saves both
                copies.
              </p>
              <p>
                for anyone who just wants to get files from point a to b without
                the headache. hope it makes your life a bit less annoying.
              </p>
              <p>
                github:
                <a href="https://github.com/sirbread/sink"
                  >https://github.com/sirbread/sink</a
                >
                binary:
                <a href="https://github.com/sirbread/sink/releases/tag/v0.1"
                  >https://github.com/sirbread/sink/releases/tag/v0.1</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="44393942">
          <h3>
            <a class="item" href="https://nullprogram.com/blog/2025/06/26/"
              >Parameterized types in C using the new tag compatibility rule</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-27 @ 05:31:56</span
              ><span class="points-container"
                >Points: <span class="points">118</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44393942"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44393817">
          <h3>
            <a class="item" href="https://github.com/pacocoursey/xslt"
              >XSLT â€“ Native, zero-config build system for the Web</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-27 @ 05:00:41</span
              ><span class="points-container"
                >Points: <span class="points">369</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44393817"
                  >Comments</a
                ><span class="descendants">: 302</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44392776">
          <h3>
            <a
              class="item"
              href="https://www.ryanliptak.com/blog/better-named-character-reference-tokenization/"
              >Slightly better named character reference tokenization than
              Chrome, Safari, FF</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-27 @ 00:27:26</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44392776"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44390501">
          <h3>
            <a
              class="item"
              href="https://alternativelayoutsystem.com/scripts/#same-sizer"
              >Alternative Layout System</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-26 @ 19:31:29</span
              ><span class="points-container"
                >Points: <span class="points">345</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44390501"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44390488">
          <h3>
            <a
              class="item"
              href="https://sharnoff.io/blog/why-rust-compiler-slow"
              >Why is the Rust compiler so slow?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-26 @ 19:29:32</span
              ><span class="points-container"
                >Points: <span class="points">269</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44390488"
                  >Comments</a
                ><span class="descendants">: 355</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44390452">
          <h3>
            <a
              class="item"
              href="https://justinfagnani.com/2025/06/26/the-time-is-right-for-a-dom-templating-api/"
              >The time is right for a DOM templating API</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-26 @ 19:23:28</span
              ><span class="points-container"
                >Points: <span class="points">198</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44390452"
                  >Comments</a
                ><span class="descendants">: 200</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44366142">
          <h3>
            <a class="item" href="https://hispi.app"
              >Show HN: I built Hispi, an app to design custom jewellery</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-24 @ 13:38:17</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44366142"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
            <div class="text">
              Designing is free and gives you a breakdown of material choices
              and costs, then you can get a quote if you want to buy the ring.
              I'm working with around 50 jewellers in London and the UK's
              Jewellery Quarter but I think just designing a ring is pretty
              nice.
            </div>
          </section>
        </section>
        <section id="44363948">
          <h3>
            <a class="item" href="https://maxwellito.github.io/do-you-know-rgb/"
              >Show HN: Do you know RGB?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-24 @ 08:19:49</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44363948"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44362628">
          <h3>
            <a
              class="item"
              href="https://lightmatter.co/blog/a-new-kind-of-computer/"
              >A New Kind of Computer (April 2025)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-24 @ 03:27:48</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44362628"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44356456">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/science/2025/06/this-archaeologist-built-a-replica-boat-to-sail-like-the-vikings/"
              >Sailing the fjords like the Vikings yields unexpected insights</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-23 @ 14:56:02</span
              ><span class="points-container"
                >Points: <span class="points">128</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44356456"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44356130">
          <h3>
            <a
              class="item"
              href="https://github.com/hansake/Whitesmiths-C-compiler"
              >Whitesmiths C compiler: One of the earliest commercial C
              compilers available</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-06-23 @ 14:25:56</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44356130"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
