<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="40807072">
          <h3>
            <a
              class="item"
              href="https://www.chase.com/digital/digital-payments/paze-faqs"
              >Chase will soon share their customers' credit card information
              with startup Paze</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-27 @ 04:02:32</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40807072"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40807032">
          <h3>
            <a
              class="item"
              href="https://latenighter.com/news/paramount-axes-comedy-central-website-show-clips-library/"
              >25 years of video clips gone as Paramount axes Comedy Central
              wesbite</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-27 @ 03:55:02</span
              ><span class="points-container"
                >Points: <span class="points">70</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40807032"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40806980">
          <h3>
            <a
              class="item"
              href="https://www.bloomberg.com/news/articles/2024-06-27/spacex-tender-offer-said-to-value-company-at-record-210-billion"
              >SpaceX Tender Offer Said to Value Company at Record $210B</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-27 @ 03:46:47</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40806980"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40806930">
          <h3>
            <a
              class="item"
              href="https://www.joanwestenberg.com/6-months-ago,-i-left-the-bullshit-industrial-complex"
              >6 months ago, I left the bullshit industrial complex</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-27 @ 03:33:52</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40806930"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40806698">
          <h3>
            <a
              class="item"
              href="https://thezvi.substack.com/p/on-claude-35-sonnet"
              >Claude 3.5 Sonnet</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-27 @ 02:42:10</span
              ><span class="points-container"
                >Points: <span class="points">123</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40806698"
                  >Comments</a
                ><span class="descendants">: 83</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40806356">
          <h3>
            <a
              class="item"
              href="https://www.readmargins.com/p/doordash-and-pizza-arbitrage"
              >DoorDash and Pizza Arbitrage</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-27 @ 01:16:52</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40806356"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40806302">
          <h3>
            <a
              class="item"
              href="https://williams.chemistry.gatech.edu/structure/molecular_interactions/mol_int.html"
              >Molecular Interactions and the Behaviors of Biological
              Macromolecules</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-27 @ 01:05:28</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40806302"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40806151">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/how-ai-revolutionized-protein-science-but-didnt-end-it-20240626/"
              >AI Revolutionized Protein Science, but Didn't End It</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-27 @ 00:39:14</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40806151"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40805351">
          <h3>
            <a class="item" href="https://github.com/corcel/corcel"
              >Corcel â€“ Use WordPress backend with Laravel or any PHP
              application</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-26 @ 22:33:59</span
              ><span class="points-container"
                >Points: <span class="points">81</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40805351"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40805251">
          <h3>
            <a
              class="item"
              href="https://www.npr.org/sections/shots-health-news/2024/06/26/g-s1-6177/brain-waste-removal-system-amyloid-alzheimer-toxins"
              >The brain makes a lot of waste. Now scientists think they know
              where it goes</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-26 @ 22:21:49</span
              ><span class="points-container"
                >Points: <span class="points">148</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40805251"
                  >Comments</a
                ><span class="descendants">: 79</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40805248">
          <h3>
            <a class="item" href="https://datatracker.ietf.org/doc/html/rfc7624"
              >Confidentiality in the Face of Pervasive Surveillance</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-26 @ 22:21:29</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40805248"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40805099">
          <h3>
            <a
              class="item"
              href="https://www.tomshardware.com/tech-industry/cyber-security/south-korean-telecom-company-attacks-torrent-users-with-malware-over-600000-people-report-missing-files-strange-folders-and-disabled-pcs"
              >South Korean telecom company attacks torrent users with
              malware</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-26 @ 22:03:00</span
              ><span class="points-container"
                >Points: <span class="points">191</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40805099"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40804675">
          <h3>
            <a class="item" href="https://sfwriter.com/wordstar.htm"
              >WordStar â€“ A Writer's Word Processor (1990)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-26 @ 21:16:41</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40804675"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40804635">
          <h3>
            <a
              class="item"
              href="https://quuxplusone.github.io/blog/2024/06/25/most-stl-ctors-arent-explicit-but-yours-still-should-be/"
              >How the STL Uses Explicit</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-26 @ 21:12:31</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40804635"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40804489">
          <h3>
            <a
              class="item"
              href="https://www.govexec.com/pay-benefits/2024/06/federal-whistleblowers-are-entitled-damages-missed-future-pay-court-rules/397638/"
              >Federal whistleblowers are entitled to damages of missed future
              pay, court rules</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-26 @ 20:54:08</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40804489"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40804122">
          <h3>
            <a class="item" href="http://mynor.org/my4th_forthdeck.htm"
              >The Forth Deck mini: a portable Forth computer with a discrete
              CPU</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-26 @ 20:12:31</span
              ><span class="points-container"
                >Points: <span class="points">190</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40804122"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40803783">
          <h3>
            <a class="item" href="https://fabric8labs.com"
              >Next gen 3D metal printing</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-26 @ 19:41:14</span
              ><span class="points-container"
                >Points: <span class="points">139</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40803783"
                  >Comments</a
                ><span class="descendants">: 72</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40802676">
          <h3>
            <a class="item" href="https://www.figma.com/slides/"
              >Figma Slides</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-26 @ 18:04:34</span
              ><span class="points-container"
                >Points: <span class="points">284</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40802676"
                  >Comments</a
                ><span class="descendants">: 103</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40802557">
          <h3>
            <a class="item" href="https://alpha.reconquer.online"
              >Show HN: I built an indie, browser-based MMORPG</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-26 @ 17:53:22</span
              ><span class="points-container"
                >Points: <span class="points">100</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40802557"
                  >Comments</a
                ><span class="descendants">: 60</span></span
              >
            </h4>
            <div class="text">
              <p>Here are the major open source technologies that I use:</p>
              <p>
                Blender - 3D modeling software for creating the overall
                environment and every game object. I've gotten a lot of CC and
                Public Domain assets from
                <a href="https://poly.pizza">https://poly.pizza</a>
              </p>
              <p>
                GLTF - I export assets from blender to the GLTF asset format
              </p>
              <p>
                JSON - I write a JSON config for every game object that
                describes things like its name, its interactions, its
                collisions, etc.
              </p>
              <p>
                Node.js exporter - I iterate over the environment and every
                asset to create a scene hierarchy. I use gltf-transform for
                processing all GLTF files, compressing them, removing
                redundancies, etc.
              </p>
              <p>
                Node.js server - Uses express and socket.io to process game
                state updates. It keeps track of every client's game state and
                issues delta's at each game tick (currently 600ms). The client
                can send interactions with different objects. The server
                validates those and updates the game state accordingly.
              </p>
              <p>
                HTML/CSS/JavaScript/Three.js client - I use regular web
                technologies for the UI elements and three.js for the 3D rending
                on the browser. The client is responsible for rending the world
                state and providing the client with different interactions. All
                code is written in JavaScript which means less context
                switching. Performance seems to be good enough, and I figure I
                can always optimize the server code in C++ if necessary.
              </p>
              <p>
                I am currently running two cheap shared instances but based on
                my testing, they can likely support about 200 users each. This
                is a low-poly browser based game so it should be compatible
                across many devices. The data a user needs to download to play,
                including all 3d assets, is approximately 2 MB, even though
                there are hundreds of assets.
              </p>
              <p>
                Overall, it's been a fun project. Web development and open
                source software have progressed to the point that this is no
                longer an incredibly difficult feat. I feel like development is
                going pretty well and in a year or so there will be plenty of
                good content to play.
              </p>
            </div>
          </section>
        </section>
        <section id="40802054">
          <h3>
            <a
              class="item"
              href="https://jobs.ashbyhq.com/motion/731e6994-c9b0-43ae-b7e4-28cbca03920f?utm_source=hn"
              >Motion (YC W20) Is Hiring Our First DevOps Engineer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-26 @ 17:00:17</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40800869">
          <h3>
            <a class="item" href="https://onemillioncheckboxes.com/"
              >One Million Checkboxes</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-26 @ 15:02:38</span
              ><span class="points-container"
                >Points: <span class="points">682</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40800869"
                  >Comments</a
                ><span class="descendants">: 241</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40799791">
          <h3>
            <a class="item" href="https://github.com/SciPhi-AI/R2R"
              >Show HN: R2R V2 â€“ A open source RAG engine with prod features</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-26 @ 13:27:14</span
              ><span class="points-container"
                >Points: <span class="points">198</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40799791"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
            <div class="text">
              <a href="https://github.com/SciPhi-AI/R2R"
                >https://github.com/SciPhi-AI/R2R</a
              >], an open source RAG answer engine that is built on top of
              Postgres+Neo4j. The best way to get started is with the docs -
              <a href="https://r2r-docs.sciphi.ai/introduction"
                >https://r2r-docs.sciphi.ai/introduction</a
              >.
              <p>
                This is a major update from our V1 which we have spent the last
                3 months intensely building after getting a ton of great
                feedback from our first Show HN (<a
                  href="https://news.ycombinator.com/item?id=39510874"
                  >https://news.ycombinator.com/item?id=39510874</a
                >). We changed our focus to building a RAG engine instead of a
                framework, because this is what developers asked for the most.
                To us this distinction meant working on an opinionated system
                instead of layers of abstractions over providers. We built
                features for multimodal data ingestion, hybrid search with
                reranking, advanced RAG techniques (e.g. HyDE), automatic
                knowledge graph construction alongside the original goal of an
                observable RAG system built on top of a RESTful API that we
                shared back in February.
              </p>
              <p>
                What's the problem? Developers are struggling to build accurate,
                reliable RAG solutions. Popular tools like Langchain are complex
                and overly abstracted and lack crucial production features such
                as user/document management, observability, and a default API.
                There was a big thread about this a few days ago:
                <i>Why we no longer use LangChain for building our AI agents</i>
                (<a href="https://news.ycombinator.com/item?id=40739982"
                  >https://news.ycombinator.com/item?id=40739982</a
                >)
              </p>
              <p>
                We experienced these challenges firsthand while building a
                large-scale semantic search engine, having users report numerous
                hallucinations and inaccuracies. This highlighted that
                search+RAG is a difficult problem. We're convinced that these
                missing features, and more, are essential to effectively monitor
                and improve such systems over time.
              </p>
              <p>
                Teams have been using R2R to develop custom AI agents with their
                own data, with applications ranging from B2B lead generation to
                research assistants. Best of all, the developer experience is
                much improved. For example, we have recently seen multiple teams
                use R2R to deploy a user-facing RAG engine for their application
                within a day. By day 2 some of these same teams were using their
                generated logs to tune the system with advanced features like
                hybrid search and HyDE.
              </p>
              <p>
                Here are a few examples of how R2R can outperform classic RAG
                with semantic search only:
              </p>
              <p>
                1. â€œWhat were the UK's top exports in 2023?". R2R with hybrid
                search can identify documents mentioning "UK exports" and
                "2023", whereas semantic search finds related concepts like
                trade balance and economic reports.
              </p>
              <p>
                2. "List all YC founders that worked at Google and now have an
                AI startup." Our knowledge graph feature allows R2R to
                understand relationships between employees and projects,
                answering a query that would be challenging for simple vector
                search.
              </p>
              <p>
                The built in observability and customizability of R2R helps you
                to tune and improve your system long after launching. Our plan
                is to keep the API ~fixed while we iterate on the internal
                system logic, making it easier for developers to trust R2R for
                production from day 1.
              </p>
              <p>
                We are currently working on the following: (1) Improve semantic
                chunking through third party providers or our own custom LLMs;
                (2) Training a custom model for knowledge graph triples
                extraction that will allow KG construction to be 10x more
                efficient. (This is in private beta, please reach out if
                interested!); (3) Ability to handle permissions at a more
                granular level than just a single user; (4) LLM-powered online
                evaluation of system performance + enhanced analytics and
                metrics.
              </p>
              <p>
                Getting started is easy. R2R is a lightweight repository that
                you can install locally with `pip install r2r`, or run with
                Docker. Check out our quickstart guide:
                <a href="https://r2r-docs.sciphi.ai/quickstart"
                  >https://r2r-docs.sciphi.ai/quickstart</a
                >. Lastly, if it interests you, we are also working on a cloud
                solution at <a href="https://sciphi.ai">https://sciphi.ai</a>.
              </p>
              <p>
                Thanks a lot for taking the time to read! The feedback from the
                first ShowHN was invaluable and gave us our direction for the
                last three months, so we'd love to hear any more comments you
                have!
              </p>
            </div>
          </section>
        </section>
        <section id="40789179">
          <h3>
            <a
              class="item"
              href="https://www.geekwire.com/2024/seattles-living-computers-museum-logs-off-for-good-as-paul-allen-estate-will-auction-vintage-items/"
              >Living Computers Museum to permanently close, auction vintage
              items</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-25 @ 14:35:07</span
              ><span class="points-container"
                >Points: <span class="points">301</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40789179"
                  >Comments</a
                ><span class="descendants">: 163</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40781573">
          <h3>
            <a
              class="item"
              href="https://insidestory.org.au/spy-accomplice-ghostwriter/"
              >Spy, accomplice, ghostwriter</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-24 @ 22:13:46</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40781573"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40779791">
          <h3>
            <a
              class="item"
              href="http://www.practicallyefficient.com/2017/10/13/from-boiling-lead-and-black-art.html"
              >Boiling lead and black art: a history of mathematical typography
              (2017)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-24 @ 19:37:02</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40779791"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40774833">
          <h3>
            <a
              class="item"
              href="https://developers.redhat.com/articles/2022/09/17/gccs-new-fortification-level"
              >GCC's new fortification level: The gains and costs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-24 @ 11:42:03</span
              ><span class="points-container"
                >Points: <span class="points">118</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40774833"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40774748">
          <h3>
            <a
              class="item"
              href="https://btmc.substack.com/p/tracing-garbage-collection-for-arenas"
              >Tracing garbage collection for arenas</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-24 @ 11:31:16</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40774748"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40773125">
          <h3>
            <a class="item" href="https://olano.dev/blog/from-rss-to-my-kindle"
              >From RSS to My Kindle</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-24 @ 06:47:47</span
              ><span class="points-container"
                >Points: <span class="points">109</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40773125"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40768124">
          <h3>
            <a class="item" href="https://avdweb.nl/arduino/attiny3217/nano-dip"
              >Nano DIP: the smallest complete Arduino board 33 x 10mm</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-23 @ 15:26:04</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40768124"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40765770">
          <h3>
            <a class="item" href="https://grantkot.com/ll/">Liquid Layers</a>
          </h3>
          <section>
            <h4>
              <span>2024-06-23 @ 08:43:29</span
              ><span class="points-container"
                >Points: <span class="points">322</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40765770"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
            <div class="text">
              <a href="https://twitter.com/kotsoft"
                >https://twitter.com/kotsoft</a
              >
            </div>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
