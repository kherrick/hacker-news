<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="40815046">
          <h3>
            <a class="item" href="https://www.tesorio.com/careers#job-openings"
              >Tesorio (YC S15) Is Hiring a Senior GenAI/LLM Engineer (100%
              Remote)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-27 @ 21:00:24</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40814728">
          <h3>
            <a
              class="item"
              href="https://techcrunch.com/2024/06/27/fcc-rule-would-make-carriers-unlock-all-phones-after-60-days/"
              >FCC rule would make carriers unlock all phones after 60 days</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-27 @ 20:27:01</span
              ><span class="points-container"
                >Points: <span class="points">113</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40814728"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40814612">
          <h3>
            <a
              class="item"
              href="https://sourcegraph.com/blog/developer-productivity-thoughts"
              >A dev's thoughts on developer productivity (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-27 @ 20:16:58</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40814612"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40814011">
          <h3>
            <a class="item" href="https://www.valve.computer/"
              >A modern 8 bit design, built using 1950s thermionic valves</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-27 @ 19:18:10</span
              ><span class="points-container"
                >Points: <span class="points">121</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40814011"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40813384">
          <h3>
            <a
              class="item"
              href="https://www.space.com/iss-astronauts-shelter-return-spacecraft-satellite-breakup"
              >Astronauts take shelter in Starliner, other spacecraft after
              satellite breakup</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-27 @ 18:15:16</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40813384"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40813369">
          <h3>
            <a
              class="item"
              href="https://www.washingtonpost.com/politics/2024/06/27/purdue-pharma-supreme-court-opioid-bankruptcy/"
              >Supreme Court blocks controversial Purdue Pharma opioid
              settlement</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-27 @ 18:13:51</span
              ><span class="points-container"
                >Points: <span class="points">130</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40813369"
                  >Comments</a
                ><span class="descendants">: 376</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40813077">
          <h3>
            <a
              class="item"
              href="https://dl.acm.org/doi/10.1145/3652588.3663324"
              >Misconceptions about loops in C</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-27 @ 17:46:21</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40813077"
                  >Comments</a
                ><span class="descendants">: 64</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40813076">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/d41586-024-02085-2"
              >The strategy behind Cambridgeâ€™s Laboratory of Molecular
              Biology</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-27 @ 17:46:19</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40813076"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40812695">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/gadgets/2024/06/larry-finger-linux-wireless-hero-was-a-persistent-patient-coder-and-mentor/"
              >Remembering Larry Finger, who made Linux wireless work</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-27 @ 17:09:37</span
              ><span class="points-container"
                >Points: <span class="points">267</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40812695"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40812622">
          <h3>
            <a
              class="item"
              href="https://openai.com/index/finding-gpt4s-mistakes-with-gpt-4/"
              >CriticGPT: Finding GPT-4's mistakes with GPT-4</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-27 @ 17:02:09</span
              ><span class="points-container"
                >Points: <span class="points">133</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40812622"
                  >Comments</a
                ><span class="descendants">: 123</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40811785">
          <h3>
            <a
              class="item"
              href="https://www.noemamag.com/the-secret-magical-life-of-lithium/"
              >The Secret, Magical Life of Lithium</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-27 @ 15:49:17</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40811785"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40811675">
          <h3>
            <a
              class="item"
              href="https://sixcolors.com/post/2024/06/review-moaan-inkpalm-plus-is-weird-cheap-small-and-my-kind-of-e-reader/"
              >Moaan InkPalm Plus is weird, cheap, small, and my kind of
              e-reader</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-27 @ 15:40:23</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40811675"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40811225">
          <h3>
            <a
              class="item"
              href="https://www.uni-heidelberg.de/en/newsroom/aromatic-compounds-a-ring-made-up-solely-of-metal-atoms"
              >Aromatic compounds: A ring made up solely of metal atoms</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-27 @ 14:57:13</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40811225"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40810986">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=40810986"
              >Launch HN: Hatchet (YC W24) â€“ Open-source task queue, now with a
              cloud version</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-27 @ 14:35:34</span
              ><span class="points-container"
                >Points: <span class="points">136</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40810986"
                  >Comments</a
                ><span class="descendants">: 60</span></span
              >
            </h4>
            <div class="text">
              <a href="https://hatchet.run">https://hatchet.run</a>). Weâ€™re
              building a modern task queue as an alternative to tools like
              Celery for Python and BullMQ for Node. Our open-source repo is at
              <a href="https://github.com/hatchet-dev/hatchet"
                >https://github.com/hatchet-dev/hatchet</a
              >
              and is 100% MIT licensed.
              <p>
                When we did a Show HN a few months ago (<a
                  href="https://news.ycombinator.com/item?id=39643136"
                  >https://news.ycombinator.com/item?id=39643136</a
                >), our cloud version was invite-only and we were focused on our
                open-source offering.
              </p>
              <p>
                Today weâ€™re launching our self-serve cloud so that anyone can
                get started creating tasks on our platform - you can get started
                at
                <a href="https://cloud.onhatchet.run"
                  >https://cloud.onhatchet.run</a
                >, or you can use these credentials to access a demo (should be
                prefilled):
              </p>
              <p></p>
              <pre><code>  URL: https://demo.hatchet-tools.com 
  Email: hacker@news.ycombinator.com
  Password: HatchetDemo123!
</code></pre>
              People are currently using Hatchet for a bunch of use-cases:
              orchestrating RAG pipelines, queueing up user notifications,
              building agentic LLM workflows, or scheduling image generation
              tasks on GPUs.
              <p>
                We built this out of frustration with existing tools and a
                conviction that PostgreSQL is the right choice for a task queue.
                Beyond the fact that many developers are already using Postgres
                in their stack, which makes it easier to self-host Hatchet, itâ€™s
                also easier to model higher-order concepts in Postgres, like
                chains of tasks (which we call workflows). In our system, the
                acknowledgement of the task, the task result, and the updates to
                higher-order models are done as part of the same Postgres
                transaction, which significantly reduces the risk of data
                loss/race conditions when compared with other task queues (which
                usually pass acknowledgements through a broker, storing the task
                results elsewhere, and only then figuring out the next task in
                the chain).
              </p>
              <p>
                We also became increasingly frustrated with tools like Celery
                and the challenges it introduces when using a modern Python
                stack (&gt; 3.5). We wrote up a list of these frustrations here:
                <a href="https://docs.hatchet.run/blog/problems-with-celery"
                  >https://docs.hatchet.run/blog/problems-with-celery</a
                >.
              </p>
              <p>
                Since our Show HN, weâ€™ve (partially or completely) addressed the
                most common pieces of feedback from the post, which weâ€™ll
                outline here:
              </p>
              <p>
                1. The most common ask was built-in support for fanout workflows
                â€” one task which triggers an arbitrary number of child tasks to
                run in parallel. We previously only had support for DAG
                executions. We generalized this concept and launched child
                workflows (<a
                  href="https://docs.hatchet.run/home/features/child-workflows"
                  >https://docs.hatchet.run/home/features/child-workflows</a
                >). This is the first step towards a developer-friendly model of
                durable execution.
              </p>
              <p>
                2. Support for HTTP-based triggers â€” weâ€™ve built out support for
                webhook workers (<a
                  href="https://docs.hatchet.run/home/features/webhooks"
                  >https://docs.hatchet.run/home/features/webhooks</a
                >), which allow you to trigger any workflow over an HTTP
                webhook. This is particularly useful for apps on Vercel, who are
                dealing with timeout limits of 60s, 300s, or 900s (depending on
                your tier).
              </p>
              <p>
                3. Our RabbitMQ dependency â€” while we havenâ€™t gotten rid of this
                completely, weâ€™ve recently launched hatchet-lite (<a
                  href="https://docs.hatchet.run/self-hosting/hatchet-lite"
                  >https://docs.hatchet.run/self-hosting/hatchet-lite</a
                >), which allows you to run the various Hatchet components in a
                single Docker image that bundles RabbitMQ along with a migration
                process, admin CLI, our REST API, and our gRPC engine. Hopefully
                the lite was a giveaway, but this is meant for local development
                and low-volume processing, on the order of hundreds per minute.
              </p>
              <p>
                Weâ€™ve also launched more features, like support for global rate
                limiting, steps which only run on workflow failure, and custom
                event streaming.
              </p>
              <p>
                Weâ€™ll be here the whole day for questions and feedback, and look
                forward to hearing your thoughts!
              </p>
            </div>
          </section>
        </section>
        <section id="40810949">
          <h3>
            <a class="item" href="https://pketh.org/open-sourcing-kinopio.html"
              >Open Sourcing Kinopio</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-27 @ 14:32:35</span
              ><span class="points-container"
                >Points: <span class="points">103</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40810949"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40810802">
          <h3>
            <a
              class="item"
              href="https://storage.googleapis.com/deepmind-media/gemma/gemma-2-report.pdf"
              >Gemma 2: Improving Open Language Models at a Practical Size
              [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-27 @ 14:18:46</span
              ><span class="points-container"
                >Points: <span class="points">180</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40810802"
                  >Comments</a
                ><span class="descendants">: 114</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40810776">
          <h3>
            <a
              class="item"
              href="https://behavioralscientist.org/is-everything-bs/"
              >Not everything is behavioral science</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-27 @ 14:16:26</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40810776"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40809033">
          <h3>
            <a
              class="item"
              href="https://mlops.systems/posts/2024-06-25-evaluation-finetuning-manual-dataset.html"
              >How to think about creating a dataset for LLM fine-tuning
              evaluation</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-27 @ 10:29:06</span
              ><span class="points-container"
                >Points: <span class="points">107</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40809033"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40808933">
          <h3>
            <a
              class="item"
              href="https://www.ams.org/notices/199701/comm-rota.pdf"
              >Lessons I Wish I Had Been Taught (1996) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-27 @ 10:06:18</span
              ><span class="points-container"
                >Points: <span class="points">217</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40808933"
                  >Comments</a
                ><span class="descendants">: 72</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40808820">
          <h3>
            <a
              class="item"
              href="https://web.dev/case-studies/google-sheets-wasmgc"
              >Google Sheets ported its calculation worker from JavaScript to
              WasmGC</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-27 @ 09:34:09</span
              ><span class="points-container"
                >Points: <span class="points">341</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40808820"
                  >Comments</a
                ><span class="descendants">: 147</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40808110">
          <h3>
            <a
              class="item"
              href="https://coryrylan.com/blog/flow-charts-with-css-anchor-positioning"
              >Flow Charts with CSS Anchor Positioning</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-27 @ 07:07:08</span
              ><span class="points-container"
                >Points: <span class="points">141</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40808110"
                  >Comments</a
                ><span class="descendants">: 60</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40807923">
          <h3>
            <a
              class="item"
              href="https://lars.ingebrigtsen.no/2024/06/26/a-new-package-for-making-charts-in-emacs-eplot/"
              >Eplot: A new package for making charts in Emacs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-27 @ 06:33:44</span
              ><span class="points-container"
                >Points: <span class="points">232</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40807923"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40806858">
          <h3>
            <a class="item" href="https://github.com/orisano/gosax"
              >Show HN: Gosax â€“ A high-performance SAX XML parser for Go</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-27 @ 03:17:09</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40806858"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
            <div class="text">
              <a href="https://github.com/orisano/gosax"
                >https://github.com/orisano/gosax</a
              >
              Key features:
              <p>
                - Read-only SAX parsing - Highly efficient parsing using
                techniques inspired by quick-xml and pkg/json - SWAR (SIMD
                Within A Register) optimizations for fast text processing
              </p>
              <p>
                gosax is particularly useful for processing large XML files or
                streams without loading the entire document into memory. It's
                well-suited for data feeds, large configuration files, or any
                scenario where XML parsing speed is crucial. I'd appreciate any
                feedback, especially from those working with large-scale XML
                processing in Go. What are your current pain points with XML
                parsing? How could gosax potentially help your projects?
              </p>
            </div>
          </section>
        </section>
        <section id="40805949">
          <h3>
            <a
              class="item"
              href="https://www.404media.co/id-verification-service-for-tiktok-uber-x-exposed-driver-licenses-au10tix/"
              >ID verification service for TikTok, Uber, X exposed driver
              licenses</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-27 @ 00:05:05</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40805949"
                  >Comments</a
                ><span class="descendants">: 81</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40804294">
          <h3>
            <a class="item" href="https://github.com/VladM7/Stack-Solver"
              >Show HN: A Modern Palletization App</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-26 @ 20:31:37</span
              ><span class="points-container"
                >Points: <span class="points">63</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40804294"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
            <div class="text">
              <p>
                So what I had in mind when making Stack Solver was an app with a
                modern interface that has the most essential features. It is
                also well integrated with Microsoft Excel and renders a 3D
                customizable drawing.
              </p>
              <p>
                Stack Solver is programmed in C# using the WPF framework to
                ensure it is fast and light. The interface is built using WPF
                UI, a library that allows it to keep up with modern trends
                (specifically the Fluent design).
              </p>
              <p>
                It is a work in progress with tons of new features planned and
                it is my first "serious" project so I would appreciate any
                feedback :)
              </p>
            </div>
          </section>
        </section>
        <section id="40798983">
          <h3>
            <a
              class="item"
              href="https://www.eetimes.com/pulsed-laser-deposition-at-wafer-level-is-a-game-changer/"
              >Pulsed Laser Deposition at Wafer Level Is a Game Changer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-26 @ 12:03:33</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40798983"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40798939">
          <h3>
            <a class="item" href="http://www.spudguns.org/"
              >Spudguns: Potato Cannon Guide</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-26 @ 11:59:13</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40798939"
                  >Comments</a
                ><span class="descendants">: 69</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40798740">
          <h3>
            <a class="item" href="https://kmcd.dev/posts/grpc-the-bad-parts/"
              >gRPC: The Bad Parts</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-26 @ 11:30:04</span
              ><span class="points-container"
                >Points: <span class="points">120</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40798740"
                  >Comments</a
                ><span class="descendants">: 125</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40797790">
          <h3>
            <a
              class="item"
              href="https://www.npr.org/2024/06/26/g-s1-6238/fda-warns-bakery-foods-allergens"
              >FDA warns top U.S. bakery not to claim foods contain allergens
              when they don't</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-26 @ 08:45:44</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40797790"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40796697">
          <h3>
            <a class="item" href="https://github.com/dorklyorg/dorkly/wiki"
              >Show HN: Dorkly â€“Â Open source feature flags</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-06-26 @ 05:28:09</span
              ><span class="points-container"
                >Points: <span class="points">81</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40796697"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
            <div class="text">
              <p>
                Full disclosure: made by a former LaunchDarkly employee +
                current fan.
              </p>
            </div>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
