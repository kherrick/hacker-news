<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="44063703">
          <h3>
            <a class="item" href="https://www.anthropic.com/news/claude-4"
              >Claude 4</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-22 @ 16:34:42</span
              ><span class="points-container"
                >Points: <span class="points">367</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44063703"
                  >Comments</a
                ><span class="descendants">: 134</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44063379">
          <h3>
            <a
              class="item"
              href="https://nautil.us/ice-theft-in-antarctica-1210083/"
              >Ice Theft in Antarctica</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-22 @ 16:02:09</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44063379"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44063248">
          <h3>
            <a class="item" href="https://chriskw.xyz/2025/05/21/Fractal/"
              >That fractal that's been up on my wall for 12 years</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-22 @ 15:50:16</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44063248"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44063141">
          <h3>
            <a
              class="item"
              href="https://blog.nilenso.com/blog/2025/05/12/mcp-explained-without-hype-or-fluff/"
              >MCP explained without hype or fluff</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-22 @ 15:39:49</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44063141"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44063051">
          <h3>
            <a
              class="item"
              href="https://www.cell.com/cell/fulltext/S0092-8674(25)00454-4"
              >Near-infrared spatiotemporal color vision enabled by upconversion
              contact lenses</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-22 @ 15:30:24</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44063051"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44063000">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=44063000"
              >Launch HN: WorkDone (YC X25) – AI Audit of Medical Charts</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-22 @ 15:23:40</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44063000"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.wrkdn.com/">https://www.wrkdn.com/</a>). In
              one sentence: we built an AI product that audits medical
              documentation in real time to catch and fix errors before they
              turn into treatment mistakes or denied insurance claims.
              <p>
                We got interested in this problem when we saw how often small
                documentation slip-ups can snowball into huge financial, legal,
                and even life-threatening outcomes. Sometimes it’s just a
                mistyped medication time or a missing discharge note - basic
                stuff - but when you’re dealing with claims and regulatory
                rules, a minor error can trigger an automatic denial. Wrong
                copy-pasting on a discharge note will be uncovered by the
                insurance provider and will cost stressful appeal. By the time
                an overworked clinical or compliance team discovers it, it’s
                usually too late to just fix it. Our own experiences hit close
                to home: Dmitry’s family member faced grave consequences from a
                misread lab result, and Sergey comes from a full medical family
                that’s battled these issues up close.
              </p>
              <p>
                Here’s our demo if you’d be interested to take a look -
                <a
                  href="https://www.loom.com/share/add16021bb29432eba7f3254dd5e9a75"
                  >https://www.loom.com/share/add16021bb29432eba7f3254dd5e9a75</a
                >
              </p>
              <p>
                Our solution is a set of AI agents that plug directly into a
                clinic or hospital EHR/EMR system. As clinicians go about their
                daily routines, WorkDone continuously monitors the records. If
                it spots something that looks off-like a missing signature or a
                suspicious timestamp- it asks the responsible staff member to
                double-check and correct it on the spot. We want to prevent
                errors from becoming big headaches and wasted hours down the
                road. Technically, this involves running a secure event listener
                on top of EHR APIs and applying a group of coordinated AI agents
                that’s been loaded with clinical protocols, payor rules, and
                finetuned on historical claim denials and regulatory guidelines.
                The moment the model flags a potential error, an agent nudges
                the user to clarify or confirm. If it’s a genuine mistake, we
                request correction approval from the provider and fix it right
                away and store an audit trail for compliance. We are extending
                the approach to finding conflicting medication or prescribed
                treatments.
              </p>
              <p>
                What’s different about our approach from AI tools for hospital
                revenue management is this focus on near-real-time intervention.
                Most tools detect errors after the claim has already been
                submitted, so compliance teams end up firefighting. We think the
                best place to fix something is in the flow of work itself. One
                common question about the use of AI in the medical/health field
                is: what if the AI hallucinates or gets something wrong? In our
                case, since the tool is flagging possible errors and its primary
                effect is to get extra human review, there’s no impact on
                anything health-critical like treatments. Rather the risk is
                that too many false positives could waste staff members’
                valuable time. For pilots, we are starting with read-only mode
                in which we use API only to retrieve the data, and we are able
                to see that the QA we built into the agent orchestration layer
                does a pretty good job for spotting common documentation
                mistakes even in lengthy charts (for instance, multi-day
                hospital stay).
              </p>
              <p>
                We’re in the early stages of refining our system, and we’d love
                feedback from the community. If you have ideas on integrating
                with EHRs, experiences with compliance tools, or just general
                insights about working in healthcare environments, we’re all
                ears. We’re also on the lookout for early users - particularly
                rehabs, small clinics and hospitals - willing to give our AI a
                try and tell us where it needs improvement.
              </p>
              <p>Thanks for reading, and let us know what you think!</p>
            </div>
          </section>
        </section>
        <section id="44062919">
          <h3>
            <a
              class="item"
              href="https://apps.apple.com/us/app/whenish/id6745035749"
              >Show HN: Whenish – Plan Group Events in iMessages</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-22 @ 15:15:27</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44062919"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
            <div class="text">
              <p>
                Whenish is an iMessage app that allows individuals to select
                multiple dates that work for them for an event attempting to be
                planned for.
              </p>
              <p>
                i have more ideas for new features but wanted to get something
                out there that was usable. so far ive had good reception in my
                friend group chats of Whenish.
              </p>
              <p>
                download it, give it a go, let me know what you think! this is
                my first app i felt ~good~ about releasing.
              </p>
            </div>
          </section>
        </section>
        <section id="44062774">
          <h3>
            <a
              class="item"
              href="https://www.scottgoci.com/social-media-platforms-whats-wrong-and-whats-next/"
              >Social media platforms: what's wrong, and what's next</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-22 @ 15:01:09</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44062774"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44062586">
          <h3>
            <a
              class="item"
              href="https://theintercept.com/2025/05/22/intel-agencies-buying-data-portal-privacy/"
              >U.S. Spy Agencies–One-Stop Shop to Buy Your Personal Data</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-22 @ 14:43:21</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44062586"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44062227">
          <h3>
            <a
              class="item"
              href="https://nexo.sh/posts/why-i-built-a-native-mp3-player-in-swiftui/"
              >Why I Built My Own Audio Player</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-22 @ 14:09:25</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44062227"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44062176">
          <h3>
            <a
              class="item"
              href="https://www.wsj.com/tech/ai/what-sam-altman-told-openai-about-the-secret-device-hes-making-with-jony-ive-f1384005"
              >What Sam Altman told OpenAI about the device he's making with
              Jony Ive</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-22 @ 14:03:37</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44062176"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44062160">
          <h3>
            <a
              class="item"
              href="https://railsatscale.com/2025-05-21-fast-allocations-in-ruby-3-5/"
              >Fast Allocations in Ruby 3.5</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-22 @ 14:01:55</span
              ><span class="points-container"
                >Points: <span class="points">95</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44062160"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44062130">
          <h3>
            <a
              class="item"
              href="https://www.stephendiehl.com/posts/computer_algebra_mcp/"
              >Adventures in Symbolic Algebra with Model Context Protocol</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-22 @ 13:59:25</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44062130"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44061836">
          <h3>
            <a class="item" href="https://github.com/sqliteai/sqlite-js"
              >Showh HN: SQLite JavaScript - extend your database with
              JavaScript</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-22 @ 13:25:33</span
              ><span class="points-container"
                >Points: <span class="points">93</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44061836"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44061698">
          <h3>
            <a
              class="item"
              href="https://newintrigue.com/2020/06/29/the-philosophy-of-byung-chul-han/"
              >The Philosophy of Byung-Chul Han (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-22 @ 13:09:15</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44061698"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44061604">
          <h3>
            <a class="item" href="https://ft-checker.com/"
              >Free-Threaded Python Library Compatibility Checker</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-22 @ 12:57:55</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44061604"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44061160">
          <h3>
            <a
              class="item"
              href="https://ohadravid.github.io/posts/2025-05-rav1d-faster/"
              >Improving performance of rav1d video decoder</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-22 @ 11:59:03</span
              ><span class="points-container"
                >Points: <span class="points">198</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44061160"
                  >Comments</a
                ><span class="descendants">: 63</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44060772">
          <h3>
            <a class="item" href="https://github.com/bntre/CurvedSpaceShader"
              >Show HN: Curved Space Shader in Three.js (via 4D sphere
              projection)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-22 @ 10:52:44</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44060772"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
            <div class="text">
              <p>The idea:</p>
              <p></p>
              <pre><code>  1. Project a model onto a 4D sphere
  2. Rotate the sphere
  3. Project the model back to 3D
</code></pre>
              Code and details:
              <a href="https://github.com/bntre/CurvedSpaceShader"
                >https://github.com/bntre/CurvedSpaceShader</a
              >
              <p>Curious what you think.</p>
            </div>
          </section>
        </section>
        <section id="44060533">
          <h3>
            <a
              class="item"
              href="https://www.seangoedecke.com/limitations-of-text-diffusion-models/"
              >Strengths and limitations of diffusion language models</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-22 @ 10:10:09</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44060533"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44060305">
          <h3>
            <a
              class="item"
              href="https://somethingaboutmaps.wordpress.com/2025/05/20/planetfall/"
              >Planetfall</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-22 @ 09:17:57</span
              ><span class="points-container"
                >Points: <span class="points">230</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44060305"
                  >Comments</a
                ><span class="descendants">: 49</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44058778">
          <h3>
            <a
              class="item"
              href="https://lcamtuf.substack.com/p/decibels-are-ridiculous"
              >The scientific “unit” we call the decibel</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-22 @ 04:24:33</span
              ><span class="points-container"
                >Points: <span class="points">490</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44058778"
                  >Comments</a
                ><span class="descendants">: 390</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44057820">
          <h3>
            <a
              class="item"
              href="https://simonwillison.net/2025/May/21/gemini-diffusion/"
              >Gemini Diffusion</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-22 @ 01:13:50</span
              ><span class="points-container"
                >Points: <span class="points">769</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44057820"
                  >Comments</a
                ><span class="descendants">: 202</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44057612">
          <h3>
            <a
              class="item"
              href="https://github.com/derekeder/csv-to-html-table"
              >Display any CSV file as a searchable, filterable, pretty HTML
              table</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-22 @ 00:31:01</span
              ><span class="points-container"
                >Points: <span class="points">226</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44057612"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
            <div class="text">
              I combined this with a simple API to update a CSV file using
              Deno/deno-csv library, allowing an Ansible job to easily update a
              CSV file via the API with Ansible URI module, and then have that
              same CSV file viewable/downloadable in a simple and
              easy/dashboardy way (with CSV-to-html-table). Copilot created the
              Deno/deno-csv CSV API code and then with a little back and forth I
              added static website functionality (to serve the CSV table), and I
              had a /view and a /update route. I'm just a sysadmin but I love
              piecing together stuff like this. Thanks Derek!
            </div>
          </section>
        </section>
        <section id="44050269">
          <h3>
            <a
              class="item"
              href="https://www.theguardian.com/world/2025/may/21/without-time-there-is-no-flavour-a-south-korean-grand-master-on-the-art-of-the-perfect-soy-sauce"
              >A South Korean grand master on the art of the perfect soy
              sauce</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-21 @ 11:19:59</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44050269"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44049310">
          <h3>
            <a
              class="item"
              href="https://pieces.app/blog/how-we-made-our-optical-character-recognition-ocr-code-more-accurate"
              >How we made our OCR code more accurate</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-21 @ 08:05:13</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44049310"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44035125">
          <h3>
            <a class="item" href="https://github.com/KDAB/hotspot"
              >Hotspot: Linux `perf` GUI for performance analysis</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-19 @ 21:33:03</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44035125"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44026370">
          <h3>
            <a
              class="item"
              href="https://www.bozemanpass.com/everythings-a-bug-or-an-issue/"
              >Everything’s a bug (or an issue)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-19 @ 03:46:59</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44026370"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44026364">
          <h3>
            <a
              class="item"
              href="https://sandrock.co.za/carl/2025/05/four-years-of-sight-reading-pracice/"
              >Four years of sight reading practice</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-19 @ 03:44:30</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44026364"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44025283">
          <h3>
            <a
              class="item"
              href="https://microkerneldude.org/2025/04/27/benchmarking-crimes-meet-formal-verification/"
              >Benchmarking Crimes Meet Formal Verification</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-19 @ 00:04:22</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44025283"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44020107">
          <h3>
            <a class="item" href="https://iquilezles.org/articles/"
              >Inigo Quilez: computer graphics, mathematics, shaders, fractals,
              demoscene</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-05-18 @ 09:32:39</span
              ><span class="points-container"
                >Points: <span class="points">264</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44020107"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
