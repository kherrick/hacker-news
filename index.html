<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="38306317">
          <h3>
            <a
              class="item"
              href="https://www.ashbyhq.com/careers?utm_source=hn&amp;ashby_jid=443ded5b-4baf-4bdc-8081-1666b4cb7ee3"
              >Ashby (YC W19) Is Hiring a Remote SRE to Help Us Scale</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-17 @ 17:01:07</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38306174">
          <h3>
            <a
              class="item"
              href="https://breakingdefense.com/2023/11/with-trillions-at-play-pentagon-fails-audit-for-sixth-year-in-a-row/"
              >With trillions at play, Pentagon fails audit for sixth year in a
              row</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-17 @ 16:52:28</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38306174"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38306061">
          <h3>
            <a
              class="item"
              href="https://www.wired.com/2016/03/two-moves-alphago-lee-sedol-redefined-future/"
              >In Two Moves, AlphaGo and Lee Sedol Redefined the Future
              (2016)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-17 @ 16:45:43</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38306061"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38306057">
          <h3>
            <a
              class="item"
              href="https://www.filfre.net/2023/11/putting-the-j-in-the-rpg-part-1-dorakue/"
              >Putting the "J" in the RPG, Part 1: Dorakue</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-17 @ 16:45:34</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38306057"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38305787">
          <h3>
            <a class="item" href="https://stranger.video/"
              >A game about staring into the eyes of a stranger</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-17 @ 16:30:07</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38305787"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38305187">
          <h3>
            <a
              class="item"
              href="https://www.reuters.com/legal/transactional/apple-files-legal-challenge-eus-digital-markets-act-2023-11-17/"
              >Apple files legal challenge to EU's Digital Markets Act</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-17 @ 15:49:16</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38305187"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38305111">
          <h3>
            <a
              class="item"
              href="https://www.geekwire.com/2023/amazon-will-cut-several-hundred-more-jobs-on-alexa-team-as-it-discontinues-some-initiatives/"
              >Amazon will cut 'several hundred' Alexa jobs as it ends
              unspecified initiatives</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-17 @ 15:44:21</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38305111"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38305097">
          <h3>
            <a
              class="item"
              href="https://www.cnbc.com/2023/11/17/amazon-cuts-several-hundred-jobs-in-alexa-division.html"
              >Amazon cuts 'several hundred' jobs in Alexa division</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-17 @ 15:43:20</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38305097"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38304485">
          <h3>
            <a
              class="item"
              href="https://theconversation.com/the-worlds-280-million-electric-bikes-and-mopeds-are-cutting-demand-for-oil-far-more-than-electric-cars-213870"
              >280M e-bikes and mopeds are cutting demand for oil far more than
              electric cars</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-17 @ 15:02:26</span
              ><span class="points-container"
                >Points: <span class="points">273</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38304485"
                  >Comments</a
                ><span class="descendants">: 253</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38304290">
          <h3>
            <a
              class="item"
              href="https://twitter.com/WikiResearch/status/1723966761962520824"
              >Wikidata, with 12B facts, can ground LLMs to improve their
              factuality</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-17 @ 14:44:58</span
              ><span class="points-container"
                >Points: <span class="points">87</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38304290"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38304148">
          <h3>
            <a class="item" href="https://github.com/joennlae/tensorli"
              >Show HN: less than 650 LOC trainable GPT only using NumPy (no
              framework)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-17 @ 14:34:34</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38304148"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38302903">
          <h3>
            <a
              class="item"
              href="https://stefan-marr.de/2023/11/python-global-interpreter-lock/"
              >The Changing "Guarantees" Given by Python's Global Interpreter
              Lock</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-17 @ 13:03:06</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38302903"
                  >Comments</a
                ><span class="descendants">: 82</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38302780">
          <h3>
            <a
              class="item"
              href="https://www.wsj.com/personal-finance/real-estate-buying-home-charts-6dc40caa"
              >Almost No One Pays a 6% Real-Estate Commission–Except
              Americans</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-17 @ 12:48:36</span
              ><span class="points-container"
                >Points: <span class="points">266</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38302780"
                  >Comments</a
                ><span class="descendants">: 268</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38302634">
          <h3>
            <a
              class="item"
              href="https://torrentfreak.com/youtube-copyright-id-scammers-must-pay-artists-3-3m-restitution-231116/"
              >YouTube Copyright ID Scammers Must Pay Artists $3.3M
              Restitution</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-17 @ 12:34:37</span
              ><span class="points-container"
                >Points: <span class="points">151</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38302634"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38302319">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/information-technology/2023/11/unauthorized-david-attenborough-ai-clone-narrates-developers-life-goes-viral/"
              >Unauthorized "David Attenborough" AI clone narrates developer's
              life, goes viral</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-17 @ 11:57:18</span
              ><span class="points-container"
                >Points: <span class="points">176</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38302319"
                  >Comments</a
                ><span class="descendants">: 149</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38302306">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/gadgets/2023/11/google-news-will-stop-hosting-already-purchased-magazines-next-month/"
              >Google News is shutting down purchased magazine content, offering
              refunds</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-17 @ 11:56:13</span
              ><span class="points-container"
                >Points: <span class="points">112</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38302306"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
            <div class="text">
              <p>Hello,</p>
              <p>
                Since 2020, new purchases of magazines have not been available
                in Google News and very few users now regularly access their
                magazine subscriptions. We wanted to inform you that support for
                magazine content in Google News is being discontinued beginning
                on December 18, 2023, which means access from Google News apps
                or news.google.com to the library of magazines you previously
                purchased or subscribed to will be removed. To continue to
                access previously purchased magazine content, you must export
                and save each purchased issue before December 18, 2023.
              </p>
            </div>
          </section>
        </section>
        <section id="38302288">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/the-astonishing-behavior-of-recursive-sequences-20231116/"
              >The Astonishing Behavior of Recursive Sequences</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-17 @ 11:54:23</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38302288"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38302283">
          <h3>
            <a
              class="item"
              href="https://spectrum.ieee.org/ethernet-ieee-milestone"
              >Ethernet Is Still Going Strong After 50 Years</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-17 @ 11:53:51</span
              ><span class="points-container"
                >Points: <span class="points">226</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38302283"
                  >Comments</a
                ><span class="descendants">: 230</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38301801">
          <h3>
            <a
              class="item"
              href="https://www.eff.org/deeplinks/2021/12/chrome-users-beware-manifest-v3-deceitful-and-threatening"
              >Chrome Users Beware: Manifest V3 Is Deceitful and Threatening –
              EFF (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-17 @ 10:46:20</span
              ><span class="points-container"
                >Points: <span class="points">378</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38301801"
                  >Comments</a
                ><span class="descendants">: 148</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38301710">
          <h3>
            <a
              class="item"
              href="https://trstringer.com/oss-compensation-broken/"
              >The Lack of Compensation in Open Source Software Is
              Unsustainable</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-17 @ 10:33:23</span
              ><span class="points-container"
                >Points: <span class="points">190</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38301710"
                  >Comments</a
                ><span class="descendants">: 299</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38301644">
          <h3>
            <a class="item" href="https://github.com/emacs-ng/emacs-ng"
              >Emacs-ng: A project to integrate Deno and WebRender into Emacs</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-17 @ 10:20:33</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38301644"
                  >Comments</a
                ><span class="descendants">: 60</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38301480">
          <h3>
            <a
              class="item"
              href="https://theprogressplaybook.com/2023/10/19/energy-independent-uruguay-runs-on-100-renewables-for-four-straight-months/"
              >'Energy independent' Uruguay runs on 100% renewables for four
              straight months</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-17 @ 09:52:26</span
              ><span class="points-container"
                >Points: <span class="points">260</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38301480"
                  >Comments</a
                ><span class="descendants">: 178</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38299888">
          <h3>
            <a class="item" href="https://matan-h.com/analyze-stackoverflow"
              >I analyzed Stack Overflow for secrets</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-17 @ 05:18:56</span
              ><span class="points-container"
                >Points: <span class="points">163</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38299888"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38298695">
          <h3>
            <a
              class="item"
              href="https://thelast19digitsofpi.github.io/hardware-explorations/dist/index.html"
              >Arithmetic in Computer Hardware</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-17 @ 02:40:31</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38298695"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38298694">
          <h3>
            <a
              class="item"
              href="https://blog.jim-nielsen.com/2023/html-web-components-an-example/"
              >HTML Web Components: An Example</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-17 @ 02:40:26</span
              ><span class="points-container"
                >Points: <span class="points">106</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38298694"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38292915">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=vREokZa4dNU"
              >I spent 3 years working on a coat hanger [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-16 @ 17:52:55</span
              ><span class="points-container"
                >Points: <span class="points">1119</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38292915"
                  >Comments</a
                ><span class="descendants">: 391</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38274380">
          <h3>
            <a
              class="item"
              href="https://wingolog.org/archives/2023/11/14/whiffle-a-purpose-built-scheme"
              >Whiffle: A Purpose-Built Scheme</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-15 @ 08:03:02</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38274380"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38274301">
          <h3>
            <a
              class="item"
              href="https://hbr.org/2000/01/communities-of-practice-the-organizational-frontier"
              >Communities of Practice: The Organizational Frontier (2000)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-15 @ 07:49:30</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38274301"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38274049">
          <h3>
            <a
              class="item"
              href="https://www.phoronix.com/news/Canonical-Ubuntu-MicroCloud"
              >Canonical Launches MicroCloud to Deploy Your Own "Fully
              Functional Cloud"</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-15 @ 06:58:35</span
              ><span class="points-container"
                >Points: <span class="points">92</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38274049"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38273043">
          <h3>
            <a
              class="item"
              href="https://venturebeat.com/ai/what-meta-learned-from-galactica-the-doomed-model-launched-two-weeks-before-chatgpt/"
              >What Meta learned from Galactica, the doomed model</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-15 @ 03:40:40</span
              ><span class="points-container"
                >Points: <span class="points">105</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38273043"
                  >Comments</a
                ><span class="descendants">: 49</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
