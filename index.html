<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="37285804">
          <h3>
            <a
              class="item"
              href="https://www.businessinsider.com/flannery-silicon-valley-billionaires-build-new-california-city-solano-county-2023-8"
              >A company backed by SV has purchased 52,000 acres to build a new
              city</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-27 @ 19:25:45</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37285804"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37285653">
          <h3>
            <a
              class="item"
              href="https://hachyderm.io/@nedbat/110962461917632486"
              >Python Proposal (Inspired by Lua)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-27 @ 19:06:58</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37285653"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37285413">
          <h3>
            <a
              class="item"
              href="https://www.firstthings.com/web-exclusives/2023/08/classical-music-is-for-everyone"
              >Classical Music Is for Everyone</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-27 @ 18:37:10</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37285413"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37285396">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2308.08742"
              >PMET: Precise Model Editing in a Transformer</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-27 @ 18:35:14</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37285396"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37285156">
          <h3>
            <a class="item" href="https://asm32.info/fossil/asmbb/index"
              >A forum engine written in Assembly</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-27 @ 18:05:17</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37285156"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37284764">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/science/2023/08/study-carbon-offsets-arent-doing-their-job-overstate-impact/"
              >Study: Carbon offsets aren’t doing their job, overstate impact</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-27 @ 17:26:42</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37284764"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37284488">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=37284488"
              >Infiuss Health (YC S21) is hiring a data analyst</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-27 @ 17:00:40</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
            <div class="text">
              <p>Responsibilities:</p>
              <p>
                Data Preprocessing: Clean and preprocess large-scale healthcare
                datasets, ensuring data quality, consistency, and readiness for
                analysis. Address missing values, outliers, and other data
                anomalies to prepare the data for meaningful insights.
              </p>
              <p>
                Data Analysis: Conduct rigorous data analysis using statistical
                techniques and tools. Identify patterns, trends, correlations,
                and other meaningful insights in healthcare data to inform
                decision-making and research.
              </p>
              <p>
                Health Outcomes Analysis: Collaborate with domain experts to
                analyze health outcomes, disease incidence, prevalence,
                severity, and other relevant metrics. Frame analyses within the
                context of public health objectives.
              </p>
              <p>
                Data Visualization: Create informative and visually appealing
                data visualizations to communicate findings to both technical
                and non-technical stakeholders. Use visualization tools (e.g.,
                Tableau, ggplot) to convey complex data patterns in a clear and
                understandable manner.
              </p>
              <p>
                Report Generation: Generate regular and ad hoc reports for
                internal and external stakeholders, summarizing analysis
                results, key findings, and recommendations. Communicate insights
                through clear and concise reports and presentations.
              </p>
              <p>
                Collaboration with Data Team: Work closely with data scientists,
                data engineers, and other members of the project team to
                understand data requirements, support statistical modeling
                efforts, and ensure alignment with project goals.
              </p>
              <p>
                Health Equity-Focused Analyses: Contribute to the design and
                execution of health equity-focused studies, analyzing
                disparities and vulnerabilities in disease patterns and outcomes
                among specific population groups.
              </p>
              <p>
                Data Quality Assurance: Implement data quality checks,
                validation processes, and data cleansing as needed to ensure the
                accuracy and reliability of healthcare data.
              </p>
              <p>
                Continuous Learning: Stay updated on the latest data analysis
                techniques, tools, and best practices. Incorporate new knowledge
                into analyses to enhance the depth and quality of insights.
              </p>
              <p>Qualifications:</p>
              <p>
                Bachelor's or Master's degree in Data Science, Statistics,
                Epidemiology, or a related field. Proven experience (typically
                2+ years) in data analysis roles, preferably with exposure to
                healthcare or large-scale data projects. Proficiency in data
                preprocessing, statistical analysis, and data visualization.
                Strong programming skills in languages such as R or Python for
                data analysis. Experience with data visualization tools, such as
                Tableau or ggplot, to create meaningful and informative
                visualizations. Understanding of public health concepts and
                health outcomes. Excellent communication skills, capable of
                conveying analysis findings to both technical and non-technical
                audiences. Ability to collaborate effectively with
                cross-functional teams, domain experts, and stakeholders.
                Ethical and trustworthy, with a commitment to maintaining the
                highest level of integrity in data analysis. Knowledge of data
                privacy regulations (e.g., HIPAA) and ethical considerations in
                data handling.
              </p>
              <p>
                Role Engineering Eng type Data Science Job type Contract
                Experience 6+ years Location San Francisco, CA, US / Remote (US)
                Remote Yes US visas No sponsorship Salary $250K - $350K Equity
                missing Hiring manager Melissa Bime Last updated 08/13/2023
                Public URL
                <a
                  href="https://www.ycombinator.com/companies/infiuss-health/jobs/aLyB6Cr-data-analyst"
                  >https://www.ycombinator.com/companies/infiuss-health/jobs/aL...</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="37283860">
          <h3>
            <a
              class="item"
              href="https://thehustle.co/where-do-fonts-come-from/"
              >Where do fonts come from? This one business, mostly</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-27 @ 15:54:16</span
              ><span class="points-container"
                >Points: <span class="points">249</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37283860"
                  >Comments</a
                ><span class="descendants">: 125</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37283636">
          <h3>
            <a class="item" href="https://en.wikipedia.org/wiki/I_Can_Eat_Glass"
              >I Can Eat Glass</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-27 @ 15:33:58</span
              ><span class="points-container"
                >Points: <span class="points">120</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37283636"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37283375">
          <h3>
            <a
              class="item"
              href="https://www.cs.cmu.edu/~jasonh/personal/humor/compile.html"
              >Some of the error messages produced by Apple's MPW C compiler
              (2006)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-27 @ 15:04:04</span
              ><span class="points-container"
                >Points: <span class="points">150</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37283375"
                  >Comments</a
                ><span class="descendants">: 65</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37282469">
          <h3>
            <a
              class="item"
              href="https://annas-software.org/AnnaArchivist/annas-archive"
              >AnnaArchivist/annas-archive</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-27 @ 13:21:53</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37282469"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37282450">
          <h3>
            <a
              class="item"
              href="https://destevez.net/2023/08/demodulation-of-the-5g-nr-downlink/"
              >Demodulation of the 5G NR Downlink</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-27 @ 13:20:13</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37282450"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37282385">
          <h3>
            <a
              class="item"
              href="https://adamj.eu/tech/2021/05/11/python-type-hints-args-and-kwargs/"
              >Python Type Hints – *args and **kwargs (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-27 @ 13:11:18</span
              ><span class="points-container"
                >Points: <span class="points">155</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37282385"
                  >Comments</a
                ><span class="descendants">: 80</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37281745">
          <h3>
            <a class="item" href="https://overthewire.org/wargames/"
              >Overthewire.org</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-27 @ 11:53:56</span
              ><span class="points-container"
                >Points: <span class="points">191</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37281745"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37281692">
          <h3>
            <a class="item" href="https://github.com/satwikkansal/wtfpython"
              >WTFPython: Exploring and understanding Python through surprising
              snippets</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-27 @ 11:46:30</span
              ><span class="points-container"
                >Points: <span class="points">171</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37281692"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37281630">
          <h3>
            <a class="item" href="https://waku.gg/"
              >Waku: The Minimalist React Framework with Server Components</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-27 @ 11:37:42</span
              ><span class="points-container"
                >Points: <span class="points">81</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37281630"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37281411">
          <h3>
            <a
              class="item"
              href="https://github.com/exogee-technology/graphweaver"
              >Show HN: Graphweaver – Instant GraphQL API on Postgres, MySQL,
              SQLite and More</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-27 @ 11:00:09</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37281411"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
            <div class="text">
              Graphweaver is an open-source GraphQL API Server that can connect
              many data sources to create a single API. Create a headless CMS,
              API Gateway, BaaS or use it as a BFF.
            </div>
          </section>
        </section>
        <section id="37281060">
          <h3>
            <a class="item" href="https://ognjen.io/lie-still-in-bed/"
              >Lie still in bed</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-27 @ 09:52:06</span
              ><span class="points-container"
                >Points: <span class="points">206</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37281060"
                  >Comments</a
                ><span class="descendants">: 163</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37280972">
          <h3>
            <a
              class="item"
              href="https://solutional.ee/blog/2023-08-26-Prisoners-of-Google-Android-Development.html"
              >Prisoners of Google Android Development</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-27 @ 09:36:34</span
              ><span class="points-container"
                >Points: <span class="points">219</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37280972"
                  >Comments</a
                ><span class="descendants">: 155</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37280878">
          <h3>
            <a
              class="item"
              href="https://popey.com/blog/2023/08/i386-in-ubuntu-wont-die/"
              >i386 in Ubuntu won't die</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-27 @ 09:18:03</span
              ><span class="points-container"
                >Points: <span class="points">113</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37280878"
                  >Comments</a
                ><span class="descendants">: 95</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37279773">
          <h3>
            <a class="item" href="https://openwrt.org/docs/techref/ubus"
              >Ubus (OpenWrt micro bus architecture)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-27 @ 05:51:10</span
              ><span class="points-container"
                >Points: <span class="points">101</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37279773"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37279109">
          <h3>
            <a
              class="item"
              href="https://ericdraken.com/pfsense-decrypt-ad-traffic/"
              >Block YouTube ads on AppleTV by decrypting and stripping ads from
              Profobuf</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-27 @ 03:13:13</span
              ><span class="points-container"
                >Points: <span class="points">1026</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37279109"
                  >Comments</a
                ><span class="descendants">: 559</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37274610">
          <h3>
            <a
              class="item"
              href="https://pencilandpaper.io/articles/ux-pattern-analysis-loading-feedback/"
              >UX design patterns for loading</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-26 @ 17:02:10</span
              ><span class="points-container"
                >Points: <span class="points">4</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37274610"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37272652">
          <h3>
            <a class="item" href="https://rmkit.dev/eink-is-so-retropunk/"
              >E-ink is so Retropunk</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-26 @ 13:21:16</span
              ><span class="points-container"
                >Points: <span class="points">734</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37272652"
                  >Comments</a
                ><span class="descendants">: 344</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37272362">
          <h3>
            <a
              class="item"
              href="https://landmines.substack.com/p/earning-the-privilege-to-work-on"
              >Earning the privilege to work on unoriginal problems</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-26 @ 12:45:55</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37272362"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37271644">
          <h3>
            <a
              class="item"
              href="https://www.openculture.com/2019/06/when-kraftwerk-issued-their-own-pocket-calculator-synthesizer.html"
              >Kraftwerk issued their own pocket calculator synthesizer
              (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-26 @ 11:00:18</span
              ><span class="points-container"
                >Points: <span class="points">89</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37271644"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37271001">
          <h3>
            <a class="item" href="https://github.com/johnsonjh/OpenVi"
              >Portable OpenBSD vi for Unix systems</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-26 @ 09:15:59</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37271001"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37270108">
          <h3>
            <a
              class="item"
              href="https://adamsilver.io/blog/7-reasons-to-replace-advanced-search-with-filters-so-users-can-easily-find-what-they-need/"
              >Reasons to replace advanced search with filters</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-26 @ 05:10:18</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37270108"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37270007">
          <h3>
            <a
              class="item"
              href="https://www.japantimes.co.jp/news/2023/08/18/japan/society/exploring-the-eerie-beauty-of-japans-abandoned-villages/"
              >Exploring the eerie beauty of Japan's abandoned villages</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-26 @ 04:45:08</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37270007"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="37247906">
          <h3>
            <a
              class="item"
              href="https://daily.jstor.org/burned-house-mystery-why-did-this-ancient-culture-torch-its-own-homes-every-60-years/"
              >Ancient Culture Torched Its Own Homes Every 60 Years</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-08-24 @ 12:15:05</span
              ><span class="points-container"
                >Points: <span class="points">90</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=37247906"
                  >Comments</a
                ><span class="descendants">: 72</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
