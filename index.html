<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="36113564">
          <h3>
            <a class="item" href="https://codictionary.com/"
              >Show HN: A weekly newsletter that explain tech terms in plain,
              everyday language</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-29 @ 13:06:00</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36113564"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
            <div class="text">
              <p>
                At first, I tried to make a newsletter just for my clients. I
                wanted to bridge the gap between tech-savvy folks like me and
                those who aren't as familiar with the ins and outs of
                programming. But then it hit me—why not make it available to
                everyone who wants to understand the tech world without having
                to learn how to code? So, I revamped it to cater to anyone who's
                curious about technology.
              </p>
              <p>
                Each edition of the newsletter focuses on a specific tech term
                or concept. We'll break it down, ditch the complicated jargon,
                and give you real-life examples that make it all crystal clear.
                My goal isn't to teach you programming (that's a whole different
                ball game). Instead, I want to give you the knowledge you need
                to have better conversations and a deeper understanding of the
                tech that shapes our world.
              </p>
              <p>
                So, whether you're an entrepreneur who wants to connect better
                with your tech team, a project manager looking to understand
                what the developers are talking about, or simply a tech
                enthusiast who wants to dive into the digital world, hop on
                board and let's make tech simple together!
              </p>
            </div>
          </section>
        </section>
        <section id="36113551">
          <h3>
            <a
              class="item"
              href="https://www.altnews.in/wrestlers-detained-in-delhi-ai-image-of-smiling-vinesh-sangeeta-phogat-viral/"
              >India ruling party's IT cell used AI to show smile on arrested
              protesters' faces</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-29 @ 13:04:39</span
              ><span class="points-container"
                >Points: <span class="points">102</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36113551"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36113542">
          <h3>
            <a
              class="item"
              href="https://wasmlabs.dev/articles/hardening-drupal-with-webassembly/"
              >Hardening Drupal with WebAssembly</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-29 @ 13:03:05</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36113542"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36113534">
          <h3>
            <a
              class="item"
              href="https://www.reforge.com/blog/ai-products-arms-race"
              >Winning the AI Products Arms Race</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-29 @ 13:02:14</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36113534"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36113453">
          <h3>
            <a
              class="item"
              href="https://twitter.com/SakshiMalik/status/1662729269532065792"
              >India’s Olympics medalist female wrestlers detained while
              protesting against SA</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-29 @ 12:52:48</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36113453"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36113444">
          <h3>
            <a
              class="item"
              href="https://medium.com/onebigthought/the-ux-research-reckoning-is-here-c63710ea4084"
              >The UX Research Reckoning is Here</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-29 @ 12:50:41</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36113444"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36113331">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=36113331"
              >Ask HN: What are the most reliable tech sites in east and south
              Asia?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-29 @ 12:32:58</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36113331"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
            <div class="text">
              <p>
                While there is a lot of tech news related to what is going on in
                those countries (often for the wrong reasons), it’s hard to gage
                what the tech ecosystem is up to without knowing where to look.
              </p>
              <p>
                Language barriers aside (which are becoming less of an issue
                anyway), where would one go for reliable and direct news around
                semiconductor developments in Taiwan, or the weird products that
                emerge out of Shenzhen through AliExpress?
              </p>
              <p>Is there an HN of India? Or Indonesia?</p>
            </div>
          </section>
        </section>
        <section id="36113324">
          <h3>
            <a
              class="item"
              href="https://web.archive.org/web/20050322021208/http://www.kuro5hin.org/story/2005/3/19/133129/548"
              >A Coder in Courierland (2005)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-29 @ 12:31:26</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36113324"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36113307">
          <h3>
            <a
              class="item"
              href="https://www.eetimes.com/amprius-high-density-batteries-go-aloft/"
              >Amprius High-Density Batteries Go Aloft</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-29 @ 12:30:13</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36113307"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36113115">
          <h3>
            <a class="item" href="http://akkartik.name/freewheeling"
              >Using computers more freely and safely (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-29 @ 12:04:09</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36113115"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36112641">
          <h3>
            <a
              class="item"
              href="https://www.engadget.com/japan-will-try-to-beam-solar-power-from-space-by-2025-214338244.html"
              >Japan will try to beam solar power from space by 2025</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-29 @ 10:45:33</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36112641"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36112080">
          <h3>
            <a
              class="item"
              href="https://plus.maths.org/content/circles-rolling-circles"
              >Circles Rolling on Circles (2014)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-29 @ 08:56:01</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36112080"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36111878">
          <h3>
            <a class="item" href="https://github.com/clovaai/donut"
              >Donut: OCR-Free Document Understanding Transformer</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-29 @ 08:19:46</span
              ><span class="points-container"
                >Points: <span class="points">131</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36111878"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36111750">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/science/2023/05/intricate-tunnels-of-termite-mounds-could-be-key-to-energy-efficient-buildings/"
              >No A/C? No problem, if buildings copy networked tunnels of
              termite mounds</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-29 @ 07:54:44</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36111750"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36111683">
          <h3>
            <a
              class="item"
              href="https://www.infoq.com/news/2023/05/cloudflare-workers-connect-api/"
              >Cloudflare Workers Introduces Connect() API to Create TCP
              Sockets</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-29 @ 07:44:15</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36111683"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36111596">
          <h3>
            <a
              class="item"
              href="https://methexis.substack.com/p/production-ai-systems-are-really"
              >Production AI systems are hard</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-29 @ 07:27:20</span
              ><span class="points-container"
                >Points: <span class="points">92</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36111596"
                  >Comments</a
                ><span class="descendants">: 55</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36110684">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=O2cMnxShCVQ"
              >Commodore 64 Web server [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-29 @ 04:35:44</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36110684"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36110680">
          <h3>
            <a class="item" href="https://www.pagetable.com/?p=1107"
              >Fitting 44% More Data on a C64/1541 Floppy Disk</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-29 @ 04:35:15</span
              ><span class="points-container"
                >Points: <span class="points">89</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36110680"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36110629">
          <h3>
            <a
              class="item"
              href="https://predictabledesigns.com/how-much-does-it-cost-to-develop-and-manufacture-new-electronic-product/"
              >How much does it cost to develop and manufacture an electronic
              product? (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-29 @ 04:26:15</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36110629"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36110576">
          <h3>
            <a
              class="item"
              href="https://engineering.kablamo.com.au/posts/2023/media-queries-and-responsive-design/"
              >Media Queries and Responsive Design</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-29 @ 04:13:45</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36110576"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36110527">
          <h3>
            <a
              class="item"
              href="https://blog.archive.org/2023/05/29/let-us-serve-you-but-dont-bring-us-down/"
              >Let us serve you, but don't bring us down</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-29 @ 04:03:29</span
              ><span class="points-container"
                >Points: <span class="points">692</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36110527"
                  >Comments</a
                ><span class="descendants">: 158</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36110253">
          <h3>
            <a
              class="item"
              href="https://community.arm.com/arm-community-blogs/b/infrastructure-solutions-blog/posts/container-runtimes-wasmedge-arm"
              >Container Runtimes and WasmEdge benchmarking on Arm</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-29 @ 03:20:46</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36110253"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36108927">
          <h3>
            <a class="item" href="https://github.com/wwmm/easyeffects"
              >Easy Effects: Audio effects for PipeWire applications</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-28 @ 23:44:08</span
              ><span class="points-container"
                >Points: <span class="points">139</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36108927"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36108486">
          <h3>
            <a
              class="item"
              href="http://www.mevis-research.de/~ritter/awakeideas/desktop.html"
              >DESKTOP2 – A Graphical User Interface for DOS</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-28 @ 22:40:43</span
              ><span class="points-container"
                >Points: <span class="points">105</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36108486"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36106925">
          <h3>
            <a
              class="item"
              href="https://www.salon.com/2023/03/16/health-officials-delayed-report-linking-fluoride-to-brain-harm_partner/"
              >Health officials delayed report linking fluoride to brain harm</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-28 @ 19:24:51</span
              ><span class="points-container"
                >Points: <span class="points">393</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36106925"
                  >Comments</a
                ><span class="descendants">: 324</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36105591">
          <h3>
            <a
              class="item"
              href="https://conversableeconomist.com/2023/05/26/globalization-evolves-not-reverses/"
              >Globalization Evolves, Not Reverses</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-28 @ 16:37:35</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36105591"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36105398">
          <h3>
            <a
              class="item"
              href="https://www.wsj.com/articles/a-rare-1914-silent-film-was-considered-lost-forever-a-professor-rescued-it-from-a-vault-9bfdc1f0"
              >1914 Silent Film Considered Lost Forever. A Professor Rescued It
              from a Vault</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-28 @ 16:18:19</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36105398"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36104234">
          <h3>
            <a
              class="item"
              href="https://www.medialens.org/2023/head-trapped-descartes-dawkins-hobbes-marx-mill-darwin-and-the-myth-of-western-civilisation/"
              >Head-Trapped – Descartes, Dawkins, Hobbes, Marx, Mill, Darwin</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-28 @ 14:22:50</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36104234"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36103520">
          <h3>
            <a
              class="item"
              href="https://softwaredoug.com/blog/2023/05/28/feedback-is-rarely-a-gift.html"
              >When feedback is not a gift</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-28 @ 12:44:50</span
              ><span class="points-container"
                >Points: <span class="points">99</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36103520"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36102460">
          <h3>
            <a
              class="item"
              href="https://austinhenley.com/blog/teenytinycompiler1.html"
              >Let's make a Teeny Tiny compiler (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-05-28 @ 09:25:33</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36102460"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
