<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="44642349">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/ai-comes-up-with-bizarre-physics-experiments-but-they-work-20250721/"
              >AI comes up with bizarre physics experiments, but they work</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-22 @ 01:28:49</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44642349"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44641669">
          <h3>
            <a
              class="item"
              href="https://hardcoresoftware.learningbyshipping.com/p/234-if-writing-is-thinking"
              >If writing is thinking then what happens if AI is doing the
              writing and reading?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-21 @ 23:45:15</span
              ><span class="points-container"
                >Points: <span class="points">92</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44641669"
                  >Comments</a
                ><span class="descendants">: 75</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44641521">
          <h3>
            <a
              class="item"
              href="https://docs.astral.sh/uv/guides/scripts/#running-a-script-with-dependencies"
              >Uv: Running a script with dependencies</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-21 @ 23:26:40</span
              ><span class="points-container"
                >Points: <span class="points">177</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44641521"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44641464">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/civis/threads/fcc-to-eliminate-gigabit-speed-goal-and-scrap-analysis-of-broadband-prices.1508451/page-2"
              >FCC to eliminate gigabit speed goal and scrap analysis of
              broadband prices</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-21 @ 23:18:14</span
              ><span class="points-container"
                >Points: <span class="points">155</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44641464"
                  >Comments</a
                ><span class="descendants">: 81</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44640651">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/spice-data/jobs/RJz1peY-product-associate-new-grad"
              >Spice Data (YC S19) Is Hiring a Product Associate (New Grad)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-21 @ 21:31:23</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44640331">
          <h3>
            <a
              class="item"
              href="https://www.washingtonpost.com/news/wonk/wp/2015/09/22/the-surprising-geography-of-american-left-handedness/"
              >The surprising geography of American left-handedness (2015)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-21 @ 20:57:11</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44640331"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
            <div class="text">
              <a
                href="http://web.archive.org/web/20250420182951/https://www.washingtonpost.com/news/wonk/wp/2015/09/22/the-surprising-geography-of-american-left-handedness/"
                >http://web.archive.org/web/20250420182951/https://www.washin...</a
              >
            </div>
          </section>
        </section>
        <section id="44640233">
          <h3>
            <a
              class="item"
              href="https://e360.yale.edu/features/world-bank-hydro-dams"
              >In a major reversal, the world bank is backing mega dams
              (2024)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-21 @ 20:48:50</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44640233"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44640178">
          <h3>
            <a
              class="item"
              href="https://www.riskgaming.com/p/how-jane-jacobs-got-americans-stuck"
              >Yoni Appelbaum on the real villians behind our housing and
              mobility problems</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-21 @ 20:43:10</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44640178"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44639524">
          <h3>
            <a
              class="item"
              href="https://www.grisp.org/blog/posts/2025-06-11-grisp-nano-codebeam-sto"
              >Erlang 28 on GRiSP Nano using only 16 MB</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-21 @ 19:40:15</span
              ><span class="points-container"
                >Points: <span class="points">119</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44639524"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44639421">
          <h3>
            <a
              class="item"
              href="https://blog.getjetback.com/scarcity-inventory-and-inequity-a-deep-dive-into-airline-fare-buckets/"
              >Scarcity, Inventory, and Inequity: A Deep Dive into Airline Fare
              Buckets</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-21 @ 19:31:43</span
              ><span class="points-container"
                >Points: <span class="points">90</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44639421"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44638710">
          <h3>
            <a
              class="item"
              href="https://github.com/anordin95/a-conceptual-overview-of-asyncio/blob/main/readme.md"
              >The Fundamentals of Asyncio</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-21 @ 18:32:26</span
              ><span class="points-container"
                >Points: <span class="points">120</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44638710"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44638580">
          <h3>
            <a
              class="item"
              href="https://www.lumafield.com/article/what-went-wrong-inside-these-recalled-power-banks"
              >What went wrong inside recalled Anker PowerCore 10000 power
              banks?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-21 @ 18:22:11</span
              ><span class="points-container"
                >Points: <span class="points">336</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44638580"
                  >Comments</a
                ><span class="descendants">: 163</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44638510">
          <h3>
            <a class="item" href="https://www.lotas.ai/"
              >Show HN: Lotas – Cursor for RStudio</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-21 @ 18:16:10</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44638510"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.lotas.ai/">https://www.lotas.ai/</a>), and
              we’ve built an AI coding assistant into RStudio (think Cursor for
              RStudio).
              <p>
                RStudio is used by about 2 million data scientists and
                academics, but they currently lack a coding assistant within
                their IDE. Developers in other environments benefit from tools
                like Cursor and Windsurf, but R users don’t have any equivalent
                tools to speed up their workflow. Since ~80% of R programmers
                prefer to use RStudio over other IDEs like VSCode to write R
                code, we figured a tool like this one could be quite useful.
              </p>
              <p>
                Both of us were PhD students at Harvard. Jorge was in the
                biophysics program and Will was in the biostatistics program
                where most people used RStudio every day. We saw how integrated
                code assistants were taking off in other IDEs, but we noticed
                that the RStudio integrations were still lagging far behind.
                Many R users were copying and pasting code from ChatGPT to build
                their workflows, and this was clearly slow and fragile.
              </p>
              <p>
                To bring the Cursor-like experience to RStudio users, we built
                Rao (<a href="https://www.lotas.ai/">https://www.lotas.ai/</a>):
                a fork of RStudio with an embedded AI assistant that is aware of
                the user’s local context (both files and variable environment),
                can read and write files, can run code or commands, and can
                interpret textual or visual output. It works with any of the
                file formats already in RStudio (R, notebooks including RMDs and
                QMDs, Python, Stan, etc.), allowing R programmers to iteratively
                perform entire data analyses inside their preferred IDE.
              </p>
              <p>
                Other AI data science tools are either (1) built on the web or
                in environments people don’t already use, (2) are completely
                focused on python notebooks, or (3) are weak package-based
                assistants with limited functionality. Rao is exactly like the
                RStudio IDE that millions of data scientists already use, but it
                incorporates a powerful AI assistant and works with all the
                standard file types.
              </p>
              <p>
                You can download Rao at
                <a href="https://www.lotas.ai/download"
                  >https://www.lotas.ai/download</a
                >, watch our demo on the homepage (<a
                  href="https://www.lotas.ai/"
                  >https://www.lotas.ai/</a
                >), and work through some example use cases on our GitHub (<a
                  href="https://github.com/lotas-ai/rao/tree/main/demos"
                  >https://github.com/lotas-ai/rao/tree/main/demos</a
                >). We have a one-week free trial (no card required) and provide
                500 queries/month for $20/month after that. We’d love to hear
                feedback from the HN community to make Rao as useful as
                possible! You can reach us at founders@lotas.ai.
              </p>
              <p>
                P.S. We have zero data retention (ZDR) agreements with OpenAI
                and Anthropic, but we currently recommend users do not input
                sensitive or regulated data like PHI into Rao until we sign BAAs
                with both model providers. For more information on our security
                practices, please visit the security page on our website
                <a href="https://www.lotas.ai/security"
                  >https://www.lotas.ai/security</a
                >.
              </p>
            </div>
          </section>
        </section>
        <section id="44638509">
          <h3>
            <a
              class="item"
              href="https://www.newyorker.com/magazine/2025/07/28/the-mission-the-cia-in-the-21st-century-tim-weiner-book-review"
              >What Will Become of the CIA?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-21 @ 18:16:07</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44638509"
                  >Comments</a
                ><span class="descendants">: 111</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44637716">
          <h3>
            <a class="item" href="https://github.com/noperator/jqfmt"
              >Jqfmt like gofmt, but for jq</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-21 @ 17:16:44</span
              ><span class="points-container"
                >Points: <span class="points">142</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44637716"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44637715">
          <h3>
            <a class="item" href="https://www.morphik.ai/blog/stop-parsing-docs"
              >Don't bother parsing: Just use images for RAG</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-21 @ 17:16:41</span
              ><span class="points-container"
                >Points: <span class="points">207</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44637715"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44637352">
          <h3>
            <a class="item" href="https://accounting.penrose.com/"
              >AccountingBench: Evaluating LLMs on real long-horizon business
              tasks</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-21 @ 16:48:28</span
              ><span class="points-container"
                >Points: <span class="points">421</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44637352"
                  >Comments</a
                ><span class="descendants">: 111</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44637191">
          <h3>
            <a
              class="item"
              href="https://deepmind.google/discover/blog/advanced-version-of-gemini-with-deep-think-officially-achieves-gold-medal-standard-at-the-international-mathematical-olympiad/"
              >Gemini with Deep Think achieves gold-medal standard at the IMO</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-21 @ 16:36:13</span
              ><span class="points-container"
                >Points: <span class="points">473</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44637191"
                  >Comments</a
                ><span class="descendants">: 213</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44636204">
          <h3>
            <a
              class="item"
              href="https://www.iter.org/node/20687/new-records-wendelstein-7-x"
              >New records on Wendelstein 7-X</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-21 @ 15:18:41</span
              ><span class="points-container"
                >Points: <span class="points">201</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44636204"
                  >Comments</a
                ><span class="descendants">: 85</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44635867">
          <h3>
            <a
              class="item"
              href="https://the418.substack.com/p/a-bug-in-the-mail"
              >Occasionally USPS sends me pictures of other people's mail</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-21 @ 14:54:41</span
              ><span class="points-container"
                >Points: <span class="points">164</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44635867"
                  >Comments</a
                ><span class="descendants">: 161</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44635808">
          <h3>
            <a class="item" href="https://github.com/KrishKrosh/TrackWeight"
              >TrackWeight: Turn your MacBook's trackpad into a digital weighing
              scale</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-21 @ 14:51:13</span
              ><span class="points-container"
                >Points: <span class="points">490</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44635808"
                  >Comments</a
                ><span class="descendants">: 125</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44635745">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/tech-policy/2025/07/uk-backing-down-on-apple-encryption-backdoor-after-pressure-from-us/"
              >UK backing down on Apple encryption backdoor after pressure from
              US</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-21 @ 14:46:40</span
              ><span class="points-container"
                >Points: <span class="points">464</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44635745"
                  >Comments</a
                ><span class="descendants">: 321</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44634340">
          <h3>
            <a
              class="item"
              href="https://www.indiehackers.com/post/ive-launched-37-products-in-5-years-and-not-doing-that-again-0b66e6e8b3"
              >I've launched 37 products in 5 years and not doing that again</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-21 @ 12:27:24</span
              ><span class="points-container"
                >Points: <span class="points">116</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44634340"
                  >Comments</a
                ><span class="descendants">: 104</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44629710">
          <h3>
            <a
              class="item"
              href="https://www.washingtonpost.com/technology/2025/07/20/microsoft-sharepoint-hack/"
              >Global hack on Microsoft Sharepoint hits U.S., state agencies,
              researchers say</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-20 @ 21:58:06</span
              ><span class="points-container"
                >Points: <span class="points">493</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44629710"
                  >Comments</a
                ><span class="descendants">: 217</span></span
              >
            </h4>
            <div class="text">
              <a href="https://archive.ph/Ym2jZ">https://archive.ph/Ym2jZ</a>,
              <a
                href="https://web.archive.org/web/20250721135933/https://www.washingtonpost.com/technology/2025/07/20/microsoft-sharepoint-hack/"
                >https://web.archive.org/web/20250721135933/https://www.washi...</a
              >
              <p>
                <a href="https://research.eye.security/sharepoint-under-siege/"
                  >https://research.eye.security/sharepoint-under-siege/</a
                >
              </p>
              <p>
                <a
                  href="https://krebsonsecurity.com/2025/07/microsoft-fix-targets-attacks-on-sharepoint-zero-day/"
                  >https://krebsonsecurity.com/2025/07/microsoft-fix-targets-at...</a
                >
              </p>
              <p>
                <a
                  href="https://www.bleepingcomputer.com/news/microsoft/microsoft-releases-emergency-patches-for-sharepoint-rce-flaws-exploited-in-attacks/"
                  >https://www.bleepingcomputer.com/news/microsoft/microsoft-re...</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="44615033">
          <h3>
            <a
              class="item"
              href="https://www.nasa.gov/image-article/nasas-x-59-quiet-supersonic-aircraft-begins-taxi-tests/"
              >NASA's X-59 Quiet Supersonic Aircraft Begins Taxi Tests</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-19 @ 12:41:15</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44615033"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44614747">
          <h3>
            <a class="item" href="https://en.m.wikipedia.org/wiki/SignWriting"
              >Sutton SignWriting is a writing system for sign languages</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-19 @ 11:54:40</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44614747"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44613361">
          <h3>
            <a
              class="item"
              href="https://eclecticlight.co/2025/07/19/a-brief-history-of-primary-coding-languages/"
              >A brief history of primary coding languages</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-19 @ 07:33:19</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44613361"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44613268">
          <h3>
            <a
              class="item"
              href="https://vurt.org/articles/my-favourite-german-word/"
              >My favourite German word</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-19 @ 07:11:14</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44613268"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44605245">
          <h3>
            <a class="item" href="https://graydon2.dreamwidth.org/318788.html"
              >Losing language features: some stories about disjoint unions</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-18 @ 14:47:16</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44605245"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44598090">
          <h3>
            <a
              class="item"
              href="https://www.medievalists.net/2025/07/medieval-king-daily-life/"
              >The daily life of a medieval king</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-17 @ 20:54:02</span
              ><span class="points-container"
                >Points: <span class="points">280</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44598090"
                  >Comments</a
                ><span class="descendants">: 157</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
