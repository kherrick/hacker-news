<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="40023319">
          <h3>
            <a
              class="item"
              href="https://wingolog.org/archives/2023/11/24/tree-shaking-the-horticulturally-misguided-algorithm"
              >Tree-shaking, the horticulturally misguided algorithm</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-13 @ 14:20:20</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40023319"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40023070">
          <h3>
            <a
              class="item"
              href="https://twitter.com/fortranlang/status/1778953864458174941"
              >Fortran-lang joins NumFOCUS as a sponsored project</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-13 @ 13:40:37</span
              ><span class="points-container"
                >Points: <span class="points">4</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40023070"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40022801">
          <h3>
            <a
              class="item"
              href="https://untappedcities.com/2024/04/12/grain-de-sail-ll/"
              >350 tons of of chocolate and wine arrive on world’s largest cargo
              sailboat</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-13 @ 12:45:47</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40022801"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40022709">
          <h3>
            <a
              class="item"
              href="https://internationaltimes.it/a-disgruntled-federal-employees-1980s-desk-calendar/"
              >A disgruntled federal employee's 1980s desk calendar (2018)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-13 @ 12:27:54</span
              ><span class="points-container"
                >Points: <span class="points">57</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40022709"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40022651">
          <h3>
            <a
              class="item"
              href="https://knowablemagazine.org/content/article/society/2024/why-do-some-people-always-get-lost-but-others-dont"
              >Why do some people always get lost?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-13 @ 12:17:25</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40022651"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40022628">
          <h3>
            <a
              class="item"
              href="https://jameshfisher.com/2024/04/12/shape-typing-in-python/"
              >Shape Typing in Python</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-13 @ 12:12:24</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40022628"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40019217">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2404.07544"
              >Your LLM Is a Capable Regressor When Given In-Context Examples</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-13 @ 00:39:00</span
              ><span class="points-container"
                >Points: <span class="points">96</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40019217"
                  >Comments</a
                ><span class="descendants">: 23</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40017310">
          <h3>
            <a
              class="item"
              href="https://securelist.com/xz-backdoor-story-part-1/112354/"
              >XZ backdoor story – Initial analysis</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-12 @ 20:28:36</span
              ><span class="points-container"
                >Points: <span class="points">354</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40017310"
                  >Comments</a
                ><span class="descendants">: 201</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40017180">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=40017180"
              >Show HN: Mazelit - My wife and I released our first game</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-12 @ 20:16:28</span
              ><span class="points-container"
                >Points: <span class="points">448</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40017180"
                  >Comments</a
                ><span class="descendants">: 126</span></span
              >
            </h4>
            <div class="text">
              <p>
                About a year ago my wife and I, both closing in on 40, quit our
                jobs at Red Hat to start a games company and learn game
                development. Many things happened along the road, and about a
                week ago we released our first (small) game on Steam.
              </p>
              <p>
                <a href="https://store.steampowered.com/app/2816120/Mazelit/"
                  >https://store.steampowered.com/app/2816120/Mazelit/</a
                >
              </p>
              <p>
                The demo is free to play up to level 8 (the final game plays up
                to level 80) and we'd appreciate any feedback you have, whether
                it's for the store page or the game itself.
              </p>
              <p>
                We made the game in Godot 4.2 in roughly 3 months and I was
                working full time next to it. Since we ran into a bunch of
                roadblocks, we decided to also offer the entire source code up
                as a DLC in case someone wants to go look how we implemented the
                game, mod the game, or compile it for a different platform. The
                only thing we can't redistribute with the game code is the
                Steamworks SDK, which is available for download from Steam. (The
                game minus integration is fully runnable without the SDK,
                though.)
              </p>
              <p>Cheers and happy weekend!</p>
            </div>
          </section>
        </section>
        <section id="40016888">
          <h3>
            <a class="item" href="https://greensdictofslang.com/"
              >Green's Dictionary of Slang</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-12 @ 19:45:40</span
              ><span class="points-container"
                >Points: <span class="points">93</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40016888"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40015460">
          <h3>
            <a class="item" href="https://github.com/nanochess/RayTracer"
              >Ray Tracer in a Boot Sector</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-12 @ 17:33:58</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40015460"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40015113">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/artisan-ai/jobs/QNttgQ2-senior-backend-engineer"
              >Artisan AI (YC W24) Is Hiring a Senior Back End Engineer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-12 @ 17:00:17</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40014937">
          <h3>
            <a
              class="item"
              href="https://www.doscher.com/recovery-kit-version-2/"
              >Show HN: 5 Years Ago I made the Recovery Kit, I just made the
              RK2</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-12 @ 16:45:09</span
              ><span class="points-container"
                >Points: <span class="points">377</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40014937"
                  >Comments</a
                ><span class="descendants">: 75</span></span
              >
            </h4>
            <div class="text">
              The Recovery Kit 2 is another cyberdeck that for me is part
              computer, part backup device, and part functional movie prop. It's
              been fun to build, and the HN community has been great with ideas-
              especially around hosting and getting me off Squarespace. I hope
              you all enjoy!
            </div>
          </section>
        </section>
        <section id="40014730">
          <h3>
            <a class="item" href="https://www.zerosheets.com/"
              >Show HN: Using Google Sheets as the back end/APIs of your app</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-12 @ 16:29:01</span
              ><span class="points-container"
                >Points: <span class="points">321</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40014730"
                  >Comments</a
                ><span class="descendants">: 152</span></span
              >
            </h4>
            <div class="text">
              <p>
                At a company I worked for, we needed to develop an MVP
                (basically a web page) and apply certain business logic to a
                Google Drive spreadsheet that was frequently updated by the
                Sales team.
              </p>
              <p>In this case, we had two options:</p>
              <p>
                Develop a backend to replace the current spreadsheet and have
                the sales team use it as a new "backoffice" - This would take a
                very long time, and if the hypothesis we were testing was wrong,
                it would be time wasted.
              </p>
              <p>
                Create the web page and use Google's SDK to extract data from
                the spreadsheet.
              </p>
              <p>
                We chose to go with the second option because it was quicker.
                Indeed, it was much faster than creating a new backoffice. But
                not as quick as we imagined. Integrating with Google's SDK
                requires some effort, especially to handle the OAuth logic,
                configure it in the console, and understand the documentation
                (which is quite shallow, by the way).
              </p>
              <p>
                Anyway! We did the project and I realized that maybe other devs
                might have encountered similar issues. Therefore, I developed a
                tool that transforms Google spreadsheets into "realtime APIs"
                with PATCH, GET, POST, and DELETE methods.
              </p>
              <p>
                Since it's a product for devs, I think it would be cool to hear
                your opinions. It's still quite primitive, but the basic
                features already work.
              </p>
              <p><a href="https://zerosheets.com">https://zerosheets.com</a></p>
            </div>
          </section>
        </section>
        <section id="40014087">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=40014087"
              >I'm Peter Roberts, immigration attorney who does work for YC and
              startups. AMA</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-12 @ 15:34:07</span
              ><span class="points-container"
                >Points: <span class="points">285</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40014087"
                  >Comments</a
                ><span class="descendants">: 325</span></span
              >
            </h4>
            <div class="text">
              <p>
                Previous threads we've done:
                <a href="https://news.ycombinator.com/submitted?id=proberts"
                  >https://news.ycombinator.com/submitted?id=proberts</a
                >.
              </p>
              <p>
                Edit: Good afternoon. I will be stepping out now and returning
                this evening or tomorrow morning so please continue to send me
                your questions and comments and I will make sure to answer every
                one. Thank you! This has been great so far.
              </p>
            </div>
          </section>
        </section>
        <section id="40010819">
          <h3>
            <a
              class="item"
              href="https://github.com/tinygrad/open-gpu-kernel-modules"
              >Hacked Nvidia 4090 GPU driver to enable P2P</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-12 @ 09:27:58</span
              ><span class="points-container"
                >Points: <span class="points">694</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40010819"
                  >Comments</a
                ><span class="descendants">: 291</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40010615">
          <h3>
            <a class="item" href="https://heatpumpmonitor.org/"
              >An open source initiative to share and compare heat pump
              performance data</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-12 @ 08:53:16</span
              ><span class="points-container"
                >Points: <span class="points">676</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40010615"
                  >Comments</a
                ><span class="descendants">: 330</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40010221">
          <h3>
            <a
              class="item"
              href="https://spacetelescopelive.org/webb?obsId=01HTJT20C0STKNZ01KQYGEKBQ1"
              >What is Webb observing now?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-12 @ 07:29:17</span
              ><span class="points-container"
                >Points: <span class="points">354</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40010221"
                  >Comments</a
                ><span class="descendants">: 73</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40009997">
          <h3>
            <a
              class="item"
              href="https://contrapunctus.codeberg.page/blog/mapping-party-tips.html"
              >Organizing OpenStreetMap mapping parties</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-12 @ 06:46:07</span
              ><span class="points-container"
                >Points: <span class="points">194</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40009997"
                  >Comments</a
                ><span class="descendants">: 86</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40009856">
          <h3>
            <a
              class="item"
              href="https://www.ianvisits.co.uk/articles/theres-a-dead-rabbit-in-seven-sisters-tube-station-71502/"
              >There’s a 30-year old dead Rabbit in Seven Sisters tube
              station</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-12 @ 06:14:55</span
              ><span class="points-container"
                >Points: <span class="points">409</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40009856"
                  >Comments</a
                ><span class="descendants">: 215</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40009143">
          <h3>
            <a class="item" href="https://github.com/andrewcourtice/ripl"
              >Show HN: A JavaScript library for data visualization in both SVG
              and Canvas</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-12 @ 03:31:29</span
              ><span class="points-container"
                >Points: <span class="points">141</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40009143"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
            <div class="text">
              <p>
                I am aware there are already libraries that can draw to multiple
                contexts interchangeably, but I've added a few little niceties
                to Ripl that (as far as I know) some other libraries don't have
                such as CSS-like query selectors, DOM-like event bubbling, and
                keyframe animation support.
              </p>
              <p>
                The project is far from done and not published to NPM yet, but
                there are a few demos and source that you can look at in the
                repo.
              </p>
              <p>
                I'm happy with how it has come along and the things I've learnt
                along the way, especially the math. My dream would be to one day
                work on this full-time and build out a full data-viz library.
              </p>
            </div>
          </section>
        </section>
        <section id="40007947">
          <h3>
            <a
              class="item"
              href="https://www.the-tls.co.uk/articles/carson-mccullers-mary-v-dearborn-book-review-tom-seymour-evans/"
              >Life at the sad café: Carson McCullers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-11 @ 23:35:46</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40007947"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="40003710">
          <h3>
            <a
              class="item"
              href="https://paulbupejr.com/developing-the-optigap-sensor-system/"
              >Show HN: I made a new sensor out of 3D printer filament for my
              PhD</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-11 @ 16:06:03</span
              ><span class="points-container"
                >Points: <span class="points">843</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40003710"
                  >Comments</a
                ><span class="descendants">: 127</span></span
              >
            </h4>
            <div class="text">
              <p>
                I've been on HN for a while now and I've seen my fair share of
                posts about the woes of pursuing a PhD. Now that I'm done with
                mine I wanna share some anecdotal evidence that doing a PhD can
                actually be enjoyable (not necessarily easy) and also be doable
                in 3 years.
              </p>
              <p>
                When I started I knew I didn't want to work on something that
                would never leave the lab or languish in a dissertation PDF no
                one will ever read. Thanks to an awesome advisor I think I
                managed to thread the needle between simplicity and
                functionality.
              </p>
              <p>
                Looking back, the ideas and methods behind it are pretty
                straightforward, but getting there took some doing. It’s funny
                how things seem obvious once you've figured them out!
              </p>
              <p>
                Oh, I love creating GUIs for sensor data and visualizations as
                you'll see -- it's such a game changer! pyqtgraph is my go-to at
                the moment - such a great library.
              </p>
            </div>
          </section>
        </section>
        <section id="40000349">
          <h3>
            <a
              class="item"
              href="https://textslashplain.com/2024/04/10/browser-security-bugs-that-arent-javascript-in-pdf/"
              >Browser Security Bugs That Aren't: JavaScript in PDF</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-11 @ 09:50:18</span
              ><span class="points-container"
                >Points: <span class="points">73</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=40000349"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39999855">
          <h3>
            <a
              class="item"
              href="https://yehudakatz.com/2009/11/15/metaprogramming-in-ruby-its-all-about-the-self/"
              >Metaprogramming in Ruby: It's All About the Self (2009)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-11 @ 08:42:52</span
              ><span class="points-container"
                >Points: <span class="points">77</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39999855"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39999713">
          <h3>
            <a
              class="item"
              href="https://www.vogue.com/article/joan-didion-self-respect-essay-1961"
              >On Self-Respect (1961)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-11 @ 08:23:12</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39999713"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39999159">
          <h3>
            <a class="item" href="https://gekk.info/articles/dosapps.html"
              >Running DOS Apps on Windows from 1.0 to 95 (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-11 @ 07:04:30</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39999159"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39998903">
          <h3>
            <a class="item" href="https://worldsensorium.com/backyard-birding/"
              >Backyard Birding (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-11 @ 06:11:06</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39998903"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39998483">
          <h3>
            <a
              class="item"
              href="https://www.nextbigfuture.com/2018/09/commercial-wing-in-ground-effect-plane.html"
              >Commercial wing in ground effect plane (2018)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-11 @ 04:48:24</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39998483"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39998396">
          <h3>
            <a class="item" href="https://eprint.iacr.org/2024/555"
              >Quantum Algorithms for Lattice Problems</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-11 @ 04:32:15</span
              ><span class="points-container"
                >Points: <span class="points">196</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39998396"
                  >Comments</a
                ><span class="descendants">: 89</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
