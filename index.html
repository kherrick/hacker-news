<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="43329373">
          <h3>
            <a
              class="item"
              href="https://www.economist.com/finance-and-economics/2025/02/27/india-has-undermined-a-popular-myth-about-development"
              >Extreme poverty in India is now negligible, without an industrial
              miracle</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-11 @ 05:19:50</span
              ><span class="points-container"
                >Points: <span class="points">4</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43329373"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43328095">
          <h3>
            <a class="item" href="https://www.seven39.com"
              >Seven39 – a social media app that is only open for 3 hours every
              evening</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-11 @ 01:05:10</span
              ><span class="points-container"
                >Points: <span class="points">161</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43328095"
                  >Comments</a
                ><span class="descendants">: 101</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43327758">
          <h3>
            <a class="item" href="https://github.com/eduardoagarcia/shef"
              >Shef</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-11 @ 00:16:54</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43327758"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43327730">
          <h3>
            <a class="item" href="https://www.fourmilab.ch/gravitation/foobar/"
              >Bending Spacetime in the Basement</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-11 @ 00:11:33</span
              ><span class="points-container"
                >Points: <span class="points">111</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43327730"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43327230">
          <h3>
            <a class="item" href="https://chatgpt-folders.netlify.app/"
              >Show HN: Chrome Extension for ChatGPT to organize conversations
              into folders</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-10 @ 23:11:47</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43327230"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
            <div class="text">
              <p>
                The idea for this extension came from a friend who highlighted
                the lack of good (and affordable) ChatGPT organizers. Many
                existing tools were either low-quality or overpriced, so I
                decided to create one that was both reliable and accessible. I
                built the extension using plain JavaScript and developed a
                backend with Express to handle Google authentication. For
                storage, I used MongoDB, enabling all users with an account to
                save their folder structures and conversation data. Initially, I
                planned to charge $5 per month to cover costs since originally
                this extension was intended as a portfolio project addressing a
                real-world problem.
              </p>
              <p>
                However, just as I finished the main functionality and was about
                to implement payments, ChatGPT announced an official feature
                similar to one my extension was providing. Rather than continue
                competing in a market with an "official" solution, I decided to
                stop development. But I didn't want my work to go to waste, so I
                chose to release it for free, motivated by a desire to share it
                with the community.
              </p>
              <p>
                I made some changes to eliminate the backend. Now the extension
                stores all folder structures and content locally in Chrome
                storage. Luckily, I had some old code to reuse for this. The
                extension is now live on the Chrome Web Store.
              </p>
              <p>
                This project introduced me to a lot of new challenges with
                technologies I hadn’t used before, but I’m grateful for the
                experience and the skills I gained along the way.
              </p>
              <p>
                I hope you find it useful! Links to the extension and its
                website:
                <a
                  href="https://chromewebstore.google.com/detail/chatgpt-folders/akgpkjgpdobkagnipbohfpagjmbpjnfb"
                  >https://chromewebstore.google.com/detail/chatgpt-folders/akg...</a
                >
                <a href="https://chatgpt-folders.netlify.app/"
                  >https://chatgpt-folders.netlify.app/</a
                >
              </p>
              <p>
                If you have any questions or suggestions, feel free to reach out
                in the comments or via email at georgepozdman@gmail.com.
              </p>
            </div>
          </section>
        </section>
        <section id="43326275">
          <h3>
            <a
              class="item"
              href="https://www.newyorker.com/magazine/2025/03/17/rot-padraic-x-scanlan-book-review"
              >What made the Irish famine so deadly</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-10 @ 21:24:06</span
              ><span class="points-container"
                >Points: <span class="points">175</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43326275"
                  >Comments</a
                ><span class="descendants">: 213</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43323946">
          <h3>
            <a
              class="item"
              href="https://github.com/MathFoundationRL/Book-Mathematical-Foundation-of-Reinforcement-Learning"
              >Mathematical Foundations of Reinforcement Learning</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-10 @ 18:27:32</span
              ><span class="points-container"
                >Points: <span class="points">254</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43323946"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43323860">
          <h3>
            <a
              class="item"
              href="https://tinlizzie.org/VPRIPapers/tr2012001_steps.pdf"
              >STEPS Toward the Reinvention of Programming (2012) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-10 @ 18:22:57</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43323860"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43323071">
          <h3>
            <a
              class="item"
              href="https://www.analog.com/media/en/training-seminars/design-handbooks/Software-Defined-Radio-for-Engineers-2018/SDR4Engineers.pdf"
              >Software-Defined Radio for Engineers (2018) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-10 @ 17:40:40</span
              ><span class="points-container"
                >Points: <span class="points">227</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43323071"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43322922">
          <h3>
            <a
              class="item"
              href="https://chromewebstore.google.com/detail/ublock-origin/cjpalhdlnbpafiamejdnhcphjbkeiagm?hl=en"
              >uBlock Origin is no longer available on the Chrome Store</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-10 @ 17:30:34</span
              ><span class="points-container"
                >Points: <span class="points">1625</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43322922"
                  >Comments</a
                ><span class="descendants">: 804</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43322245">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/tech-policy/2025/03/music-labels-will-regret-coming-for-the-internet-archive-sound-historian-says/"
              >Music labels will regret coming for the Internet Archive, sound
              historian says</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-10 @ 16:28:44</span
              ><span class="points-container"
                >Points: <span class="points">375</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43322245"
                  >Comments</a
                ><span class="descendants">: 130</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43321688">
          <h3>
            <a class="item" href="https://playscl.com/make"
              >Show HN: Editable Games</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-10 @ 15:31:57</span
              ><span class="points-container"
                >Points: <span class="points">123</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43321688"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
            <div class="text">
              <p>
                I've been working on canvas language for 15 years now. Not very
                successful, but editable gifs turned out okay. Since it's my
                passion, I keep trying, and my latest is editable games - I'm
                not officially calling it that though.
              </p>
              <p>
                I've had some interest in advergames and this would allow
                designers to easily customize games for their clients - the
                hidden objects game being the best example for this, and the
                only one made specifically for the purpose.
              </p>
              <p>
                Anyways, games are interpreted at runtime by JavaScript. To
                publish, for example on itch or your own website, you need to
                submit your project file (download it from the dev studio) and
                wait a few minutes. You'll get back a JS file that contains your
                game.
              </p>
              <p>
                ngl, although a passion project, I'd like this to one day be
                profitable - trying to work that out.
              </p>
              <p>
                If interested, the main project site is
                <a href="https://canvaslanguage.com"
                  >https://canvaslanguage.com</a
                >
              </p>
              <p>
                I'd love to get some feedback. Although to be honest, I just
                want to show somebody my newest creation :)
              </p>
              <p>Thank you.</p>
            </div>
          </section>
        </section>
        <section id="43321523">
          <h3>
            <a class="item" href="https://blog.kuzudb.com/post/kuzu-wasm-rag/"
              >Show HN: In-Browser Graph RAG with Kuzu-WASM and WebLLM</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-10 @ 15:12:57</span
              ><span class="points-container"
                >Points: <span class="points">115</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43321523"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
            <div class="text">
              <p>
                We will soon also be releasing a vector index as part of Kuzu
                that you can also use in the browser to build traditional RAG or
                Graph RAG that retrieves from both vectors and graphs. The
                system has come a long way since we open sourced it about 2
                years ago, so please give us feedback about how it can be more
                useful!
              </p>
            </div>
          </section>
        </section>
        <section id="43321131">
          <h3>
            <a
              class="item"
              href="https://www.mcmordie.co.uk/acornhistory/index.shtml"
              >A technical history of Acorn Computers</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-10 @ 14:35:05</span
              ><span class="points-container"
                >Points: <span class="points">95</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43321131"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43320230">
          <h3>
            <a
              class="item"
              href="https://exclusivearchitecture.com/03-technical-articles-CLT-12-autofocus-systems.html"
              >Canon EF and RF Lenses – All Autofocus Motors</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-10 @ 13:12:38</span
              ><span class="points-container"
                >Points: <span class="points">423</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43320230"
                  >Comments</a
                ><span class="descendants">: 103</span></span
              >
            </h4>
            <div class="text">
              Hi there! I have written an e-book about all autofocus motor types
              used in Canon EF &amp;amp; RF lenses from the past 40 years.
            </div>
          </section>
        </section>
        <section id="43320024">
          <h3>
            <a
              class="item"
              href="https://glasskube.dev/blog/kubernetes-zero-downtime-deployments-aws-eks/"
              >Zero-Downtime Kubernetes Deployments on AWS with EKS</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-10 @ 12:48:32</span
              ><span class="points-container"
                >Points: <span class="points">122</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43320024"
                  >Comments</a
                ><span class="descendants">: 62</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43318624">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2502.05244"
              >Probabilistic Artificial Intelligence</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-10 @ 09:50:33</span
              ><span class="points-container"
                >Points: <span class="points">291</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43318624"
                  >Comments</a
                ><span class="descendants">: 77</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43317887">
          <h3>
            <a class="item" href="https://blog.ecosia.org/trees-not-profits/"
              >Trees not profits: we're giving up our right to ever sell Ecosia
              (2018)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-10 @ 07:42:11</span
              ><span class="points-container"
                >Points: <span class="points">297</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43317887"
                  >Comments</a
                ><span class="descendants">: 183</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43317592">
          <h3>
            <a
              class="item"
              href="https://blog.nelhage.com/post/cpython-tail-call/"
              >Performance of the Python 3.14 tail-call interpreter</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-10 @ 06:44:27</span
              ><span class="points-container"
                >Points: <span class="points">555</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43317592"
                  >Comments</a
                ><span class="descendants">: 160</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43308111">
          <h3>
            <a class="item" href="https://vegard.blog.engen.priv.no/?p=423"
              >Kubernetes Home – what do you do if your ISP changes your IP
              addresses?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-09 @ 11:29:46</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43308111"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43307833">
          <h3>
            <a
              class="item"
              href="https://siginthistorian.blogspot.com/2025/02/sigint-in-fiction.html"
              >Sigint in Fiction</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-09 @ 10:29:27</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43307833"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43307541">
          <h3>
            <a
              class="item"
              href="https://alexop.dev/posts/how-to-implement-a-cosine-similarity-function-in-typescript-for-vector-comparison/"
              >How to Implement a Cosine Similarity Function in TypeScript</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-09 @ 09:20:20</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43307541"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43301848">
          <h3>
            <a
              class="item"
              href="https://opengears.medium.com/hackintoshing-as-a-sustainable-environmental-practice-78baf2cdd353"
              >Hackintoshing as a Sustainable Environmental Practice</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-08 @ 17:36:54</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43301848"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43300414">
          <h3>
            <a class="item" href="https://thomwolf.io/blog/scientific-ai.html"
              >The Einstein AI Model</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-08 @ 14:14:22</span
              ><span class="points-container"
                >Points: <span class="points">154</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43300414"
                  >Comments</a
                ><span class="descendants">: 138</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43298945">
          <h3>
            <a
              class="item"
              href="https://github.com/vnglst/when-ai-fails/blob/main/shepards-dog/README.md"
              >Asking LLMs to create my game Shepard's Dog</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-08 @ 10:06:01</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43298945"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43290620">
          <h3>
            <a class="item" href="https://stopa.io/post/290"
              >Bel in Clojure (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-07 @ 14:50:09</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43290620"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43289994">
          <h3>
            <a
              class="item"
              href="https://www.bbc.com/news/articles/cq6yg204pvmo"
              >Planes are having their GPS hacked. Could new clocks keep them
              safe?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-07 @ 13:31:46</span
              ><span class="points-container"
                >Points: <span class="points">163</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43289994"
                  >Comments</a
                ><span class="descendants">: 244</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43288691">
          <h3>
            <a
              class="item"
              href="https://randomascii.wordpress.com/2021/02/16/arranging-invisible-icons-in-quadratic-time/"
              >Arranging invisible icons in quadratic time (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-07 @ 09:42:03</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43288691"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43288410">
          <h3>
            <a class="item" href="https://hypershell.tech/en-us"
              >HyperShell X Outdoor PowerSuit Exoskeleton</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-07 @ 08:54:00</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43288410"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43287327">
          <h3>
            <a
              class="item"
              href="https://www.abortretry.fail/p/so-powerful-its-kind-of-ridiculous"
              >3dfx: So powerful, it's kind of ridiculous (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-07 @ 04:07:18</span
              ><span class="points-container"
                >Points: <span class="points">242</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43287327"
                  >Comments</a
                ><span class="descendants">: 209</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
