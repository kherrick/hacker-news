<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="38166431">
          <h3>
            <a class="item" href="https://openai.com/blog/introducing-gpts"
              >Introducing GPTs</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-06 @ 18:18:44</span
              ><span class="points-container"
                >Points: <span class="points">91</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38166431"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38166420">
          <h3>
            <a
              class="item"
              href="https://openai.com/blog/new-models-and-developer-products-announced-at-devday"
              >New models and developer products announced at OpenAI DevDay</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-06 @ 18:17:58</span
              ><span class="points-container"
                >Points: <span class="points">98</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38166420"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38165183">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/giga-ml/jobs/d3zdZXn-founding-engineer"
              >Giga ML (YC S23) Is Hiring</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-06 @ 17:01:02</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38165090">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=U9mJuUkhUzk"
              >OpenAI DevDay, Opening Keynote Livestream [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-06 @ 16:55:21</span
              ><span class="points-container"
                >Points: <span class="points">119</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38165090"
                  >Comments</a
                ><span class="descendants">: 91</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38164886">
          <h3>
            <a class="item" href="https://x.ai/prompt-ide/">XAI PromptIDE</a>
          </h3>
          <section>
            <h4>
              <span>2023-11-06 @ 16:42:00</span
              ><span class="points-container"
                >Points: <span class="points">96</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38164886"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38164735">
          <h3>
            <a
              class="item"
              href="https://lapcatsoftware.com/articles/2023/11/2.html"
              >Apple developer boycott of Feedback Assistant</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-06 @ 16:30:43</span
              ><span class="points-container"
                >Points: <span class="points">192</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38164735"
                  >Comments</a
                ><span class="descendants">: 71</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38164727">
          <h3>
            <a
              class="item"
              href="https://www.washingtonpost.com/technology/2023/11/06/epic-google-antitrust-trial-play-store/"
              >Epic targets Google app store after losing to Apple</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-06 @ 16:29:50</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38164727"
                  >Comments</a
                ><span class="descendants">: 41</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38164189">
          <h3>
            <a
              class="item"
              href="https://duckdb.org/2023/11/03/db-benchmark-update.html"
              >DuckDB performance improvements with the latest release</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-06 @ 15:51:59</span
              ><span class="points-container"
                >Points: <span class="points">139</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38164189"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38164127">
          <h3>
            <a
              class="item"
              href="https://practicalbetterments.com/create-a-shortcut-for-even-lower-phone-brightness/"
              >Create a shortcut for even lower phone brightness</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-06 @ 15:47:58</span
              ><span class="points-container"
                >Points: <span class="points">120</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38164127"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38164046">
          <h3>
            <a
              class="item"
              href="https://jvns.ca/blog/2023/11/06/rebasing-what-can-go-wrong-/"
              >Git rebase, what can go wrong</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-06 @ 15:42:23</span
              ><span class="points-container"
                >Points: <span class="points">134</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38164046"
                  >Comments</a
                ><span class="descendants">: 171</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38163973">
          <h3>
            <a class="item" href="https://github.com/Cicada-Software/cicada"
              >Cicada – A FOSS, Cross-Platform Version of GitHub Actions and
              Gitlab CI</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-06 @ 15:36:57</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38163973"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38163412">
          <h3>
            <a class="item" href="https://www.bunniestudios.com/blog/?p=6862"
              >Regarding Proposed US Restrictions on RISC-V</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-06 @ 14:54:14</span
              ><span class="points-container"
                >Points: <span class="points">121</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38163412"
                  >Comments</a
                ><span class="descendants">: 65</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38162837">
          <h3>
            <a
              class="item"
              href="https://www.theverge.com/2023/11/6/23948486/usb-c-cables-marking-speed-power-delivery-elgato"
              >USB-C cable with the bandwidth and USB type imprinted on the
              connector</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-06 @ 14:15:15</span
              ><span class="points-container"
                >Points: <span class="points">215</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38162837"
                  >Comments</a
                ><span class="descendants">: 158</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38162597">
          <h3>
            <a
              class="item"
              href="https://krebsonsecurity.com/2023/11/whos-behind-the-swat-usa-reshipping-service/"
              >Who's Behind the Swat USA Reshipping Service?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-06 @ 13:55:55</span
              ><span class="points-container"
                >Points: <span class="points">122</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38162597"
                  >Comments</a
                ><span class="descendants">: 115</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38162573">
          <h3>
            <a
              class="item"
              href="https://codeconfessions.substack.com/p/a-linear-algebra-trick-for-fibonacci-numbers"
              >A Linear Algebra Trick for Computing Fibonacci Numbers Fast</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-06 @ 13:54:16</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38162573"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38162435">
          <h3>
            <a class="item" href="https://phuoc.ng/collection/html-dom/"
              >Mastering DOM manipulation with vanilla JavaScript</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-06 @ 13:41:30</span
              ><span class="points-container"
                >Points: <span class="points">318</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38162435"
                  >Comments</a
                ><span class="descendants">: 98</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38162275">
          <h3>
            <a
              class="item"
              href="https://element.io/blog/element-to-adopt-agplv3/"
              >A new home and license (AGPL) for Synapse and friends</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-06 @ 13:25:17</span
              ><span class="points-container"
                >Points: <span class="points">90</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38162275"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38161997">
          <h3>
            <a
              class="item"
              href="https://dtransposed.github.io/blog/2023/11/02/Remote-SWE/"
              >A Video Game That Pays: Lessons Learned from Working Remotely</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-06 @ 13:00:22</span
              ><span class="points-container"
                >Points: <span class="points">138</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38161997"
                  >Comments</a
                ><span class="descendants">: 85</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38161617">
          <h3>
            <a
              class="item"
              href="https://blog.jgc.org/2023/11/my-1976-kim-1.html"
              >My 1976 KIM-1</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-06 @ 12:24:43</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38161617"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38161452">
          <h3>
            <a class="item" href="https://github.com/kubero-dev/ladder"
              >Show HN: Ladder, open source alternative to 12ft.io and 1ft.io</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-06 @ 12:04:44</span
              ><span class="points-container"
                >Points: <span class="points">247</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38161452"
                  >Comments</a
                ><span class="descendants">: 105</span></span
              >
            </h4>
            <div class="text">
              <p>
                I made a opensource alternative for these services. Although
                these workedd very well, I was not so confident what they do. So
                I made my own and opensourced it.
              </p>
              <p>It is written in Golang and is fully customizable.</p>
            </div>
          </section>
        </section>
        <section id="38161215">
          <h3>
            <a
              class="item"
              href="https://www.fpgajobs.com/blog/fpga-boards-under-150-dollars/"
              >FPGA Dev Boards for $150 or Less</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-06 @ 11:33:20</span
              ><span class="points-container"
                >Points: <span class="points">146</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38161215"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38161016">
          <h3>
            <a
              class="item"
              href="https://www.memorysafety.org/blog/sudo-first-stable-release/"
              >The first stable release of a memory safe sudo implementation</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-06 @ 10:58:24</span
              ><span class="points-container"
                >Points: <span class="points">262</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38161016"
                  >Comments</a
                ><span class="descendants">: 177</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38160703">
          <h3>
            <a
              class="item"
              href="https://twitter.com/FFmpeg/status/1721275669336707152"
              >FFmpeg is getting better with multithreaded transcoding
              pipelines</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-06 @ 10:12:34</span
              ><span class="points-container"
                >Points: <span class="points">249</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38160703"
                  >Comments</a
                ><span class="descendants">: 68</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38160454">
          <h3>
            <a
              class="item"
              href="https://medium.com/@coolcontinuum/the-composer-continuum-35396e5d09bc"
              >Cool Continuum: Make Your Mark in the Arts</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-06 @ 09:35:19</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38160454"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38160079">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=38160079"
              >Ask HN: How do you start a research based company?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-06 @ 08:35:16</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38160079"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
            <div class="text">
              Looking around hacker news it seems like everyone everywhere has
              their new AI company whose main goal is to develop some kind of
              new algorithm and then find customers later. Where do people get
              funding for such initiatives? I believe I'm a bit naive but it
              also seems like this could be a better way of doing research for
              the time being than continuing on in academia. But how do you get
              money to start a company whose goal is "make AI and worry about
              customers later"?
            </div>
          </section>
        </section>
        <section id="38159927">
          <h3>
            <a class="item" href="https://github.com/01-ai/Yi"
              >01-AI/Yi: A series of large language models trained from
              scratch</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-06 @ 08:03:57</span
              ><span class="points-container"
                >Points: <span class="points">133</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38159927"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38158309">
          <h3>
            <a class="item" href="https://github.com/fuzzballcat/milliForth"
              >milliForth</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-06 @ 03:03:23</span
              ><span class="points-container"
                >Points: <span class="points">199</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38158309"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38151776">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2023-10-scientists-artificial-protein-capable-degrading.html"
              >Scientists create artificial protein that can degrade
              microplastics in bottles</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-05 @ 15:11:42</span
              ><span class="points-container"
                >Points: <span class="points">100</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38151776"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38126052">
          <h3>
            <a class="item" href="https://github.com/lone-lang/lone"
              >A standalone zero-dependency Lisp for Linux</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-03 @ 08:44:51</span
              ><span class="points-container"
                >Points: <span class="points">87</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38126052"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="38125799">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=Csb-AFD58ww"
              >Volute Shaped Blower [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-11-03 @ 08:04:08</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=38125799"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
