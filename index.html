<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="35250873">
          <h3>
            <a
              class="item"
              href="https://www.loc.gov/preservation/digital/formats/fdd/fdd000360.shtml"
              >PDF/A-3, PDF for Long-Term Preservation, Use of ISO 32000-1...
              (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-21 @ 19:00:20</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35250873"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35250564">
          <h3>
            <a
              class="item"
              href="https://www.gatesnotes.com/The-Age-of-AI-Has-Begun"
              >The Age of AI has begun</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-21 @ 18:40:39</span
              ><span class="points-container"
                >Points: <span class="points">40</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35250564"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35250210">
          <h3>
            <a class="item" href="https://github.com/typst/typst"
              >Typst, a modern alternative to LaTeX, is now open source</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-21 @ 18:18:00</span
              ><span class="points-container"
                >Points: <span class="points">205</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35250210"
                  >Comments</a
                ><span class="descendants">: 64</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35250045">
          <h3>
            <a
              class="item"
              href="https://www.ft.com/content/cb213446-332d-4689-8911-e0371c2eb287"
              >Switzerland bans deferred bonuses for Credit Suisse staff</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-21 @ 18:07:01</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35250045"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35249971">
          <h3>
            <a
              class="item"
              href="https://twitter.com/David3141593/status/1638222624084951040"
              >Windows Snipping Tool is vulnerable to Acropalypse too</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-21 @ 18:03:09</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35249971"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35249210">
          <h3>
            <a
              class="item"
              href="https://www.npr.org/2023/03/21/1164360143/rolling-stone-fbi-raid-journalist-james-gordon-meek"
              >Rolling Stone left out the reason why FBI raided journalist's
              home</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-21 @ 17:10:42</span
              ><span class="points-container"
                >Points: <span class="points">107</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35249210"
                  >Comments</a
                ><span class="descendants">: 63</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35249064">
          <h3>
            <a class="item" href="https://skio.com/careers/"
              >Skio (Subscriptions for Shopify, ReCharge migrations) is
              hiring</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-21 @ 17:00:30</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35248975">
          <h3>
            <a
              class="item"
              href="https://www.anandtech.com/show/18780/nvidia-announces-h100-nvl-max-memory-server-card-for-large-language-models"
              >Nvidia Announces H100 NVL – Max Memory Server Card for Large
              Language Models</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-21 @ 16:55:25</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35248975"
                  >Comments</a
                ><span class="descendants">: 26</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35248912">
          <h3>
            <a class="item" href="https://github.com/jsvan/BusStopBloomfilter"
              >Show HN: Public transportation signage based on bloom filters
              (rough mockup)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-21 @ 16:50:58</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35248912"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
            <div class="text">
              <p>
                Linked is a very shoddy mockup of how bloom filters could be
                used to allow passengers O(1) lookup time for which platform+bus
                is the correct one. I believe it's likely for public
                transportation to grow increasingly more complex in the future,
                as population grows, and under the current list-based system,
                this will make the signage ever more complex. I think some bloom
                filter mechanism could reduce that complexity.
              </p>
              <p>So, here is my fantasy, my day dream. What do you think?</p>
            </div>
          </section>
        </section>
        <section id="35248704">
          <h3>
            <a class="item" href="https://www.watermelontools.com/"
              >Show HN: Watermelon – GPT-powered code contextualizer</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-21 @ 16:39:26</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35248704"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
            <div class="text">
              <p>
                We're starting with a VS Code extension that indexes information
                from git (GitHub, GitLab, or Bitbucket integrations available),
                Slack and Jira to explain the context around a file or block of
                code. Finally, we summarize such aggregated context using the
                power of GPT.
              </p>
              <p>
                As devs we know that it's very annoying to look at a new
                codebase and start understanding all the nuances, particularly
                when the person who wrote the code already left the company.
                With this problem in mind, we decided to build this solution.
                You'll be able to get into "the ghost" of the person who left
                the company.
              </p>
              <p>
                Soon, we will also be building a GitHub Action that does the
                same thing as the VS Code extension but at the time of creating
                a PR: Index the most relevant information related to this new
                PR, and add it as a comment. This way we will provide context at
                one more moment, and also, we will be making the IDE extension
                better.
              </p>
              <p>
                Here's our open source repo if you also want to check it out:
                <a
                  href="https://github.com/watermelontools/watermelon-extension"
                  >https://github.com/watermelontools/watermelon-extension</a
                >
              </p>
              <p>Please give us your feedback! Thanks.</p>
            </div>
          </section>
        </section>
        <section id="35248517">
          <h3>
            <a
              class="item"
              href="https://github.com/gorhill/uBlock/releases/tag/1.48.0"
              >uBlock 1.48.0 Adds Readiness Status, Code Viewer, and Other
              Fixes</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-21 @ 16:28:01</span
              ><span class="points-container"
                >Points: <span class="points">224</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35248517"
                  >Comments</a
                ><span class="descendants">: 60</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35248296">
          <h3>
            <a
              class="item"
              href="https://www.dpreview.com/news/5901145460/dpreview-com-to-close"
              >Dpreview.com is coming to an end</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-21 @ 16:14:58</span
              ><span class="points-container"
                >Points: <span class="points">346</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35248296"
                  >Comments</a
                ><span class="descendants">: 157</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35248188">
          <h3>
            <a class="item" href="https://physics.aps.org/articles/v16/44"
              >“Off Switch” Makes Explosives Safer</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-21 @ 16:07:00</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35248188"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35248098">
          <h3>
            <a class="item" href="https://andrew-quinn.me/fzf/"
              >So you've installed `fzf`. Now what?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-21 @ 16:01:34</span
              ><span class="points-container"
                >Points: <span class="points">339</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35248098"
                  >Comments</a
                ><span class="descendants">: 116</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35247299">
          <h3>
            <a
              class="item"
              href="https://blog.aaronkharris.com/avoiding-errors-in-demo-day-fundraising"
              >Avoiding Errors in Demo Day Fundraising</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-21 @ 15:08:22</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35247299"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35247242">
          <h3>
            <a
              class="item"
              href="https://planetscale.com/courses/mysql-for-developers/introduction/course-introduction"
              >MySQL for Developers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-21 @ 15:05:11</span
              ><span class="points-container"
                >Points: <span class="points">203</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35247242"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35247174">
          <h3>
            <a
              class="item"
              href="https://blogs.microsoft.com/blog/2023/03/21/create-images-with-your-words-bing-image-creator-comes-to-the-new-bing/"
              >Image Creator in Bing</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-21 @ 15:00:08</span
              ><span class="points-container"
                >Points: <span class="points">125</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35247174"
                  >Comments</a
                ><span class="descendants">: 57</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35246710">
          <h3>
            <a
              class="item"
              href="https://mail.openjdk.org/pipermail/jdk-dev/2023-March/007517.html"
              >Java 20 / JDK 20: General Availability</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-21 @ 14:30:58</span
              ><span class="points-container"
                >Points: <span class="points">148</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35246710"
                  >Comments</a
                ><span class="descendants">: 207</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35246573">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/surprise-computer-science-proof-stuns-mathematicians-20230321/"
              >Surprise computer science proof in combinatorics</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-21 @ 14:23:54</span
              ><span class="points-container"
                >Points: <span class="points">172</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35246573"
                  >Comments</a
                ><span class="descendants">: 93</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35246292">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=35246292"
              >Launch HN: Frigade (YC W23) – Faster, better product
              onboarding</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-21 @ 14:06:58</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35246292"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.frigade.com">https://www.frigade.com</a>), a
              developer tool for building high-quality product onboarding.
              Here’s a demo video:
              <a href="https://frigade.com/video/demo.mp4"
                >https://frigade.com/video/demo.mp4</a
              >. Also, the “Frigade demo checklist” on our home page (<a
                href="https://frigade.com/#demo"
                >https://frigade.com/#demo</a
              >) was built using Frigade itself, if you want to give it a spin.
              <p>
                Onboarding is a critical first experience for software products.
                It makes a big difference for customer activation and retention.
                However, onboarding experiences often do not get the attention
                they deserve because, without good tooling, they’re a pain to
                build. At a previous startup, Christian and I were surprised at
                how hard it was to get right. It took a ton of time that would
                otherwise have gone to our core product. We also knew that much
                better tooling was possible because we had experienced it in the
                internal tooling at LinkedIn, where we worked at a previous job.
              </p>
              <p>
                Established software companies such as LinkedIn, Uber, Vanta,
                and many others invest in internal developer platforms to give
                their team unfair advantages, like the ability to quickly build
                great onboarding experiences. But these platforms only get built
                at scale. With Frigade, our goal is to develop the platform that
                every growth engineering team would love to have, but can’t
                afford to build themselves.
              </p>
              <p>
                There are no-code tools for onboarding (e.g. Pendo, Appcues,
                Intercom), but they’re rigid and clumsy. They’re built for
                marketers and managers rather than developers, so they sit on
                top of your product instead of feeling native. They’re not
                defined in your codebase, frequently break without teams
                noticing, and there are limits to what you can build with them.
                Unlike these tools, Frigade uses native SDKs and provides an API
                for developers to build new onboardings in code.
              </p>
              <p>
                How to use Frigade in your product: first install our SDK (React
                for now); choose a production-ready Frigade UI component or go
                headless; create a “Frigade Flow” in our admin panel and hook it
                up to the SDK (Flows are where you set the logic, targeting,
                content, and more); publish your flow to go live.
              </p>
              <p>
                Frigade automatically tracks users’ progress through your Flows.
                Your team can sign in to our admin panel to see which customers
                have completed what steps or input data, and you can use our API
                to sync tracking events to your analytics platform, send drip
                campaign (emails that guide users through setup), or show
                product reminders (e.g. “Finish connecting your data” banners).
                Frigade leverages server-driven UI, so once a Flow is live, you
                can easily update content (e.g. change copy, add another step)
                and logic (e.g. who should see it and when) in real-time without
                new code deploys.
              </p>
              <p>
                We’ve spent most of our time building out the platform with
                early customers so far, but our self-serve flow is (ironically)
                coming soon. In the meantime, our demo video gives you the basic
                picture:
                <a href="https://frigade.com/video/demo.mp4"
                  >https://frigade.com/video/demo.mp4</a
                >. Please let us know if you’re interested in trying Frigade,
                we’d love to get your feedback on what we’ve built so far! We
                work mostly with web-based B2B companies today, and our pricing
                is competitive with other tools on the market.
              </p>
              <p>
                What has been your experience with product onboarding? We’d love
                to hear more about examples of what’s worked well and what’s
                been a pain in the ass—as well as anything else you’d like to
                share.
              </p>
            </div>
          </section>
        </section>
        <section id="35246260">
          <h3>
            <a class="item" href="https://bard.google.com/"
              >Google Bard enters open beta</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-21 @ 14:04:40</span
              ><span class="points-container"
                >Points: <span class="points">408</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35246260"
                  >Comments</a
                ><span class="descendants">: 434</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35246228">
          <h3>
            <a
              class="item"
              href="https://blog.sqlitecloud.io/strong-consistency-with-raft-and-sqlite"
              >Strong Consistency with Raft and SQLite</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-21 @ 14:02:34</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35246228"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35246139">
          <h3>
            <a
              class="item"
              href="https://www.adobe.com/sensei/generative-ai/firefly.html"
              >Adobe Firefly: AI Art Generator</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-21 @ 13:55:58</span
              ><span class="points-container"
                >Points: <span class="points">480</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35246139"
                  >Comments</a
                ><span class="descendants">: 276</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35217945">
          <h3>
            <a
              class="item"
              href="https://99percentinvisible.org/episode/a-whale-oiled-machine/"
              >A Whale-Oiled Machine</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-19 @ 11:27:46</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35217945"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35216787">
          <h3>
            <a
              class="item"
              href="https://en.wikipedia.org/wiki/Perturbation_theory"
              >Perturbation Theory</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-19 @ 07:20:44</span
              ><span class="points-container"
                >Points: <span class="points">87</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35216787"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35215870">
          <h3>
            <a class="item" href="https://erikmcclure.com/blog/a-rant-on-terra/"
              >A Rant on Terra (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-19 @ 03:51:12</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35215870"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35208166">
          <h3>
            <a class="item" href="http://ciel-lang.org/#/?id=ciel"
              >CIEL is a ready-to-use collection of Lisp libraries</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-18 @ 11:31:33</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35208166"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35207941">
          <h3>
            <a
              class="item"
              href="https://brickexperimentchannel.wordpress.com/2022/10/24/thoughts-on-video-editing/"
              >Thoughts on Video Editing (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-18 @ 10:50:51</span
              ><span class="points-container"
                >Points: <span class="points">96</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35207941"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35207171">
          <h3>
            <a class="item" href="https://iolanguage.org">The Io Language</a>
          </h3>
          <section>
            <h4>
              <span>2023-03-18 @ 08:06:39</span
              ><span class="points-container"
                >Points: <span class="points">84</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35207171"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35206141">
          <h3>
            <a
              class="item"
              href="https://qz.com/846530/something-weird-happens-to-companies-when-they-hit-150-people"
              >Something weird happens to companies when they hit 150 people
              (2017)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-18 @ 04:38:05</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35206141"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
