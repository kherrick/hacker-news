<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="41106109">
          <h3>
            <a class="item" href="https://lang.video/"
              >Video is a language for making movies</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-30 @ 04:46:37</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41106109"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41106041">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2024/07/24/business/media/lewis-h-lapham-dead.html"
              >Lewis H. Lapham, Harper's Editor and Piercing Columnist, Dies at
              89</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-30 @ 04:26:29</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41106041"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41105881">
          <h3>
            <a
              class="item"
              href="https://newsletter.maartengrootendorst.com/p/a-visual-guide-to-quantization"
              >A Visual Guide to LLM Quantization</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-30 @ 03:42:10</span
              ><span class="points-container"
                >Points: <span class="points">8</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41105881"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41105779">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2407.15811"
              >Diffusion Training from Scratch on a Micro-Budget</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-30 @ 03:19:23</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41105779"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41105617">
          <h3>
            <a class="item" href="https://orca-app.dev/index.html"
              >Orca: WebAssembly Apps Without the Web</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-30 @ 02:34:53</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41105617"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41105527">
          <h3>
            <a
              class="item"
              href="https://idinsight.github.io/tech-blog/blog/aam_pseudo_agent/"
              >[LLMs] Using agents to not use agents</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-30 @ 02:14:28</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41105527"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41105261">
          <h3><a class="item" href="http://microjs.com/">Microjs</a></h3>
          <section>
            <h4>
              <span>2024-07-30 @ 01:16:23</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41105261"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41104997">
          <h3>
            <a
              class="item"
              href="https://repost.aws/questions/QUshILm0xbTjWJZSD8afYVgA/codecommit-cannot-create-a-repository"
              >AWS Code Commit Ceased Onboarding New Customers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-30 @ 00:27:03</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41104997"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41104721">
          <h3>
            <a class="item" href="https://davidar.io/post/sim-glsl"
              >Four billion years in four minutes â€“ Simulating worlds on the
              GPU</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-29 @ 23:33:51</span
              ><span class="points-container"
                >Points: <span class="points">132</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41104721"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41104709">
          <h3>
            <a class="item" href="https://ai.meta.com/blog/segment-anything-2/"
              >Sam 2: The next generation of Meta Segment Anything Model</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-29 @ 23:31:57</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41104709"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41104615">
          <h3>
            <a class="item" href="https://spectrum.ieee.org/transparent-tv"
              >LG and Samsung are making TV screens disappear</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-29 @ 23:13:37</span
              ><span class="points-container"
                >Points: <span class="points">91</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41104615"
                  >Comments</a
                ><span class="descendants">: 117</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41104523">
          <h3>
            <a
              class="item"
              href="https://github.com/facebookresearch/segment-anything-2"
              >SAM 2: Segment Anything in Images and Videos</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-29 @ 22:52:56</span
              ><span class="points-container"
                >Points: <span class="points">329</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41104523"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41104504">
          <h3>
            <a
              class="item"
              href="https://www.digicert.com/support/certificate-revocation-incident"
              >DigiCert Revocation Incident (CNAME Domain Validation)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-29 @ 22:50:45</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41104504"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41104305">
          <h3>
            <a class="item" href="https://fastht.ml/"
              >FastHTML â€“ Modern web applications in pure Python</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-29 @ 22:18:01</span
              ><span class="points-container"
                >Points: <span class="points">240</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41104305"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41104293">
          <h3>
            <a
              class="item"
              href="https://blog.healthchecks.io/2024/07/running-one-man-saas-9-years-in/"
              >One-man SaaS, 9 Years In</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-29 @ 22:15:53</span
              ><span class="points-container"
                >Points: <span class="points">471</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41104293"
                  >Comments</a
                ><span class="descendants">: 79</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41104243">
          <h3>
            <a
              class="item"
              href="https://dgerrells.com/blog/how-to-save-13-27-on-your-saas-bill"
              >How to save $13.27 on your SaaS bill</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-29 @ 22:09:04</span
              ><span class="points-container"
                >Points: <span class="points">131</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41104243"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41103403">
          <h3>
            <a class="item" href="https://augmend.com/blog/TreeSeg"
              >TreeSeg: Hierarchical Topic Segmentation of Large Transcripts</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-29 @ 20:21:19</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41103403"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41103101">
          <h3>
            <a
              class="item"
              href="https://heavymeta.org/2024/07/28/crowdstrikes-impact-on-aviation.html"
              >CrowdStrike's impact on aviation</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-29 @ 19:41:47</span
              ><span class="points-container"
                >Points: <span class="points">295</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41103101"
                  >Comments</a
                ><span class="descendants">: 211</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41101502">
          <h3>
            <a
              class="item"
              href="https://www.penguinsinternational.org/do-penguins-have-knees-and-other-frequently-asked-questions/"
              >Do Penguins Have Knees? (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-29 @ 16:10:07</span
              ><span class="points-container"
                >Points: <span class="points">106</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41101502"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41101144">
          <h3>
            <a
              class="item"
              href="https://www.aei.mpg.de/1171367/what-no-one-has-seen-before-new-study-simulates-gravitational-waves-from-failing-warp-drive"
              >New study simulates gravitational waves from failing warp
              drive</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-29 @ 15:23:42</span
              ><span class="points-container"
                >Points: <span class="points">63</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41101144"
                  >Comments</a
                ><span class="descendants">: 71</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41100094">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=41100094"
              >Launch HN: Roame (YC S23) â€“ Flight search engine for your credit
              card points</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-29 @ 12:56:23</span
              ><span class="points-container"
                >Points: <span class="points">161</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41100094"
                  >Comments</a
                ><span class="descendants">: 103</span></span
              >
            </h4>
            <div class="text">
              <a href="https://roame.travel">https://roame.travel</a>). Roame is
              a flight search engine that lets you find and redeem business
              class flights using points and miles, rather than exorbitant
              amounts of cash. Here's a demo video:
              <a href="https://www.youtube.com/watch?v=fixXuyhofgo"
                >https://www.youtube.com/watch?v=fixXuyhofgo</a
              >
              We have been flying around the world in first and business class
              using points for yearsâ€”Tim for more than a decade and Zi more
              recently. A little over a year ago, we were trying to find cheap
              round-trip tickets in first or business class to Asia and back
              using points. We had tons of points across Chase, American
              Express, and Citi, but finding a good redemption is always a pain.
              <p>
                We had flexibility with points currency, destinations, and
                dates. Our only requirement was securing two round-trip flight
                redemptions in first or business class on the same flight. This
                flexibility came at a cost: we spent over 30 hours across two
                weeks manually searching dates and routes on the websites of
                10-20 airline transfer partners.
              </p>
              <p>
                Ultimately, we did find two Japan Airlines first class tickets
                from Los Angeles to Tokyo for 70,000 points each, returning to
                New York for 80,000 points each. These flights typically cost
                between $20,000 to $30,000 roundtrip in cash, but using points,
                we effectively paid only ~$2,000.
              </p>
              <p>
                The first class experience was unforgettable, but we didn't want
                to repeat the tedious search process. So, we decided to build a
                tool to save time in the future.
              </p>
              <p>
                I know all this about points might sound a bit like magic, but
                booking cheap business class flights using points is achievable
                for the average person. Here's how it works: Credit card sign-up
                offers range from 50,000 to 150,000 points. These points are
                either tied to credit card currencies (Chase Ultimate Rewards,
                American Express Membership Rewards) or specific airlines (Delta
                Skymiles, United MileagePlus). The most valuable and versatile
                points are tied to credit card currencies because they can be
                transferred to various travel partners. This flexibility allows
                you to choose the best value before transferring points. If you
                only have points with one airline program, you're limited to
                their redemptions.
              </p>
              <p>
                While most people redeem their credit card points through the
                Chase or American Express travel portals at about 1-1.5 cents
                per point, transferring to an airline partner can yield 3-8
                cents per point for business class or 12-20 cents per point for
                first class.
              </p>
              <p>
                The best value for points often comes from non-US airlines like
                Air Canada, Air France/KLM, Avianca, and British Airways. For
                example, you can redeem 50,000 points for an Air France business
                class flight from San Francisco to Paris, which would otherwise
                cost around $4,000. That's an 8 cents per point value,
                significantly higher than using the credit card travel portal.
              </p>
              <p>
                However, the challenges are: 1) most people don't know their
                credit card points can transfer to airline partners, 2) they
                don't consider non-US airlines, and 3) manually searching each
                airline website is time-consuming.
              </p>
              <p>
                Our tool simplifies this process: Enter your origin airport,
                destination airport, date, fare class, and number of travelers.
                After you click search, our tool searches up to 16 different
                airline loyalty programs in real time and displays the results,
                including flight information, points cost, and redemption
                instructions.
              </p>
              <p>
                The real-time search is free and offers access to 60 days of
                SkyView, a cached database of the top 6,500 most popular routes
                categorized by regions (state, country, continent) across two
                months. The paid version extends access to the full 365 calendar
                and allows searches up to two months at a time, with email
                alerts. SkyView is perfect for showing you what is currently
                available or was previously possible for all your award
                redemption needs.
              </p>
              <p>
                We're continuously adding more features and would love to hear
                your ideas, experiences, and feedback! Thank you in advance!
              </p>
            </div>
          </section>
        </section>
        <section id="41099901">
          <h3>
            <a class="item" href="https://loro.dev/blog/movable-tree"
              >Movable tree CRDTs and Loro's implementation</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-29 @ 12:24:59</span
              ><span class="points-container"
                >Points: <span class="points">252</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41099901"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41099028">
          <h3>
            <a
              class="item"
              href="https://e10v.me/tea-tasting-analysis-of-experiments/"
              >Show HN: Tea-tasting, a Python package for the statistical
              analysis of A/B tests</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-29 @ 09:10:05</span
              ><span class="points-container"
                >Points: <span class="points">131</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41099028"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
            <div class="text">
              <p>
                It features Student's t-test, Bootstrap, variance reduction
                using CUPED, power analysis, and other statistical methods.
              </p>
              <p>
                tea-tasting supports a wide range of data backends, including
                BigQuery, ClickHouse, PostgreSQL, Snowflake, Spark, and more,
                all thanks to Ibis.
              </p>
              <p>
                I consider it ready for important tasks and use it for the
                analysis of switchback experiments in my work.
              </p>
            </div>
          </section>
        </section>
        <section id="41098974">
          <h3>
            <a class="item" href="https://github.com/alexta69/metube"
              >MeTube: Self-hosted YouTube downloader</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-29 @ 08:59:41</span
              ><span class="points-container"
                >Points: <span class="points">257</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41098974"
                  >Comments</a
                ><span class="descendants">: 122</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41093719">
          <h3>
            <a
              class="item"
              href="https://simondobson.org/2024/07/27/my-mental-model-of-setf-was-wrong/"
              >My mental model of setf was wrong</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-28 @ 15:09:20</span
              ><span class="points-container"
                >Points: <span class="points">163</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41093719"
                  >Comments</a
                ><span class="descendants">: 80</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41090134">
          <h3>
            <a
              class="item"
              href="http://madcompiler.blogspot.com/2024/02/lessons-from-ancient-file-systems.html"
              >Lessons from Ancient File Systems</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-27 @ 23:33:45</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41090134"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41080189">
          <h3>
            <a class="item" href="https://github.com/jodigiordano/gg"
              >Show HN: Create diagrams of complex data flows in software
              systems</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-26 @ 16:57:12</span
              ><span class="points-container"
                >Points: <span class="points">93</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41080189"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
            <div class="text">
              <p>
                It has been a while since I contributed to the web, so I decided
                to get back in shape and publish "something".
              </p>
              <p>
                This app is a POC of "what if diagrams were more dynamic". I'm a
                software engineer by trade, and with conventional tools, I often
                times struggle to explain flows of data in complex software
                systems.
              </p>
              <p>
                I got inspired by video games like The Incredible Machine and
                Factorio, as in some ways, software systems tend to become Rube
                Goldberg-esque machines ;) As a side quest, I also wanted to
                craft diagrams faster than text-based tools (ex: mermaid), as I
                am always forgetting their syntax.
              </p>
              <p>
                If you try the app, you will certainly struggle with its UI,
                especially when crafting flows, as I used all my brain juice on
                the core idea. I have cool features in my head for a v1 but
                today I really wanted to simply show what I got.
              </p>
              <p>
                You can access the app directly at
                <a href="https://gg-charts.com">https://gg-charts.com</a> and
                there are some examples in the Github README to get you started.
              </p>
              <p>
                Happy to answer questions and humbly receive your honest
                feedback on this crazy idea!
              </p>
            </div>
          </section>
        </section>
        <section id="41077647">
          <h3>
            <a
              class="item"
              href="https://zverok.space/blog/2024-07-26-range-evolution.html"
              >The evolution of Ruby's Range class</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-26 @ 11:12:29</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41077647"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41074703">
          <h3>
            <a
              class="item"
              href="https://dhashe.com/how-to-build-highly-debuggable-c-binaries.html"
              >How to build highly-debuggable C++ binaries</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-26 @ 00:00:52</span
              ><span class="points-container"
                >Points: <span class="points">175</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41074703"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41063489">
          <h3>
            <a
              class="item"
              href="https://www.thedrive.com/news/culture/hackers-exploited-a-pc-driving-sim-to-pull-off-massive-disney-data-breach"
              >Hackers Exploited a PC Driving SIM to Pull Off Disney Data
              Breach</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-24 @ 23:59:10</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41063489"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
