<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="46299022">
          <h3>
            <a
              class="item"
              href="https://www.workatastartup.com/companies/subsets"
              >Subsets (YC S23) is hiring engineers in Copenhagen, Denmark</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-17 @ 07:00:16</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46298385">
          <h3>
            <a
              class="item"
              href="https://www.businessinsider.com/caroline-ellison-prison-release-ftx-sam-bankman-fried-2025-12"
              >FTX insider Caroline Ellison has been moved out of prison</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-17 @ 04:48:24</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46298385"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46298055">
          <h3>
            <a
              class="item"
              href="https://blog.ozeninc.com/resources/from-datasheet-to-demagnetization-a-guide-to-magnetizing-n48-magnets-in-ansys-maxwell"
              >A Guide to Magnetizing N48 Magnets in Ansys Maxwell</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-17 @ 03:55:59</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46298055"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46297127">
          <h3>
            <a class="item" href="https://bernsteinbear.com/isdt/"
              >Introduction to Software Development Tooling (2024)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-17 @ 01:26:14</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46297127"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46296863">
          <h3>
            <a class="item" href="https://lingoku.ai/learn-japanese"
              >Show HN: Learn Japanese contextually while browsing</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-17 @ 00:50:40</span
              ><span class="points-container"
                >Points: <span class="points">63</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46296863"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
            <div class="text">
              <p>
                Just wanted to share a tool i've been working on to help with my
                own study routine. It’s a browser extension called Lingoku.
              </p>
              <p>
                The idea is simple: we spend hours browsing the web in English
                every day. This tool replaces some of the english words with
                Japanese vocabulary based on your japanese level (Similar to
                Toucan, but with a better user experience).
              </p>
              <p>
                It’s basically an attempt to make the "i+1" method actually
                passive, you understand the sentence because it's mostly
                english, but you pick up Japanese words naturally from the
                context. It uses an LLM in the backend to make sure the
                translations fit the context (so it distinguishes between
                different meanings of the same word).
              </p>
              <p>
                since it uses paid AI APIs for the words replacement, I couldn't
                make it 100% free (server costs are real, unfortunately).
                However, there is a "forever free" plan with daily credits that
                doesn't require a credit card. it should be enough for casual
                daily browsing.
              </p>
              <p>
                I built this because I struggle with Anki burnout and wanted a
                way to review words without feeling like i am "studying"
              </p>
              <p>
                It supports Chrome, Edge, and Firefox now. would love any
                feedback or feature requests!
              </p>
              <p>
                <a href="https://lingoku.ai/learn-japanese"
                  >https://lingoku.ai/learn-japanese</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="46295792">
          <h3>
            <a class="item" href="https://dafny.org/"
              >Dafny: Verification-Aware Programming Language</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-16 @ 22:50:59</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46295792"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46295771">
          <h3>
            <a
              class="item"
              href="https://simonwillison.net/2025/Dec/15/porting-justhtml/"
              >I ported JustHTML from Python to JavaScript with Codex CLI and
              GPT-5.2 in hours</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-16 @ 22:48:56</span
              ><span class="points-container"
                >Points: <span class="points">140</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46295771"
                  >Comments</a
                ><span class="descendants">: 85</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46295268">
          <h3>
            <a
              class="item"
              href="https://www.waterfox.com/blog/no-ai-here-response-to-mozilla/"
              >No AI* Here – A Response to Mozilla's Next Chapter</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-16 @ 22:07:49</span
              ><span class="points-container"
                >Points: <span class="points">265</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46295268"
                  >Comments</a
                ><span class="descendants">: 142</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46294592">
          <h3>
            <a
              class="item"
              href="https://tailscale.com/blog/chat-tails-terminal-chat"
              >Chat-tails: Throwback terminal chat, built on Tailscale</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-16 @ 21:16:35</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46294592"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46294574">
          <h3>
            <a
              class="item"
              href="https://martin.kleppmann.com/2025/12/08/ai-formal-verification.html"
              >AI will make formal verification go mainstream</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-16 @ 21:14:49</span
              ><span class="points-container"
                >Points: <span class="points">543</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46294574"
                  >Comments</a
                ><span class="descendants">: 274</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46294289">
          <h3>
            <a class="item" href="https://astral.sh/blog/ty"
              >Announcing the Beta release of ty</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-16 @ 20:52:45</span
              ><span class="points-container"
                >Points: <span class="points">502</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46294289"
                  >Comments</a
                ><span class="descendants">: 91</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46293062">
          <h3>
            <a
              class="item"
              href="https://www.sebastianaaltonen.com/blog/no-graphics-api"
              >No Graphics API</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-16 @ 19:20:17</span
              ><span class="points-container"
                >Points: <span class="points">565</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46293062"
                  >Comments</a
                ><span class="descendants">: 101</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46291941">
          <h3>
            <a
              class="item"
              href="https://openai.com/index/new-chatgpt-images-is-here/"
              >GPT Image 1.5</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-16 @ 18:07:07</span
              ><span class="points-container"
                >Points: <span class="points">409</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46291941"
                  >Comments</a
                ><span class="descendants">: 191</span></span
              >
            </h4>
            <div class="text">
              <a href="https://platform.openai.com/docs/models/gpt-image-1.5"
                >https://platform.openai.com/docs/models/gpt-image-1.5</a
              >
            </div>
          </section>
        </section>
        <section id="46291156">
          <h3>
            <a
              class="item"
              href="https://resources.github.com/actions/2026-pricing-changes-for-github-actions/"
              >Pricing Changes for GitHub Actions</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-16 @ 17:12:02</span
              ><span class="points-container"
                >Points: <span class="points">603</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46291156"
                  >Comments</a
                ><span class="descendants">: 668</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46290916">
          <h3><a class="item" href="https://alpr.watch/">alpr.watch</a></h3>
          <section>
            <h4>
              <span>2025-12-16 @ 16:54:19</span
              ><span class="points-container"
                >Points: <span class="points">729</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46290916"
                  >Comments</a
                ><span class="descendants">: 353</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46289918">
          <h3>
            <a class="item" href="https://kemble.net/blog/provoke/"
              >Writing a blatant Telegram clone using Qt, QML and Rust. And
              C++</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-16 @ 15:41:47</span
              ><span class="points-container"
                >Points: <span class="points">107</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46289918"
                  >Comments</a
                ><span class="descendants">: 65</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46288491">
          <h3>
            <a
              class="item"
              href="https://blog.mozilla.org/en/mozilla/leadership/mozillas-next-chapter-anthony-enzor-demeo-new-ceo/"
              >Mozilla appoints new CEO Anthony Enzor-Demeo</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-16 @ 13:53:14</span
              ><span class="points-container"
                >Points: <span class="points">483</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46288491"
                  >Comments</a
                ><span class="descendants">: 737</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46288415">
          <h3>
            <a
              class="item"
              href="https://www.tum.de/en/news-and-events/all-news/press-releases/details/40-percent-of-mri-signals-do-not-correspond-to-actual-brain-activity"
              >40 percent of fMRI signals do not correspond to actual brain
              activity</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-16 @ 13:46:57</span
              ><span class="points-container"
                >Points: <span class="points">429</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46288415"
                  >Comments</a
                ><span class="descendants">: 179</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46288024">
          <h3>
            <a class="item" href="https://gamehistory.org/segachannel/"
              >Sega Channel: VGHF Recovers over 100 Sega Channel ROMs (and
              More)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-16 @ 13:07:14</span
              ><span class="points-container"
                >Points: <span class="points">247</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46288024"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46286292">
          <h3>
            <a
              class="item"
              href="https://www.japantimes.co.jp/news/2025/08/21/japan/panel-hepburn-style-romanization/"
              >Japan to revise romanization rules for first time in 70 years</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-16 @ 08:54:58</span
              ><span class="points-container"
                >Points: <span class="points">177</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46286292"
                  >Comments</a
                ><span class="descendants">: 145</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46283276">
          <h3>
            <a
              class="item"
              href="https://www.joanwestenberg.com/thin-desires-are-eating-your-life/"
              >Thin desires are eating life</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-16 @ 00:50:41</span
              ><span class="points-container"
                >Points: <span class="points">440</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46283276"
                  >Comments</a
                ><span class="descendants">: 172</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46282874">
          <h3>
            <a
              class="item"
              href="https://yaschamounk.substack.com/p/the-world-happiness-report-is-a-sham"
              >The World Happiness Report is beset with methodological
              problems</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-16 @ 00:06:49</span
              ><span class="points-container"
                >Points: <span class="points">112</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46282874"
                  >Comments</a
                ><span class="descendants">: 133</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46276002">
          <h3>
            <a class="item" href="https://github.com/Maxteabag/sqlit"
              >Show HN: Sqlit – A lazygit-style TUI for SQL databases</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-15 @ 15:47:14</span
              ><span class="points-container"
                >Points: <span class="points">135</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46276002"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
            <div class="text">
              <p>
                I wanted something like lazygit for databases – run it, connect,
                and query and frankly just make it enjoyable to access data.
              </p>
              <p></p>
              <pre><code>  Sqlit is a keyboard-driven SQL TUI with:

  - Context-based keybindings (always visible)
  - Neovim-like interface with normal and insert mode for query editing
  - Browse databases, tables, views, stored procedures
  - Adapters for SQL Server, SQLite, PostgreSQL, Turso &amp; more
  - SSH tunneling support
  - Themes (Tokyo Night, Nord, Gruvbox etc.)

  Inspired by lazygit, neovim and lazysql. Built with Python/Textual.
</code></pre>
              Feedback welcome – especially on which adapters to prioritize
              next. My vision of sqlit is to make a tool that makes it easy to
              connect and query data, and to do that, and that thing only,
              really well.
              <p>
                <a href="https://github.com/Maxteabag/sqlit"
                  >https://github.com/Maxteabag/sqlit</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="46275111">
          <h3>
            <a
              class="item"
              href="https://research.nvidia.com/labs/nemotron/Nemotron-3/"
              >Nvidia Nemotron 3 Family of Models</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-15 @ 14:39:49</span
              ><span class="points-container"
                >Points: <span class="points">188</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46275111"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46254909">
          <h3>
            <a
              class="item"
              href="https://plasticsoldierreview.com/ShowFeature.aspx?id=27"
              >Annual Production of 1/72 (22mm) scale plastic soldiers,
              1958-2025</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-13 @ 14:51:43</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46254909"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46248627">
          <h3>
            <a
              class="item"
              href="https://chillphysicsenjoyer.substack.com/p/testing-a-cheaper-laminar-flow-hood"
              >Testing a cheaper laminar flow hood</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-12 @ 20:40:31</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46248627"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46245083">
          <h3>
            <a
              class="item"
              href="https://devblogs.microsoft.com/oldnewthing/20251211-37/?p=111858"
              >Various locale mismatch scenarios in Windows clipboard text
              format synthesis</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-12 @ 15:34:45</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46245083"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46231370">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/cars/2025/11/an-electric-car-thats-faster-than-f1-around-monaco-thats-the-idea/"
              >Twin suction turbines and 3-Gs in slow corners? Meet the
              DRG-Lola</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-11 @ 13:53:58</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46231370"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46230456">
          <h3>
            <a
              class="item"
              href="https://dfarq.homeip.net/va-linux-the-biggest-dotcom-ipo/"
              >VA Linux: The biggest dotcom IPO</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-11 @ 12:17:53</span
              ><span class="points-container"
                >Points: <span class="points">45</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46230456"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="46229761">
          <h3>
            <a
              class="item"
              href="https://www.npmjs.com/package/@ezetgalaxy/titan"
              >Show HN: Titan – JavaScript-first framework that compiles into a
              Rust server</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-12-11 @ 10:37:08</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=46229761"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
            <div class="text">
              <p>
                I built Titan, a backend framework where you write routes and
                logic in JavaScript, and the CLI compiles everything into a
                single Rust + Axum binary using the Boa JS engine. No Node.js is
                required in production.
              </p>
              <p>
                The idea is to keep JS developer experience while getting Rust
                performance and a self-contained deployable server.
              </p>
              <p>Current features:</p>
              <p>JS route DSL</p>
              <p>Action system mapped to Rust</p>
              <p>esbuild bundling</p>
              <p>Generated Rust server with Axum</p>
              <p>Hot-reload dev server</p>
              <p>Single-binary output</p>
              <p>
                Repo:
                <a href="https://github.com/ezet-galaxy/-ezetgalaxy-titan"
                  >https://github.com/ezet-galaxy/-ezetgalaxy-titan</a
                >
              </p>
              <p>
                Would love feedback on the architecture, DX, and whether this
                hybrid JS→Rust approach is useful.
              </p>
              <p>Thanks for reading!</p>
            </div>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
