<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="43214576">
          <h3>
            <a
              class="item"
              href="https://tanelpoder.com/posts/ebpf-pt-regs-error-on-linux-blame-fred/"
              >When eBPF pt_regs reads return garbage on the latest Linux
              kernels, blame Fred</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-01 @ 01:37:26</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43214576"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43214294">
          <h3>
            <a
              class="item"
              href="https://blog.diego.dev/posts/firefox-sync-server/"
              >Self-Hosting a Firefox Sync Server</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-01 @ 01:03:48</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43214294"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43214263">
          <h3>
            <a
              class="item"
              href="https://worksinprogress.co/issue/the-housing-theory-of-everything/"
              >The Housing Theory of Everything</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-03-01 @ 00:59:13</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43214263"
                  >Comments</a
                ><span class="descendants">: 49</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43213612">
          <h3>
            <a
              class="item"
              href="https://blog.mozilla.org/en/products/firefox/update-on-terms-of-use/"
              >An Update on Mozilla's Terms of Use for Firefox</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-28 @ 23:59:35</span
              ><span class="points-container"
                >Points: <span class="points">196</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43213612"
                  >Comments</a
                ><span class="descendants">: 87</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43213143">
          <h3>
            <a
              class="item"
              href="https://www.economist.com/leaders/2025/02/27/inheriting-is-becoming-nearly-as-important-as-working"
              >Inheriting is becoming nearly as important as working</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-28 @ 23:20:38</span
              ><span class="points-container"
                >Points: <span class="points">224</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43213143"
                  >Comments</a
                ><span class="descendants">: 279</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43213090">
          <h3>
            <a class="item" href="https://github.com/cmackenzie1/torii-rs"
              >Show HN: Torii – a framework agnostic authentication library for
              Rust</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-28 @ 23:16:16</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43213090"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43212952">
          <h3>
            <a
              class="item"
              href="https://www.construction-physics.com/p/why-its-so-hard-to-build-a-jet-engine"
              >Why it's so hard to build a jet engine</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-28 @ 23:05:21</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43212952"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43210858">
          <h3>
            <a class="item" href="https://kibty.town/blog/todesktop/"
              >How to gain code execution on hundreds of millions of people and
              popular apps</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-28 @ 21:05:35</span
              ><span class="points-container"
                >Points: <span class="points">418</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43210858"
                  >Comments</a
                ><span class="descendants">: 106</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43210537">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=JZcui85b4EE"
              >Japanese Toshiba Typewriter Model BW-2112 (2020) [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-28 @ 20:51:34</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43210537"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43210536">
          <h3>
            <a class="item" href="https://azsh.it"
              >400 reasons to not use Microsoft Azure</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-28 @ 20:51:34</span
              ><span class="points-container"
                >Points: <span class="points">192</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43210536"
                  >Comments</a
                ><span class="descendants">: 98</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43210185">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=43210185"
              >Show HN: Betting game puzzle (Hamming neighbor sum in linear
              time)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-28 @ 20:33:43</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43210185"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
            <div class="text">
              <a href="https://es.wikipedia.org/wiki/La_Quiniela_(Espa%C3%B1a)"
                >https://es.wikipedia.org/wiki/La_Quiniela_(Espa%C3%B1a)</a
              >
              <p>
                Players predict the outcome of 14 football matches (home win,
                draw, away win). You win money if you get at least 10 correct,
                and the prize amount depends on the number of winners. Since all
                bets are public, the number of winners and the corresponding
                payouts can be estimated for each of the 3^14 possible outcomes.
                We can also estimate their probabilities using bookmaker odds,
                allowing us to compute the expected value for each prediction.
              </p>
              <p>
                As a side project, I wanted to analyze this, but ran into a
                computational bottleneck: to evaluate a prediction, I had to sum
                the values of all its Hamming neighbors up to distance 4. That’s
                nearly 20,000 neighbors per prediction
                (1+28+364+2912+16016=19321):
              </p>
              <p>
                S_naive = sum from k=0 to r of [(d! / ((d-k)! * k!)) * (q-1)^k]
                (d=14, q=3, r=4)
              </p>
              <p>
                This took days to run in my first implementation. Optimizing and
                doing it with matrices brought it down to 20 minutes—still too
                slow (im running it in GAS with 6 minutes limit). For a while, I
                used a heuristic: start from a random prediction, check its 28
                nearest neighbors, move to the highest-value one, and repeat
                until no improvement is possible within distance 3. It worked
                surprisingly well.
              </p>
              <p>
                But I kept thinking about how to solve the problem properly.
                Eventually, I realized that partial sums could be accumulated
                efficiently by exploiting overlaps: if two predictions A and B
                share neighbors, their shared neighbors can be computed once and
                reused. This is achieved through a basic transformation that I
                implemented using reshape, roll, and flatten (it is probably not
                the most efficient implementation but it is the clearest), which
                realigns the matrix by applying an offset in dimension i. This
                transformation has two key properties that enable reducing the
                number of summations from 19,321 to just 101:
              </p>
              <p>- T(T(space, d1), d2) = T(T(space, d2), d1)</p>
              <p>- T(space1, d) + T(space2, d) = T(space1+space2, d)</p>
              <p>Number of sums would be the result of this expression:</p>
              <p>S_PSA = 1 + (d - (r-1)/2) * r * (q-1)</p>
              <p>
                I've generalized the algorithm for any number of dimensions,
                elements per dimension, and summation radius. The implementation
                is in pure NumPy. I have uploaded the code to colab, github and
                an explanation in my blog.
              </p>
              <p>
                Apparently, this falls under Hamming neighbor summation, but I
                haven't found similar approaches elsewhere (maybe I'm searching
                poorly). If you know or you've worked on something similar, I'd
                love to hear your thoughts!
              </p>
              <p>
                colab:
                <a
                  href="https://colab.research.google.com/drive/1aENKd7eemGqmjdB8Y6ysxAx4BykguXUM?usp=sharing"
                  >https://colab.research.google.com/drive/1aENKd7eemGqmjdB8Y6y...</a
                >
              </p>
              <p>
                github:
                <a href="https://github.com/petopello/PSA"
                  >https://github.com/petopello/PSA</a
                >
              </p>
              <p>
                blog:
                <a
                  href="https://sudapollismo.substack.com/p/partial-sum-accumulation-algorithm"
                  >https://sudapollismo.substack.com/p/partial-sum-accumulation...</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="43209064">
          <h3>
            <a class="item" href="https://github.com/salesforce/Merlion"
              >Merlion: A Machine Learning Framework for Time Series
              Intelligence</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-28 @ 18:59:23</span
              ><span class="points-container"
                >Points: <span class="points">104</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43209064"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43207942">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=43207942"
              >Show HN: Globstar – Open-source static analysis toolkit</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-28 @ 17:12:26</span
              ><span class="points-container"
                >Points: <span class="points">73</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43207942"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
            <div class="text">
              <a href="https://github.com/DeepSourceCorp/globstar"
                >https://github.com/DeepSourceCorp/globstar</a
              >), a static analysis toolkit that lets you easily write and run
              custom code quality and security checkers in YAML [1] or Go [2].
              <p>
                After 5+ years of building AST-based static analyzers that
                process millions of lines of code daily at DeepSource, we kept
                hearing a common request from customers: "How do we write custom
                checks specific to our codebase?" AppSec and DevOps teams have a
                lot of learned anti-patterns and security rules they want to
                enforce across their orgs, and being able to do that without
                being a static analysis expert, came up as an important want.
              </p>
              <p>
                We initially built an internal framework using tree-sitter [3]
                for our proprietary infrastructure-as-code analyzers, which
                enabled us to rapidly create new checkers. We realized that
                making the framework open-source could solve this problem for
                everyone.
              </p>
              <p>
                Our key insight was that writing checkers isn't the hard part
                anymore. Modern AI assistants like ChatGPT and Claude are
                excellent at generating tree-sitter queries with very high
                accuracy. We realized that the tree-sitters' gnarly s-expression
                syntax isn’t a problem anymore (since the AI will be doing all
                the generation anyway), and we can instead focus on building a
                fast, flexible, and reliable checker runtime around it.
              </p>
              <p>
                So instead of creating yet another DSL, we use tree-sitter's
                native query syntax. Yes, the expressions look more complex than
                simplified DSLs, but they give you direct access to your code's
                actual AST structure – which means your rules work exactly as
                you'd expect them to. When you need to debug a rule, you're
                working with the actual structure of your code, not an
                abstraction that might hide important details.
              </p>
              <p>
                We've also designed Globstar to have a gradual learning curve:
                The YAML interface works well for simple checkers, and the Go
                Interface can handle complex scenarios when you need features
                like cross-file analysis, scope resolution, data flow analysis,
                and context awareness. The Go API gives you direct access to
                tree-sitter bindings, so you can write arbitrarily complex
                checkers on day one.
              </p>
              <p>Key features:</p>
              <p>
                - Written in Go with native tree-sitter bindings, distributed as
                a single binary
              </p>
              <p>- MIT-licensed</p>
              <p>
                - Write all your checkers in a “.globstar” folder in your repo,
                in YAML or Go, and just run “globstar check” without any build
                steps
              </p>
              <p>
                - Multi-language support through tree-sitter (20+ languages
                today)
              </p>
              <p>
                We have a long way to go and a very exciting roadmap for
                Globstar, and we’d love to hear your feedback!
              </p>
              <p>
                [1]
                <a href="https://globstar.dev/guides/writing-yaml-checker"
                  >https://globstar.dev/guides/writing-yaml-checker</a
                >
              </p>
              <p>
                [2]
                <a href="https://globstar.dev/guides/writing-go-checker"
                  >https://globstar.dev/guides/writing-go-checker</a
                >
              </p>
              <p>
                [3]
                <a href="https://tree-sitter.github.io/tree-sitter/"
                  >https://tree-sitter.github.io/tree-sitter/</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="43207831">
          <h3>
            <a
              class="item"
              href="https://josephmate.github.io/2025-02-26-3200p-cpu-util/"
              >3,200% CPU Utilization</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-28 @ 17:01:43</span
              ><span class="points-container"
                >Points: <span class="points">347</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43207831"
                  >Comments</a
                ><span class="descendants">: 145</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43206722">
          <h3>
            <a
              class="item"
              href="https://news.ufl.edu/2025/02/syrian-violence-epigenetics/"
              >Violence alters human genes for generations, researchers
              discover</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-28 @ 15:33:39</span
              ><span class="points-container"
                >Points: <span class="points">361</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43206722"
                  >Comments</a
                ><span class="descendants">: 219</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43206491">
          <h3>
            <a
              class="item"
              href="https://www.elenaverna.com/p/ai-is-killing-some-companies-yet"
              >AI is killing some companies, yet others are thriving – let's
              look at the data</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-28 @ 15:12:54</span
              ><span class="points-container"
                >Points: <span class="points">125</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43206491"
                  >Comments</a
                ><span class="descendants">: 127</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43206174">
          <h3>
            <a
              class="item"
              href="https://kupajo.com/write-to-escape-your-default-setting/"
              >Write to Escape Your Default Setting</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-28 @ 14:45:36</span
              ><span class="points-container"
                >Points: <span class="points">266</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43206174"
                  >Comments</a
                ><span class="descendants">: 65</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43204604">
          <h3>
            <a
              class="item"
              href="https://terinstock.com/post/2025/02/Netboot-Windows-11-with-iSCSI-and-iPXE/"
              >Netboot Windows 11 with iSCSI and iPXE</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-28 @ 11:47:52</span
              ><span class="points-container"
                >Points: <span class="points">167</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43204604"
                  >Comments</a
                ><span class="descendants">: 45</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43204575">
          <h3>
            <a
              class="item"
              href="https://deno.com/blog/the-dino-llama-and-whale"
              >The Dino, the Llama, and the Whale (Deno and Jupyter for Local AI
              Experiments)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-28 @ 11:43:22</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43204575"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43203543">
          <h3>
            <a
              class="item"
              href="https://garymarcus.substack.com/p/hot-take-gpt-45-is-a-nothing-burger"
              >Hot take: GPT 4.5 is a nothing burger</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-28 @ 09:24:13</span
              ><span class="points-container"
                >Points: <span class="points">127</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43203543"
                  >Comments</a
                ><span class="descendants">: 131</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43202982">
          <h3>
            <a
              class="item"
              href="https://en.chessbase.com/post/boris-spassky-1937-2025"
              >Boris Spassky: 1937–2025</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-28 @ 08:02:33</span
              ><span class="points-container"
                >Points: <span class="points">258</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43202982"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43201682">
          <h3>
            <a
              class="item"
              href="https://www.cbc.ca/radio/asithappens/tooth-in-eye-surgery-canada-1.7470626"
              >Surgery implants tooth material in eye as scaffolding for lens</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-28 @ 04:26:52</span
              ><span class="points-container"
                >Points: <span class="points">105</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43201682"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43185909">
          <h3>
            <a
              class="item"
              href="https://blog.mozilla.org/en/products/firefox/firefox-news/firefox-terms-of-use/"
              >Introducing a terms of use and updated privacy notice for
              Firefox</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-26 @ 17:31:58</span
              ><span class="points-container"
                >Points: <span class="points">209</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43185909"
                  >Comments</a
                ><span class="descendants">: 1055</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43174298">
          <h3>
            <a class="item" href="https://olmocr.allenai.org/"
              >OlmOCR: Open-source tool to extract plain text from PDFs</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-25 @ 16:51:47</span
              ><span class="points-container"
                >Points: <span class="points">99</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43174298"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43173808">
          <h3>
            <a
              class="item"
              href="https://hms.harvard.edu/news/resident-physicians-exam-scores-tied-patient-survival"
              >Resident Physicians' Exam Scores Tied to Patient Survival</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-25 @ 16:18:11</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43173808"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43170843">
          <h3>
            <a class="item" href="https://www.autodidacts.io/troubleshooting/"
              >Troubleshooting: A skill that never goes obsolete</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-25 @ 12:03:04</span
              ><span class="points-container"
                >Points: <span class="points">149</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43170843"
                  >Comments</a
                ><span class="descendants">: 61</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43169706">
          <h3>
            <a class="item" href="https://alexp.pl/2025/02/19/vibe-coding.html"
              >Vibe Coding and the Future of Software Engineering</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-25 @ 09:06:21</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43169706"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43169694">
          <h3>
            <a class="item" href="https://www.failurecriteria.com/"
              >Failure Theory for Materials Science and Engineering – Richard M.
              Christensen</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-25 @ 09:04:22</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43169694"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43169054">
          <h3>
            <a
              class="item"
              href="https://simons.berkeley.edu/news/stone-soup-ai"
              >Stone Soup AI (2024)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-25 @ 07:02:58</span
              ><span class="points-container"
                >Points: <span class="points">93</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43169054"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43160226">
          <h3>
            <a class="item" href="https://terokarvinen.com/2021/calendar-txt/"
              >Calendar.txt</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-02-24 @ 14:51:53</span
              ><span class="points-container"
                >Points: <span class="points">280</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43160226"
                  >Comments</a
                ><span class="descendants">: 111</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
