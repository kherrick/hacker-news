<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="35282325">
          <h3>
            <a class="item" href="https://github.com/apple/ml-ane-transformers"
              >Apple: Transformer architecture optimized for Apple Silicon</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-23 @ 22:31:47</span
              ><span class="points-container"
                >Points: <span class="points">147</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35282325"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35282293">
          <h3>
            <a
              class="item"
              href="http://habitatchronicles.com/2004/04/you-cant-tell-people-anything/"
              >You can't tell people anything</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-23 @ 22:29:34</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35282293"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35281617">
          <h3>
            <a
              class="item"
              href="https://steveridout.com/2023/03/23/buy-back.html"
              >I Bought Back My Acquihired Startup</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-23 @ 21:35:06</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35281617"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35281561">
          <h3>
            <a
              class="item"
              href="https://reasonablypolymorphic.com/blog/protos-are-wrong/"
              >Protobuffers Are Wrong (2018)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-23 @ 21:29:30</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35281561"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35281527">
          <h3>
            <a
              class="item"
              href="https://twitter.com/DV2559106965076/status/1638769434763608064"
              >Microsoft's paper on OpenAI's GPT-4 had hidden information</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-23 @ 21:26:28</span
              ><span class="points-container"
                >Points: <span class="points">122</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35281527"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35281194">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=35281194"
              >Generally Intelligent (YC S17) Is Hiring Machine Learning
              Research Engineers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-23 @ 21:00:51</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
            <div class="text">
              <p>
                Machine Learning Engineer (Remote, Contract or Full-time):
                <a
                  href="https://jobs.lever.co/generallyintelligent/9411e2ec-502a-403f-a39a-0d44c676b6af?lever-origin=applied&amp;lever-source%5B%5D=Y%20Combinator"
                  >https://jobs.lever.co/generallyintelligent/9411e2ec-502a-403...</a
                >
              </p>
              <p>
                Research Scientist (SF, Full-time):
                <a
                  href="https://jobs.lever.co/generallyintelligent/6c25a25c-35ec-4d7b-8d7e-40e9c4c85fba?lever-origin=applied&amp;lever-source%5B%5D=Y%20Combinator"
                  >https://jobs.lever.co/generallyintelligent/6c25a25c-35ec-4d7...</a
                >
              </p>
              <p>
                Machine Learning Research Engineer (SF, Full-time):
                <a
                  href="https://jobs.lever.co/generallyintelligent/c2f4a435-1eef-489a-9972-fba95e4a0296?lever-origin=applied&amp;lever-source%5B%5D=Y%20Combinator"
                  >https://jobs.lever.co/generallyintelligent/c2f4a435-1eef-489...</a
                >
              </p>
              <p>
                Systems Engineer (Remote or SF, Full-time):
                <a
                  href="https://jobs.lever.co/generallyintelligent/7afede07-8f22-4c49-b247-19e1a0ca6953?lever-origin=applied&amp;lever-source%5B%5D=Y%20Combinator"
                  >https://jobs.lever.co/generallyintelligent/7afede07-8f22-4c4...</a
                >
              </p>
              <p>
                Technical Lead Manager (SF, Full-time):
                <a
                  href="https://jobs.lever.co/generallyintelligent/75fac008-22e5-49ab-9f4e-a4c459b52b41?lever-origin=applied&amp;lever-source%5B%5D=Y%20Combinator"
                  >https://jobs.lever.co/generallyintelligent/75fac008-22e5-49a...</a
                >
              </p>
              <p>
                Infrastructure Engineer (Remote or SF, Full-time):
                <a
                  href="https://jobs.lever.co/generallyintelligent/e66a55a3-a117-406c-9b07-8ba055047cea?lever-origin=applied&amp;lever-source%5B%5D=Y%20Combinator"
                  >https://jobs.lever.co/generallyintelligent/e66a55a3-a117-406...</a
                >
              </p>
              <p>
                Senior Software Engineer (Remote or SF, Full-time):
                <a
                  href="https://jobs.lever.co/generallyintelligent/38a93a78-fb8d-4614-bb12-b6277a7f874e?lever-origin=applied&amp;lever-source%5B%5D=Y%20Combinator"
                  >https://jobs.lever.co/generallyintelligent/38a93a78-fb8d-461...</a
                >
              </p>
              <p>
                Technical Interviewer (Remote or SF, Contract):
                <a
                  href="https://jobs.lever.co/generallyintelligent/8443234d-a8c7-439f-bb8a-8142e713edc4?lever-origin=applied&amp;lever-source%5B%5D=Y%20Combinator"
                  >https://jobs.lever.co/generallyintelligent/8443234d-a8c7-439...</a
                >
              </p>
              <p>
                Theory Engineer:
                <a
                  href="https://jobs.lever.co/generallyintelligent/63499488-91b1-4154-956e-26551d7ac500?lever-origin=applied&amp;lever-source%5B%5D=Y%20Combinator"
                  >https://jobs.lever.co/generallyintelligent/63499488-91b1-415...</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="35281026">
          <h3>
            <a class="item" href="https://github.com/BlinkDL/RWKV-LM"
              >RWKV RNN: Better than ChatGPT?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-23 @ 20:45:35</span
              ><span class="points-container"
                >Points: <span class="points">87</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35281026"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35280454">
          <h3>
            <a class="item" href="https://www.robinwieruch.de/react-starter/"
              >How to start a React Project in 2023</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-23 @ 19:57:23</span
              ><span class="points-container"
                >Points: <span class="points">109</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35280454"
                  >Comments</a
                ><span class="descendants">: 84</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35280006">
          <h3>
            <a
              class="item"
              href="https://www.thefp.com/p/stanfords-war-against-its-own-students"
              >Stanford’s war against its own students</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-23 @ 19:24:05</span
              ><span class="points-container"
                >Points: <span class="points">112</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35280006"
                  >Comments</a
                ><span class="descendants">: 138</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35279656">
          <h3>
            <a
              class="item"
              href="https://replicate.com/blog/fine-tune-alpaca-with-lora"
              >How to use Alpaca-LoRA to fine-tune a model like ChatGPT</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-23 @ 18:59:33</span
              ><span class="points-container"
                >Points: <span class="points">118</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35279656"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35279274">
          <h3>
            <a
              class="item"
              href="https://www.modular.com/blog/ais-compute-fragmentation-what-matrix-multiplication-teaches-us"
              >AI’s compute fragmentation: what matrix multiplication teaches
              us</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-23 @ 18:34:03</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35279274"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35279155">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=35279155"
              >Launch HN: Helicone.ai (YC W23) – Open-source logging for
              OpenAI</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-23 @ 18:25:45</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35279155"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.helicone.ai">https://www.helicone.ai</a>) an
              open-source logging solution for OpenAi applications. Helicone's
              one-line integration logs the prompts, completions, latencies, and
              costs of your OpenAI requests. It currently works with GPT, and
              can be integrated with one line of code. There’s a demo at
              <a href="https://www.helicone.ai/video"
                >https://www.helicone.ai/video</a
              >.
              <p>
                Helicone's core technology is a proxy that routes all your
                OpenAI requests through our edge-deployed Cloudflare Workers.
                These workers are incredibly reliable and cause no discernible
                latency impact in production environments. As a proxy, we offer
                more than just observability: we provide caching and prompt
                formatting, and we'll soon add user rate limiting and model
                provider back off to make sure your app is still up when OpenAI
                is down.
              </p>
              <p>
                Our web application then provides insights into key metrics,
                such as which users are disproportionately driving costs and
                what is the token usage broken down by prompts. You can filter
                this data based on custom logic and export it to other
                destinations.
              </p>
              <p>
                Getting started with Helicone is quick and easy, regardless of
                the OpenAI SDK you use. Our proxy-based solution does not
                require a third party package—simply change your request's base
                URL from
                <a href="https://api.openai.com/v1"
                  >https://api.openai.com/v1</a
                >
                to
                <a href="https://oai.hconeai.com/v1"
                  >https://oai.hconeai.com/v1</a
                >. Helicone can be integrated with LangChain, LLama Index, and
                all other OpenAI native libraries. (<a
                  href="https://docs.helicone.ai/quickstart/integrate-in-one-line-of-code"
                  >https://docs.helicone.ai/quickstart/integrate-in-one-line-of...</a
                >)
              </p>
              <p>
                We have exciting new features coming up, one of which is an API
                to log user feedback. For instance, if you're developing a tool
                like GitHub Copilot, you can log when a user accepted or
                rejected a suggestion. Helicone will then aggregate your result
                quality into metrics and make finetuning suggestions for when
                you can save costs or improve performance.
              </p>
              <p>
                Before launching Helicone, we developed several projects with
                GPT-3, including airapbattle.com, tabletalk.ai, and
                dreamsubmarine.com. For each project, we used a beta version of
                Helicone which gave us instant visibility into user engagement
                and result quality issues. As we talked to more builders and
                companies, we realized they were spending too much time building
                in-house solutions like this and that existing analytics
                products were not tailored to inference endpoints like GPT-3.
              </p>
              <p>
                Helicone is developed under the Common Clause V1.0 w/ Apache 2.0
                license so that you can use Helicone within your own
                infrastructure. If you do not want to self-host, we provide a
                hosted solution with 1k requests free per month to try our
                product. If you exceed that we offer a paid subscription as
                well, and you can view our pricing at
                <a href="https://www.helicone.ai/pricing"
                  >https://www.helicone.ai/pricing</a
                >.
              </p>
              <p>
                We're thrilled to introduce Helicone to the HackerNews community
                and would love to hear your thoughts, ideas, and experiences
                related to LLM logging and analytics. We're eager to engage in
                meaningful discussions, so please don't hesitate to share your
                insights and feedback with us!
              </p>
            </div>
          </section>
        </section>
        <section id="35277925">
          <h3>
            <a
              class="item"
              href="https://writings.stephenwolfram.com/2023/03/chatgpt-gets-its-wolfram-superpowers/"
              >ChatGPT can now call Wolfram Alpha</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-23 @ 17:12:43</span
              ><span class="points-container"
                >Points: <span class="points">665</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35277925"
                  >Comments</a
                ><span class="descendants">: 233</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35277677">
          <h3>
            <a class="item" href="https://openai.com/blog/chatgpt-plugins"
              >ChatGPT Plugins</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-23 @ 16:57:28</span
              ><span class="points-container"
                >Points: <span class="points">1270</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35277677"
                  >Comments</a
                ><span class="descendants">: 682</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35277660">
          <h3>
            <a class="item" href="https://frame.work/"
              >Framework announces AMD, new Intel gen, 16“ laptop and more</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-23 @ 16:56:30</span
              ><span class="points-container"
                >Points: <span class="points">643</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35277660"
                  >Comments</a
                ><span class="descendants">: 301</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35277245">
          <h3>
            <a
              class="item"
              href="https://www.space.com/relativity-space-terran-1-test-launch-failure"
              >Relativity Space launches first 3D-printed rocket on historic
              test flight</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-23 @ 16:28:25</span
              ><span class="points-container"
                >Points: <span class="points">165</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35277245"
                  >Comments</a
                ><span class="descendants">: 75</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35276765">
          <h3>
            <a class="item" href="https://github.com/bibliotechy/dirty-poetry"
              >Poetry from dirty OCR</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-23 @ 15:57:49</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35276765"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35275658">
          <h3>
            <a
              class="item"
              href="https://www.coindesk.com/business/2023/03/23/do-kwon-arrested-in-montenegro-interior-minister/"
              >Do Kwon arrested in Montenegro: Interior Minister</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-23 @ 14:48:11</span
              ><span class="points-container"
                >Points: <span class="points">322</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35275658"
                  >Comments</a
                ><span class="descendants">: 219</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35275301">
          <h3>
            <a
              class="item"
              href="https://tristancacqueray.github.io/blog/introducing-butler"
              >Butler Virtual Operating System</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-23 @ 14:24:46</span
              ><span class="points-container"
                >Points: <span class="points">255</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35275301"
                  >Comments</a
                ><span class="descendants">: 15</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35274519">
          <h3>
            <a
              class="item"
              href="https://www.theverge.com/2023/3/23/23652373/ftc-click-to-cancel-subscription-service-dark-patterns-ban"
              >The FTC wants to ban tough-to-cancel subscriptions</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-23 @ 13:33:10</span
              ><span class="points-container"
                >Points: <span class="points">682</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35274519"
                  >Comments</a
                ><span class="descendants">: 304</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35274362">
          <h3>
            <a
              class="item"
              href="https://oneusefulthing.substack.com/p/a-quick-and-sobering-guide-to-cloning"
              >A quick and sobering guide to cloning yourself</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-23 @ 13:22:33</span
              ><span class="points-container"
                >Points: <span class="points">82</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35274362"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35272350">
          <h3>
            <a
              class="item"
              href="https://www.economist.com/special-report/2023/03/20/moviemaking-and-gamemaking-are-converging"
              >Moviemaking and gamemaking are converging</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-23 @ 10:01:17</span
              ><span class="points-container"
                >Points: <span class="points">154</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35272350"
                  >Comments</a
                ><span class="descendants">: 181</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35272227">
          <h3>
            <a
              class="item"
              href="https://markessien.com/posts/drama_of_transcription/"
              >The drama in trying to convert election PDFs to Spreadsheets</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-23 @ 09:40:21</span
              ><span class="points-container"
                >Points: <span class="points">617</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35272227"
                  >Comments</a
                ><span class="descendants">: 129</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35270806">
          <h3>
            <a
              class="item"
              href="https://rmc.library.cornell.edu/witchcraftcoll/"
              >The Cornell University Witchcraft Collection</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-23 @ 05:25:55</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35270806"
                  >Comments</a
                ><span class="descendants">: 49</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35270637">
          <h3>
            <a
              class="item"
              href="https://blog.ploeh.dk/2023/03/20/on-trust-in-software-development/"
              >On Trust in Software Development</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-23 @ 04:45:44</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35270637"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35270257">
          <h3>
            <a
              class="item"
              href="http://msinilo.pl/blog2/post/debugger-barrier/"
              >A debugger barrier</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-23 @ 03:38:26</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35270257"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35270131">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2023/03/21/well/live/cleaning-disinfectant-bleach-risks.html"
              >The risks of cleaning with bleach and other disinfectants</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-23 @ 03:16:33</span
              ><span class="points-container"
                >Points: <span class="points">104</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35270131"
                  >Comments</a
                ><span class="descendants">: 121</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35264919">
          <h3>
            <a class="item" href="https://en.wikipedia.org/wiki/Miller_test"
              >Miller test</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-22 @ 18:10:20</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35264919"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35262841">
          <h3>
            <a
              class="item"
              href="https://aeon.co/essays/why-are-most-of-us-stuck-with-a-belief-in-the-soul"
              >Stuck with the Soul</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-22 @ 15:43:50</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35262841"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="35262594">
          <h3>
            <a
              class="item"
              href="https://web.archive.org/web/20081225064415/http://pcmcia.org/"
              >Official Home Page for the PCMCIA Trade Association (2008)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-03-22 @ 15:31:09</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=35262594"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
