<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="36775693">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/velt/jobs/7W1w74l-founding-fullstack-engineer-crdts-us-only"
              >Velt (YC W22) Is Hiring Engineer to Build a Better “CRDT”</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 17:01:01</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36775576">
          <h3>
            <a
              class="item"
              href="https://socketsite.com/archives/2023/07/enough-empty-office-space-for-178000-people-in-san-francisco.html"
              >17.1 Salesforce Towers worth of empty office space spread across
              SF</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 16:54:30</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36775576"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36775398">
          <h3>
            <a
              class="item"
              href="https://identity.sweden.se/en/design-elements/typography"
              >Sweden Sans Font</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 16:43:12</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36775398"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36775098">
          <h3>
            <a
              class="item"
              href="https://nickjanetakis.com/blog/what-i-learned-about-payment-systems-while-working-at-a-pizza-place"
              >What I Learned about Payment Systems While Working at a Pizza
              Place</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 16:27:00</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36775098"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36774940">
          <h3>
            <a
              class="item"
              href="https://www.noahpinion.blog/p/refusing-to-teach-kids-math-will"
              >Refusing to teach kids math will not improve equity</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 16:18:30</span
              ><span class="points-container"
                >Points: <span class="points">222</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36774940"
                  >Comments</a
                ><span class="descendants">: 130</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36774627">
          <h3>
            <a class="item" href="https://ai.meta.com/llama/"
              >Llama 2 – Meta AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 16:01:49</span
              ><span class="points-container"
                >Points: <span class="points">554</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36774627"
                  >Comments</a
                ><span class="descendants">: 163</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36774611">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=36774611"
              >Launch HN: Highlight.io (YC W23) – Open-source, full stack web
              app monitoring</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 16:01:08</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36774611"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
            <div class="text">
              <a href="https://highlight.io">https://highlight.io</a>). We’re
              building a truly open source [1] observability platform for modern
              web applications. We posted some of our tools to HN in recent
              months [2][3]. Today, we’re excited to formally launch the
              project, share more about where we’re going, and of course, poll
              the community for some feedback. A bit of background: Vadim and I
              have worked at quite a few startups at this point, and a recurring
              challenge we’ve faced was tracing usability issues on the frontend
              to downstream errors and logs on the server. Understanding the
              real reason behind customer issues was always a chaotic juggling
              of multiple tools. With the rise of "frontend-forward" frameworks
              such as NextJS, which blur the boundary between the client and
              server, the complexity of tracing these issues is only growing.
              <p>
                This is where Highlight.io comes in: our product bridges the gap
                between client and server to give you a holistic view of your
                entire application.
              </p>
              <p>
                At its core, Highlight.io has three main “products”: Session
                Replay, Error Monitoring, and Logging. The novelty here is not
                in each product but in how they are connected. For example, in
                Highlight.io it’s very easy to click from a given error to the
                associated user session where it is thrown [4], and from a given
                error, you can easily inspect all of the logs that fired leading
                up to it. Ensuring that all of our products work together
                seamlessly with little to no effort is a core principle of our
                product strategy. If you’re using a common framework [5], for
                example, we’ll automatically link your frontend sessions with
                backend errors and logs. No agents, configuring facets, or
                anything else, It just works.
              </p>
              <p>
                We depend on several open source projects that help us move
                quickly. OpenTelemetry (OTEL) [6] is one of them, which helps us
                with maintainability, i.e. for every language that we support,
                we only maintain a thin wrapper around its respective OTEL SDK.
                OTEL is also a great way to enable the community to contribute,
                and we’re already seeing traction in this space (ie. an open
                source contributor built a wrapper for a Java SDK [7]).
              </p>
              <p>
                rrweb [8] is another project we leverage heavily for our session
                replay product. It drives our ability to record and replay the
                DOM to visualize user flows in the frontend. We’ve had the
                privilege to work closely with the rrweb team to ship
                improvements, and we’re now actively sponsoring the project [9].
              </p>
              <p>
                ClickHouse [10] has recently become a loved database on our
                team, as we historically used Opensearch for search-heavy
                workloads and started to hit growing pains with ingest
                throughput. We recently rolled it out for our logging product
                [3] and plan to replace our sessions and errors (and upcoming
                tracing work) with the database as well.
              </p>
              <p>
                From a business perspective, Highlight.io is open source under
                the Apache 2.0 license, and we make money with our hosted
                product [11]. For the hosted product, you can set billing caps
                for each offering and we don’t charge for seats. At this point,
                we have 100+ companies paying for our product (some of which are
                large enterprises), and thousands of sole developers use
                Highlight.io every week.
              </p>
              <p>
                On our roadmap [12] for the future includes metrics, tracing,
                release management and more. We also are launching several
                updates this week on our launch week page [13].
              </p>
              <p>
                Overall, we’re excited to be sharing Highlight.io with the
                world, and Vadim and I are particularly excited to get some
                feedback from the HN community. Please give us a test-drive at
                <a href="https://app.highlight.io">https://app.highlight.io</a>
                and let us know what you think. We would love to learn about
                what you wish you had in an observability product as well as any
                other experiences and ideas in this space. We look forward to
                hearing from you!
              </p>
              <p>
                1:
                <a
                  href="https://github.com/highlight/highlight/blob/main/LICENSE"
                  >https://github.com/highlight/highlight/blob/main/LICENSE</a
                >
              </p>
              <p>
                2:
                <a href="https://news.ycombinator.com/item?id=34897645"
                  >https://news.ycombinator.com/item?id=34897645</a
                >
              </p>
              <p>
                3:
                <a href="https://news.ycombinator.com/item?id=35643255"
                  >https://news.ycombinator.com/item?id=35643255</a
                >
              </p>
              <p>
                4:
                <a href="https://youtu.be/EvGsmbt0F7s?t=65"
                  >https://youtu.be/EvGsmbt0F7s?t=65</a
                >
              </p>
              <p>
                5:
                <a href="https://highlight.io/frameworks"
                  >https://highlight.io/frameworks</a
                >
              </p>
              <p>
                6:
                <a href="https://opentelemetry.io/"
                  >https://opentelemetry.io/</a
                >
              </p>
              <p>
                7:
                <a href="https://github.com/highlight/highlight/pull/4812"
                  >https://github.com/highlight/highlight/pull/4812</a
                >
              </p>
              <p>
                8:
                <a href="https://github.com/rrweb-io/rrweb"
                  >https://github.com/rrweb-io/rrweb</a
                >
              </p>
              <p>
                9:
                <a href="https://github.com/rrweb-io/rrweb#gold-sponsors-"
                  >https://github.com/rrweb-io/rrweb#gold-sponsors-</a
                >
              </p>
              <p>
                10:
                <a href="https://clickhouse.com/blog/overview-of-highlightio"
                  >https://clickhouse.com/blog/overview-of-highlightio</a
                >
              </p>
              <p>
                11:
                <a href="https://highlight.io/pricing"
                  >https://highlight.io/pricing</a
                >
              </p>
              <p>
                12:
                <a href="https://www.highlight.io/docs/general/roadmap"
                  >https://www.highlight.io/docs/general/roadmap</a
                >
              </p>
              <p>
                13:
                <a href="https://highlight.io/launch-week-2"
                  >https://highlight.io/launch-week-2</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="36774472">
          <h3>
            <a
              class="item"
              href="https://fromthedesk.substack.com/p/trip-report-rafting-the-selway-to"
              >Whitewater Rafting on the Selway River in Idaho</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 15:52:55</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36774472"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36774093">
          <h3>
            <a class="item" href="https://github.com/weaviate/healthsearch-demo"
              >Show HN: Weaviate – Build your own generative health search
              engine</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 15:30:22</span
              ><span class="points-container"
                >Points: <span class="points">22</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36774093"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
            <div class="text">
              We are super excited to release our latest open-source demo,
              Healthsearch. This demo decodes user reviews of supplements and
              performs semantic- and generative search on them, retrieving the
              most related products for specific health effects, and leveraging
              Large Language Models to generate product and review summaries.
              The demo can understand natural language queries and derive all
              search filters directly from the context of your query.
            </div>
          </section>
        </section>
        <section id="36773554">
          <h3>
            <a class="item" href="https://tomcritchlow.com/2019/11/18/yes-and/"
              >The office is a theatre for work (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 15:01:39</span
              ><span class="points-container"
                >Points: <span class="points">202</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36773554"
                  >Comments</a
                ><span class="descendants">: 131</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36773363">
          <h3>
            <a
              class="item"
              href="https://www.theverge.com/2023/7/18/23798814/the-plan-is-to-flood-google-search-with-ai-garbage-it-is-not-a-secret-plan"
              >The plan is to flood Google search with AI garbage</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 14:53:10</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36773363"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36773022">
          <h3>
            <a
              class="item"
              href="https://www.appsmith.com/blog/write-a-great-readme"
              >How to Write a Great Readme</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 14:34:29</span
              ><span class="points-container"
                >Points: <span class="points">80</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36773022"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36771980">
          <h3>
            <a class="item" href="https://github.com/Lxtharia/minegrub-theme"
              >A Grub Theme in the style of Minecraft</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 13:38:43</span
              ><span class="points-container"
                >Points: <span class="points">234</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36771980"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36771637">
          <h3>
            <a
              class="item"
              href="https://flowchart.fun/blog/post/styling-flowcharts-using-css"
              >Styling Flowcharts Using CSS</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 13:15:43</span
              ><span class="points-container"
                >Points: <span class="points">91</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36771637"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36771484">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2304.09871"
              >A Theory on Adam Instability in Large-Scale Machine Learning</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 13:02:25</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36771484"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36771227">
          <h3>
            <a
              class="item"
              href="https://blog.carlmjohnson.net/post/2023/ten-years-of-go-good-bad-meh/"
              >Ten Years of “Go: The Good, the Bad, and the Meh”</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 12:37:09</span
              ><span class="points-container"
                >Points: <span class="points">92</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36771227"
                  >Comments</a
                ><span class="descendants">: 57</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36771149">
          <h3>
            <a class="item" href="https://griffin.moe/voder/"
              >Voder Speech Synthesizer</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 12:29:54</span
              ><span class="points-container"
                >Points: <span class="points">166</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36771149"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36770883">
          <h3>
            <a
              class="item"
              href="https://treeherder.mozilla.org/perfherder/graphs?timerange=31536000&amp;series=mozilla-central,3735773,1,13&amp;series=mozilla-central,3412459,1,13"
              >Firefox has surpassed Chrome on Speedometer</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 12:00:21</span
              ><span class="points-container"
                >Points: <span class="points">806</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36770883"
                  >Comments</a
                ><span class="descendants">: 348</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36770624">
          <h3>
            <a
              class="item"
              href="https://www.nature.com/articles/d41586-023-02299-w"
              >Medicine is plagued by untrustworthy clinical trials</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 11:27:21</span
              ><span class="points-container"
                >Points: <span class="points">185</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36770624"
                  >Comments</a
                ><span class="descendants">: 172</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36769912">
          <h3>
            <a class="item" href="https://www.swig.org/"
              >Swig – Connect C/C++ programs with high-level programming
              languages</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 09:37:48</span
              ><span class="points-container"
                >Points: <span class="points">87</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36769912"
                  >Comments</a
                ><span class="descendants">: 71</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36769173">
          <h3>
            <a class="item" href="https://github.com/stalwartlabs/mail-server"
              >Stalwart All-in-One Mail Server (IMAP, JMAP, SMTP)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 07:50:32</span
              ><span class="points-container"
                >Points: <span class="points">138</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36769173"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36767837">
          <h3>
            <a
              class="item"
              href="https://writings.stephenwolfram.com/2023/07/generative-ai-space-and-the-mental-imagery-of-alien-minds/"
              >Generative AI space and the mental imagery of alien minds</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 04:34:25</span
              ><span class="points-container"
                >Points: <span class="points">186</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36767837"
                  >Comments</a
                ><span class="descendants">: 72</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36767092">
          <h3>
            <a
              class="item"
              href="https://www.hagerty.com/media/advice/a-few-things-to-know-before-you-steal-my-914/"
              >A few things to know before stealing my 914 (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-18 @ 02:32:25</span
              ><span class="points-container"
                >Points: <span class="points">338</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36767092"
                  >Comments</a
                ><span class="descendants">: 251</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36762513">
          <h3>
            <a
              class="item"
              href="https://www.wsj.com/articles/everyday-utopia-review-the-road-to-nowhere-1ca3ceb3"
              >‘Everyday Utopia’ Review: The Road to Nowhere</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 19:02:14</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36762513"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36762283">
          <h3>
            <a class="item" href="https://hg.sr.ht/~dalke/rectfillcurve"
              >Show HN: Rectfillcurve – generate rectangle-filling curves</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 18:43:42</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36762283"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
            <div class="text">
              <p>
                Luckily for me, people have developed generalized versions of
                those algorithms which can handle arbitrary-sized rectangles.
              </p>
              <p>
                I've taken those and packaged all of the those curves into
                "rectfillcurve", with an iterator API for generating those
                curves, and a bonus "mlcg curve" with a pseudo-random visit
                order that should have poor cache behavior. Implemented in
                stand-alone C, and also available as a Python module.
              </p>
            </div>
          </section>
        </section>
        <section id="36756504">
          <h3>
            <a class="item" href="https://jacquesmattheij.com/be-consultant/"
              >How to be a consultant, a freelancer, or an independent
              contractor (2009)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-17 @ 11:05:36</span
              ><span class="points-container"
                >Points: <span class="points">290</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36756504"
                  >Comments</a
                ><span class="descendants">: 125</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36744690">
          <h3>
            <a class="item" href="https://mathoverflow.net/a/44213"
              >It's not mathematics that you need to contribute to (2010)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-16 @ 08:11:11</span
              ><span class="points-container"
                >Points: <span class="points">145</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36744690"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36742131">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=Qg3XOfioapI"
              >“Kolmogorov music” by Christopher Ford (2015) [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-16 @ 00:12:53</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36742131"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36741976">
          <h3>
            <a
              class="item"
              href="https://rainingcomputers.blog/dist/the_path_to_implementing_a_programming_language.md"
              >The path to implementing a programming language</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-15 @ 23:47:27</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36741976"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36736723">
          <h3>
            <a class="item" href="https://data-oriented.design/"
              >Data-Oriented Design Principles</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-15 @ 13:48:41</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36736723"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
