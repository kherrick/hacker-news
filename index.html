<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="45140730">
          <h3>
            <a
              class="item"
              href="https://ec.europa.eu/commission/presscorner/detail/en/ip_25_1992"
              >European Commission fines Google €2.95B over abusive ad tech
              practices</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-05 @ 16:52:34</span
              ><span class="points-container"
                >Points: <span class="points">54</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45140730"
                  >Comments</a
                ><span class="descendants">: 27</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45140381">
          <h3>
            <a class="item" href="https://github.com/Mentra-Community/MentraOS"
              >MentraOS – open-source Smart glasses OS</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-05 @ 16:25:48</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45140381"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45139656">
          <h3>
            <a
              class="item"
              href="https://reasonablypolymorphic.com/blog/protos-are-wrong/"
              >Protobuffers Are Wrong (2018)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-05 @ 15:25:10</span
              ><span class="points-container"
                >Points: <span class="points">108</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45139656"
                  >Comments</a
                ><span class="descendants">: 119</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45139270">
          <h3>
            <a
              class="item"
              href="https://www.bart.gov/news/articles/2025/news20250905"
              >A computer upgrade has shut down BART</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-05 @ 14:52:37</span
              ><span class="points-container"
                >Points: <span class="points">144</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45139270"
                  >Comments</a
                ><span class="descendants">: 111</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45139088">
          <h3>
            <a
              class="item"
              href="https://emilkowal.ski/ui/you-dont-need-animations"
              >Purposeful animations</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-05 @ 14:34:57</span
              ><span class="points-container"
                >Points: <span class="points">120</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45139088"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45138156">
          <h3>
            <a
              class="item"
              href="https://pawelbrodzinski.substack.com/p/development-speed-is-not-a-bottleneck"
              >Development speed is not a bottleneck</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-05 @ 13:13:41</span
              ><span class="points-container"
                >Points: <span class="points">117</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45138156"
                  >Comments</a
                ><span class="descendants">: 93</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45137927">
          <h3>
            <a
              class="item"
              href="https://www.ssp.sh/blog/practical-data-modeling-clickhouse/"
              >Data modeling guide for real-time analytics with ClickHouse</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-05 @ 12:51:27</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45137927"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45137914">
          <h3>
            <a class="item" href="https://amaiorano.io/2025/09/03/lava-rgb.html"
              >Lava RGB</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-05 @ 12:50:00</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45137914"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45137802">
          <h3>
            <a class="item" href="https://absolutelyright.lol/"
              >I'm absolutely right</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-05 @ 12:36:47</span
              ><span class="points-container"
                >Points: <span class="points">446</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45137802"
                  >Comments</a
                ><span class="descendants">: 196</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45137554">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=45137554"
              >Relace (YC W23) Is Hiring for Code LLMs (SF)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-05 @ 12:01:09</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
            <div class="text">
              <p>
                If you have a Physics, Math, CS degree; and training fast
                codegen models is something that piques your interest, please
                email me directly at pzhou@relace.ai.
              </p>
            </div>
          </section>
        </section>
        <section id="45137525">
          <h3>
            <a
              class="item"
              href="https://codesmash.dev/why-i-ditched-docker-for-podman-and-you-should-too"
              >I ditched Docker for Podman</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-05 @ 11:56:59</span
              ><span class="points-container"
                >Points: <span class="points">620</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45137525"
                  >Comments</a
                ><span class="descendants">: 368</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45137373">
          <h3>
            <a
              class="item"
              href="https://signalsandthreads.com/why-ml-needs-a-new-programming-language/"
              >ML needs a new programming language – Interview with Chris
              Lattner</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-05 @ 11:33:48</span
              ><span class="points-container"
                >Points: <span class="points">100</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45137373"
                  >Comments</a
                ><span class="descendants">: 99</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45137363">
          <h3>
            <a
              class="item"
              href="https://www.aljazeera.com/news/2025/9/4/nepal-moves-to-block-facebook-x-youtube-and-others"
              >Nepal moves to block Facebook, X, YouTube and others</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-05 @ 11:31:58</span
              ><span class="points-container"
                >Points: <span class="points">155</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45137363"
                  >Comments</a
                ><span class="descendants">: 154</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45137245">
          <h3>
            <a
              class="item"
              href="https://6octaves.com/2025/09/interview-with-demoscener-0b5vr.html"
              >Interview with Japanese Demoscener 0b5vr</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-05 @ 11:08:26</span
              ><span class="points-container"
                >Points: <span class="points">121</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45137245"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45136728">
          <h3>
            <a
              class="item"
              href="https://twitter.com/davepl1968/status/1963803025572770212"
              >I have two Amazon Echos that I never use, but they apparently
              burn GBs a day</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-05 @ 09:40:08</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45136728"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45133938">
          <h3>
            <a class="item" href="https://fil-c.org/fugc"
              >Fil's Unbelievable Garbage Collector</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-05 @ 00:55:52</span
              ><span class="points-container"
                >Points: <span class="points">540</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45133938"
                  >Comments</a
                ><span class="descendants">: 242</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45132810">
          <h3>
            <a
              class="item"
              href="https://www.quantamagazine.org/what-is-the-fourier-transform-20250903/"
              >What Is the Fourier Transform?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-04 @ 22:11:09</span
              ><span class="points-container"
                >Points: <span class="points">398</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45132810"
                  >Comments</a
                ><span class="descendants">: 177</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45132710">
          <h3>
            <a
              class="item"
              href="https://www.bitflux.ai/blog/memory-is-slow-part2/"
              >io_uring is faster than mmap</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-04 @ 22:01:11</span
              ><span class="points-container"
                >Points: <span class="points">261</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45132710"
                  >Comments</a
                ><span class="descendants">: 113</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45130260">
          <h3>
            <a class="item" href="https://bbycroft.net/llm"
              >LLM Visualization</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-04 @ 18:06:05</span
              ><span class="points-container"
                >Points: <span class="points">553</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45130260"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45129085">
          <h3>
            <a class="item" href="https://tempo.xyz"
              >Stripe Launches L1 Blockchain: Tempo</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-04 @ 16:32:24</span
              ><span class="points-container"
                >Points: <span class="points">754</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45129085"
                  >Comments</a
                ><span class="descendants">: 943</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45128889">
          <h3>
            <a
              class="item"
              href="https://github.com/browseros-ai/BrowserOS/issues/99"
              >Ask HN: What Arc/Dia features should we prioritize?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-04 @ 16:13:53</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45128889"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
            <div class="text">
              <p>
                With Arc selling to Atlassian, figured it's good timing to ask:
                what features do you actually miss? We are working on
                implementing some obvious ones (vertical tabs, workspaces) but
                honestly not sure what matters vs. what's just cool.
              </p>
              <p>
                Feature requests:
                <a href="https://github.com/browseros-ai/BrowserOS/issues/99"
                  >https://github.com/browseros-ai/BrowserOS/issues/99</a
                >
              </p>
              <p>We are still early but shipping fast.</p>
            </div>
          </section>
        </section>
        <section id="45128391">
          <h3>
            <a
              class="item"
              href="https://www.theverge.com/cs/features/717322/wikipedia-attacks-neutrality-history-jimmy-wales"
              >Wikipedia survives while the rest of the internet breaks</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-04 @ 15:30:20</span
              ><span class="points-container"
                >Points: <span class="points">534</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45128391"
                  >Comments</a
                ><span class="descendants">: 399</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45125247">
          <h3>
            <a class="item" href="https://enda.sh/vapor/"
              >Show HN: Vapor – A notepad that fades away as you type</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-04 @ 09:16:28</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45125247"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
            <div class="text">
              <p>
                I made this simple notepad for writing down whatever comes to
                mind. The goal is to force you to not get hung up on what you’ve
                already written. There’s no formatting, you can’t edit what
                you’ve typed, you can’t select text or move your caret around.
                There’s no backspace, delete, undo/redo, or paste. You can’t
                even see any words except the one you’re currently typing, and
                when you’re done with it, it fades away.
              </p>
              <p>
                The text is all still there, just invisible. You can save
                everything you’ve written as a .txt if you want, or just empty
                your thoughts and let them disappear forever.
              </p>
              <p>
                The idea was to encourage myself to do more
                stream-of-consciousness writing. I tend to edit while I write.
                This forces me to just keep moving forward, and I’ve found it
                very helpful so far. I was going to build this into my other
                writing tool, Drift, but I didn’t think it fit with the idea of
                the project, so I just made it its own thing. I’m calling it
                Vapor for now.
              </p>
              <p>Enjoy, and let me know what you think!</p>
            </div>
          </section>
        </section>
        <section id="45101797">
          <h3>
            <a
              class="item"
              href="https://vickiboykis.com/2025/09/01/how-big-are-our-embeddings-now-and-why/"
              >How big are our embeddings now and why?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-02 @ 11:45:46</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45101797"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45100516">
          <h3>
            <a
              class="item"
              href="https://system-illumination.org/01-rustler.html"
              >Debugging Rustler on Illumos</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-02 @ 08:42:43</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45100516"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45098609">
          <h3>
            <a class="item" href="https://www.theoldrobots.com/index2.html"
              >The Old Robots Web Site</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-02 @ 02:43:00</span
              ><span class="points-container"
                >Points: <span class="points">95</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45098609"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45097303">
          <h3>
            <a class="item" href="https://dusty.phillips.codes/roc/"
              >Building a WASM compiler in Roc (series)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-01 @ 22:49:26</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45097303"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45093501">
          <h3>
            <a class="item" href="https://www.waitingforfriday.com/?p=264"
              >Vetinari's Clock (2011)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-01 @ 15:29:09</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45093501"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45090553">
          <h3>
            <a class="item" href="https://github.com/mindbrix/Rasterizer"
              >Rasterizer: A GPU-accelerated 2D vector graphics engine in ~4k
              LOC</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-09-01 @ 07:56:30</span
              ><span class="points-container"
                >Points: <span class="points">141</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45090553"
                  >Comments</a
                ><span class="descendants">: 53</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45084133">
          <h3>
            <a
              class="item"
              href="https://austinhenley.com/blog/babytypechecker.html"
              >Baby's first type checker</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-31 @ 15:53:22</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45084133"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
