<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="41125297">
          <h3>
            <a
              class="item"
              href="https://mccue.dev/pages/7-31-24-rust-just-failed-its-test"
              >Rust Just Failed an Important Test</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-01 @ 01:18:31</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41125297"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41125226">
          <h3>
            <a
              class="item"
              href="https://etleap.com/careers/customer-success-manager/"
              >Etleap (YC W13) Is Hiring a Customer Success Manager (SF)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-08-01 @ 01:02:01</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41124472">
          <h3>
            <a class="item" href="https://snowflakeos.org/"
              >SnowflakeOS: Beginner friendly and GUI focused NixOS variant</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-31 @ 23:06:11</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41124472"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41123155">
          <h3>
            <a
              class="item"
              href="https://statmodeling.stat.columbia.edu/2024/07/31/suspicious-data-pattern-in-recent-venezuelan-election/"
              >Suspicious data pattern in recent Venezuelan election</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-31 @ 20:34:31</span
              ><span class="points-container"
                >Points: <span class="points">617</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41123155"
                  >Comments</a
                ><span class="descendants">: 335</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41122793">
          <h3>
            <a class="item" href="https://github.com/nfoert/cardie"
              >Cardie – An open source business card designer and sharing
              platform</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-31 @ 19:50:37</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41122793"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41122509">
          <h3>
            <a class="item" href="https://www.nongnu.org/skribilo/"
              >Skribilo: The Document Programming Framework</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-31 @ 19:23:51</span
              ><span class="points-container"
                >Points: <span class="points">31</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41122509"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41120254">
          <h3>
            <a
              class="item"
              href="https://buttondown.email/hillelwayne/archive/why-i-prefer-rst-to-markdown/"
              >I prefer rST to Markdown</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-31 @ 15:49:55</span
              ><span class="points-container"
                >Points: <span class="points">263</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41120254"
                  >Comments</a
                ><span class="descendants">: 305</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41119443">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=41119443"
              >Launch HN: Martin (YC S23) – Using LLMs to Make a Better Siri</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-31 @ 14:24:27</span
              ><span class="points-container"
                >Points: <span class="points">117</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41119443"
                  >Comments</a
                ><span class="descendants">: 88</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.trymartin.com">https://www.trymartin.com</a
              >). Martin is a better Siri with an LLM brain and deeper
              integrations with everyday apps. See our demo here (<a
                href="https://youtu.be/jiJdfrWurvk"
                >https://youtu.be/jiJdfrWurvk</a
              >). You can talk to Martin through voice in our iOS app. You can
              also text it via SMS, WhatsApp, or email. Currently, Martin can
              manage your calendar, set reminders, find information, send you
              daily briefings, and have text conversations with your contacts on
              your behalf (from its own phone number).
              <p>
                I’ve been a Siri power user for a long time, mainly because I’ve
                always liked using voice as an interface. But, legacy voice
                assistants like Siri, Google Assistant, and Alexa were never
                well integrated enough or reliable enough to actually save time.
                Maybe 1 in 5 commands end up executing as smoothly as you
                expected, but the most useful thing they do is play a song or
                set an alarm. The advent of LLMs seemed like a great opportunity
                to push the state of the art forward a notch or two!
              </p>
              <p>Our goal is to do 2 things better:</p>
              <p>
                1) Deeper integrations with productivity-related apps you use
                every day, like calendar, email, messages, whatsApp, and soon
                Google Docs, Slack, and phone calls.
              </p>
              <p>
                2) Better memory of each user based on their past conversations
                and integrations, so Martin can start to anticipate parameters
                in the user’s commands (e.g. text the guy from yesterday about
                the plans we made this morning)
              </p>
              <p>
                A great way that our early users use Martin is having morning
                syncs and evening debriefs with the software. At the start/end
                of each day, they’ll have a 5-10 minute sync about their TODOs
                for the next day, and Martin will brief them on upcoming tasks
                and news they’re typically interested in.
              </p>
              <p>
                Something else Martin does which is unlike other voice
                assistants is it can have full text conversations with your
                contacts on your behalf from its own phone number. For example,
                you can tell it to plan a lunch with a friend, and it can text
                back and forth with that friend to figure out a time and place.
                After the text conversation between your friend and Martin is
                over, Martin reports back to you via a notification and a text.
                You can also monitor all of its messages with your contacts in
                the app.
              </p>
              <p>
                We started building Martin exactly 1 year ago, during our YC
                batch. It’s definitely a hard product to “complete" because of
                the many unsolved technical challenges, but we’re making
                progress step by step. First was the voice interface, which Siri
                still hasn’t gotten right after more than a decade. We have 2
                modes: push-to-talk and handsfree. Handsfree is great for
                obvious reasons. We’ve gotten our latency down to only a couple
                seconds max for most commands, and we’ve tuned our own voice
                activity detection model to minimize the chance of Martin
                cutting you off (a common problem with voiceGPTs). But, even
                then, Martin may still cut you off if you pause for 3-5 seconds
                in the middle of a thought, so we made a push-to-talk mode. For
                those cases where you want to describe something in detail or
                just brain-dump to Martin, you might need 20-30 seconds to
                finish speaking. So just hold down, speak, and release when
                you’re done—like a walkie talkie.
              </p>
              <p>
                We’ve also had to tackle a very long tail of integrations, and
                we want to do each one well. For example, when we launched
                Google calendar, we wanted to make sure you could add a Google
                Meet link, invite your contacts to the events, and access
                secondary calendars. And, you should be able to say things like
                “set reminders leading up to the event” or “text Eric the
                details of this event.” So, we pretty much release one new major
                integration every month.
              </p>
              <p>
                Finally, there’s the problem of personalization / LLM memory,
                which is still very unsolved. From each conversation that a user
                has with their Martin, we try to infer what the user is busy
                with, worried about, or looking forward to, so in their next
                “morning sync” or “evening debrief”, Martin can proactively
                suggest to-dos or goals/topics to discuss with the user. Right
                now, we use a few different LLMs and many chain-of-thought steps
                to extract clues from each conversation and have Martin
                “reflect” periodically to build its memory. But, with all that
                said we still have a lot of work to do here, and this is just a
                start!
              </p>
              <p>
                You can try Martin by going to our website (<a
                  href="https://www.trymartin.com"
                  >https://www.trymartin.com</a
                >) and starting a 7 day free trial. Once you start your trial,
                you’ll get an access code emailed to you along with the download
                link for our iOS app. After you enter your access code into the
                app, you can integrate your calendar, contacts, etc. If you find
                Martin useful after the trial, we charge our early users (who
                are generally productivity gurus and prosumers with multiple AI
                subscriptions) a $30/month subscription.
              </p>
              <p>
                We can’t wait to hear your thoughts. Any cool experiences with
                Siri, things you wish a voice assistant could do, or ideas about
                LLM memory, tool calling, etc. - I’d love to discuss any of
                these topics with you!
              </p>
            </div>
          </section>
        </section>
        <section id="41119080">
          <h3>
            <a
              class="item"
              href="https://eos.org/science-updates/how-great-was-the-great-oxidation-event"
              >How great was the Great Oxidation Event?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-31 @ 13:40:49</span
              ><span class="points-container"
                >Points: <span class="points">176</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41119080"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41118928">
          <h3>
            <a
              class="item"
              href="https://siboehm.com/articles/22/Fast-MMM-on-CPU"
              >Fast Multidimensional Matrix Multiplication on CPU from Scratch
              (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-31 @ 13:16:29</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41118928"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41118468">
          <h3>
            <a class="item" href="https://www.accessowl.io/scan"
              >Show HN: Shadow IT Scan – Uncover SaaS Apps, Users and Risky
              OAuth Scopes</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-31 @ 12:05:41</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41118468"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
            <div class="text">
              <p>
                TL;DR: We’ve launched a free version of our Shadow IT scanner to
                identify which SaaS apps are used in your company, who uses
                them, and if they have high-risk OAuth scopes.
              </p>
              <p>
                Philip and I went through YC with AccessOwl in 2022. We started
                the company because, in our previous roles, we struggled to
                track all the SaaS apps, users, and granted OAuth scopes. The
                Shadow IT scanner started as a small feature within AccessOwl,
                which manages SaaS vendors and user accounts centrally. But a
                standalone scanner would have made our lives so much easier in
                our previous roles. So, we thought, why not release it?
              </p>
              <p>And here it is: a free, standalone Shadow IT scanner!</p>
              <p>Hope you find it useful :) The Shadow IT scan helps with:</p>
              <p>
                1. Offboarding: Employees often don’t report all the apps they
                sign up for, making it tough to track and secure these accounts
                when they leave, especially with the common SSO tax.
              </p>
              <p>
                2. Security: OAuth scopes are quickly granted but rarely
                reviewed or removed, leading to organizations unknowingly
                spreading their data.
              </p>
              <p>
                3. Compliance: Auditors need a list of SaaS vendors, which is
                hard to compile when employees sign up for tools independently.
              </p>
              <p>
                Any surprises in your scan? What features would you like to see
                in the next version? Looking forward to your feedback!
              </p>
              <p>FAQ</p>
              <p>
                What’s Shadow IT? Unauthorized SaaS apps within an organization
                not centrally managed, posing security and compliance risks.
              </p>
              <p>
                How does it work? Our tool connects to your Google Workspace or
                M365 instance, identifies OAuth tokens granted, and maps them to
                known SaaS tools. Note: In this v1 version, it only detects apps
                using the “Sign in with Google/Microsoft” button.
              </p>
              <p>
                Who is this for? Typically IT and InfoSec teams, but in smaller
                companies, it may fall under the CTO.
              </p>
              <p>
                Is it safe to use? Yes, reading OAuth tokens is standard for
                SaaS management tools. Data extraction only occurs when you
                initiate a scan. AccessOwl is SOC 2 Type II audited and GDPR
                compliant.
              </p>
            </div>
          </section>
        </section>
        <section id="41116473">
          <h3>
            <a class="item" href="https://github.com/sickcodes/Docker-OSX"
              >macOS in QEMU in Docker</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-31 @ 04:51:12</span
              ><span class="points-container"
                >Points: <span class="points">562</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41116473"
                  >Comments</a
                ><span class="descendants">: 145</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41116414">
          <h3>
            <a class="item" href="https://github.com/mcastillof/FakeTraveler"
              >FakeTraveler: Fake where your phone is located (Mock location for
              Android)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-31 @ 04:30:15</span
              ><span class="points-container"
                >Points: <span class="points">151</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41116414"
                  >Comments</a
                ><span class="descendants">: 101</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41116253">
          <h3>
            <a class="item" href="https://coldwar-ct.com/Home_Page_S1DO.html"
              >Construction of the AT&amp;amp;T Long Lines "Cheshire"
              underground site</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-31 @ 03:47:42</span
              ><span class="points-container"
                >Points: <span class="points">178</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41116253"
                  >Comments</a
                ><span class="descendants">: 82</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41115941">
          <h3>
            <a
              class="item"
              href="https://ogiekako.vercel.app/blog/find_mkdir_tc"
              >`find` + `mkdir` is Turing complete</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-31 @ 02:22:41</span
              ><span class="points-container"
                >Points: <span class="points">325</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41115941"
                  >Comments</a
                ><span class="descendants">: 82</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41115591">
          <h3>
            <a
              class="item"
              href="https://spectrum.ieee.org/new-superconductor-microprocessor-yields-a-substantial-boost-in-efficiency"
              >Superconducting Microprocessors? Turns Out They're
              Ultra-Efficient (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-31 @ 01:00:26</span
              ><span class="points-container"
                >Points: <span class="points">149</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41115591"
                  >Comments</a
                ><span class="descendants">: 77</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41114839">
          <h3>
            <a
              class="item"
              href="https://blog.trailofbits.com/2024/07/30/our-audit-of-homebrew/"
              >Our audit of Homebrew</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-30 @ 22:39:21</span
              ><span class="points-container"
                >Points: <span class="points">778</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41114839"
                  >Comments</a
                ><span class="descendants">: 159</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41114825">
          <h3>
            <a
              class="item"
              href="https://shwin.co/blog/creativity-fundamentally-comes-from-memorization"
              >Creativity fundamentally comes from memorization?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-30 @ 22:37:24</span
              ><span class="points-container"
                >Points: <span class="points">327</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41114825"
                  >Comments</a
                ><span class="descendants">: 257</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41112854">
          <h3>
            <a class="item" href="https://porffor.dev/"
              >Porffor: A from-scratch experimental ahead-of-time JS engine</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-30 @ 18:55:10</span
              ><span class="points-container"
                >Points: <span class="points">426</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41112854"
                  >Comments</a
                ><span class="descendants">: 119</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41111208">
          <h3>
            <a
              class="item"
              href="https://www.smithsonianmag.com/smart-news/underwater-marble-floor-mosaic-discovered-off-the-coast-of-naples-180984772/"
              >Divers discover Roman mosaic</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-30 @ 16:46:15</span
              ><span class="points-container"
                >Points: <span class="points">164</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41111208"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41108662">
          <h3>
            <a
              class="item"
              href="https://www.tunglevo.com/note/crafting-interpreters-with-rust-on-garbage-collection/"
              >Crafting Interpreters with Rust: On Garbage Collection</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-30 @ 12:57:18</span
              ><span class="points-container"
                >Points: <span class="points">184</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41108662"
                  >Comments</a
                ><span class="descendants">: 72</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41107811">
          <h3>
            <a
              class="item"
              href="https://sports.yahoo.com/paris-olympics-2024-is-a-slow-swimming-pool-impeding-world-records-133347713.html"
              >Is a 'slow' swimming pool impeding world records?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-30 @ 10:49:29</span
              ><span class="points-container"
                >Points: <span class="points">110</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41107811"
                  >Comments</a
                ><span class="descendants">: 213</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41105130">
          <h3>
            <a class="item" href="https://www.embedding.io/"
              >Show HN: Turn any website into a knowledge base for LLMs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-30 @ 00:54:05</span
              ><span class="points-container"
                >Points: <span class="points">159</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41105130"
                  >Comments</a
                ><span class="descendants">: 57</span></span
              >
            </h4>
            <div class="text">
              <p>
                It takes away the pain of crawling, extracting content,
                chunking, vectorizing, and updating periodically.
              </p>
              <p>
                I'm curious to see if it can be useful to others. I meant to
                launch this six months ago but life got in the way...
              </p>
            </div>
          </section>
        </section>
        <section id="41104597">
          <h3>
            <a
              class="item"
              href="http://www.observationalhazard.com/2024/07/after-10-years-yelp-gave-my-app-4-days_29.html"
              >After 10 years, Yelp gave my app 4 days</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-29 @ 23:09:58</span
              ><span class="points-container"
                >Points: <span class="points">436</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41104597"
                  >Comments</a
                ><span class="descendants">: 228</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41104288">
          <h3>
            <a
              class="item"
              href="https://aws.amazon.com/blogs/opensource/amazons-exabyte-scale-migration-from-apache-spark-to-ray-on-amazon-ec2/"
              >Amazon's exabyte-scale migration from Apache Spark to Ray on
              EC2</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-29 @ 22:14:51</span
              ><span class="points-container"
                >Points: <span class="points">160</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41104288"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41101597">
          <h3>
            <a class="item" href="https://polylith.gitbook.io/polylith"
              >Polylith</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-29 @ 16:22:58</span
              ><span class="points-container"
                >Points: <span class="points">73</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41101597"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41091109">
          <h3>
            <a class="item" href="https://type-writer.org/?p=6981"
              >Milton Bartholomew: More pianos than typewriters</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-28 @ 03:49:30</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41091109"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41088355">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=41088355"
              >Tell HN: I am going to host "Real Analysis" book club meetings</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-27 @ 18:19:30</span
              ><span class="points-container"
                >Points: <span class="points">67</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41088355"
                  >Comments</a
                ><span class="descendants">: 32</span></span
              >
            </h4>
            <div class="text">
              <p>
                This new series of book club meetings is going to be on Real
                Analysis. This is going to be a multi-month journey where we are
                going to cover topics like sequences and series, functions and
                continuity, calculus, logarithmic functions, exponential
                functions, circular functions, etc.
              </p>
              <p>
                The first meeting is scheduled at 19:00 UTC today, i.e., about
                40 minutes from the time of sharing this post.
              </p>
              <p>
                If you are interested in this type of thing, please see
                https://susam.net/cc/real-analysis/ for more details.
              </p>
            </div>
          </section>
        </section>
        <section id="41076021">
          <h3>
            <a
              class="item"
              href="https://blog.poisson.chat/posts/2024-07-26-adt-history.html"
              >Where does the name "algebraic data type" come from?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-26 @ 05:32:05</span
              ><span class="points-container"
                >Points: <span class="points">129</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41076021"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41073907">
          <h3>
            <a
              class="item"
              href="https://www.scientificamerican.com/article/is-your-nervous-system-a-democracy-or-a-dictatorship/"
              >Is the nervous system a democracy? (2016)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-07-25 @ 22:09:59</span
              ><span class="points-container"
                >Points: <span class="points">39</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41073907"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
