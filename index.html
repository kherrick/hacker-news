<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="41698907">
          <h3>
            <a
              class="item"
              href="http://williamcotton.com/articles/a-burrito-is-a-monad"
              >A Burrito Is a Monad</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-30 @ 16:18:15</span
              ><span class="points-container"
                >Points: <span class="points">42</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41698907"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41698823">
          <h3>
            <a
              class="item"
              href="https://www.newyorker.com/magazine/2024/10/07/dr-calhouns-mousery-lee-alan-dugatkin-book-reviews-rat-city-edmund-ramsden-and-jon-adams"
              >The Rat Studies That Foretold a Nightmarish Human Future</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-30 @ 16:11:52</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41698823"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41698551">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2024/09/30/sports/dikembe-mutombo-dead.html"
              >Dikembe Mutombo has died at age 58</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-30 @ 15:49:17</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41698551"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41698361">
          <h3>
            <a
              class="item"
              href="https://www.liquid.ai/liquid-foundation-models"
              >Liquid Foundation Models: Our First Series of Generative AI
              Models</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-30 @ 15:33:30</span
              ><span class="points-container"
                >Points: <span class="points">64</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41698361"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41697137">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=41697137"
              >Launch HN: Inkeep (YC W23) – Copilot for Support (Think Cursor
              for Help Desks)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-30 @ 13:57:38</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41697137"
                  >Comments</a
                ><span class="descendants">: 31</span></span
              >
            </h4>
            <div class="text">
              <a href="https://inkeep.com">https://inkeep.com</a>). We help
              companies turn their content into AI support copilots. So far,
              we’d focused on customer-facing experiences (e.g. find us as an
              “Ask AI” button in the docs of companies like Anthropic and
              Pinecone). Today, we’re excited to share our new copilot, Keep,
              which is designed specifically for support agents.
              <p>
                It’s a conversational sidebar you can use as an app for Zendesk
                or Chrome Extension for any support platform. There’s a demo
                video at
                <a href="https://vid.inkeep.com/cx-copilot"
                  >https://vid.inkeep.com/cx-copilot</a
                >
                or you can try the live sandbox with example tickets at
                <a href="https://try.inkeep.com/cx-copilot"
                  >https://try.inkeep.com/cx-copilot</a
                >.
              </p>
              <p>
                Why? Most AI support tools today are focused on trying to have
                AI answer customer questions before they even reach support
                teams (‘deflection’). We’d focused on that too. However, we
                heard from many of our customers that while they care about
                deflection, they care even more about providing high-quality,
                fast human support when users need it. Some teams don’t even
                want customer-facing AI at all and just want AI tools to help
                their team be more efficient. We created Keep with these
                scenarios in mind.
              </p>
              <p>Keep does a few neat things we haven’t seen elsewhere:</p>
              <p>
                1. Provides intelligent suggestions: if Keep is confident, it’ll
                create a draft answer and tell you the sources it used. If the
                ticket is long, it’ll summarize the conversation so far and
                outline the remaining to-dos. All automatic and contextual to
                the ticket.
              </p>
              <p>
                2. Is fully conversational: ask for clarifications, revise draft
                answers, and iterate as needed.
              </p>
              <p>
                3. Uses ‘Generative UI’: suggestions are rendered as glanceable,
                interactive UI components. For example, a draft answer has
                buttons like “Shorten” &amp; “Concise” that prompt the AI to
                revise the answer. UI components are interweaved within normal
                text.
              </p>
              <p>
                4. Turns tickets into FAQs: can generate an FAQ from a closed
                ticket and lets you iterate on it and save it when done.
              </p>
              <p>
                5. Leverages many content types: uses your docs, help center,
                previous support tickets, Slack threads, etc.
              </p>
              <p>
                We were inspired by tools like Cursor, Claude Artifacts, and v0.
                These experiences go beyond plain-text conversations by
                interweaving interactive code blocks or UI previews into their
                answers. This makes answers digestible and intuitive (and fun)
                to iterate on.
              </p>
              <p>
                Some technical details, for those interested: We use the Vercel
                AI SDK to optimistically stream the React components by using
                our Chat APIs, which are powered by Claude Sonnet 3.5 and our
                RAG service. Our APIs follow the OpenAI chat completion format
                so are generally compatible with any LLM tooling. Our
                `inkeep-qa` API generates draft answers and the `inkeep-context`
                API generates structured outputs and tool calls (docs:
                <a href="https://go.inkeep.com/ai-api"
                  >https://go.inkeep.com/ai-api</a
                >). For an example of how these APIs are used, check out our
                Intelligent Support Form example (demo:
                <a href="https://try.inkeep.com/ai-form"
                  >https://try.inkeep.com/ai-form</a
                >, repo:
                <a href="https://quickstart.inkeep.com/ai-form"
                  >https://quickstart.inkeep.com/ai-form</a
                >).
              </p>
              <p>
                If you want to try Inkeep on your product's content, just fill
                out the form in our landing page. You’ll get a demo in your
                inbox powered by your public content — NO “call us”, “book a
                demo”, or “schedule a meeting” required. Note: we do check that
                your email domain matches your content to prevent spam.
              </p>
              <p>
                Curious to hear about your experiences when working with
                customer/support questions and any ideas on how else the copilot
                could be useful for those scenarios.
              </p>
            </div>
          </section>
        </section>
        <section id="41697064">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/typewise/jobs/NH0WiMZ-senior-backend-engineer-f-m-x"
              >Typewise (YC S22) Is Hiring a Senior AI Back End Engineer
              (Python, Europe)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-30 @ 13:50:48</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41697032">
          <h3>
            <a class="item" href="https://unfashionable.blog/p/yc/"
              >Y Combinator Traded Prestige for Growth</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-30 @ 13:48:03</span
              ><span class="points-container"
                >Points: <span class="points">332</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41697032"
                  >Comments</a
                ><span class="descendants">: 151</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41696434">
          <h3>
            <a
              class="item"
              href="https://www.sciencedaily.com/releases/2024/09/240905120923.htm"
              >New research on anesthesia and microtubules gives new clues about
              consciousness</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-30 @ 12:34:46</span
              ><span class="points-container"
                >Points: <span class="points">91</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41696434"
                  >Comments</a
                ><span class="descendants">: 97</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41696236">
          <h3>
            <a
              class="item"
              href="https://blog.archive.org/2024/09/30/vanishing-culture-preserving-cookbooks/"
              >Vanishing Culture: Preserving Cookbooks</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-30 @ 12:06:55</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41696236"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41696046">
          <h3>
            <a
              class="item"
              href="https://www.marginalia.nu/log/a_111_phrase_matching/"
              >Phrase Matching in Marginalia Search</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-30 @ 11:42:55</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41696046"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41695840">
          <h3>
            <a class="item" href="https://github.com/mediar-ai/screenpipe"
              >Screenpipe: 24/7 local AI screen and mic recording</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-30 @ 11:15:36</span
              ><span class="points-container"
                >Points: <span class="points">117</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41695840"
                  >Comments</a
                ><span class="descendants">: 64</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41694712">
          <h3>
            <a class="item" href="https://app.keeptrack.space"
              >Keep Track: 3D Satellite Toolkit</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-30 @ 08:10:12</span
              ><span class="points-container"
                >Points: <span class="points">84</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41694712"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41694504">
          <h3>
            <a
              class="item"
              href="https://ngrok.com/blog-post/how-we-built-ngroks-data-platform"
              >How we built ngrok's data platform</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-30 @ 07:35:01</span
              ><span class="points-container"
                >Points: <span class="points">89</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41694504"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41694044">
          <h3>
            <a class="item" href="https://walzr.com/bop-spotter">Bop Spotter</a>
          </h3>
          <section>
            <h4>
              <span>2024-09-30 @ 06:09:53</span
              ><span class="points-container"
                >Points: <span class="points">737</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41694044"
                  >Comments</a
                ><span class="descendants">: 156</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41694025">
          <h3>
            <a
              class="item"
              href="https://www.davidbrin.com/nonfiction/dogmaofotherness.html"
              >The Dogma of Otherness (1986)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-30 @ 06:06:39</span
              ><span class="points-container"
                >Points: <span class="points">99</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41694025"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41693979">
          <h3>
            <a
              class="item"
              href="https://rodneybrooks.com/tips-for-building-and-deploying-robots/"
              >Tips for Building and Deploying Robots</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-30 @ 05:55:51</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41693979"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41693087">
          <h3>
            <a
              class="item"
              href="https://simonwillison.net/2024/Sep/29/notebooklm-audio-overview/"
              >NotebookLM's automatically generated podcasts are surprisingly
              effective</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-30 @ 02:58:02</span
              ><span class="points-container"
                >Points: <span class="points">714</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41693087"
                  >Comments</a
                ><span class="descendants">: 364</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41691943">
          <h3>
            <a
              class="item"
              href="https://benn.substack.com/p/do-ai-companies-work"
              >Do AI companies work?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-29 @ 23:44:57</span
              ><span class="points-container"
                >Points: <span class="points">117</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41691943"
                  >Comments</a
                ><span class="descendants">: 108</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41690302">
          <h3>
            <a
              class="item"
              href="https://www.gov.ca.gov/wp-content/uploads/2024/09/SB-1047-Veto-Message.pdf"
              >Gavin Newsom vetoes SB 1047</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-29 @ 20:43:32</span
              ><span class="points-container"
                >Points: <span class="points">663</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41690302"
                  >Comments</a
                ><span class="descendants">: 387</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41689332">
          <h3>
            <a
              class="item"
              href="https://technology.riotgames.com/news/taxonomy-tech-debt"
              >A Taxonomy of Tech Debt (2018)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-29 @ 18:28:26</span
              ><span class="points-container"
                >Points: <span class="points">221</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41689332"
                  >Comments</a
                ><span class="descendants">: 66</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41689138">
          <h3>
            <a
              class="item"
              href="https://www.washingtonpost.com/business/2024/09/26/fda-antipsychotic-mental-illness-alzheimers/"
              >FDA approves a novel drug for schizophrenia</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-29 @ 18:02:47</span
              ><span class="points-container"
                >Points: <span class="points">204</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41689138"
                  >Comments</a
                ><span class="descendants">: 218</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41688469">
          <h3>
            <a class="item" href="https://mundraub.org/map"
              >Map with public fruit trees</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-29 @ 16:29:36</span
              ><span class="points-container"
                >Points: <span class="points">288</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41688469"
                  >Comments</a
                ><span class="descendants">: 120</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41688018">
          <h3>
            <a class="item" href="https://gitlab.com/zephray/sitina1"
              >Sitina1 Open-Source Camera</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-29 @ 15:27:54</span
              ><span class="points-container"
                >Points: <span class="points">279</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41688018"
                  >Comments</a
                ><span class="descendants">: 95</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41686722">
          <h3>
            <a
              class="item"
              href="https://nolanlawson.com/2024/09/28/web-components-are-okay/"
              >Web components are okay</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-29 @ 11:57:00</span
              ><span class="points-container"
                >Points: <span class="points">248</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41686722"
                  >Comments</a
                ><span class="descendants">: 288</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41679497">
          <h3>
            <a
              class="item"
              href="https://languagelog.ldc.upenn.edu/nll/?p=66229"
              >Is English a “creole Language”?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-28 @ 11:15:02</span
              ><span class="points-container"
                >Points: <span class="points">66</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41679497"
                  >Comments</a
                ><span class="descendants">: 75</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41669747">
          <h3>
            <a
              class="item"
              href="https://vanhunteradams.com/Pico/Galton/Collisions.html"
              >The Physics of Colliding Balls</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-27 @ 12:41:49</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41669747"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41668896">
          <h3>
            <a
              class="item"
              href="https://csrc.nist.gov/Projects/interoperable-randomness-beacons/beacon-20"
              >NIST Interoperable Randomness Beacons</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-27 @ 11:07:20</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41668896"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41666269">
          <h3>
            <a
              class="item"
              href="https://www.historytoday.com/archive/normans-and-slavery-breaking-bonds"
              >Normans and Slavery: Breaking the Bonds</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-27 @ 04:31:27</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41666269"
                  >Comments</a
                ><span class="descendants">: 35</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41652735">
          <h3>
            <a
              class="item"
              href="https://www.loc.gov/collections/japanese-fine-prints-pre-1915/about-this-collection/"
              >Library of Congress Pre-1915 Japanese Woodblock Prints and
              Drawings</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-25 @ 22:55:22</span
              ><span class="points-container"
                >Points: <span class="points">25</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41652735"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="41646782">
          <h3>
            <a class="item" href="https://awala.network/"
              >Awala: The computer network on which humankind can rely</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-09-25 @ 12:43:31</span
              ><span class="points-container"
                >Points: <span class="points">94</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=41646782"
                  >Comments</a
                ><span class="descendants">: 39</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
