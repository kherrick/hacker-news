<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="36607064">
          <h3>
            <a
              class="item"
              href="https://clearleft.com/thinking/starting-design-work-in-a-spreadsheet"
              >Starting design work in a spreadsheet</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-05 @ 21:02:39</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36607064"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36606323">
          <h3>
            <a
              class="item"
              href="https://scholarlykitchen.sspnet.org/2023/07/05/why-does-the-u-s-copyright-office-require-libraries-to-lie-to-users-about-their-fair-use-rights-they-wont-say/"
              >The U.S. Copyright Office requires libraries to lie about fair
              use rights?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-05 @ 20:08:10</span
              ><span class="points-container"
                >Points: <span class="points">128</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36606323"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36605912">
          <h3>
            <a class="item" href="https://patrickcollison.com/fast">Fast</a>
          </h3>
          <section>
            <h4>
              <span>2023-07-05 @ 19:34:55</span
              ><span class="points-container"
                >Points: <span class="points">223</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36605912"
                  >Comments</a
                ><span class="descendants">: 66</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36605869">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=36605869"
              >Tell HN: People forget that you can stick any data at the end of
              a bash script</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-05 @ 19:32:01</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36605869"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
            <div class="text">
              <p></p>
              <pre><code>    tail -c &lt;number of bytes for the binary&gt; $0
</code></pre>
              All you have to do is make sure you append an explicit 'exit' to
              the end of your program before your new 'data section', so that
              bash won't parse any of the 'data section'.
              <p>
                One thing to bear in mind is that if you append binary data, it
                will be corrupted if you save it in most text editors so when I
                want to make changes I just delete all the binary and reappend
                it.
              </p>
            </div>
          </section>
        </section>
        <section id="36605831">
          <h3>
            <a class="item" href="https://many.pw/"
              >A table that looks good on mobile and desktop</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-05 @ 19:29:23</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36605831"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36605806">
          <h3>
            <a
              class="item"
              href="https://chat.openai.com/share/ed8044da-22c5-4c5e-ba82-4353f67d553f"
              >With plugins, GPT-4 posts GitHub issue without being instructed
              to</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-05 @ 19:27:26</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36605806"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36605730">
          <h3>
            <a class="item" href="https://functiontrace.com"
              >FunctionTrace: Graphical Python Profiler</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-05 @ 19:22:52</span
              ><span class="points-container"
                >Points: <span class="points">49</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36605730"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36605493">
          <h3>
            <a class="item" href="https://dm.hn"
              >Show HN: Hacker News user blogroll</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-05 @ 19:06:43</span
              ><span class="points-container"
                >Points: <span class="points">256</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36605493"
                  >Comments</a
                ><span class="descendants">: 66</span></span
              >
            </h4>
            <div class="text">
              <p>
                Right now is like 60 lines of Ruby using Nokogiri, but I will
                certainly look into it further down the line and improve the
                list.
              </p>
              <p>
                There's a cronjob checking the thread every 12 hours but I will
                eventually shut that down and it will become static after that.
              </p>
              <p>
                There are some really awesome blogs in there. I really recommend
                going through the list, it made my day.
              </p>
              <p>
                [0] "Could you share your personal blog here".
                <a href="https://news.ycombinator.com/item?id=36575081"
                  >https://news.ycombinator.com/item?id=36575081</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="36605085">
          <h3>
            <a
              class="item"
              href="https://tertulia-moderna.blogspot.com/2010/12/overflowing-brain-by-torkel-klingberg.html"
              >The Overflowing Brain: Information overload and the limits of
              working memory</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-05 @ 18:40:04</span
              ><span class="points-container"
                >Points: <span class="points">69</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36605085"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36604188">
          <h3>
            <a
              class="item"
              href="https://about.gitlab.com/blog/2023/07/05/beautifying-of-our-ui/"
              >Beautifying our UI: Giving Gitlab build features a fresh look</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-05 @ 17:50:26</span
              ><span class="points-container"
                >Points: <span class="points">58</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36604188"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36603816">
          <h3>
            <a
              class="item"
              href="https://github.com/ggerganov/llama.cpp/pull/1998"
              >LLama.cpp now has a web interface</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-05 @ 17:33:04</span
              ><span class="points-container"
                >Points: <span class="points">242</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36603816"
                  >Comments</a
                ><span class="descendants">: 37</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36603573">
          <h3>
            <a
              class="item"
              href="https://moultano.wordpress.com/2023/06/28/the-many-ways-that-digital-minds-can-know/"
              >The Many Ways That Digital Minds Can Know – A Better Way to Think
              about LLMs</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-05 @ 17:17:08</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36603573"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36603382">
          <h3>
            <a
              class="item"
              href="https://openai.com/blog/introducing-superalignment"
              >Introducing Superalignment</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-05 @ 17:04:29</span
              ><span class="points-container"
                >Points: <span class="points">111</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36603382"
                  >Comments</a
                ><span class="descendants">: 110</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36603263">
          <h3>
            <a
              class="item"
              href="https://nationalpost.com/news/canada/canadian-government-suspends-advertising-on-facebook-instagram"
              >Ottawa pulls advertising, escalating showdown with Facebook and
              Instagram</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-05 @ 16:57:51</span
              ><span class="points-container"
                >Points: <span class="points">79</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36603263"
                  >Comments</a
                ><span class="descendants">: 112</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36602970">
          <h3>
            <a class="item" href="https://fly.io/blog/litefs-cloud/"
              >LiteFS Cloud: Distributed SQLite with Managed Backups</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-05 @ 16:41:50</span
              ><span class="points-container"
                >Points: <span class="points">143</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36602970"
                  >Comments</a
                ><span class="descendants">: 50</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36602909">
          <h3>
            <a
              class="item"
              href="https://practical.engineering/blog/2023/6/28/why-is-desalination-so-difficult"
              >Why is desalination so difficult?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-05 @ 16:37:46</span
              ><span class="points-container"
                >Points: <span class="points">245</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36602909"
                  >Comments</a
                ><span class="descendants">: 211</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36602709">
          <h3>
            <a
              class="item"
              href="https://issue.freebsdfoundation.org/publication/?i=794483&amp;p=24&amp;view=issueViewer&amp;pp=1"
              >FreeBSD at 30: Its secrets to success</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-05 @ 16:25:22</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36602709"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36602097">
          <h3>
            <a
              class="item"
              href="https://spectrum.ieee.org/heat-pump-air-conditioning-alternative"
              >Heat Pumps – The Well-Tempered Future of A/Cs</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-05 @ 15:47:11</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36602097"
                  >Comments</a
                ><span class="descendants">: 124</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36601622">
          <h3>
            <a
              class="item"
              href="https://opencoreventures.com/blog/2023-06-27-ai-weights-are-not-open-source/"
              >AI weights are not open “source”</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-05 @ 15:18:44</span
              ><span class="points-container"
                >Points: <span class="points">186</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36601622"
                  >Comments</a
                ><span class="descendants">: 204</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36601290">
          <h3>
            <a
              class="item"
              href="https://psyche.co/guides/how-to-cultivate-shoshin-or-a-beginners-mind"
              >How to foster shoshin</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-05 @ 14:55:46</span
              ><span class="points-container"
                >Points: <span class="points">73</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36601290"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36600263">
          <h3>
            <a class="item" href="https://blog.burntsushi.net/regex-internals/"
              >Regex engine internals as a library</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-05 @ 13:36:01</span
              ><span class="points-container"
                >Points: <span class="points">288</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36600263"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36599893">
          <h3>
            <a class="item" href="https://deno.com/blog/v1.35"
              >Deno 1.35: A fast and convenient way to build web servers</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-05 @ 13:06:41</span
              ><span class="points-container"
                >Points: <span class="points">170</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36599893"
                  >Comments</a
                ><span class="descendants">: 95</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36599706">
          <h3>
            <a
              class="item"
              href="https://github.com/karanpratapsingh/system-design"
              >Learn how to design systems at scale and prepare for system
              design interviews</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-05 @ 12:51:07</span
              ><span class="points-container"
                >Points: <span class="points">172</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36599706"
                  >Comments</a
                ><span class="descendants">: 94</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36599137">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/piinpoint/jobs/4jPeUKT-data-scientist"
              >Piinpoint (YC W14) is hiring for data science – remote within
              Canada</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-05 @ 12:00:19</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36597534">
          <h3>
            <a
              class="item"
              href="https://research.wmz.ninja/projects/phd/index.html"
              >PhD Simulator</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-05 @ 08:39:27</span
              ><span class="points-container"
                >Points: <span class="points">609</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36597534"
                  >Comments</a
                ><span class="descendants">: 197</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36596750">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=36596750"
              >Ask HN: What boosted your confidence as a new programmer?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-05 @ 07:17:10</span
              ><span class="points-container"
                >Points: <span class="points">51</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36596750"
                  >Comments</a
                ><span class="descendants">: 70</span></span
              >
            </h4>
            <div class="text">
              <p>
                Similar things happen with novice programmers when they start
                out.
              </p>
              <p>
                Then they read a beautiful codebase which they can fully
                understand and replicate, or build a project from scratch, or
                read a book or take a class on a subject. And their confidence
                is tremendously boosted thereafter.
              </p>
              <p>
                What was it for you? How did you gain this confidence to take
                the first step from being a tinkerer to being a skilled
                craftman?
              </p>
            </div>
          </section>
        </section>
        <section id="36593407">
          <h3>
            <a
              class="item"
              href="http://www.sciencemadness.org/talk/viewthread.php?tid=22554"
              >Life after detonation (2012)</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-04 @ 22:38:49</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36593407"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36583419">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=36583419"
              >Ask HN: Any hardware startups here?</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-04 @ 07:31:31</span
              ><span class="points-container"
                >Points: <span class="points">260</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36583419"
                  >Comments</a
                ><span class="descendants">: 372</span></span
              >
            </h4>
            <div class="text">
              <p>
                Remember, no venture is too small or niche! It's the passion and
                innovation that counts.
              </p>
            </div>
          </section>
        </section>
        <section id="36582064">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2023-06-user-friendly-platform-virtual-exploration-chemical.html"
              >A user-friendly platform for virtual exploration of chemical
              reactions</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-04 @ 03:58:36</span
              ><span class="points-container"
                >Points: <span class="points">36</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36582064"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="36580623">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=lw6TaiXzHAE"
              >Growing a Language (1998) [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2023-07-04 @ 00:26:32</span
              ><span class="points-container"
                >Points: <span class="points">95</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=36580623"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
