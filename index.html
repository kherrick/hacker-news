<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="45051798">
          <h3>
            <a
              class="item"
              href="https://blog.engora.com/2025/08/the-sisters-paradox-counter-intuitive.html"
              >The sisters "paradox" – counter-intuitive probability</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-28 @ 13:17:15</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45051798"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45051777">
          <h3>
            <a
              class="item"
              href="https://cloudsquid.substack.com/p/ocr-is-legacy-tech"
              >LLMs solving problems OCR+NLP couldn't</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-28 @ 13:15:28</span
              ><span class="points-container"
                >Points: <span class="points">14</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45051777"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45051584">
          <h3>
            <a
              class="item"
              href="https://kennethreitz.org/essays/2025-08-27-the_cost_of_transparency"
              >The cost of transparency: Living with schizoaffective disorder in
              tech</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-28 @ 12:53:37</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45051584"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45051542">
          <h3>
            <a class="item" href="https://github.com/b0nes164/GPUPrefixSums"
              >GPUPrefixSums – state of the art GPU prefix sum algorithms</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-28 @ 12:49:10</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45051542"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45051361">
          <h3>
            <a
              class="item"
              href="https://ntietz.com/blog/that-boolean-should-probably-be-something-else/"
              >That boolean should probably be something else</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-28 @ 12:31:15</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45051361"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45051345">
          <h3>
            <a class="item" href="https://verdagon.dev/blog/group-borrowing"
              >Group Borrowing: Zero-Cost Memory Safety with Fewer
              Restrictions</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-28 @ 12:29:15</span
              ><span class="points-container"
                >Points: <span class="points">30</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45051345"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45051188">
          <h3>
            <a
              class="item"
              href="https://blog.jeffschomay.com/rendering-a-game-in-real-time-with-ai"
              >Rendering a Game in Real-Time with AI</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-28 @ 12:10:14</span
              ><span class="points-container"
                >Points: <span class="points">53</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45051188"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45051096">
          <h3>
            <a
              class="item"
              href="https://jobs.ashbyhq.com/prosper-ai/29684590-4cec-4af2-bb69-eb5c6d595fb8"
              >Prosper AI (YC S23) Is Hiring Founding Account Executives
              (NYC)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-28 @ 12:00:48</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45051034">
          <h3>
            <a class="item" href="https://tj401.com/blog/formd/index.html"
              >The startup bubble that no one is talking about</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-28 @ 11:51:30</span
              ><span class="points-container"
                >Points: <span class="points">35</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45051034"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45050958">
          <h3>
            <a class="item" href="https://jaketae.github.io/study/gan-math/"
              >GAN Math (2020)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-28 @ 11:42:35</span
              ><span class="points-container"
                >Points: <span class="points">85</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45050958"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45050931">
          <h3>
            <a
              class="item"
              href="https://chizkidd.github.io//2025/05/30/machine-learning-key-math-eqns/"
              >Important machine learning equations</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-28 @ 11:38:44</span
              ><span class="points-container"
                >Points: <span class="points">149</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45050931"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45050873">
          <h3>
            <a
              class="item"
              href="https://journals.asm.org/doi/10.1128/mbio.01718-25"
              >Microbial metabolite repairs liver injury by restoring hepatic
              lipid metabolism</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-28 @ 11:29:42</span
              ><span class="points-container"
                >Points: <span class="points">9</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45050873"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45050538">
          <h3>
            <a class="item" href="https://www.fossjobs.net/"
              >Fossjobs: A job board for Free and Open Source jobs</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-28 @ 10:39:08</span
              ><span class="points-container"
                >Points: <span class="points">87</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45050538"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45050502">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=45050502"
              >Petition to stop Google from restricting sideloading and FOSS
              apps</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-28 @ 10:32:51</span
              ><span class="points-container"
                >Points: <span class="points">226</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45050502"
                  >Comments</a
                ><span class="descendants">: 121</span></span
              >
            </h4>
            <div class="text">
              <p>
                A developer started a petition to stop Google from limiting app
                installation on Android devices unless developers provide
                personal identity documents.
              </p>
              <p>
                Even though Google has not revoked similar controversial
                policies in the past, we do our best as much as we can. This
                change particularly threatens the freedom to build, share, and
                use software without giving away sensitive personal information.
                It affects independent developers, FOSS contributors, and even
                regular users who want to install apps outside of Google Play.
              </p>
              <p>
                ``Just imagine giving sensitive personal, government-issued ID
                to a corporation to install an app outside Google Play``
              </p>
              <p>
                Let’s stand together to protect our freedom to create and use
                software without handing over personal information to a
                corporation. Every signature, share, and voice counts here
              </p>
              <p>Support the petition here: https://chng.it/MsHzSXtJnw</p>
            </div>
          </section>
        </section>
        <section id="45050192">
          <h3>
            <a
              class="item"
              href="https://old.reddit.com/r/msp/comments/1n1sgxx/windows_11_update_kb5063878_causing_ssd_failures/"
              >Windows 11 Update KB5063878 Causing SSD Failures</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-28 @ 09:31:13</span
              ><span class="points-container"
                >Points: <span class="points">141</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45050192"
                  >Comments</a
                ><span class="descendants">: 79</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45050090">
          <h3>
            <a class="item" href="https://claude-checkpoints.com/"
              >Claude Code Checkpoints</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-28 @ 09:16:17</span
              ><span class="points-container"
                >Points: <span class="points">61</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45050090"
                  >Comments</a
                ><span class="descendants">: 49</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45048736">
          <h3>
            <a
              class="item"
              href="https://jamesoclaire.com/2025/08/28/uncovering-lesser-known-mobile-adtech-domains/"
              >Lesser known mobile adtech domains where data is sent</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-28 @ 05:30:23</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45048736"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45048419">
          <h3>
            <a
              class="item"
              href="https://community.broadcom.com/tanzu/blogs/beltran-rueda-borrego/2025/08/18/how-to-prepare-for-the-bitnami-changes-coming-soon"
              >The Deletion of Docker.io/Bitnami</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-28 @ 04:37:12</span
              ><span class="points-container"
                >Points: <span class="points">284</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45048419"
                  >Comments</a
                ><span class="descendants">: 185</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45047897">
          <h3>
            <a
              class="item"
              href="https://onionservices.torproject.org/research/proposals/usability/certificates/"
              >Certificates for Onion Services</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-28 @ 03:05:42</span
              ><span class="points-container"
                >Points: <span class="points">96</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45047897"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45047460">
          <h3>
            <a
              class="item"
              href="https://opensourcesecurity.io/2025/08-oss-one-person/"
              >Open Source is one person</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-28 @ 01:54:59</span
              ><span class="points-container"
                >Points: <span class="points">154</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45047460"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45046916">
          <h3>
            <a
              class="item"
              href="https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0329411"
              >Altered states of consciousness induced by breathwork accompanied
              by music</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-28 @ 00:22:24</span
              ><span class="points-container"
                >Points: <span class="points">448</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45046916"
                  >Comments</a
                ><span class="descendants">: 233</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45045307">
          <h3>
            <a class="item" href="https://yamanot.es/"
              >Yamanot.es: A music box of train station melodies from the JR
              Yamanote Line</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-27 @ 21:08:49</span
              ><span class="points-container"
                >Points: <span class="points">285</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45045307"
                  >Comments</a
                ><span class="descendants">: 88</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45041286">
          <h3>
            <a
              class="item"
              href="https://lubeno.dev/blog/rusts-productivity-curve"
              >Unexpected productivity boost of Rust</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-27 @ 15:48:07</span
              ><span class="points-container"
                >Points: <span class="points">470</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45041286"
                  >Comments</a
                ><span class="descendants">: 417</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45034496">
          <h3>
            <a
              class="item"
              href="https://github.com/nrwl/nx/security/advisories/GHSA-cxm3-wv7p-598c"
              >Malicious versions of Nx and some supporting plugins were
              published</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-27 @ 01:38:48</span
              ><span class="points-container"
                >Points: <span class="points">418</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45034496"
                  >Comments</a
                ><span class="descendants">: 417</span></span
              >
            </h4>
            <div class="text">
              <p>
                <a
                  href="https://www.stepsecurity.io/blog/supply-chain-security-alert-popular-nx-build-system-package-compromised-with-data-stealing-malware"
                  >https://www.stepsecurity.io/blog/supply-chain-security-alert...</a
                >
              </p>
              <p>
                <a
                  href="https://semgrep.dev/blog/2025/security-alert-nx-compromised-to-steal-wallets-and-credentials/"
                  >https://semgrep.dev/blog/2025/security-alert-nx-compromised-...</a
                >
              </p>
            </div>
          </section>
        </section>
        <section id="45018869">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/gadgets/2025/08/like-intel-before-it-amd-blames-motherboard-makers-for-burnt-out-cpus/"
              >Like Intel before it, AMD blames motherboard makers for burnt-out
              CPUs</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-25 @ 20:54:42</span
              ><span class="points-container"
                >Points: <span class="points">46</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45018869"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45014275">
          <h3>
            <a class="item" href="https://iere.org/what-is-synthetic-gasoline/"
              >What Is Synthetic Gasoline?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-25 @ 14:31:50</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45014275"
                  >Comments</a
                ><span class="descendants">: 43</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45010406">
          <h3>
            <a
              class="item"
              href="https://abhinavsarkar.net/posts/arithmetic-bytecode-vm-compiler/"
              >A Fast Bytecode VM for Arithmetic: The Compiler</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-25 @ 05:08:22</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45010406"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45008434">
          <h3>
            <a
              class="item"
              href="https://www.nvidia.com/en-us/products/workstations/dgx-spark/"
              >Nvidia DGX Spark</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-24 @ 22:35:23</span
              ><span class="points-container"
                >Points: <span class="points">164</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45008434"
                  >Comments</a
                ><span class="descendants">: 169</span></span
              >
            </h4>
          </section>
        </section>
        <section id="45007857">
          <h3>
            <a
              class="item"
              href="https://www.nytimes.com/2025/08/24/magazine/landfill-calabasas-los-angeles-wildfire-ash.html"
              >A Ritzy L.A. Enclave Learned a Bitter Lesson About the Limits of
              Its Wealth</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-24 @ 21:15:50</span
              ><span class="points-container"
                >Points: <span class="points">19</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=45007857"
                  >Comments</a
                ><span class="descendants">: 29</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44998010">
          <h3>
            <a
              class="item"
              href="https://www.thedrive.com/news/toyota-is-recycling-old-ev-batteries-to-help-power-mazdas-production-line"
              >Toyota is recycling old EV batteries to help power Mazda's
              production line</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-08-23 @ 18:29:05</span
              ><span class="points-container"
                >Points: <span class="points">283</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44998010"
                  >Comments</a
                ><span class="descendants">: 129</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
