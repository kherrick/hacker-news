<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="44478171">
          <h3>
            <a
              class="item"
              href="https://newatlas.com/around-the-home/photon-matrix-laser-mosquitoes/"
              >Laser-wielding device is like an anti-aircraft system for
              mosquitoes</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-06 @ 05:54:58</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44478171"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44478115">
          <h3>
            <a
              class="item"
              href="https://geohot.github.io//blog/jekyll/update/2025/07/05/are-we-the-baddies.html"
              >Are We the Baddies?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-06 @ 05:36:32</span
              ><span class="points-container"
                >Points: <span class="points">68</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44478115"
                  >Comments</a
                ><span class="descendants">: 18</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44478083">
          <h3>
            <a
              class="item"
              href="https://www.pcgamer.com/gaming-industry/european-game-publisher-group-responds-to-stop-killing-games-claims-these-proposals-would-curtail-developer-choice/"
              >Game publishers respond to Stop Killing Games claim it curtails
              developer choice</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-06 @ 05:27:42</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44478083"
                  >Comments</a
                ><span class="descendants">: 24</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44477768">
          <h3>
            <a
              class="item"
              href="https://multiverseemployeehandbook.com/blog/when-newton-explained-why-you-dont-float-away/"
              >July 5, 1687: When Newton Explained Why You Don't Float Away</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-06 @ 04:11:53</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44477768"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44477660">
          <h3>
            <a
              class="item"
              href="https://neurosciencenews.com/hedonism-happiness-achievement-23923/"
              >Chasing Hobbies over Achievement Boosts Happiness (2023)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-06 @ 03:47:02</span
              ><span class="points-container"
                >Points: <span class="points">15</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44477660"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44477601">
          <h3>
            <a
              class="item"
              href="https://www.france24.com/en/americas/20250702-colombia-narco-submarine-starlink"
              >Colombia seizes first unmanned narco-submarine with Starlink
              antenna</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-06 @ 03:31:21</span
              ><span class="points-container"
                >Points: <span class="points">62</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44477601"
                  >Comments</a
                ><span class="descendants">: 42</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44477500">
          <h3>
            <a
              class="item"
              href="https://thedailywtf.com/articles/Injection_Rejection"
              >Injection Rejection (2006)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-06 @ 03:07:39</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44477500"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44477417">
          <h3>
            <a class="item" href="https://newsalert.im/"
              >Show HN: News Alert ，Real-time global news monitoring with
              keyword alerts</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-06 @ 02:47:35</span
              ><span class="points-container"
                >Points: <span class="points">6</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44477417"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
            <div class="text">
              <p></p>
              <pre><code>  Key features:
  • Real-time alerts from global news sources
  • Custom keyword tracking 
  • Smart filtering to prioritize important news
  • Perfect for investors, traders, and business professionals</code></pre>
            </div>
          </section>
        </section>
        <section id="44477331">
          <h3>
            <a
              class="item"
              href="https://electrek.co/2025/06/29/volvo-delivers-5000th-electric-semi-with-little-fanfare-sending-a-big-message/"
              >Volvo delivers 5,000th electric semi with little fanfare</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-06 @ 02:29:04</span
              ><span class="points-container"
                >Points: <span class="points">71</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44477331"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44477235">
          <h3>
            <a
              class="item"
              href="https://www.bostonherald.com/2025/07/03/baptist-anti-slavery-scroll/"
              >Volunteer finds Holy Grail of abolitionist-era Baptist
              documents</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-06 @ 02:11:48</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44477235"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44476716">
          <h3>
            <a
              class="item"
              href="https://simonwillison.net/2025/Jul/5/cgi-bin-performance/"
              >Serving 200M requests per day with a CGI-bin</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-06 @ 00:32:18</span
              ><span class="points-container"
                >Points: <span class="points">97</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44476716"
                  >Comments</a
                ><span class="descendants">: 56</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44476297">
          <h3>
            <a
              class="item"
              href="https://interactions.acm.org/archive/view/july-august-2025/stop-hiding-my-controls-hidden-interface-controls-are-affecting-usability"
              >Hidden interface controls are affecting usability</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-05 @ 23:10:03</span
              ><span class="points-container"
                >Points: <span class="points">331</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44476297"
                  >Comments</a
                ><span class="descendants">: 181</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44476115">
          <h3>
            <a class="item" href="https://mynoise.net/blog.php"
              >What a Hacker Stole from Me</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-05 @ 22:32:28</span
              ><span class="points-container"
                >Points: <span class="points">122</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44476115"
                  >Comments</a
                ><span class="descendants">: 30</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44475634">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2503.14283"
              >Techno-Feudalism and the Rise of AGI: A Future Without Economic
              Rights?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-05 @ 21:19:50</span
              ><span class="points-container"
                >Points: <span class="points">113</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44475634"
                  >Comments</a
                ><span class="descendants">: 96</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44475537">
          <h3>
            <a
              class="item"
              href="https://aginfer.bearblog.dev/how-to-network-as-an-introvert/"
              >How to Network as an Introvert</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-05 @ 21:06:41</span
              ><span class="points-container"
                >Points: <span class="points">139</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44475537"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44475453">
          <h3>
            <a
              class="item"
              href="https://viksit.substack.com/p/optimizing-tool-selection-for-llm"
              >Optimizing Tool Selection for LLM Workflows with Differentiable
              Programming</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-05 @ 20:52:46</span
              ><span class="points-container"
                >Points: <span class="points">78</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44475453"
                  >Comments</a
                ><span class="descendants">: 33</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44474759">
          <h3>
            <a
              class="item"
              href="https://www.smithsonianmag.com/smart-news/these-cod-have-been-shrinking-dramatically-for-decades-now-scientists-say-theyve-solved-the-mystery-180986920/"
              >Eastern Baltic cod grow much smaller than they did due to
              overfishing</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-05 @ 19:00:34</span
              ><span class="points-container"
                >Points: <span class="points">164</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44474759"
                  >Comments</a
                ><span class="descendants">: 54</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44473888">
          <h3>
            <a
              class="item"
              href="https://xata.io/blog/behind-the-scenes-speeding-up-pgstream-snapshots-for-postgresql"
              >Speeding up PostgreSQL dump/restore snapshots</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-05 @ 16:42:19</span
              ><span class="points-container"
                >Points: <span class="points">107</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44473888"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44473400">
          <h3>
            <a
              class="item"
              href="https://basicappleguy.com/basicappleblog/macos-icon-history"
              >macOS Icon History</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-05 @ 15:25:41</span
              ><span class="points-container"
                >Points: <span class="points">172</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44473400"
                  >Comments</a
                ><span class="descendants">: 67</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44473135">
          <h3>
            <a
              class="item"
              href="https://www.inkandswitch.com/essay/local-first/"
              >Local-first software (2019)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-05 @ 14:45:39</span
              ><span class="points-container"
                >Points: <span class="points">656</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44473135"
                  >Comments</a
                ><span class="descendants">: 213</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44472992">
          <h3>
            <a
              class="item"
              href="https://www.eumetsat.int/europes-first-geostationary-sounder-satellite-launched"
              >Europe's first geostationary sounder satellite is launched</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-05 @ 14:21:14</span
              ><span class="points-container"
                >Points: <span class="points">178</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44472992"
                  >Comments</a
                ><span class="descendants">: 38</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44458532">
          <h3>
            <a class="item" href="https://nanochess.org/transputer_board.html"
              >Development of a transputer ISA board</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-03 @ 19:43:59</span
              ><span class="points-container"
                >Points: <span class="points">7</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44458532"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44457549">
          <h3>
            <a
              class="item"
              href="https://www.bytebot.ai/blog/designing-bytebot-why-the-simplest-desktop-agent-abstraction-wins"
              >Why the simplest desktop agent abstraction wins</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-03 @ 17:52:05</span
              ><span class="points-container"
                >Points: <span class="points">11</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44457549"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44448802">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=An-ImWVppNQ"
              >ClojureScript from First Principles [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-02 @ 21:03:13</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44448802"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44447797">
          <h3>
            <a
              class="item"
              href="https://toytales.ca/atomic-bomb-ring-from-kix-1947/"
              >Atomic "Bomb" Ring from KiX (1947)</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-02 @ 19:24:18</span
              ><span class="points-container"
                >Points: <span class="points">70</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44447797"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44447233">
          <h3>
            <a class="item" href="https://relentlessly.no/"
              >Show HN: a community for collaborating on sideprojects</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-02 @ 18:32:33</span
              ><span class="points-container"
                >Points: <span class="points">13</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44447233"
                  >Comments</a
                ><span class="descendants">: 5</span></span
              >
            </h4>
            <div class="text">
              <p>
                A year ago i completed my first sideproject, a digital course on
                how to "cold email a chief information security officer". I
                thought and think its a great course, but of course I fell into
                all the traps (didnt verify a need, i thought id make it and
                everyone would buy automatically), i tested google ads but hated
                nerding on that, so i decided to find a marketing person to
                partner up with! But i knew no one! That got me thinking how
                many people with relevant knowledge that isnt connected to
                others who need it, so i started gathering these people in an
                excel doc with what they know and then we created a slack
                channel for this etc! (fenomener.framer.website). Suddenly now
                we are 400 people sharing about our projects and collaborating!
                But if there is one thing ive been missing its "profile pages",
                that doesnt work well in slack. Id love to see an awesome
                project but then lurk a bit on who this person is before
                engaging in anything. so thats when we made the common decision
                of: what the heck, lets just build the thing we want.
              </p>
              <p>
                So I partnered up with a fullstack (from the community!!!!!) and
                built relentlessly.no. we have like 50 users now and 17 projects
                and just finished our Minimum Lovable Product. Its not good
                enough yet and we are working on adding notifications and at
                least optimizing for first the product leader flow, then the
                builder flow. (we often get product leaders with a demo joining
                that are HUNGRY for devs, or we get builders hungry for anyone
                with an idea! its a god damn marketplace maybe!)
              </p>
              <p>
                I actually think this might become 1000x more important than YC,
                because its place and time independant, and no one or no org has
                taken a place in the important space of sideprojects, where
                actually "everything begins". SIdeprojects sound so naive and
                not important, but after nerding on this a year i kinda see them
                as the most powerful thing we have. And this feels exactly as
                counter intuitive as a great idea should feel. So if we can let
                relentlessly resourceful people around the globe bump into each
                other, then the next gen of startups will be born here. Thats
                freaking meaningful stuff. And the hidden gem in all of this is
                something that didnt strike me before i had been working on it
                for a year: The point isnt to find someone to collab on your
                current sideproject. The whole value is the relationships that
                get formed. Because now after a year in this space then
                sideprojects have come and gone, but i have like 8 new
                "cofounder ready" relationships formed, where i actually trust
                them and "know" them and can build in the future with them. So i
                guess we are sortof solving "cofounder matching" without the
                akward "cofounder meetup night", or the slow "you HAVE to go to
                school with them for four years.
              </p>
              <p>
                business wise this is my passion project for life I feel, and
                the ethical founder friendly direction im pursuing is just
                adding this on the site: "if you met your cofounder here, like
                the product and youre raising money with another confirmed
                investor: please invite me to your round &lt;3"
              </p>
              <p>
                I dont have money but maybe that will sort itself out, so this
                just makes me the worlds poorest investor with the most original
                investment product ever :D
              </p>
            </div>
          </section>
        </section>
        <section id="44445462">
          <h3>
            <a
              class="item"
              href="https://www.architect.co/posts/how-fast-is-it-really"
              >Fast Code Is Easy. Measuring It Is Hard</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-02 @ 16:10:59</span
              ><span class="points-container"
                >Points: <span class="points">23</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44445462"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44444673">
          <h3>
            <a
              class="item"
              href="https://mattwills.bearblog.dev/haskell-postfix/"
              >Haskell, Reverse Polish Notation, and Parsing</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-02 @ 15:07:19</span
              ><span class="points-container"
                >Points: <span class="points">52</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44444673"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44442691">
          <h3>
            <a
              class="item"
              href="https://hackarcana.com/article/yet-another-zip-trick"
              >Yet Another Zip Trick</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-02 @ 12:01:59</span
              ><span class="points-container"
                >Points: <span class="points">37</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44442691"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="44440968">
          <h3>
            <a class="item" href="https://xclacksoverhead.org/home/about"
              >X-Clacks-Overhead</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-07-02 @ 07:14:19</span
              ><span class="points-container"
                >Points: <span class="points">218</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=44440968"
                  >Comments</a
                ><span class="descendants">: 51</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
