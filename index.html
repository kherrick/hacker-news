<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="43656609">
          <h3>
            <a
              class="item"
              href="https://www.mikekohn.net/micro/modern_6502.php"
              >Modern 6502</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-11 @ 18:01:33</span
              ><span class="points-container"
                >Points: <span class="points">10</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43656609"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43656279">
          <h3>
            <a
              class="item"
              href="https://darkcephas.github.io/ps3_failed/ps3_failed.html"
              >The PS3 Licked the Many Cookie</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-11 @ 17:27:39</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43656279"
                  >Comments</a
                ><span class="descendants">: 66</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43656007">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/mosaic-2/jobs/ru8Nwdq-founding-engineer"
              >Mosaic (YC W25) is building a general purpose agent for video
              editing</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-11 @ 17:00:43</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43655914">
          <h3>
            <a
              class="item"
              href="https://chrismalek.me/posts/data-star-first-impressions/"
              >Datastar: Web Framework for the Future?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-11 @ 16:53:20</span
              ><span class="points-container"
                >Points: <span class="points">41</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43655914"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43655603">
          <h3>
            <a
              class="item"
              href="https://www.dropsitenews.com/p/leaked-data-israeli-censorship-meta"
              >Leaked Meta data reveals campaign to remove pro-Palestine
              posts</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-11 @ 16:24:58</span
              ><span class="points-container"
                >Points: <span class="points">262</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43655603"
                  >Comments</a
                ><span class="descendants">: 134</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43655505">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=43655505"
              >Ask HN: Has anyone quit their startup (VC-backed) over cofounder
              disagreements?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-11 @ 16:16:07</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43655505"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
            <div class="text">
              <p>
                i've been working on a startup for the past 24 months with my
                cofounder - i'm technical and she's mostly focused on business
                side (with basic frontend skills). we got funded roughly 18
                months ago for an idea i came up with, was excited about, and
                found some traction.
              </p>
              <p>
                since then we pivoted away from it. we've roughly pivoted almost
                every month to something new. there is no longer any vision or
                clear problem we're trying to solve. each month is our team
                simply fishing for ideas in different industries and domains
                hoping to strike gold.
              </p>
              <p>
                my cofounder and i don't see eye to eye on most things anymore
                and the relationship has also deteriorated significantly. my
                cofounder and i disagree upon what problems to focus on. for
                her, ideas only resonate if there are competitors who've raised
                $X million or hit certain revenue targets with no regard for
                interest or insights for a problem/industry. i'd much rather
                work on problems where i have some inherent interest and/or urge
                to solve the problem but it's hard to drive a shared vision
                between us both. this is a constant point of friction.
              </p>
              <p>
                after 24 months of working together, i'm now considering
                quitting my own startup to either go do another one or take a
                job where i can find problems and a future cofounder. has anyone
                been through anything similar in the past? how did you navigate
                this?
              </p>
            </div>
          </section>
        </section>
        <section id="43655221">
          <h3>
            <a
              class="item"
              href="https://stevana.github.io/erlangs_not_about_lightweight_processes_and_message_passing.html"
              >Erlang's not about lightweight processes and message passing</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-11 @ 15:50:49</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43655221"
                  >Comments</a
                ><span class="descendants">: 40</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43654971">
          <h3>
            <a
              class="item"
              href="https://libertiesjournal.com/online-articles/evelyn-waughs-decadent-redemption/"
              >Evelyn Waugh's Decadent Redemption</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-11 @ 15:29:10</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43654971"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43654932">
          <h3>
            <a
              class="item"
              href="https://fin.ai/research/agency-control-reliability-the-tradeoffs-in-customer-support-agents/"
              >Agency vs. Control vs. Reliability in Agent Design</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-11 @ 15:26:53</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43654932"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43654912">
          <h3>
            <a
              class="item"
              href="https://gpuopen.com/learn/bilinear-interpolation-quadrilateral-barycentric-coordinates/"
              >Bilinear interpolation on a quadrilateral using Barycentric
              coordinates</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-11 @ 15:25:13</span
              ><span class="points-container"
                >Points: <span class="points">73</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43654912"
                  >Comments</a
                ><span class="descendants">: 20</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43654881">
          <h3>
            <a class="item" href="https://github.com/Rust-GPU/Rust-CUDA"
              >Rust CUDA Project</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-11 @ 15:22:35</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43654881"
                  >Comments</a
                ><span class="descendants">: 12</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43654813">
          <h3>
            <a class="item" href="https://webrtcforthecurious.com"
              >WebRTC for the Curious</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-11 @ 15:18:21</span
              ><span class="points-container"
                >Points: <span class="points">38</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43654813"
                  >Comments</a
                ><span class="descendants">: 9</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43654279">
          <h3>
            <a
              class="item"
              href="https://wordpress.com/blog/2025/04/09/ai-website-builder/"
              >WordPress launches new free AI website builder</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-11 @ 14:36:16</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43654279"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43653672">
          <h3>
            <a class="item" href="https://lwn.net/Articles/1014979/"
              >Fedora change aims for 99% package reproducibility</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-11 @ 13:40:26</span
              ><span class="points-container"
                >Points: <span class="points">209</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43653672"
                  >Comments</a
                ><span class="descendants">: 90</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43653251">
          <h3>
            <a class="item" href="https://github.com/avkcode/container-tools"
              >Show HN: Building better base images</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-11 @ 12:56:02</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43653251"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
            <div class="text">
              This project addresses the inefficiencies of traditional
              Dockerfile-based container builds where each customization layer
              creates storage bloat through duplicate dependencies from repeated
              apt-get install commands, network inefficiency from redundant
              package downloads across different images, and slow iteration
              cycles requiring full rebuilds of all previous steps. Our solution
              enables building minimal base images from scratch using
              debootstrap that precisely include only required components in the
              initial build, while allowing creation of specialized variants
              (Java, Kafka, etc.) from these common foundations - resulting in
              significantly leaner images, faster builds, and more efficient
              resource utilization compared to standard Docker layer stacking
              approaches.
            </div>
          </section>
        </section>
        <section id="43653004">
          <h3>
            <a
              class="item"
              href="https://www.reuters.com/world/us/pentagon-terminate-51-billion-it-contracts-with-accenture-deloitte-others-2025-04-11/"
              >Pentagon to terminate $5.1B in IT contracts with Accenture,
              Deloitte</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-11 @ 12:23:13</span
              ><span class="points-container"
                >Points: <span class="points">378</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43653004"
                  >Comments</a
                ><span class="descendants">: 503</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43652723">
          <h3>
            <a
              class="item"
              href="https://rakhim.exotext.com/but-what-if-i-really-want-a-faster-horse"
              >But what if I want a faster horse?</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-11 @ 11:39:18</span
              ><span class="points-container"
                >Points: <span class="points">1006</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43652723"
                  >Comments</a
                ><span class="descendants">: 456</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43652160">
          <h3>
            <a class="item" href="https://www.howtomakealongbow.co.uk"
              >How to Make a Longbow</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-11 @ 09:49:56</span
              ><span class="points-container"
                >Points: <span class="points">106</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43652160"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43652024">
          <h3>
            <a
              class="item"
              href="https://terriblesoftware.org/2025/03/31/your-strengths-are-your-weaknesses/"
              >Strengths Are Your Weaknesses</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-11 @ 09:27:08</span
              ><span class="points-container"
                >Points: <span class="points">219</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43652024"
                  >Comments</a
                ><span class="descendants">: 77</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43651390">
          <h3>
            <a class="item" href="https://www.londonunderground.live/"
              >Live Map of the London Underground</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-11 @ 07:41:33</span
              ><span class="points-container"
                >Points: <span class="points">410</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43651390"
                  >Comments</a
                ><span class="descendants">: 97</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43650656">
          <h3>
            <a class="item" href="https://www.hgreer.com/PlayingInTheCreek/"
              >Playing in the Creek</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-11 @ 05:05:33</span
              ><span class="points-container"
                >Points: <span class="points">302</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43650656"
                  >Comments</a
                ><span class="descendants">: 102</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43648713">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=43648713"
              >Show HN: Time Travel with Your SQL</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-10 @ 22:48:37</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43648713"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
            <div class="text">
              <a href="https://github.com/clidey/whodb"
                >https://github.com/clidey/whodb</a
              >)
              <p>
                I am not a fan of the dbeaver, beekeeper, adminer, etc
                experience because they are bloated, ugly, and at best okay but
                not great.
              </p>
              <p>Hence why I started working on WhoDB.</p>
              <p>The approach:</p>
              <p>- browser-based (chrome/firefox)</p>
              <p>- no bloat</p>
              <p>- jupyter notebook-like experience (Scratchpad)</p>
              <p>
                - built-in AI co-pilot with ollama (local) or openai/anthropic
              </p>
              <p>
                We just shipped query history and replay (time travel?) to the
                Scratchpad.
              </p>
              <p>
                Would love for you to check it out and give some feedback aka
                roast us into oblivion:
              </p>
              <p>docker run -p 8080:8080 clidey/whodb</p>
              <p>Food for thought:</p>
              <p>1. What's your biggest database pain point?</p>
              <p>2. Any killer feature missing from current tools?</p>
            </div>
          </section>
        </section>
        <section id="43647880">
          <h3>
            <a class="item" href="https://www.thecoder.cafe/p/100-go-mistakes"
              >The Story Behind “100 Go Mistakes and How to Avoid Them”</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-10 @ 20:47:01</span
              ><span class="points-container"
                >Points: <span class="points">351</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43647880"
                  >Comments</a
                ><span class="descendants">: 106</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43646920">
          <h3>
            <a
              class="item"
              href="https://www.404media.co/how-a-2-000-made-in-the-usa-liberty-phone-phone-is-manufactured/"
              >How a $2k 'Made in the USA' Phone Is Manufactured</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-10 @ 18:43:56</span
              ><span class="points-container"
                >Points: <span class="points">343</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43646920"
                  >Comments</a
                ><span class="descendants">: 409</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43646219">
          <h3>
            <a class="item" href="https://www.bigbookofr.com/">Big Book of R</a>
          </h3>
          <section>
            <h4>
              <span>2025-04-10 @ 17:34:19</span
              ><span class="points-container"
                >Points: <span class="points">271</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43646219"
                  >Comments</a
                ><span class="descendants">: 97</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43628070">
          <h3>
            <a
              class="item"
              href="https://mssv.net/2025/04/07/a-puzzle-designer-on-blue-prince-a-roguelike-puzzle-masterpiece/"
              >Blue Prince Is a Roguelike Puzzle Masterpiece</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-09 @ 01:27:48</span
              ><span class="points-container"
                >Points: <span class="points">12</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43628070"
                  >Comments</a
                ><span class="descendants">: 2</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43627300">
          <h3>
            <a
              class="item"
              href="https://www.bbc.com/news/articles/cwy6gjwd0g6o"
              >Titanic digital scan reveals new details of ship's final hours</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-08 @ 22:58:55</span
              ><span class="points-container"
                >Points: <span class="points">24</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43627300"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43622514">
          <h3>
            <a
              class="item"
              href="https://codesandbox.io/blog/how-we-clone-a-running-vm-in-2-seconds"
              >We clone a running VM in 2 seconds</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-08 @ 14:55:27</span
              ><span class="points-container"
                >Points: <span class="points">126</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43622514"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43621378">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/science/2025/04/researchers-build-a-risc-v-processor-using-a-2d-semiconductor/"
              >A 32-bit processor made with an atomically thin semiconductor</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-08 @ 13:08:49</span
              ><span class="points-container"
                >Points: <span class="points">26</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43621378"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="43612835">
          <h3>
            <a
              class="item"
              href="https://www.newscientist.com/article/2474993-bonobos-use-a-kind-of-syntax-once-thought-to-be-unique-to-humans/"
              >Bonobos use a kind of syntax once thought to be unique to
              humans</a
            >
          </h3>
          <section>
            <h4>
              <span>2025-04-07 @ 15:51:21</span
              ><span class="points-container"
                >Points: <span class="points">83</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=43612835"
                  >Comments</a
                ><span class="descendants">: 48</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2025/index.md"
              >2025</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
