<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="39389858">
          <h3>
            <a
              class="item"
              href="https://interconnected.org/home/2024/02/15/galactic-compass"
              >Show HN: Galactic Compass – an app that points to the galactic
              center</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 22:12:11</span
              ><span class="points-container"
                >Points: <span class="points">17</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39389858"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
            <div class="text">
              I made a single-serving iPhone app with a floating green arrow
              that always points to the center of the Milky Way, 26,000 lights
              years away. It’s weirdly grounding. I’ve never made an app before,
              so here’s how it worked with ChatGPT.
            </div>
          </section>
        </section>
        <section id="39389448">
          <h3>
            <a
              class="item"
              href="https://cleantechnica.com/2024/02/15/solar-battery-storage-to-make-up-81-of-new-u-s-electric-generating-capacity-in-2024/"
              >Solar and Batteries Make Up 81% of New US Electric-Generating
              Capacity in 2024</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 21:45:53</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39389448"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39389375">
          <h3>
            <a
              class="item"
              href="https://papers.ssrn.com/sol3/papers.cfm?abstract_id=4727999"
              >Breaking BFT: Quantifying the Cost to Attack Bitcoin and
              Ethereum</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 21:41:37</span
              ><span class="points-container"
                >Points: <span class="points">5</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39389375"
                  >Comments</a
                ><span class="descendants">: 1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39389154">
          <h3>
            <a
              class="item"
              href="https://www.nasdaq.com/articles/coinbase-swings-to-profit-on-interest-income-strength"
              >Coinbase swings to profit on interest income strength</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 21:27:00</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39389154"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39388269">
          <h3>
            <a class="item" href="https://github.com/MakeYourPet/hexapod"
              >Build your own 3D printed Hexapod</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 20:25:32</span
              ><span class="points-container"
                >Points: <span class="points">44</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39388269"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39388218">
          <h3>
            <a
              class="item"
              href="https://techcrunch.com/2024/02/15/apple-confirms-its-breaking-iphone-web-apps-in-the-eu-on-purpose/"
              >Apple confirms it's breaking iPhone web apps in the EU on
              purpose</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 20:22:09</span
              ><span class="points-container"
                >Points: <span class="points">263</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39388218"
                  >Comments</a
                ><span class="descendants">: 192</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39387850">
          <h3>
            <a
              class="item"
              href="https://bclarkson-code.github.io/posts/llm-from-scratch-scalar-autograd/post.html"
              >Building an LLM from Scratch: Automatic Differentiation</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 20:01:52</span
              ><span class="points-container"
                >Points: <span class="points">95</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39387850"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39387641">
          <h3>
            <a class="item" href="https://astral.sh/blog/uv"
              >Uv: Python packaging in Rust</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 19:50:27</span
              ><span class="points-container"
                >Points: <span class="points">312</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39387641"
                  >Comments</a
                ><span class="descendants">: 104</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39387304">
          <h3>
            <a
              class="item"
              href="https://app.campsite.co/campsite/p/notes/rengvq2txami"
              >PWAs wont replace native iOS apps</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 19:28:13</span
              ><span class="points-container"
                >Points: <span class="points">147</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39387304"
                  >Comments</a
                ><span class="descendants">: 174</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39387191">
          <h3>
            <a
              class="item"
              href="https://www.renesas.com/us/en/about/press-room/renesas-acquire-pcb-design-software-leader-altium-make-electronics-design-accessible-broader-market"
              >Renesas Buys Altium</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 19:20:41</span
              ><span class="points-container"
                >Points: <span class="points">32</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39387191"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39386726">
          <h3>
            <a class="item" href="https://www.youtube.com/watch?v=SSnsmqIj1MI"
              >Problem solving across 100,633 lines of code – Gemini 1.5 Pro
              Demo [video]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 18:51:25</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39386726"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39386611">
          <h3>
            <a
              class="item"
              href="https://blog.substrate.tools/safe-and-reliable-production-changes-for-fast-moving-teams-and-how-rivian-recently-got-this-wrong/"
              >Safe and reliable production changes, and how Rivian recently got
              this wrong</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 18:43:48</span
              ><span class="points-container"
                >Points: <span class="points">43</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39386611"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39386572">
          <h3>
            <a class="item" href="https://slidecross.io"
              >Show HN: SlideCross – a combination of a crossword and Rubik's
              Cube</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 18:41:12</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39386572"
                  >Comments</a
                ><span class="descendants">: 11</span></span
              >
            </h4>
            <div class="text">
              <p>I'd really appreciate any feedback! Thanks</p>
            </div>
          </section>
        </section>
        <section id="39386293">
          <h3>
            <a
              class="item"
              href="https://www.inf.fu-berlin.de/lehre/pmo/eng/Sagan-Baloney.pdf"
              >The Fine Art of Baloney Detection (1995) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 18:24:31</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39386293"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39386195">
          <h3>
            <a
              class="item"
              href="https://polar.sh/matmair/posts/code-chores-the-boring-part-of-maintenance"
              >Code Chores: The boring part of maintaining</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 18:16:34</span
              ><span class="points-container"
                >Points: <span class="points">28</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39386195"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39386156">
          <h3>
            <a class="item" href="https://openai.com/sora"
              >Sora: Creating video from text</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 18:14:18</span
              ><span class="points-container"
                >Points: <span class="points">1564</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39386156"
                  >Comments</a
                ><span class="descendants">: 911</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39385811">
          <h3>
            <a class="item" href="https://arxiv.org/abs/2402.04326"
              >Personality Trait Recognition Using ECG Spectrograms and Deep
              Learning</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 17:49:03</span
              ><span class="points-container"
                >Points: <span class="points">27</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39385811"
                  >Comments</a
                ><span class="descendants">: 8</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39385635">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=39385635"
              >Launch HN: Zenfetch (YC W23) – Turn notes/browser history into an
              AI assistant</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 17:39:48</span
              ><span class="points-container"
                >Points: <span class="points">60</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39385635"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
            <div class="text">
              <a href="https://www.zenfetch.com">https://www.zenfetch.com</a>) -
              a Chrome extension that transforms your saved web browsing into a
              personal chatGPT and search engine. Here’s a demo video:
              <a
                href="https://www.loom.com/share/abe9d40dc82545a482be55b631f9bf2a?sid=53fb1432-0c59-4c08-93aa-3b3184363cc3"
                >https://www.loom.com/share/abe9d40dc82545a482be55b631f9bf2a?...</a
              >
              <p>
                How it works: (1) Optionally import your existing saved web
                browsing through one of our integrations or through a URL CSV
                import. (2) Click the Zenfetch icon in a tab to save any PDF,
                YouTube video, note, article, email, forum post, etc. Zenfetch
                can save almost anything across the internet. (3) Zenfetch
                indexes the text or transcript and adds that information to your
                personal knowledge assistant. This is done on your computer so
                you don’t have to worry about paywalls, logins, etc. (4) Use the
                dashboard or side panel to search your knowledge or chat with
                your personal knowledge assistant.
              </p>
              <p>
                We built Zenfetch to solve our personal problem: we were reading
                tons of content but using little to none of the information.
                While searching for solutions, we found that most tools were
                good at storing information but not at retrieving it. We even
                found that search functionalities on existing read-later tools
                got worse the more content we saved.
              </p>
              <p>
                A few examples of how our users use Zenfetch: “What was that
                article I read on the new nuclear fusion company?”, “Analyze
                this strategy based on the Lenny Rachitsky article I read”,
                “Summarize Karpathys video introducing LLMs”, “Which research
                papers mentioned the increase in carbon emissions?”, “Compile
                the different perspectives I’ve read on climate change”, and
                more.
              </p>
              <p>
                Zenfetch is free for the first 14 days and then costs $14.99/mo
                (No credit card needed for the trial).
              </p>
              <p>
                We’d love for you to try it out and let us know what we can do
                to improve your experience! While we only work on Chromium-based
                browsers right now, we’re actively working on browser
                compatibility and integrations. Let us know which ones to
                prioritize!
              </p>
            </div>
          </section>
        </section>
        <section id="39385228">
          <h3>
            <a class="item" href="https://thethreevirtues.com/"
              >Three virtues of a great programmer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 17:10:15</span
              ><span class="points-container"
                >Points: <span class="points">124</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39385228"
                  >Comments</a
                ><span class="descendants">: 64</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39385121">
          <h3>
            <a class="item" href="https://www.finleycms.com/careers/"
              >Finley (YC W21) is a fintech hiring software engineers (US
              remote)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 17:00:21</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39384731">
          <h3>
            <a
              class="item"
              href="https://512pixels.net/projects/default-mac-wallpapers-in-5k/"
              >Every default macOS wallpaper</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 16:29:39</span
              ><span class="points-container"
                >Points: <span class="points">302</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39384731"
                  >Comments</a
                ><span class="descendants">: 108</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39383446">
          <h3>
            <a
              class="item"
              href="https://blog.google/technology/ai/google-gemini-next-generation-model-february-2024/"
              >Our next-generation model: Gemini 1.5</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 15:02:09</span
              ><span class="points-container"
                >Points: <span class="points">743</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39383446"
                  >Comments</a
                ><span class="descendants">: 427</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39383386">
          <h3>
            <a class="item" href="https://observablehq.com/blog/observable-2-0"
              >Observable 2.0, a static site generator for data apps</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 14:57:49</span
              ><span class="points-container"
                >Points: <span class="points">351</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39383386"
                  >Comments</a
                ><span class="descendants">: 81</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39382590">
          <h3>
            <a class="item" href="https://news.ycombinator.com/item?id=39382590"
              >Ask HN: Nitter officially declared "over" today
              – alternatives?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 13:45:02</span
              ><span class="points-container"
                >Points: <span class="points">148</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39382590"
                  >Comments</a
                ><span class="descendants">: 158</span></span
              >
            </h4>
            <div class="text">
              <p>
                Now however there is an official declaration on the site itself:
                <a href="https://nitter.cz/">https://nitter.cz/</a>
              </p>
              <p>
                Due to the reasons stated by Nitter itself on their repo, it
                seems unlikely there will alternatives.
              </p>
              <p>Are there any currently?</p>
            </div>
          </section>
        </section>
        <section id="39382092">
          <h3>
            <a
              class="item"
              href="https://phys.org/news/2024-02-eurasia-dominant-east-west-axis.html"
              >A quantitative test of Diamond’s axis of orientation
              hypothesis</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 12:54:17</span
              ><span class="points-container"
                >Points: <span class="points">65</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39382092"
                  >Comments</a
                ><span class="descendants">: 52</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39381300">
          <h3>
            <a class="item" href="https://en.wikipedia.org/wiki/EncroChat"
              >EncroChat</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 11:03:33</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39381300"
                  >Comments</a
                ><span class="descendants">: 7</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39380790">
          <h3>
            <a class="item" href="https://www.joshcanhelp.com/goodbye-auth0/"
              >Goodbye Auth0</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-15 @ 09:45:32</span
              ><span class="points-container"
                >Points: <span class="points">242</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39380790"
                  >Comments</a
                ><span class="descendants">: 242</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39377052">
          <h3>
            <a
              class="item"
              href="https://theconversation.com/online-anonymity-study-found-stable-pseudonyms-created-a-more-civil-environment-than-real-user-names-171374"
              >Stable pseudonyms create a more civil environment than real
              names: study (2021)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-14 @ 23:28:27</span
              ><span class="points-container"
                >Points: <span class="points">115</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39377052"
                  >Comments</a
                ><span class="descendants">: 44</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39368155">
          <h3>
            <a
              class="item"
              href="https://github.com/mattwright324/youtube-metadata/wiki/YouTube-Oddities"
              >YouTube Oddities</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-14 @ 09:37:39</span
              ><span class="points-container"
                >Points: <span class="points">55</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39368155"
                  >Comments</a
                ><span class="descendants">: 19</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39344583">
          <h3>
            <a
              class="item"
              href="https://www.atlasobscura.com/articles/history-of-heinz-ketchup"
              >When every ketchup but one went extinct (2022)</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-02-12 @ 13:38:28</span
              ><span class="points-container"
                >Points: <span class="points">72</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39344583"
                  >Comments</a
                ><span class="descendants">: 106</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
