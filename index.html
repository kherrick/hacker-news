<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <meta
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
      name="viewport"
    />
    <meta name="description" content="Hacker News" />
    <meta name="theme-color" content="#fff" />
    <title>Hacker News</title>
    <link rel="manifest" href="manifest.json" />
    <link
      href="data:image/x-icon;base64,AAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAAQECAAEAAQA4AAAAFgAAACgAAAABAAAAAgAAAAEAAQAAAAAAAAAAAAAAAAAAAAAAAAAA"
      rel="icon"
      type="image/x-icon"
    />
    <link
      href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAIAAQMAAADOtka5AAAAA1BMVEUAAACnej3aAAAANklEQVR42u3BAQEAAACCIP+vbkhAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB8G4IAAAFjdVCkAAAAAElFTkSuQmCC"
      rel="apple-touch-icon"
    />
    <style>
      /*<!--*/
      body {
        color: rgb(25, 25, 25);
        font-family: Verdana, Geneva, sans-serif;
        margin: 0;
      }

      a {
        text-decoration: none;
      }

      a:link,
      a:focus,
      a:hover,
      a:active {
        color: rgb(75, 75, 125);
      }

      a:visited {
        color: rgb(25, 25, 25);
      }

      h1 > a,
      h1 > a:link,
      h1 > a:focus,
      h1 > a:hover,
      h1 > a:active,
      h1 > a:visited,
      h2 > a,
      h2 > a:link,
      h2 > a:focus,
      h2 > a:hover,
      h2 > a:active,
      h2 > a:visited {
        color: rgb(25, 25, 25);
      }

      h1 {
        background-color: rgb(255, 102, 0);
        margin: 0;
        padding: 1rem;
      }

      h2 {
        background-color: rgb(200, 200, 200);
        margin: 1rem 0;
        padding: 0.5rem 0.5rem 0.5rem 1rem;
      }

      #latest > section,
      #archives > section {
        margin: 0 1rem 1rem 1rem;
        padding-bottom: 1rem;
      }

      #latest > section:not(:last-child),
      #archives > section:not(:last-child) {
        border-bottom: 1px dotted rgb(200, 200, 200);
      }

      section > h3 {
        margin: 0 0 0.5rem 0;
      }

      section > h4 {
        font-weight: normal;
        margin: 0 0 0 1rem;
      }

      .descendants-container,
      .points-container {
        align-items: center;
        border-left: 1px solid #333;
        display: inline-flex;
        margin-left: 0.5rem;
        padding-left: 0.5rem;
        text-align: center;
      }

      .points {
        align-items: center;
        display: inline-flex;
        height: 1rem;
        margin-left: 1ch;
        min-width: 3ch;
      }

      .text {
        line-height: 1.5rem;
        margin: 1rem 1rem 0 1rem;
        overflow: auto;
      }

      .text > p:first-child {
        margin-top: 1rem;
      }

      .text > p:last-child {
        margin-bottom: 0;
      }
      /*-->*/
    </style>
  </head>

  <body>
    <main>
      <h1><a href="https://kherrick.github.io/hacker-news/">Hacker News</a></h1>
      <section id="latest">
        <h2>Latest</h2>
        <section id="39992993">
          <h3>
            <a
              class="item"
              href="https://www.ycombinator.com/companies/ofone/jobs/u2E2fCX-founding-software-engineer"
              >OfOne (YC W23) – voice AI for drive-thrus – is hiring a founding
              engineer in SF</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-10 @ 17:00:50</span
              ><span class="points-container"
                >Points: <span class="points">1</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39992797">
          <h3>
            <a
              class="item"
              href="https://arstechnica.com/gadgets/2024/04/5-25-inch-floppy-disks-expected-to-help-run-san-francisco-trains-until-2030/"
              >5.25-inch floppy disks expected to help run San Francisco trains
              until 2030</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-10 @ 16:46:09</span
              ><span class="points-container"
                >Points: <span class="points">29</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39992797"
                  >Comments</a
                ><span class="descendants">: 28</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39991693">
          <h3>
            <a
              class="item"
              href="https://www.theverge.com/2024/4/10/24124411/kobo-libra-colour-clara-colour-e-reader-kindle-e-ink"
              >Kobo announces color e-readers</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-10 @ 15:18:27</span
              ><span class="points-container"
                >Points: <span class="points">107</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39991693"
                  >Comments</a
                ><span class="descendants">: 59</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39991675">
          <h3>
            <a
              class="item"
              href="https://ai.meta.com/blog/next-generation-meta-training-inference-accelerator-AI-MTIA/"
              >Meta MTIA v2 – Meta Training and Inference Accelerator</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-10 @ 15:16:22</span
              ><span class="points-container"
                >Points: <span class="points">96</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39991675"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39990346">
          <h3>
            <a class="item" href="https://adsb.exposed/"
              >Show HN: Ads-B Visualizer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-10 @ 13:15:02</span
              ><span class="points-container"
                >Points: <span class="points">115</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39990346"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
            <div class="text">
              <a href="https://adsb.exposed/">https://adsb.exposed/</a>
              <p>
                Source code:
                <a href="https://github.com/ClickHouse/adsb.exposed/"
                  >https://github.com/ClickHouse/adsb.exposed/</a
                >
              </p>
              <p>
                The results significantly exceeded my expectations because the
                pictures are insanely beautiful, and the data is a treasure
                trove.
              </p>
              <p>
                It proves many statements that were not certain: - it is
                feasible to generate tiles by aggregation on a pixel level
                (instead of hexagons or rectangular grid); - it does not require
                JPG/PNG tiles - we can transfer raw bitmap data with zstd
                compression; - it is possible to do it in real time;
              </p>
            </div>
          </section>
        </section>
        <section id="39990319">
          <h3>
            <a
              class="item"
              href="https://thenewstack.io/webassembly-adoption-is-slow-and-steady-winning-the-race/"
              >WebAssembly Adoption: Is Slow and Steady Winning the Race?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-10 @ 13:11:42</span
              ><span class="points-container"
                >Points: <span class="points">48</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39990319"
                  >Comments</a
                ><span class="descendants">: 36</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39990109">
          <h3>
            <a
              class="item"
              href="https://minus-ze.ro/posts/flattening-bezier-curves-and-arcs/"
              >Flattening Bézier Curves and Arcs</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-10 @ 12:48:57</span
              ><span class="points-container"
                >Points: <span class="points">21</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39990109"
                  >Comments</a
                ><span class="descendants">: 3</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39990004">
          <h3>
            <a class="item" href="https://awards.acm.org/about/2023-turing"
              >2023 ACM Turing Prize awarded to Avi Wigderson</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-10 @ 12:36:43</span
              ><span class="points-container"
                >Points: <span class="points">121</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39990004"
                  >Comments</a
                ><span class="descendants">: 22</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39989992">
          <h3>
            <a
              class="item"
              href="https://badgerbadgerbadgerbadger.dev/posts/misc/2024-04-08-is-it-dry-yet/"
              >Is It Dry Yet?</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-10 @ 12:35:22</span
              ><span class="points-container"
                >Points: <span class="points">16</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39989992"
                  >Comments</a
                ><span class="descendants">: 16</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39989467">
          <h3>
            <a class="item" href="https://deco.cx"
              >Show HN: Deco.cx – realtime TypeScript web editor</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-10 @ 11:30:46</span
              ><span class="points-container"
                >Points: <span class="points">34</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39989467"
                  >Comments</a
                ><span class="descendants">: 6</span></span
              >
            </h4>
            <div class="text">
              <a href="https://github.com/deco-cx/deco"
                >https://github.com/deco-cx/deco</a
              >
              and discover more at our site
              <a href="https://deco.cx/">https://deco.cx/</a>.
              <p>
                We built frontend tools at a hyper-growth e-commerce platform
                for 9 years. Deco.cx is the thing that we wish existed when we
                were managing hundreds of enterprise-grade React-based websites.
              </p>
              <p>
                The gist is: JSX, HTMX, TypeScript, Tailwind and Deno. All
                visually editable in a beautiful, collaborative, REALTIME (!)
                admin UI. Great for devs, great for content.
              </p>
              <p>
                In essence, we're a git-based TypeScript-first configuration
                management system. We take TypeScript code that represents your
                site, your entities, your UI, and we allow anyone to "save"
                configuration and content based on those types.
              </p>
              <p>
                It's great for developers, because you can code directly on the
                web, or on your machine, and get instant feedback. You "export
                interface Props" and boom, an automatic form is generated. It's
                great for the business users, the content editors, because you
                just press "." (dot) in your keyboard and you go into a visual
                edit mode for the page you're at right now. Everything the
                developer exported in TypeScript is editable.
              </p>
              <p>
                And when you hit "publish", it's already live, with a proper
                CDN, proper caching, everything already setup and just working.
                Ready to scale!
              </p>
              <p>
                But you can't fly blind. We're democratizing pro-level tools for
                web analytics and observability by bundling in our Pro plan:
                fully-managed Plausible analytics and HyperDX observability.
                Check them out — these are great tools on their own, and they
                shine in the deco.cx platform bundle.
              </p>
              <p>
                We don't want to be the only answer, we don't claim to be right
                about anything, we just want to make the friendly and accessible
                open-source tool that we wish existed when we were junior
                developers. If you want to participate, please join our discord
                community at
                <a href="https://deco.cx/discord">https://deco.cx/discord</a>
              </p>
              <p>
                on open-source: our admin UI core is not ready for prime time,
                we're working to open-source it this year. but basically
                everything else, our integrations, templates and configuration
                management runtime are all open-source already! take a look at
                these:
                <a href="https://github.com/deco-cx/deco"
                  >https://github.com/deco-cx/deco</a
                >
                <a href="https://github.com/deco-cx/apps"
                  >https://github.com/deco-cx/apps</a
                >
                <a href="https://github.com/deco-sites/storefront"
                  >https://github.com/deco-sites/storefront</a
                >
                Making the admin UI core extensible and open source is a MAIN
                OBJECTIVE for this year, so expect news here soon!
              </p>
              <p>Thanks for your support!</p>
            </div>
          </section>
        </section>
        <section id="39988993">
          <h3>
            <a
              class="item"
              href="https://matheusportela.com/double-entry-bookkeeping-as-a-directed-graph"
              >Double-Entry Bookkeeping as a Directed Graph</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-10 @ 10:13:23</span
              ><span class="points-container"
                >Points: <span class="points">329</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39988993"
                  >Comments</a
                ><span class="descendants">: 181</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39988948">
          <h3>
            <a
              class="item"
              href="https://github.com/dsnet/compress/blob/master/doc/bzip2-format.pdf"
              >Bzip2 Format Specification (2016) [pdf]</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-10 @ 10:07:47</span
              ><span class="points-container"
                >Points: <span class="points">47</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39988948"
                  >Comments</a
                ><span class="descendants">: 17</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39988912">
          <h3>
            <a
              class="item"
              href="https://proton.me/blog/proton-standard-notes-join-forces"
              >Proton and Standard Notes are joining forces</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-10 @ 10:01:14</span
              ><span class="points-container"
                >Points: <span class="points">50</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39988912"
                  >Comments</a
                ><span class="descendants">: 21</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39988716">
          <h3>
            <a class="item" href="https://www.marginalia.nu/log/a_104_dep_bug/"
              >Deep Bug</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-10 @ 09:30:59</span
              ><span class="points-container"
                >Points: <span class="points">171</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39988716"
                  >Comments</a
                ><span class="descendants">: 46</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39988697">
          <h3>
            <a
              class="item"
              href="https://www.thestack.technology/open-source-pioneer-perens-says-time-for-post-open/"
              >Open Source pioneer Perens says it's time to contemplate a
              Post-Open world</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-10 @ 09:28:04</span
              ><span class="points-container"
                >Points: <span class="points">18</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39988697"
                  >Comments</a
                ><span class="descendants">: 10</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39988655">
          <h3>
            <a
              class="item"
              href="https://github.com/raganwald/javascript-allonge-six"
              >JavaScript Allongé, the "Six" Edition</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-10 @ 09:20:19</span
              ><span class="points-container"
                >Points: <span class="points">33</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39988655"
                  >Comments</a
                ><span class="descendants">: 4</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39988580">
          <h3>
            <a class="item" href="https://csvbase.com/blog/7"
              >Client libraries are better when they have no API</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-10 @ 09:10:24</span
              ><span class="points-container"
                >Points: <span class="points">128</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39988580"
                  >Comments</a
                ><span class="descendants">: 82</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39988415">
          <h3>
            <a
              class="item"
              href="https://techcrunch.com/2024/04/09/microsoft-employees-exposed-internal-passwords-security-lapse/"
              >Microsoft employees exposed internal passwords in security
              lapse</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-10 @ 08:46:40</span
              ><span class="points-container"
                >Points: <span class="points">116</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39988415"
                  >Comments</a
                ><span class="descendants">: 60</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39987579">
          <h3>
            <a class="item" href="https://compressx.app"
              >Show HN: CompressX, my FFmpeg wrapper for macOS</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-10 @ 06:32:18</span
              ><span class="points-container"
                >Points: <span class="points">87</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39987579"
                  >Comments</a
                ><span class="descendants">: 63</span></span
              >
            </h4>
            <div class="text">
              <p>
                For those who may not be familiar, FFmpeg is a powerful tool for
                converting, streaming, and recording audio and video content.
              </p>
              <p>
                I started CompressX as a weekend project to serve my 9-5 jobs,
                primarily to compress demo videos for uploading to GitLab and
                sharing with my colleagues. It took me 2 weeks to make the first
                working version. I shared the demo on Twitter and the reaction
                was extraordinary. People loved it, they said that I was
                bringing the Pied Piper to life.
              </p>
              <p>
                Four months later, I hit the $9,000 mark in revenue. I never
                expected to make a dime from this project, let alone eight
                thousand dollars. It's been a surreal experience, but it's also
                been incredibly rewarding.
              </p>
              <p>
                I put a lot of time and effort into developing this tool, and
                it's amazing to see it paying off. It's been a great journey so
                far and I'm excited to see where it takes me next.
              </p>
            </div>
          </section>
        </section>
        <section id="39986687">
          <h3>
            <a
              class="item"
              href="https://www.bookforum.com/print/3004/nicholson-baker-learns-to-draw-25332"
              >Ways of Seeing: Nicholson Baker learns to draw</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-10 @ 03:30:38</span
              ><span class="points-container"
                >Points: <span class="points">59</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39986687"
                  >Comments</a
                ><span class="descendants">: 13</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39986593">
          <h3>
            <a
              class="item"
              href="https://buttondown.email/thehypothesis/archive/how-a-science-fiction-obsession-led-me-to/"
              >A science fiction obsession led me to psychological war</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-10 @ 03:08:55</span
              ><span class="points-container"
                >Points: <span class="points">145</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39986593"
                  >Comments</a
                ><span class="descendants">: 49</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39983490">
          <h3>
            <a class="item" href="https://github.com/dolthub/go-mysql-server"
              >A MySQL compatible database engine written in pure Go</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-09 @ 19:50:43</span
              ><span class="points-container"
                >Points: <span class="points">374</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39983490"
                  >Comments</a
                ><span class="descendants">: 74</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39983233">
          <h3>
            <a
              class="item"
              href="https://www.afterbabel.com/p/phone-based-childhood-cause-epidemic"
              >Yes, social media is a cause of the epidemic of teenage mental
              illness</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-09 @ 19:29:32</span
              ><span class="points-container"
                >Points: <span class="points">951</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39983233"
                  >Comments</a
                ><span class="descendants">: 951</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39978819">
          <h3>
            <a
              class="item"
              href="https://spectrum.ieee.org/organic-semiconductors-2667704065"
              >Better Biosensors Just Need a Touch of Cheap Plastic</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-09 @ 12:44:16</span
              ><span class="points-container"
                >Points: <span class="points">20</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39978819"
                  >Comments</a
                ><span class="descendants">: 0</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39976640">
          <h3>
            <a class="item" href="https://qdiv.dev/posts/eth2/"
              >Show HN: I made a discrete logic network card</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-09 @ 06:24:15</span
              ><span class="points-container"
                >Points: <span class="points">452</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39976640"
                  >Comments</a
                ><span class="descendants">: 77</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39976391">
          <h3>
            <a
              class="item"
              href="https://chipsandcheese.com/2024/04/08/intels-ambitious-meteor-lake-igpu/"
              >Intel's Ambitious Meteor Lake iGPU</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-09 @ 05:29:02</span
              ><span class="points-container"
                >Points: <span class="points">104</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39976391"
                  >Comments</a
                ><span class="descendants">: 25</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39969042">
          <h3>
            <a
              class="item"
              href="https://www.theregister.com/2024/04/08/ms_dos_easter_egg/"
              >A cheeky intern nearly turned MS-DOS into NSFW-DOS</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-08 @ 12:34:21</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39969042"
                  >Comments</a
                ><span class="descendants">: 58</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39968844">
          <h3>
            <a class="item" href="https://placenames.rtwilson.com/"
              >British Placename Mapper</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-08 @ 12:06:01</span
              ><span class="points-container"
                >Points: <span class="points">75</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39968844"
                  >Comments</a
                ><span class="descendants">: 91</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39968537">
          <h3>
            <a
              class="item"
              href="https://www.jvoderho.com/blog.html?blogid=Transformer%20as%20a%20general%20purpose%20computer"
              >Transformer as a General Purpose Computer</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-08 @ 11:16:45</span
              ><span class="points-container"
                >Points: <span class="points">118</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39968537"
                  >Comments</a
                ><span class="descendants">: 34</span></span
              >
            </h4>
          </section>
        </section>
        <section id="39968297">
          <h3>
            <a
              class="item"
              href="https://www.bunniestudios.com/blog/2024/a-2-axis-multihead-light-positioner/"
              >A 2-Axis, Multihead Light Positioner</a
            >
          </h3>
          <section>
            <h4>
              <span>2024-04-08 @ 10:37:31</span
              ><span class="points-container"
                >Points: <span class="points">76</span></span
              ><span class="descendants-container"
                ><a href="https://news.ycombinator.com/item?id=39968297"
                  >Comments</a
                ><span class="descendants">: 14</span></span
              >
            </h4>
          </section>
        </section>
      </section>
      <section id="archives">
        <h2>
          <a
            href="https://github.com/kherrick/hacker-news/blob/main/archives/index.md"
            >Archives</a
          >
        </h2>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2024/index.md"
              >2024</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2023/index.md"
              >2023</a
            >
          </h3>
        </section>
        <section>
          <h3>
            <a
              href="https://github.com/kherrick/hacker-news/blob/main/archives/2022/index.md"
              >2022</a
            >
          </h3>
        </section>
      </section>
    </main>
    <script type="module">
      import { buildDescendants } from "./lib/build-html-descendants.js";
      import { buildNextItem } from "./lib/build-html-next-item.js";
      import { getNextDateTime } from "./lib/date-time.js";

      const updateSectionById = (id) =>
        fetch(`https://hacker-news.firebaseio.com/v0/item/${id}.json`).then(
          (result) =>
            result.json().then(({ descendants, id, score, text, type }) => {
              const currentItem = document.getElementById(id);

              if (score) {
                currentItem.querySelector(".points").textContent = score;
              }

              if (descendants && (type === "poll" || type === "story")) {
                const currentDescendants =
                  currentItem.querySelector(".descendants");

                if (currentDescendants) {
                  currentDescendants.textContent = `: ${descendants}`;
                } else {
                  const comments = buildDescendants(
                    document,
                    descendants,
                    `https://news.ycombinator.com/item?id=${id}`
                  );

                  currentItem.querySelector("h4").appendChild(comments);
                }
              }

              if (text) {
                const currentText = currentItem.querySelector(".text");

                if (currentText) {
                  currentText.innerHTML = text.replace(/\0/g, "");
                } else {
                  const content = document.createElement("div");
                  content.innerHTML = text.replace(/\0/g, "");
                  content.setAttribute("class", "text");

                  currentItem.appendChild(content);
                }
              }
            })
        );

      class UpdateQueue {
        constructor() {
          this._ids = [];
          this._isUpdating = false;
        }

        addItemById(id) {
          this._ids.push(id);
        }

        async flush() {
          const id = this._ids.shift();

          if (id) {
            this._isUpdating = true;

            await updateSectionById(id);
            await this.flush();
          } else {
            this._isUpdating = false;

            setTimeout(async () => {
              if (!this._isUpdating && this._ids && this._ids.length) {
                await this.flush();
              }
            }, 0);
          }
        }
      }

      // get latest data
      const latestSection = document.getElementById("latest");

      for (let item of latestSection.querySelectorAll("section[id]")) {
        updateSectionById(item.getAttribute("id"));
      }

      if ("IntersectionObserver" in window) {
        window.hackerNewsState = { index: [], nextTimeIndex: -1 };

        const addNewsItem = async (newsItem, queue) => {
          try {
            const { date, time, itemComments, itemTitle, itemLink } = newsItem;
            const section = await buildNextItem({
              document,
              dateTime: `${date}, ${time}`,
              itemComments,
              itemLink,
              itemTitle: new DOMParser().parseFromString(
                itemTitle.replace(/\\/g, ""),
                "text/html"
              ).documentElement.textContent,
              fetchItemDetails: false,
            });

            // display loading indicator for section
            section.querySelector(".points-container").innerHTML =
              'Points: <span class="points"><img style="height: 100%;" src="lib/images/loading.svg" /></span>';

            const id = section.getAttribute("id");
            if (!document.getElementById(id)) {
              document.getElementById("latest").appendChild(section);

              queue.addItemById(id);
            }
          } catch (error) {}
        };

        const buildArchiveIndex = async (lastDateTime) => {
          const nextDate = lastDateTime.slice(0, 10);
          const nextYear = nextDate.slice(0, 4);

          return (
            await (
              await fetch(
                `https://raw.githubusercontent.com/kherrick/hacker-news/main/archives/${nextYear}/${nextDate}/index.md`
              )
            ).text()
          )
            .split("\n")
            .filter((line) => line.match(new RegExp("^\\* \\[")))
            .map((line) => {
              const segment = line.replace("* ", "").split("](");
              const pubDate = segment[0].slice(1);

              const itemComments = segment[1].split(") - [")[0];
              const itemTitle = segment[1].split(") - [")[1];
              const itemLink = segment[2].slice(0, -1);
              const date = pubDate.slice(0, 10);
              const time = pubDate.slice(-8);

              return {
                date,
                itemComments,
                itemLink,
                itemTitle,
                time,
              };
            });
        };

        const handleIntersectingEntry = async (entry, queue) => {
          if (entry.isIntersecting) {
            const lastDateTime = document
              .getElementById("latest")
              .querySelector(
                "section:last-child > section > h4 > span"
              ).textContent;

            const nextDateTime = getNextDateTime(lastDateTime ?? "", -1);
            const archiveIndex = await buildArchiveIndex(nextDateTime);
            const nextTimeIndex = archiveIndex.findIndex(
              ({ time }) => time === nextDateTime.slice(-8)
            );

            const handleIndexUpdate = (index, existingIndexValues = []) => {
              index.forEach((i) => {
                existingIndexValues.push(i);
              });
              return existingIndexValues;
            };

            window.hackerNewsState = {
              index: handleIndexUpdate(
                archiveIndex,
                window.hackerNewsState.index
              ),
              nextTimeIndex,
            };

            let currentTimeIndex = nextTimeIndex + 1;
            const items = Object.values(window.hackerNewsState.index);
            for (let item of items) {
              if (currentTimeIndex < window.hackerNewsState.index.length) {
                addNewsItem(items[currentTimeIndex], queue);

                currentTimeIndex = currentTimeIndex + 1;
              }
            }

            queue.flush();
          }
        };

        const archives = document.getElementById("archives");
        const archivesObserver = new IntersectionObserver(
          (entries) => {
            const queue = new UpdateQueue();

            entries.forEach((entry) => handleIntersectingEntry(entry, queue));
          },
          {
            root: null,
            rootMargin: "0px",
            threshold: 0,
          }
        );

        archivesObserver.observe(archives);

        let latestSectionsExpanded = true;
        const handleLatestHeaderClick = () => {
          latestSectionsExpanded = !latestSectionsExpanded;

          if (latestSectionsExpanded) {
            archivesObserver.observe(archives);
          } else {
            archivesObserver.disconnect(archives);
          }

          for (let section of document.querySelectorAll("#latest > section")) {
            section.style.display = latestSectionsExpanded ? "block" : "none";
          }
        };

        const latestHeader = document.querySelector("#latest > h2");
        latestHeader.style.cursor = "pointer";
        latestHeader.addEventListener("click", handleLatestHeaderClick);
      }
    </script>
    <script type="module">
      import { Workbox } from "https://storage.googleapis.com/workbox-cdn/releases/6.4.1/workbox-window.prod.mjs";

      if ("serviceWorker" in navigator) {
        const base = document.querySelector("base");
        const serviceWorkerPath = `${
          base ? base.href.replace(/\/$/, "") : ""
        }/service-worker.js`;

        const wb = new Workbox(serviceWorkerPath);

        // setup event listeners
        wb.addEventListener("waiting", (event) => {
          wb.addEventListener("controlling", () => {
            window.location.reload();
          });

          wb.messageSkipWaiting();
        });

        wb.register();
      }
    </script>
  </body>
</html>
